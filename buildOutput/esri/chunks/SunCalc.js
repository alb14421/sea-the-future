// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports"],function(n){"use strict";var t=Math.PI,r=Math.sin,e=Math.cos,u=Math.tan,o=Math.asin,a=Math.atan2,i=Math.acos,c=t/180,f=864e5,d=2440588,s=2451545,M={dec:0,ra:0};function l(n){return new Date((n+.5-d)*f)}function h(n){return function(n){return n.valueOf()/f-.5+d}(n)-s}var v=23.4397*c;function p(n,t){return a(r(n)*e(v)-u(t)*r(v),e(n))}function N(n,t){return o(r(t)*e(v)+e(t)*r(v)*r(n))}function P(n,t,o){return a(r(n),e(n)*r(t)-u(o)*e(t))}function x(n,t,u){return o(r(t)*r(u)+e(t)*e(u)*e(n))}function E(n,t){return c*(280.16+360.9856235*n)-t}function I(n){return c*(357.5291+.98560028*n)}function O(n){return c*(1.9148*r(n)+.02*r(2*n)+3e-4*r(3*n))}function T(n,r){return n+r+102.9372*c+t}function g(n,t){var r=I(n),e=T(r,O(r));return t||(t={dec:0,ra:0}),t.dec=N(e,0),t.ra=p(e,0),t}var m={PolarException:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(n,t,r,e){var u=c*-r,o=c*t,a=h(n),i=g(a,M),f=E(a,u)-i.ra;return e||(e={azimuth:0,altitude:0}),e.azimuth=P(f,o,i.dec),e.altitude=x(f,o,i.dec),e}},A=[[-.83,"sunrise","sunset"]];m.addTime=function(n,t,r){A.push([n,t,r])};var L=9e-4;function R(n,r,e){return L+(n+r)/(2*t)+e}function G(n,t,e){return s+n+.0053*r(t)-.0069*r(2*e)}function H(n){var t=c*(134.963+13.064993*n),u=c*(93.272+13.22935*n),o=c*(218.316+13.176396*n)+6.289*c*r(t),a=5.128*c*r(u),i=385001-20905*e(t);return{ra:p(o,a),dec:N(o,a),dist:i}}m.getTimes=function(n,u,o){var a=c*-o,f=c*u,d=function(n,r){return Math.round(n-L-r/(2*t))}(h(n),a),s=R(0,a,d),M=I(s),v=O(M),p=T(M,v),P=N(p,0),x=G(s,M,p);function E(n){var t=function(n,t,u){return i((r(n)-r(t)*r(u))/(e(t)*e(u)))}(n,f,P);return G(R(t,a,d),M,p)}var g,H,_,z,D,S,U,w={solarNoon:l(x),nadir:l(x-.5),polarException:m.PolarException.NORMAL};for(g=0,H=A.length;g<H;g+=1)D=x-((z=E((_=A[g])[0]*c))-x),w[_[1]]=l(D),w[_[2]]=l(z);return w.polarException=(S=A[0][0]*c,(U=(r(S)-r(f)*r(P))/(e(f)*e(P)))<-1?m.PolarException.MIDNIGHT_SUN:U>1?m.PolarException.POLAR_NIGHT:m.PolarException.NORMAL),w},m.getMoonPosition=function(n,t,r){var e=c*-r,o=c*t,a=h(n),i=H(a),f=E(a,e)-i.ra,d=x(f,o,i.dec);return d+=.017*c/u(d+10.26*c/(d+5.1*c)),{azimuth:P(f,o,i.dec),altitude:d,distance:i.dist}},m.getMoonFraction=function(n){var t=h(n),u=g(t),o=H(t),c=149598e3,f=i(r(u.dec)*r(o.dec)+e(u.dec)*e(o.dec)*e(u.ra-o.ra)),d=a(c*r(f),o.dist-c*e(f));return(1+e(d))/2},n.SunCalc=m});