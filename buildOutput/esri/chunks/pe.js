// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../assets","../core/has"],function(e,t,_,o){"use strict";let p;function r(){return!!t._pe}function n(){return!!o("esri-wasm")}function P(){return p||(p=new Promise((t,_)=>e(["./pe-wasm"],t,_)).then(({default:e})=>e({locateFile:e=>_.getAssetUrl(`esri/geometry/support/${e}`)})).then(e=>{h(e)}),p)}t._pe=null;const s={geogToProj(e,_,o){t._pe.ensureCache.prepare();const p=I(o),r=o===p,n=t._pe.ensureFloat64(p),P=t._pe._pe_geog_to_proj(t._pe.getPointer(e),_,n);return P&&U(o,_,n,r),P},projGeog(e,t,_,o){switch(o){case i.PE_TRANSFORM_P_TO_G:return s.projToGeog(e,t,_);case i.PE_TRANSFORM_G_TO_P:return s.geogToProj(e,t,_)}return 0},projToGeog:(e,t,_)=>s.projToGeogCenter(e,t,_,0),projToGeogCenter(e,_,o,p){t._pe.ensureCache.prepare();const r=I(o),n=o===r,P=t._pe.ensureFloat64(r),s=t._pe._pe_proj_to_geog_center(t._pe.getPointer(e),_,P,p);return s&&U(o,_,P,n),s}};class i{static init(){i.PE_BUFFER_MAX=t._pe.PeDefs.prototype.PE_BUFFER_MAX,i.PE_NAME_MAX=t._pe.PeDefs.prototype.PE_NAME_MAX,i.PE_MGRS_MAX=t._pe.PeDefs.prototype.PE_MGRS_MAX,i.PE_USNG_MAX=t._pe.PeDefs.prototype.PE_USNG_MAX,i.PE_DD_MAX=t._pe.PeDefs.prototype.PE_DD_MAX,i.PE_DDM_MAX=t._pe.PeDefs.prototype.PE_DDM_MAX,i.PE_DMS_MAX=t._pe.PeDefs.prototype.PE_DMS_MAX,i.PE_UTM_MAX=t._pe.PeDefs.prototype.PE_UTM_MAX,i.PE_PARM_MAX=t._pe.PeDefs.prototype.PE_PARM_MAX,i.PE_TYPE_NONE=t._pe.PeDefs.prototype.PE_TYPE_NONE,i.PE_TYPE_GEOGCS=t._pe.PeDefs.prototype.PE_TYPE_GEOGCS,i.PE_TYPE_PROJCS=t._pe.PeDefs.prototype.PE_TYPE_PROJCS,i.PE_TYPE_GEOGTRAN=t._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN,i.PE_TYPE_COORDSYS=t._pe.PeDefs.prototype.PE_TYPE_COORDSYS,i.PE_TYPE_UNIT=t._pe.PeDefs.prototype.PE_TYPE_UNIT,i.PE_TYPE_LINUNIT=t._pe.PeDefs.prototype.PE_TYPE_LINUNIT,i.PE_STR_OPTS_NONE=t._pe.PeDefs.prototype.PE_STR_OPTS_NONE,i.PE_STR_AUTH_NONE=t._pe.PeDefs.prototype.PE_STR_AUTH_NONE,i.PE_STR_AUTH_TOP=t._pe.PeDefs.prototype.PE_STR_AUTH_TOP,i.PE_STR_NAME_CANON=t._pe.PeDefs.prototype.PE_STR_NAME_CANON,i.PE_STR_FMT_WKT=t._pe.PeDefs.prototype.PE_STR_FMT_WKT,i.PE_STR_FMT_WKT2=t._pe.PeDefs.prototype.PE_STR_FMT_WKT2,i.PE_PARM_X0=t._pe.PeDefs.prototype.PE_PARM_X0,i.PE_PARM_ND=t._pe.PeDefs.prototype.PE_PARM_ND,i.PE_TRANSFORM_1_TO_2=t._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2,i.PE_TRANSFORM_2_TO_1=t._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1,i.PE_TRANSFORM_P_TO_G=t._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G,i.PE_TRANSFORM_G_TO_P=t._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P,i.PE_HORIZON_RECT=t._pe.PeDefs.prototype.PE_HORIZON_RECT,i.PE_HORIZON_POLY=t._pe.PeDefs.prototype.PE_HORIZON_POLY,i.PE_HORIZON_LINE=t._pe.PeDefs.prototype.PE_HORIZON_LINE,i.PE_HORIZON_DELTA=t._pe.PeDefs.prototype.PE_HORIZON_DELTA}}t.PeDouble=null;const E={},a={},T=e=>{const _=e.getType();switch(_){case i.PE_TYPE_GEOGCS:e=t._pe.castObject(e,t._pe.PeGeogcs);break;case i.PE_TYPE_PROJCS:e=t._pe.castObject(e,t._pe.PeProjcs);break;case i.PE_TYPE_GEOGTRAN:e=t._pe.castObject(e,t._pe.PeGeogtran);break;default:_&i.PE_TYPE_UNIT&&(e=t._pe.castObject(e,t._pe.PeUnit))}return e},c={initialize(){t._pe.PeFactory.prototype.initialize(null)},coordsys:e=>c.factoryByType(i.PE_TYPE_COORDSYS,e),factoryByType(e,_){let o=null,p=E[e];if(p||(p={},E[e]=p),p.hasOwnProperty(String(_))&&(o=p[_],t._pe.compare(o,t._pe.NULL)&&(o=null)),!o){const r=t._pe.PeFactory.prototype.factoryByType(e,_);t._pe.compare(r,t._pe.NULL)||(o=T(r),p[_]=o)}return o},fromString(e,_){let o=null,p=a[e];if(p||(p={},a[e]=p),p.hasOwnProperty(_)&&(o=p[_],t._pe.compare(o,t._pe.NULL)&&(o=null)),!o){const r=t._pe.PeFactory.prototype.fromString(e,_);t._pe.compare(r,t._pe.NULL)||(o=T(r),p[_]=o)}return o},geogcs:e=>c.factoryByType(i.PE_TYPE_GEOGCS,e),geogtran:e=>c.factoryByType(i.PE_TYPE_GEOGTRAN,e),getCode:e=>t._pe.PeFactory.prototype.getCode(e),projcs:e=>c.factoryByType(i.PE_TYPE_PROJCS,e),unit:e=>c.factoryByType(i.PE_TYPE_UNIT,e)};let g;t.PeGCSExtent=null;const l={PE_GTLIST_OPTS_COMMON:0,init(){l.PE_GTLIST_OPTS_COMMON=t._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,g=t._pe._pe_getPeGTlistExtendedEntrySize()},getGTlist(e,_,o,p,r,n){let P=null;const s=new t._pe.PeInteger(n);try{const i=t._pe.PeGTlistExtended.prototype.getGTlist(e,_,o,p,r,s);if((n=s.val)&&(P=[i],n>1)){const e=t._pe.getPointer(i);for(let _=1;_<n;_++)P.push(t._pe.wrapPointer(e+g*_,t._pe.PeGTlistExtendedEntry))}}finally{t._pe.destroy(s)}return P}},y={destroy(e){if(e?.length){for(const t of e)m(t),t.getEntries().forEach(e=>{m(e);const t=e.getGeogtran();m(t),t.getParameters().forEach(m),[t.getGeogcs1(),t.getGeogcs2()].forEach(e=>{m(e);const t=e.getDatum();m(t),m(t.getSpheroid()),m(e.getPrimem()),m(e.getUnit())})});t._pe.PeGTlistExtendedEntry.prototype.Delete(e[0])}}},u={geogToGeog(e,_,o,p,r){t._pe.ensureCache.prepare();const n=I(o),P=o===n,s=t._pe.ensureFloat64(n);let i=0;p&&(i=t._pe.ensureFloat64(p));const E=t._pe._pe_geog_to_geog(t._pe.getPointer(e),_,s,i,r);return E&&U(o,_,s,P),E}},S={geodesicCoordinate(e,_,o,p,r,n,P,s){t._pe.PeLineType.prototype.geodesic_coordinate(e,_,o,p,r,n,P,s)},geodeticCoordinate(e,_,o,p,r,n,P,s,i){t._pe.PeLineType.prototype.geodetic_coordinate(e,_,o,p,r,n,P,s,i)},geodeticDistance(e,_,o,p,r,n,P,s,i,E){t._pe.PeLineType.prototype.geodetic_distance(e,_,o,p,r,n,P,s,i,E)},greatEllipticDistance(e,_,o,p,r,n,P,s,i){t._pe.PeLineType.prototype.great_elliptic_distance(e,_,o,p,r,n,P,s,i)}},O={phiToEta:(e,_)=>t._pe.PeMath.prototype.phi_to_eta(e,_),etaToPhi:(e,_)=>t._pe.PeMath.prototype.eta_to_phi(e,_),phiToPhig:(e,_)=>t._pe.PeMath.prototype.phi_to_phig(e,_),q:(e,_,o)=>t._pe.PeMath.prototype.q(e,_,o),q90:(e,_)=>t._pe.PeMath.prototype.q90(e,_)},N=(e,_,o,p,r,n)=>{let P,s;switch(t._pe.ensureCache.prepare(),e){case"dd":P=t._pe._pe_geog_to_dd,s=i.PE_DD_MAX;break;case"ddm":P=t._pe._pe_geog_to_ddm,s=i.PE_DDM_MAX;break;case"dms":P=t._pe._pe_geog_to_dms,s=i.PE_DMS_MAX}let E=0;_&&(E=t._pe.getPointer(_));const a=I(p),T=t._pe.ensureFloat64(a),c=C(o,s),g=P(E,o,T,r,t._pe.ensureInt32(c));if(g)for(let e=0;e<o;e++)n[e]=t._pe.UTF8ToString(c[e]);return g},d=(e,_,o,p,r)=>{let n;switch(t._pe.ensureCache.prepare(),e){case"dd":n=t._pe._pe_dd_to_geog;break;case"ddm":n=t._pe._pe_ddm_to_geog;break;case"dms":n=t._pe._pe_dms_to_geog}let P=0;_&&(P=t._pe.getPointer(_));const s=p.map(e=>t._pe.ensureString(e)),i=t._pe.ensureInt32(s),E=t._pe.ensureFloat64(new Array(2*o)),a=n(P,o,i,E);return a&&U(r,o,E),a},f={geogToDms:(e,t,_,o,p)=>N("dms",e,t,_,o,p),dmsToGeog:(e,t,_,o)=>d("dms",e,t,_,o),geogToDdm:(e,t,_,o,p)=>N("ddm",e,t,_,o,p),ddmToGeog:(e,t,_,o)=>d("ddm",e,t,_,o),geogToDd:(e,t,_,o,p)=>N("dd",e,t,_,o,p),ddToGeog:(e,t,_,o)=>d("dd",e,t,_,o)};class M{static init(){M.PE_MGRS_STYLE_NEW=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,M.PE_MGRS_STYLE_OLD=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,M.PE_MGRS_STYLE_AUTO=t._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,M.PE_MGRS_180_ZONE_1_PLUS=t._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,M.PE_MGRS_ADD_SPACES=t._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}static geogToMgrsExtended(e,_,o,p,r,n,P){t._pe.ensureCache.prepare();let s=0;e&&(s=t._pe.getPointer(e));const E=I(o),a=t._pe.ensureFloat64(E),T=C(_,i.PE_MGRS_MAX),c=t._pe.ensureInt32(T),g=t._pe._pe_geog_to_mgrs_extended(s,_,a,p,r,n,c);if(g)for(let e=0;e<_;e++)P[e]=t._pe.UTF8ToString(T[e]);return g}static mgrsToGeogExtended(e,_,o,p,r){t._pe.ensureCache.prepare();let n=0;e&&(n=t._pe.getPointer(e));const P=o.map(e=>t._pe.ensureString(e)),s=t._pe.ensureInt32(P),i=t._pe.ensureFloat64(new Array(2*_)),E=t._pe._pe_mgrs_to_geog_extended(n,_,s,p,i);return E&&U(r,_,i),E}}const A={geogToUsng(e,_,o,p,r,n,P){t._pe.ensureCache.prepare();let s=0;e&&(s=t._pe.getPointer(e));const E=I(o),a=t._pe.ensureFloat64(E),T=C(_,i.PE_MGRS_MAX),c=t._pe.ensureInt32(T),g=t._pe._pe_geog_to_usng(s,_,a,p,r,n,c);if(g)for(let e=0;e<_;e++)P[e]=t._pe.UTF8ToString(T[e]);return g},usngToGeog(e,_,o,p){t._pe.ensureCache.prepare();let r=0;e&&(r=t._pe.getPointer(e));const n=o.map(e=>t._pe.ensureString(e)),P=t._pe.ensureInt32(n),s=t._pe.ensureFloat64(new Array(2*_)),i=t._pe._pe_usng_to_geog(r,_,P,s);return i&&U(p,_,s),i}};class D{static init(){D.PE_UTM_OPTS_NONE=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,D.PE_UTM_OPTS_ADD_SPACES=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,D.PE_UTM_OPTS_NS=t._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS}static geogToUtm(e,_,o,p,r){t._pe.ensureCache.prepare();let n=0;e&&(n=t._pe.getPointer(e));const P=I(o),s=t._pe.ensureFloat64(P),E=C(_,i.PE_UTM_MAX),a=t._pe.ensureInt32(E),T=t._pe._pe_geog_to_utm(n,_,s,p,a);if(T)for(let e=0;e<_;e++)r[e]=t._pe.UTF8ToString(E[e]);return T}static utmToGeog(e,_,o,p,r){t._pe.ensureCache.prepare();let n=0;e&&(n=t._pe.getPointer(e));const P=o.map(e=>t._pe.ensureString(e)),s=t._pe.ensureInt32(P),i=t._pe.ensureFloat64(new Array(2*_)),E=t._pe._pe_utm_to_geog(n,_,s,p,i);return E&&U(r,_,i),E}}class G{static{this.cache=new Map}static init(){G.PE_PCSINFO_OPTION_NONE=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,G.PE_PCSINFO_OPTION_DOMAIN=t._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,G.PE_POLE_OUTSIDE_BOUNDARY=t._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,G.PE_POLE_POINT=t._pe.PePCSInfo.prototype.PE_POLE_POINT}static generate(e,_=G.PE_PCSINFO_OPTION_DOMAIN){let o=null,p=null;return G.cache.has(e)&&(p=G.cache.get(e),p[_]&&(o=p[_])),o||(o=t._pe.PePCSInfo.prototype.generate(e,_),p||(p=[],G.cache.set(e,p)),p[_]=o),o}}const R={versionString:()=>t._pe.PeVersion.prototype.version_string()};function h(e){function _(e,t,_){e[t]=_(e[t])}t._pe=e,i.init(),l.init(),M.init(),D.init(),G.init(),t.PeDouble=class extends t._pe.PeDouble{constructor(e=NaN){super(e)}destroy(){t._pe.destroy(this)}[Symbol.dispose](){this.destroy()}},t.PeGCSExtent=class extends t._pe.PeGCSExtent{destroy(){t._pe.destroy(this)}[Symbol.dispose](){this.destroy()}};const o=[t._pe.PeAngunit,t._pe.PeDatum,t._pe.PeGeogcs,t._pe.PeGeogtran,t._pe.PeObject,t._pe.PeParameter,t._pe.PePrimem,t._pe.PeProjcs,t._pe.PeSpheroid,t._pe.PeUnit];for(const e of o)_(e.prototype,"getName",e=>function(){return e.call(this,new Array(i.PE_NAME_MAX))});for(const e of[t._pe.PeGeogtran,t._pe.PeProjcs])_(e.prototype,"getParameters",e=>function(){const _=new Array(i.PE_PARM_MAX);let o=e.call(this);for(let e=0;e<_.length;e++){const p=t._pe.getValue(o,"*");_[e]=p?t._pe.wrapPointer(p,t._pe.PeParameter):null,o+=Int32Array.BYTES_PER_ELEMENT}return _});_(t._pe.PeHorizon.prototype,"getCoord",e=>function(t=!1){const _=this.getSize();if(!_)return null;const o=[];return U(o,_,e.call(this),t),o}),_(t._pe.PeGTlistExtendedEntry.prototype,"getEntries",e=>{const _=t._pe._pe_getPeGTlistExtendedGTsSize();return function(){let o=null;const p=e.call(this);if(!t._pe.compare(p,t._pe.NULL)){o=[p];const e=this.getSteps();if(e>1){const r=t._pe.getPointer(p);for(let p=1;p<e;p++)o.push(t._pe.wrapPointer(r+_*p,t._pe.PeGTlistExtendedGTs))}}return o}});const p=t._pe._pe_getPeHorizonSize(),r=e=>function(){let _=this._cache;if(_||(_=new Map,this._cache=_),_.has(e))return _.get(e);let o=null;const r=e.call(this);if(!t._pe.compare(r,t._pe.NULL)){o=[r];const e=r.getNump();if(e>1){const _=t._pe.getPointer(r);for(let r=1;r<e;r++)o.push(t._pe.wrapPointer(_+p*r,t._pe.PeHorizon))}}return _.set(e,o),o};_(t._pe.PeProjcs.prototype,"horizonGcsGenerate",r),_(t._pe.PeProjcs.prototype,"horizonPcsGenerate",r),t._pe.PeObject.prototype.toString=function(e=i.PE_STR_OPTS_NONE){t._pe.ensureCache.prepare();const _=t._pe.getPointer(this),o=t._pe.ensureInt8(new Array(i.PE_BUFFER_MAX));return t._pe.UTF8ToString(t._pe._pe_object_to_string_ext(_,e,o))},t._pe.PeGeogcs.prototype.destroy=function(){this.Delete(),m(this),this.ptr=0},t._pe.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},t._pe.PeProjcs.prototype.destroy=function(){this.Delete(),m(this),this.ptr=0},t._pe.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function m(e){if(!e)return;const _=t._pe.getClass(e);if(!_)return;const o=t._pe.getCache(_);if(!o)return;const p=t._pe.getPointer(e);p&&delete o[p]}function C(e,_){const o=[],p=new Array(_);for(let _=0;_<e;_++)o.push(t._pe.ensureInt8(p));return o}function I(e){return ArrayBuffer.isView(e)?e:Array.isArray(e[0])?e.flat():e}function U(e,_,o,p=!1){if(p)for(let p=0;p<2*_;p++)e[p]=t._pe.getValue(o+p*Float64Array.BYTES_PER_ELEMENT,"double");else{const p=0===e.length;for(let r=0;r<_;r++)p&&(e[r]=new Array(2)),e[r][0]=t._pe.getValue(o,"double"),e[r][1]=t._pe.getValue(o+Float64Array.BYTES_PER_ELEMENT,"double"),o+=2*Float64Array.BYTES_PER_ELEMENT}}const F=Object.freeze(Object.defineProperty({__proto__:null,PeCSTransformations:s,PeDefs:i,get PeDouble(){return t.PeDouble},PeFactory:c,get PeGCSExtent(){return t.PeGCSExtent},PeGTTransformations:u,PeGTlistExtended:l,PeGTlistExtendedEntry:y,PeLineType:S,PeMath:O,PeNotationDms:f,PeNotationMgrs:M,PeNotationUsng:A,PeNotationUtm:D,PePCSInfo:G,PeVersion:R,_init:h,get _pe(){return t._pe},isLoaded:r,isSupported:n,load:P},Symbol.toStringTag,{value:"Module"}));t.PeCSTransformations=s,t.PeDefs=i,t.PeFactory=c,t.PeGTTransformations=u,t.PeGTlistExtended=l,t.PeGTlistExtendedEntry=y,t.PeLineType=S,t.PeMath=O,t.PeNotationDms=f,t.PeNotationMgrs=M,t.PeNotationUsng=A,t.PeNotationUtm=D,t.PePCSInfo=G,t.PeVersion=R,t._init=h,t.isLoaded=r,t.isSupported=n,t.load=P,t.pe=F});