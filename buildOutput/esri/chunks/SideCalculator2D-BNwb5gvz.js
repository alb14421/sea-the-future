// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","./Point2D","./Geometry","./Envelope2D","./ProjectionTransformation"],function(e,t,n,r,o){"use strict";function i(e,t,n){return{m_coordinate:e.clone(),m_vertexIndex:t,m_geometryIndex:0,m_distance:n,m_bRightSide:!1,isEmpty:s}}function s(){return Number.isNaN(this.m_distance)}e.calculateSide=function e(i,s,g=-1,u=-1){if(i.isEmpty())return 3;const c=i.getGeometryType();if(n.isSegment(c))return function(e,r,o,i){if(o>=0||i>=0)return n.throwInvalidArgumentException("");if(e.isDegenerate(0))return e.getStartXY().equals(r)?2:3;if(!e.isCurve()){const n=t.Point2D.orientationRobust(r,e.getStartXY(),e.getEndXY());return n<0?1:n>0?0:2}const s=e.getClosestCoordinate(r,!1),g=e.getTangent(s),u=e.getCoord2D(s),c=t.Point2D.orientationRobust(r,u,u.add(g));return c<0?1:c>0?0:2}(i,s,g,u);if(c===n.GeometryType.enumPolygon)return function(e,t,i,s){(i>=0||s>=0)&&n.throwInvalidArgumentException("");const g=new r.Envelope2D;e.queryEnvelope(g);const u=o.isPoint2DInPolygon2D(e,t,0);return 0===u?0:1===u?1:2}(i,s,g,u);if(c===n.GeometryType.enumPolyline)return function(r,o,i,s){(i<0&&s>=0||i>=0&&s<0)&&n.throwInvalidArgumentException("");const g=r.querySegmentIterator();if(i<0){let n=Number.MAX_VALUE,r=0;for(;g.nextPath();)for(;g.hasNextSegment();){const e=g.nextSegment(),u=e.getClosestCoordinate(o,!1),c=e.getCoord2D(u),a=t.Point2D.sqrDistance(c,o);a<n?(r=1,i=g.getStartPointIndex(),s=g.getPathIndex(),n=a):a===n&&r++}if(0===r)return 3;if(1===r)return g.resetToVertex(i,s),e(g.nextSegment(),o)}const u=function(e,n,r,o){const i={i1:-1,i2:-1,bRight1:!1,bRight2:!1};if(i.i1=function(e,t,n){for(e.resetToVertex(t,n);e.hasNextSegment();)if(!e.nextSegment().isDegenerate(0))return e.getStartPointIndex();for(e.resetToVertex(t,n);e.hasPreviousSegment();)if(!e.previousSegment().isDegenerate(0))return e.getStartPointIndex();return-1}(n,r,o),-1!==i.i1){n.resetToVertex(i.i1,-1);const r=n.nextSegment(),o=r.getClosestCoordinate(e,!1),s=r.getCoord2D(o),g=t.Point2D.sqrDistance(s,e);{const t=s.clone();t.subThis(r.getStartXY());const n=e.clone();n.subThis(r.getStartXY()),i.bRight1=t.crossProduct(n)<0}if(i.i2=function(e,t){for(e.resetToVertex(t,-1),e.nextSegment();e.hasNextSegment();)if(!e.nextSegment().isDegenerate(0))return e.getStartPointIndex();return-1}(n,i.i1),-1!==i.i2){n.resetToVertex(i.i2,-1);const r=n.nextSegment(),o=r.getClosestCoordinate(e,!1),s=r.getCoord2D(o);if(t.Point2D.sqrDistance(s,e)>g)i.i2=-1;else{const t=s.clone();t.subThis(r.getStartXY());const n=e.clone();n.subThis(r.getStartXY()),i.bRight2=t.crossProduct(n)<0}}if(-1===i.i2&&(i.i2=function(e,t){for(e.resetToVertex(t,-1);e.hasPreviousSegment();)if(!e.previousSegment().isDegenerate(0))return e.getStartPointIndex();return-1}(n,i.i1),-1!==i.i2)){n.resetToVertex(i.i2,-1);const r=n.nextSegment(),o=r.getClosestCoordinate(e,!1),s=r.getCoord2D(o);if(t.Point2D.sqrDistance(s,e)>g)i.i2=-1;else{const t=s.clone();t.subThis(r.getStartXY());const n=e.clone();n.subThis(r.getStartXY()),i.bRight2=t.crossProduct(n)<0;const o=i.i1;i.i1=i.i2,i.i2=o;const g=i.bRight1;i.bRight1=i.bRight2,i.bRight2=g}}}return i}(o,g,i,s);if(-1!==u.i1&&-1===u.i2)return u.bRight1?1:0;if(-1!==u.i1&&-1!==u.i2){if(u.bRight1===u.bRight2)return u.bRight1?1:0;{g.resetToVertex(u.i1,-1);const e=g.nextSegment().getTangent(1);g.resetToVertex(u.i2,-1);const t=g.nextSegment().getTangent(0);return e.crossProduct(t)>=0?1:0}}return g.resetToVertex(i,s),e(g.nextSegment(),o)}(i,s,g,u);if(c===n.GeometryType.enumEnvelope){const e=new r.Envelope2D;return i.queryEnvelope(e),e.contains(s)?e.containsExclusive(s)?1:2:0}return 3},e.makeEmptyProximity2DResult=function(){return i(new t.Point2D,-1,Number.NaN)},e.makeProximity2DResult=i});