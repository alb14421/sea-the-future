// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../core/mathUtils","../core/libs/gl-matrix-2/math/mat4","../core/libs/gl-matrix-2/factories/mat4f64","../core/libs/gl-matrix-2/factories/vec2f64","./vec32","../core/libs/gl-matrix-2/factories/vec3f64","../geometry/Extent","../geometry/Polygon","../geometry/projection/projectPointToVector","../geometry/projection/projectVectorToVector","../geometry/support/coordsUtils","../geometry/support/polygonExtentClipping","../geometry/support/ray","../views/3d/support/cameraUtilsInternal"],function(e,t,o,r,n,i,c,a,l,s,p,d,u,f,g){"use strict";const m=c.fromValues(0,1,0),T=c.fromValues(0,0,1),y=r.create(),x=c.create(),V=c.create();function h(e,r,n,c=g.createDirectionUp()){const{direction:a,up:l}=c;return o.fromZRotation(y,-t.deg2rad(r)),o.rotateX(y,y,t.deg2rad(n)),i.transformMat4(a,T,y),i.scale(a,a,-1),i.transformMat4(l,m,y),c}function j(e,t,o,r){return g.directionToHeadingTilt(t,o,r,T,m)}function A(e,t,o,r){const n=h(0,o,r),a=c.create();return i.scale(a,n.direction,-t),i.add(a,a,e),{up:n.up,eye:a,heading:o,tilt:r}}function R(e){return t.rad2deg(e)}function P(e){return t.deg2rad(e)}function b(e,t,o,r,n){const i=e.renderSpatialReference,c=e.spatialReference??t.spatialReference;return s.projectPointToVector(t,x,i),s.projectPointToVector(t,V,i),x[0]-=o/2,V[0]+=o/2,x[1]-=r/2,V[1]+=r/2,p.projectVectorToVector(x,i,x,c),p.projectVectorToVector(V,i,V,c),n?(n.xmin=x[0],n.ymin=x[1],n.xmax=V[0],n.ymax=V[1],n.spatialReference=c):n=new a(x[0],x[1],V[0],V[1],c),n}function E(e,t){const o=e.frustum,{renderCoordsHelper:r}=e,c=r.getAltitude(t),a=e.spatialReference,s=e.state.camera.eye,p=[],m=o.planes[5];for(let e=0;e<4;e++){const t=o.lines[e];r.intersectInfiniteManifold(f.wrap(t.origin,t.direction),c,v)||U(v,o,r,t.endpoint,c),g.clampLineSegmentToPlane(v,s,v,m),p.push(n.fromValues(v[0],v[1]))}return function(e,t,o){const r=e.map(e=>(i.set(v,e[0],e[1],0),t.fromRenderCoords(v,v,o),[v[0],v[1]]));return r.length<=2?new l({spatialReference:o}):(r.push(r[0].slice()),d.isClockwise(r)||r.reverse(),new l({rings:[r],spatialReference:o}))}(u.clipPolygonToExtent(p,r.extent),r,a)}function U(e,t,o,r,n){const c=t.lines[11].direction,a=(n-o.getAltitude(r))/c[2];i.scaleAndAdd(e,r,c,a)}const v=c.create(),w=Object.freeze(Object.defineProperty({__proto__:null,directionToHeadingTilt:j,eyeForCenterWithHeadingTilt:A,eyeTiltToLookAtTilt:P,headingTiltToDirectionUp:h,lookAtTiltToEyeTilt:R,toArea:E,toExtent:b},Symbol.toStringTag,{value:"Module"}));e.cameraUtilsPlanar=w,e.directionToHeadingTilt=j,e.eyeForCenterWithHeadingTilt=A,e.eyeTiltToLookAtTilt=P,e.headingTiltToDirectionUp=h,e.lookAtTiltToEyeTilt=R,e.toArea=E,e.toExtent=b});