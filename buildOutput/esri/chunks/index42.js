// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","./index7","./index41","./index40","./componentsUtils","./keyed","./ref","./dom","./key","./interactive","./component"],function(e,t,l,i,o,s,n,a,c,r,d){"use strict";const h="last-visible-row",b=o.i`@charset "UTF-8";:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{--calcite-internal-table-row-background: var(--calcite-table-row-background, var(--calcite-color-foreground-1));--calcite-internal-table-row-border-color: var(--calcite-table-row-border-color, transparent);display:contents}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) tr{pointer-events:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}tr{border-block-end:1px solid var(--calcite-internal-table-row-border-color);background-color:var(--calcite-internal-table-row-background)}tr.last-visible-row{border-block-end:0}@-moz-document url-prefix(){tr{box-shadow:inset 0 -1px 0 0 var(--calcite-internal-table-row-border-color)}tr.last-visible-row{box-shadow:inset 0 -1px 0 0 transparent}}:host([item-hidden]){display:none}`;class u extends o.LitElement{constructor(){super(),this.rowCells=[],this.tableRowSlotEl=n.e(),this.userTriggered=!1,this._selected=!1,this.clickHandler=()=>{this.handleRowSelection()},this.handleKeyboardSelection=e=>{c.isActivationKey(e.key)&&(" "===e.key&&e.preventDefault(),this.handleRowSelection())},this.itemHidden=!1,this.disabled=!1,this.interactionMode="interactive",this.numbered=!1,this.selectionMode="none",this.calciteInternalTableRowFocusRequest=o.createEvent({cancelable:!1}),this.calciteInternalTableRowSelect=o.createEvent({cancelable:!1}),this.calciteTableRowSelect=o.createEvent({cancelable:!1}),this.listenOn(document,"calciteInternalTableRowFocusChange",this.calciteInternalTableRowFocusChangeHandler)}static{this.properties={alignment:[3,{},{reflect:!0}],itemHidden:[7,{},{reflect:!0,type:Boolean}],bodyRowCount:[9,{},{type:Number}],cellCount:[9,{},{type:Number}],disabled:[7,{},{reflect:!0,type:Boolean}],interactionMode:1,lastVisibleRow:[5,{},{type:Boolean}],numbered:[5,{},{type:Boolean}],positionAll:[9,{},{type:Number}],positionSection:[9,{},{type:Number}],positionSectionLocalized:1,readCellContentsToAT:[5,{},{type:Boolean}],rowType:1,scale:1,selected:[7,{},{reflect:!0,type:Boolean}],selectedRowCount:[9,{},{type:Number}],selectedRowCountLocalized:1,selectionMode:1}}static{this.styles=b}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this.handleCellChanges())}load(){this.listenOn(this.el.shadowRoot,"slotchange",this.handleSlotChange)}willUpdate(e){(e.has("bodyRowCount")||e.has("scale")||e.has("selectedRowCount")||e.has("interactionMode")&&(this.hasUpdated||"interactive"!==this.interactionMode))&&this.handleCellChanges(),(e.has("numbered")&&(this.hasUpdated||!1!==this.numbered)||e.has("selectionMode")&&(this.hasUpdated||"none"!==this.selectionMode))&&this.handleDelayedCellChanges(),!e.has("selected")||!this.hasUpdated&&!1===this.selected||this.userTriggered||this.calciteInternalTableRowSelect.emit()}updated(){r.updateHostInteraction(this)}loaded(){this.tableRowEl&&this.rowCells.length>0&&this.updateCells()}handleSlotChange(){this.updateCells()}handleCellChanges(){this.tableRowEl&&this.rowCells.length>0&&this.updateCells()}handleDelayedCellChanges(){this.tableRowEl&&this.rowCells.length>0&&requestAnimationFrame(()=>this.updateCells())}calciteInternalTableRowFocusChangeHandler(e){if(e.target.contains(this.el)){const t=e.detail.cellPosition,l=e.detail.rowPosition,i=e.detail.destination,o=e.detail.lastCell;if(l===this.positionAll){if(this.disabled){const e="last"===i?"previous":"first"===i?"next":i;return void this.emitTableRowFocusRequest(t,this.positionAll,e)}const e=o?this.rowCells[this.rowCells.length-1]:this.rowCells?.find((e,l)=>l+1===t);e&&e.setFocus()}}}keyDownHandler(e){if("interactive"!==this.interactionMode)return;const t=e.target,l=e.key,i=e.ctrlKey,o=this.rowCells;if(t.matches("calcite-table-cell")||t.matches("calcite-table-header"))switch(l){case"ArrowUp":this.emitTableRowFocusRequest(t.positionInRow,this.positionAll,"previous"),e.preventDefault();break;case"ArrowDown":this.emitTableRowFocusRequest(t.positionInRow,this.positionAll,"next"),e.preventDefault();break;case"PageUp":this.emitTableRowFocusRequest(t.positionInRow,this.positionAll,"first"),e.preventDefault();break;case"PageDown":this.emitTableRowFocusRequest(t.positionInRow,this.positionAll,"last"),e.preventDefault();break;case"ArrowLeft":a.focusElementInGroup(o,t,"previous",!1),e.preventDefault();break;case"ArrowRight":a.focusElementInGroup(o,t,"next",!1),e.preventDefault();break;case"Home":i?(this.emitTableRowFocusRequest(1,this.positionAll,"first"),e.preventDefault()):(a.focusElementInGroup(o,t,"first",!1),e.preventDefault());break;case"End":i?(this.emitTableRowFocusRequest(this.rowCells?.length,this.positionAll,"last",!0),e.preventDefault()):(a.focusElementInGroup(o,t,"last",!1),e.preventDefault())}}emitTableRowFocusRequest(e,t,l,i){this.calciteInternalTableRowFocusRequest.emit({cellPosition:e,rowPosition:t,destination:l,lastCell:i})}updateCells(){const e=this.alignment?this.alignment:"head"!==this.rowType?"center":"start",t=this.tableRowSlotEl.value?.assignedElements({flatten:!0})?.filter(e=>e.matches("calcite-table-cell")||e.matches("calcite-table-header")),l=Array.from(this.tableRowEl?.querySelectorAll("calcite-table-header, calcite-table-cell"))?.filter(e=>e.numberCell||e.selectionCell),i=l?l.concat(t):t;i.length>0&&i?.forEach((t,l)=>{t.interactionMode=this.interactionMode,t.lastCell=l===i.length-1,t.parentRowAlignment=e,t.parentRowIsSelected=this.selected,t.parentRowType=this.rowType,t.positionInRow=l+1,t.scale=this.scale,"CALCITE-TABLE-CELL"===t.nodeName&&(t.readCellContentsToAT=this.readCellContentsToAT,t.disabled=this.disabled)}),this.rowCells=i||[],this.cellCount=i?.length}async handleRowSelection(){("body"===this.rowType||"head"===this.rowType&&"multiple"===this.selectionMode)&&(this.userTriggered=!0,this.selected=!this.selected,await this.updateComplete,this.calciteTableRowSelect.emit())}renderSelectionIcon(){const e="multiple"===this.selectionMode&&this.selected?"check-square-f":"multiple"===this.selectionMode?"square":this.selected?"circle-f":"circle";return o.x`<calcite-icon .icon=${e} .scale=${d.getIconScale(this.scale)}></calcite-icon>`}renderSelectableCell(){return"head"===this.rowType?s.i("selection-head",o.x`<calcite-table-header alignment=center .bodyRowCount=${this.bodyRowCount} @click=${this.clickHandler} @keydown=${this.handleKeyboardSelection} .parentRowAlignment=${this.alignment} .selectedRowCount=${this.selectedRowCount} .selectedRowCountLocalized=${this.selectedRowCountLocalized} .selectionCell=${!0} .selectionMode=${this.selectionMode}></calcite-table-header>`):"body"===this.rowType?s.i("selection-body",o.x`<calcite-table-cell alignment=center @click=${this.clickHandler} @keydown=${this.handleKeyboardSelection} .parentRowAlignment=${this.alignment} .parentRowIsSelected=${this.selected} .parentRowPositionLocalized=${this.positionSectionLocalized} .selectionCell=${!0}>${this.renderSelectionIcon()}</calcite-table-cell>`):s.i("selection-foot",o.x`<calcite-table-cell alignment=center .parentRowAlignment=${this.alignment} .selectionCell=${!0}></calcite-table-cell>`)}renderNumberedCell(){return"head"===this.rowType?s.i("numbered-head",o.x`<calcite-table-header alignment=center .numberCell=${!0} .parentRowAlignment=${this.alignment}></calcite-table-header>`):"body"===this.rowType?s.i("numbered-body",o.x`<calcite-table-cell alignment=center .numberCell=${!0} .parentRowAlignment=${this.alignment}>${this.positionSectionLocalized}</calcite-table-cell>`):s.i("numbered-foot",o.x`<calcite-table-cell alignment=center .numberCell=${!0} .parentRowAlignment=${this.alignment}></calcite-table-cell>`)}render(){return r.InteractiveContainer({disabled:this.disabled,children:o.x`<tr .ariaRowIndex=${this.positionAll+1} .ariaSelected=${this.selected} class=${o.safeClassMap({[h]:this.lastVisibleRow})} @keydown=${this.keyDownHandler} ${n.n(e=>{e&&(this.tableRowEl=e,o.B(o.x`${this.numbered&&this.renderNumberedCell()||""}${"none"!==this.selectionMode&&this.renderSelectableCell()||""}<slot ${n.n(this.tableRowSlotEl)}></slot>`,e))})}></tr>`})}}o.customElement("calcite-table-row",u),e.TableRow=u,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});