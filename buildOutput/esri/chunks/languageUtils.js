// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../config","../kernel","../arcade/ArcadeDate","../arcade/ArcadeModule","../arcade/executionError","../arcade/FunctionWrapper","../arcade/ImmutableArray","../arcade/ImmutablePathArray","../arcade/ImmutablePointArray","../arcade/featureset/support/shared","../core/number","../core/sql/DateOnly","../core/sql/TimeOnly","../geometry/Extent","../geometry/Geometry","../geometry/Multipoint","../geometry/Point","../geometry/Polygon","../geometry/Polyline","../geometry/SpatialReference","../geometry/support/coordsUtils","../geometry/support/jsonUtils","../intl/locale","../support/guards","./datetime"],function(e,t,r,n,i,o,a,u,s,l,c,f,m,d,y,g,p,b,h,S,N,A,T,D,Z,x){"use strict";class C{constructor(e){this.value=e}}class O{constructor(e){this.value=e}}const k={type:"VOID"},F=Symbol("BREAK"),R=Symbol("CONTINUE");function J(e,t,r){return""===t||null==t||t===r||t===r?e:e=e.split(t).join(r)}function w(e){return e instanceof a.ArcadeFunction}function M(e){return e instanceof i.ArcadeModule}function P(e){return!!(Z.isString(e)||Z.isNumber(e)||U(e)||H(e)||W(e)||Z.isBoolean(e)||null===e||e===k||"number"==typeof e)}function G(e,t){return void 0===e?t:e}function v(e){return null==e?"":Z.isArray(e)||q(e)?"Array":U(e)?"Date":W(e)?"Time":H(e)?"DateOnly":Z.isString(e)?"String":Z.isBoolean(e)?"Boolean":Z.isNumber(e)?"Number":"esri.arcade.Attachment"===e?.declaredClass?"Attachment":"esri.arcade.Portal"===e?.declaredClass?"Portal":"esri.arcade.Dictionary"===e?.declaredClass?"Dictionary":z(e)?"KnowledgeGraph":e instanceof i.ArcadeModule?"Module":L(e)?"Feature":e instanceof b?"Point":e instanceof h?"Polygon":e instanceof S?"Polyline":e instanceof p?"Multipoint":e instanceof y?"Extent":w(e)?"Function":j(e)?"FeatureSet":V(e)?"FeatureSetCollection":_(e)?"Voxel":e===k?"":"number"==typeof e&&isNaN(e)?"Number":"Unrecognized Type"}function E(e){return e===k}function I(e){return e instanceof g}function L(e){return"esri.arcade.Feature"===e?.arcadeDeclaredClass}function _(e){return"esri.arcade.Voxel"===e?.arcadeDeclaredClass}function j(e){return"esri.arcade.featureset.support.FeatureSet"===e?.declaredRootClass}function B(e){return"esri.arcade.Dictionary"===e?.declaredClass}function Y(e){return B(e)||L(e)||_(e)}function V(e){return"esri.arcade.featureSetCollection"===e?.declaredRootClass}function z(e){return"esri.rest.knowledgeGraph.KnowledgeGraph"===e?.declaredClass}function q(e){return e instanceof u}function U(e){return e instanceof n.ArcadeDate}function H(e){return e instanceof m.DateOnly}function W(e){return e instanceof d.TimeOnly}function $(e){return null!=e&&"object"==typeof e}function K(e,t,r,n,i){if(e.length<t||e.length>r)throw new o.ArcadeExecutionError(n,"WrongNumberOfParameters",i)}function Q(e){return e<0?-Math.round(-e):Math.round(e)}function X(e,t){return isNaN(e)||null==t||""===t?e.toString():(t=J(t,"‰",""),t=J(t,"¤",""),f.format(e,{pattern:t}))}function ee(e,t){return null==t||""===t?e.toISOString(!0):e.toFormat(te(t),{locale:D.getLocale(),numberingSystem:"latn"})}function te(e,t=!1){e=e.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let r="";const n=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|Z{1,5}|.)/g;for(const i of e.match(n)||[])switch(i){case"D":r+="d";break;case"DD":r+="dd";break;case"DDD":r+="o";break;case"d":r+="c";break;case"ddd":r+="ccc";break;case"dddd":r+="cccc";break;case"M":r+="L";break;case"MM":r+="LL";break;case"MMM":r+="LLL";break;case"MMMM":r+="LLLL";break;case"YY":r+="yy";break;case"Y":case"YYYY":r+="yyyy";break;case"Q":r+="q";break;case"Z":r+="Z";break;case"ZZ":r+="ZZ";break;case"ZZZ":r+="ZZZ";break;case"ZZZZ":r+=t?"[ZZZZ]":"ZZZZ";break;case"ZZZZZ":r+=t?"[ZZZZZ]":"ZZZZZ";break;case"S":r+="'S'";break;case"SS":r+="'SS'";break;case"SSS":r+="u";break;case"A":case"a":r+="a";break;case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":case"X":case"x":r+=i;break;default:i.length>=2&&i.startsWith("[")&&i.endsWith("]")?r+=`'${i.slice(1,-1)}'`:r+=`'${i}'`}return r}function re(e,t,r){switch(r){case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}return!1}function ne(e,t,r){if(null===e){if(null===t||t===k)return re(null,null,r);if(Z.isNumber(t))return re(0,t,r);if(Z.isString(t))return re(0,ce(t),r);if(Z.isBoolean(t))return re(0,ce(t),r);if(U(t))return re(0,t.toNumber(),r);if(W(t))return re(e,t.toNumber(),r);if(H(t))return re(e,t.toNumber(),r)}if(e===k){if(null===t||t===k)return re(null,null,r);if(Z.isNumber(t))return re(0,t,r);if(Z.isString(t))return re(0,ce(t),r);if(Z.isBoolean(t))return re(0,ce(t),r);if(U(t))return re(0,t.toNumber(),r);if(W(t))return re(e,t.toNumber(),r);if(H(t))return re(e,t.toNumber(),r)}else if(Z.isNumber(e)){if(Z.isNumber(t))return re(e,t,r);if(Z.isBoolean(t))return re(e,ce(t),r);if(null===t||t===k)return re(e,0,r);if(Z.isString(t))return re(e,ce(t),r);if(U(t))return re(e,t.toNumber(),r);if(W(t))return re(e,t.toNumber(),r);if(H(t))return re(e,t.toNumber(),r)}else if(Z.isString(e)){if(Z.isString(t))return re(ae(e),ae(t),r);if(U(t))return re(ce(e),t.toNumber(),r);if(W(t))return re(ce(e),t.toNumber(),r);if(H(t))return re(ce(e),t.toNumber(),r);if(Z.isNumber(t))return re(ce(e),t,r);if(null===t||t===k)return re(ce(e),0,r);if(Z.isBoolean(t))return re(ce(e),ce(t),r)}else if(U(e)){if(U(t))return e.timeZone!==t.timeZone&&(e.isUnknownTimeZone?e=n.ArcadeDate.arcadeDateAndZoneToArcadeDate(e,t.timeZone):t.isUnknownTimeZone&&(t=n.ArcadeDate.arcadeDateAndZoneToArcadeDate(t,e.timeZone))),re(e.toNumber(),t.toNumber(),r);if(null===t||t===k)return re(e.toNumber(),0,r);if(Z.isNumber(t))return re(e.toNumber(),t,r);if(Z.isBoolean(t))return re(e.toNumber(),ce(t),r);if(Z.isString(t))return re(e.toNumber(),ce(t),r);if(W(t))throw new o.ArcadeExecutionError(null,"CannotCompareDateAndTime",null);if(H(t))return re(e.toNumber(),t.toNumber(),r)}else if(Z.isBoolean(e)){if(Z.isBoolean(t))return re(e,t,r);if(Z.isNumber(t))return re(ce(e),ce(t),r);if(U(t))return re(ce(e),t.toNumber(),r);if(W(t))return re(ce(e),t.toNumber(),r);if(H(t))return re(ce(e),t.toNumber(),r);if(null===t||t===k)return re(ce(e),0,r);if(Z.isString(t))return re(ce(e),ce(t),r)}else if(H(e)){if(U(t))return re(e.toNumber(),t.toNumber(),r);if(null===t||t===k)return re(e.toNumber(),0,r);if(Z.isNumber(t))return re(e.toNumber(),t,r);if(Z.isBoolean(t))return re(e.toNumber(),ce(t),r);if(Z.isString(t))return re(e.toNumber(),ce(t),r);if(W(t))throw new o.ArcadeExecutionError(null,"CannotCompareDateAndTime",null);if(H(t))return re(e.toNumber(),t.toNumber(),r)}else if(W(e)){if(U(t))throw new o.ArcadeExecutionError(null,"CannotCompareDateAndTime",null);if(null===t||t===k)return re(e.toNumber(),0,r);if(Z.isNumber(t))return re(e.toNumber(),t,r);if(Z.isBoolean(t))return re(e.toNumber(),ce(t),r);if(Z.isString(t))return re(e.toNumber(),ce(t),r);if(W(t))return re(e.toNumber(),t.toNumber(),r);if(H(t))throw new o.ArcadeExecutionError(null,"CannotCompareDateAndTime",null)}return!!ie(e,t)&&("<="===r||">="===r)}function ie(e,t){if(e===t)return!0;if(null===e&&t===k||null===t&&e===k)return!0;if(U(e)&&U(t))return e.equals(t);if(W(e)&&W(t))return e.equals(t);if(H(e)&&H(t))return e.equals(t);if(e instanceof s)return e.equalityTest(t);if(e instanceof l)return e.equalityTest(t);if(e instanceof b&&t instanceof b){const r=e.cache._arcadeCacheId,n=t.cache._arcadeCacheId;if(null!=r)return r===n}if($(e)&&$(t)){if(e._arcadeCacheId===t._arcadeCacheId&&void 0!==e._arcadeCacheId&&null!==e._arcadeCacheId)return!0;if(e._underlyingGraphic===t._underlyingGraphic&&void 0!==e._underlyingGraphic&&null!==e._underlyingGraphic)return!0}return!1}function oe(e,{useNumbersForDates:t}){let r="";for(const n in e){""!==r&&(r+=",");const i=e[n];null==i?r+=JSON.stringify(n)+":null":Z.isBoolean(i)||Z.isNumber(i)||Z.isString(i)?r+=JSON.stringify(n)+":"+JSON.stringify(i):I(i)?r+=JSON.stringify(n)+":"+se(i):W(i)||H(i)?r+=`${JSON.stringify(n)}:${JSON.stringify(i.toString())}`:q(i)||Array.isArray(i)?r+=JSON.stringify(n)+":"+se(i,null,t):U(i)?r+=t?JSON.stringify(n)+":"+JSON.stringify(i.getTime()):JSON.stringify(n)+":"+i.stringify():null!==i&&"object"==typeof i&&"castToText"in i&&(r+=JSON.stringify(n)+":"+i.castToText(t))}return"{"+r+"}"}function ae(e,t){if(Z.isString(e))return e;if(null===e)return"";if(Z.isNumber(e))return X(e,t);if(Z.isBoolean(e))return e.toString();if(U(e))return ee(e,t);if(W(e))return e.toFormat(t);if(H(e))return e.toFormat(t);if(e instanceof g)return JSON.stringify(e.toJSON());if(Z.isArray(e)){const t=[];for(let r=0;r<e.length;r++)t[r]=le(e[r]);return"["+t.join(",")+"]"}if(e instanceof u){const t=[];for(let r=0;r<e.length();r++)t[r]=le(e.get(r));return"["+t.join(",")+"]"}return null!==e&&"object"==typeof e&&"castToText"in e?e.castToText():w(e)?"object, Function":e===k?"":M(e)?"object, Module":""}function ue(e){const t=[];if(e instanceof u){for(let r=0;r<e.length();r++)t[r]=ce(e.get(r));return t}if(!Z.isArray(e))return null;for(let r=0;r<e.length;r++)t[r]=ce(e[r]);return t}function se(e,t,r=!1){if(Z.isString(e))return e;if(null===e)return"";if(Z.isNumber(e))return X(e,t);if(Z.isBoolean(e))return e.toString();if(U(e))return ee(e,t);if(W(e))return e.toFormat(t);if(H(e))return e.toFormat(t);if(e instanceof g)return e instanceof y?'{"xmin":'+e.xmin.toString()+',"ymin":'+e.ymin.toString()+","+(e.hasZ?'"zmin":'+e.zmin.toString()+",":"")+(e.hasM?'"mmin":'+e.mmin.toString()+",":"")+'"xmax":'+e.xmax.toString()+',"ymax":'+e.ymax.toString()+","+(e.hasZ?'"zmax":'+e.zmax.toString()+",":"")+(e.hasM?'"mmax":'+e.mmax.toString()+",":"")+'"spatialReference":'+Ne(e.spatialReference)+"}":Ne(e.toJSON(),(e,t)=>e.key===t.key?0:"spatialReference"===e.key?1:"spatialReference"===t.key||e.key<t.key?-1:e.key>t.key?1:0);if(Z.isArray(e)){const t=[];for(let n=0;n<e.length;n++)t[n]=le(e[n],r);return"["+t.join(",")+"]"}if(e instanceof u){const t=[];for(let n=0;n<e.length();n++)t[n]=le(e.get(n),r);return"["+t.join(",")+"]"}return null!==e&&"object"==typeof e&&"castToText"in e?e.castToText(r):w(e)?"object, Function":e===k?"":M(e)?"object, Module":""}function le(e,t=!1){if(null===e)return"null";if(Z.isBoolean(e)||Z.isString(e))return JSON.stringify(e);if(Z.isNumber(e))return e.toString();if(e instanceof g)return se(e,null,t);if(e instanceof u)return se(e,null,t);if(Array.isArray(e))return se(e,null,t);if(U(e))return t?JSON.stringify(e.getTime()):JSON.stringify(ee(e,""));if(W(e))return JSON.stringify(e.toString());if(H(e))return JSON.stringify(e.toString());if(null!==e&&"object"==typeof e){if("castToText"in e)return e.castToText(t)}else if(e===k)return"null";return"null"}function ce(e,t){return Z.isNumber(e)?e:null===e||""===e?0:U(e)||H(e)||W(e)?NaN:Z.isBoolean(e)?e?1:0:Z.isArray(e)||""===e||void 0===e?NaN:void 0!==t&&Z.isString(e)?(t=J(t,"‰",""),t=J(t,"¤",""),f.parse(e,{pattern:t})):e===k?0:Number(e)}function fe(e,t){if(U(e))return e;if(Z.isString(e)){const r=function(e,t){const r=/ (\d\d)/,i=n.createDateTimeZone(t);let o=x.DateTime.fromISO(e,{zone:i});return o.isValid||r.test(e)&&(e=e.replace(r,"T$1"),o=x.DateTime.fromISO(e,{zone:t}),o.isValid)?o:null}(e,t);if(r)return n.ArcadeDate.dateTimeToArcadeDate(r)}return null}function me(e){return Z.isBoolean(e)?e:Z.isString(e)?"true"===(e=e.toLowerCase()):!!Z.isNumber(e)&&0!==e&&!isNaN(e)}function de(e,t){const r=JSON.parse(e);return r&&!r.spatialReference&&(r.spatialReference=t),T.fromJSON(r)}function ye(e,t){return null==e?null:(null!==e.spatialReference&&void 0!==e.spatialReference||(e.spatialReference=t),e)}function ge(e){if(null===e)return null;if(e instanceof b)return"NaN"===e.x||null===e.x||isNaN(e.x)?null:e;if(e instanceof h){if(0===(e.curveRings??e.rings).length)return null;for(const t of e.curveRings??e.rings)if(t.length>0)return e;return null}if(e instanceof S){if(0===(e.curvePaths??e.paths).length)return null;for(const t of e.curvePaths??e.paths)if(t.length>0)return e;return null}return e instanceof p?0===e.points.length?null:e:e instanceof y?"NaN"===e.xmin||null===e.xmin||isNaN(e.xmin)?null:e:null}function pe(e,t){if(!e)return t;if(!e.domain)return t;let r=null,n=null;if(U(t))r=t.toNumber();else if(H(t))r=t.toString();else if(W(t))r=t.toStorageString();else if("string"===e.field.type||"esriFieldTypeString"===e.field.type)r=ae(t);else{if(null==t)return null;if(""===t)return t;r=ce(t)}for(let t=0;t<e.domain.codedValues.length;t++){const i=e.domain.codedValues[t];i.code===r&&(n=i)}return null===n?ae(t):n.name}function be(e,t){if(!e)return t;if(!e.domain)return t;let r=null;const n=ae(t);for(let t=0;t<e.domain.codedValues.length;t++){const i=e.domain.codedValues[t];i.name===n&&(r=i)}return null===r?t:r.code}function he(e,t,r=null,n=null){if(!t)return null;if(!t.fields)return null;let i,a,u=null;for(let r=0;r<t.fields.length;r++){const n=t.fields[r];n.name.toLowerCase()===e.toString().toLowerCase()&&(u=n)}if(null===u)throw new o.ArcadeExecutionError(null,"FieldNotFound",null,{key:e});let s=t.typeIdField,l="id",c=t.types;if(t.subtypeField&&(s=t.subtypeField,l="code",c=t.subtypes??[]),null===n&&r&&s)n=r.hasField(s)?r.field(s):null;else if(s&&null!==n){let e=!1;for(const t of c||[])if(n===t[l]){e=!0;break}if(!e)for(const t of c||[])if(n===t.name){n=t[l],e=!0;break}e||(n=null,r&&s&&(n=r.hasField(s)?r.field(s):null))}return null!=n&&c.some(e=>e[l]===n&&(i=e.domains?.[u.name],i&&"inherited"===i.type&&(i=Se(u.name,t),a=!0),!0)),a||i||(i=Se(e,t)),{field:u,domain:i}}function Se(e,t){let r;return t.fields.some(t=>(t.name.toLowerCase()===e.toLowerCase()&&(r=t.domain),!!r)),r}function Ne(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});const r="boolean"==typeof t.cycles&&t.cycles,n=t.cmp&&(i=t.cmp,function(e){return function(t,r){const n={key:t,value:e[t]},o={key:r,value:e[r]};return i(n,o)}});var i;const o=[];return function e(t){if(t?.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0===t)return;if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);let i,a;if(Array.isArray(t)){for(a="[",i=0;i<t.length;i++)i&&(a+=","),a+=e(t[i])||"null";return a+"]"}if(null===t)return"null";if(o.includes(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}const u=o.push(t)-1,s=Object.keys(t).sort(n?.(t));for(a="",i=0;i<s.length;i++){const r=s[i],n=e(t[r]);n&&(a&&(a+=","),a+=JSON.stringify(r)+":"+n)}return o.splice(u,1),"{"+a+"}"}(e)}function Ae(e){if(null===e)return null;const t=[];for(const r of e)L(r)?t.push(r.geometry()):t.push(r);return t}function Te(e,t){if(!(t instanceof b))throw new o.ArcadeExecutionError(null,"InvalidParameter",null);e.push(t.hasZ?t.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])}function De(e,t){if(Z.isArray(e)||q(e)){let r=!1,n=!1,i=[],a=t;if(Z.isArray(e)){for(const t of e)Te(i,t);i.length>0&&(a=e[0].spatialReference,r=e[0].hasZ,n=e[0].hasM)}else if(e instanceof l)i=e._elements,i.length>0&&(r=e._hasZ,n=e._hasM,a=e.get(0).spatialReference);else{if(!q(e))throw new o.ArcadeExecutionError(null,"InvalidParameter",null);for(const t of e.toArray())Te(i,t);i.length>0&&(a=e.get(0).spatialReference,r=!0===e.get(0).hasZ,n=!0===e.get(0).hasM)}return 0===i.length?null:(A.isClockwise(i)||(i=i.slice().reverse()),new h({rings:[i],spatialReference:a,hasZ:r,hasM:n}))}return e}function Ze(e,t){if(Z.isArray(e)||q(e)){let r=!1,n=!1,i=[],o=t;if(Z.isArray(e)){for(const t of e)Te(i,t);i.length>0&&(o=e[0].spatialReference,r=!0===e[0].hasZ,n=!0===e[0].hasM)}else if(e instanceof l)i=e._elements,i.length>0&&(r=e._hasZ,n=e._hasM,o=e.get(0).spatialReference);else if(q(e)){for(const t of e.toArray())Te(i,t);i.length>0&&(o=e.get(0).spatialReference,r=!0===e.get(0).hasZ,n=!0===e.get(0).hasM)}return 0===i.length?null:new S({paths:[i],spatialReference:o,hasZ:r,hasM:n})}return e}function xe(e,t){if(Z.isArray(e)||q(e)){let r=!1,n=!1,i=[],o=t;if(Z.isArray(e)){for(const t of e)Te(i,t);i.length>0&&(o=e[0].spatialReference,r=!0===e[0].hasZ,n=!0===e[0].hasM)}else if(e instanceof l)i=e._elements,i.length>0&&(r=e._hasZ,n=e._hasM,o=e.get(0).spatialReference);else if(q(e)){for(const t of e.toArray())Te(i,t);i.length>0&&(o=e.get(0).spatialReference,r=!0===e.get(0).hasZ,n=!0===e.get(0).hasM)}return 0===i.length?null:new p({points:i,spatialReference:o,hasZ:r,hasM:n})}return e}function Ce(e,t=!0){if(null==e)return[];if(Z.isArray(e)){const r=[];for(const n of e){const e=ae(n);(t||""!==e)&&r.push(e)}return r}if(q(e)){const r=[];for(let n=0;n<e.length();n++){const i=ae(e.get(n));(t||""!==i)&&r.push(i)}return r}if(P(e)){const r=ae(e);if(t||""!==r)return[r]}return[]}let Oe=0;function ke(e){return Oe++,Oe%100==0?(Oe=0,new Promise(t=>{setTimeout(()=>{t(e)},0)})):e}function Fe(e,t,r){switch(r){case"&":return e&t;case"|":return e|t;case"^":return e^t;case"<<":return e<<t;case">>":return e>>t;case">>>":return e>>>t}}function Re(e,t=null){return null==e?null:Z.isBoolean(e)||Z.isNumber(e)||Z.isString(e)?e:e instanceof g?!0===t?.keepGeometryType?e:e.toJSON():e instanceof u?e.toArray().map(e=>Re(e,t)):Array.isArray(e)?e.map(e=>Re(e,t)):Z.isDate(e)?e:U(e)?e.toJSDate():W(e)?e.toString():H(e)?e.toJSDate():null!==e&&"object"==typeof e&&void 0!==e.castAsJson?e.castAsJson(t):null}async function Je(e,t,r,n,i){const o=await we(e,t,r);i[n]=o}async function we(e,t=null,r=null){if(e instanceof u&&(e=e.toArray()),null==e)return null;if(P(e)||e instanceof g||Z.isDate(e)||U(e))return Re(e,r);if(Array.isArray(e)){const n=[],i=[];for(const o of e)null===o||P(o)||o instanceof g||Z.isDate(o)||U(o)?i.push(Re(o,r)):(i.push(null),n.push(Je(o,t,r,i.length-1,i)));return n.length>0&&await Promise.all(n),i}return null!==e&&"object"==typeof e&&void 0!==e.castAsJsonAsync?e.castAsJsonAsync(t,r):null}function Me(e){return Pe(e)?e.parent:e}function Pe(e){return e&&"declaredClass"in e&&"esri.layers.support.SubtypeSublayer"===e.declaredClass}function Ge(e){return e&&"declaredClass"in e&&"esri.layers.SubtypeGroupLayer"===e.declaredClass}function ve(e,t,r){const n=Me(e.fullSchema());return null===n?null:n.fields?he(t,n,e,r):null}function Ee(e){const t=Me(e.fullSchema());return null===t?null:t.fields?t.subtypeField?{subtypeField:t.subtypeField,subtypes:t.subtypes?t.subtypes.map(e=>({name:e.name,code:e.code})):[]}:t.typeIdField?{subtypeField:t.typeIdField,subtypes:t.types?t.types.map(e=>({name:e.name,code:e.id})):[]}:null:null}function Ie(e,t,r,n){const i=Me(e.fullSchema());if(null===i)return null;if(!i.fields)return null;const o=he(t,i,e,n);if(void 0===r)try{r=e.field(t)}catch(e){return null}return pe(o,r)}function Le(e,t,r,n){const i=Me(e.fullSchema());if(null===i)return null;if(!i.fields)return null;if(void 0===r){try{r=e.field(t)}catch(e){return null}return r}return be(he(t,i,e,n),r)}function _e(e){return e?.timeZone??"system"}function je(e){const t=Me(e.fullSchema());if(null===t)return null;if(!t.fields)return null;const r=[];for(const e of t.fields)r.push(c.esriFieldToJson(e));return{objectIdField:t.objectIdField,globalIdField:t.globalIdField??"",geometryType:void 0===c.layerGeometryEsriRestConstants[t.geometryType]?"":c.layerGeometryEsriRestConstants[t.geometryType],fields:r}}function Be(e,i){const o=n.ArcadeDate.systemTimeZoneCanonicalName;return"system"===e&&(e=o),{version:Ye,engineVersion:r.version,timeZone:e,userTimeZone:o,spatialReference:i instanceof N?i.toJSON():i,application:t.applicationName??"",engine:"web",locale:D.getLocale()}}const Ye="1.32",Ve=Object.freeze(Object.defineProperty({__proto__:null,ImplicitResult:O,ReturnResult:C,absRound:Q,arcadeVersion:Ye,autoCastArrayOfPointsToMultiPoint:xe,autoCastArrayOfPointsToPolygon:De,autoCastArrayOfPointsToPolyline:Ze,autoCastFeatureToGeometry:Ae,binaryOperator:Fe,breakResult:F,castAsJson:Re,castAsJsonAsync:we,castRecordToText:oe,continueResult:R,defaultExecutingContext:Be,defaultTimeZone:_e,defaultUndefined:G,equalityTest:ie,featureDomainCodeLookup:Le,featureDomainValueLookup:Ie,featureFullDomain:ve,featureSchema:je,featureSubtypes:Ee,fixNullGeometry:ge,fixSpatialReference:ye,formatDate:ee,formatNumber:X,getDomain:he,getDomainCode:be,getDomainValue:pe,getType:v,greaterThanLessThan:ne,isArray:Z.isArray,isBoolean:Z.isBoolean,isDate:U,isDateOnly:H,isDictionary:B,isDictionaryLike:Y,isFeature:L,isFeatureSet:j,isFeatureSetCollection:V,isFunctionParameter:w,isGeometry:I,isGraphic:Z.isGraphic,isImmutableArray:q,isInteger:Z.isInteger,isJsDate:Z.isDate,isKnowledgeGraph:z,isModule:M,isNumber:Z.isNumber,isObject:$,isSimpleType:P,isString:Z.isString,isSubtypeGrouplayer:Ge,isSubtypeSublayer:Pe,isTime:W,isVoid:E,isVoxel:_,multiReplace:J,parseGeometryFromJson:de,pcCheck:K,stableStringify:Ne,standardiseDateFormat:te,tick:ke,toBoolean:me,toDate:fe,toNumber:ce,toNumberArray:ue,toString:ae,toStringArray:Ce,toStringExplicit:se,voidOperation:k},Symbol.toStringTag,{value:"Module"}));e.ImplicitResult=O,e.ReturnResult=C,e.absRound=Q,e.arcadeVersion=Ye,e.autoCastArrayOfPointsToMultiPoint=xe,e.autoCastArrayOfPointsToPolygon=De,e.autoCastArrayOfPointsToPolyline=Ze,e.autoCastFeatureToGeometry=Ae,e.binaryOperator=Fe,e.breakResult=F,e.castAsJson=Re,e.castAsJsonAsync=we,e.castRecordToText=oe,e.continueResult=R,e.defaultExecutingContext=Be,e.defaultTimeZone=_e,e.defaultUndefined=G,e.equalityTest=ie,e.featureDomainCodeLookup=Le,e.featureDomainValueLookup=Ie,e.featureFullDomain=ve,e.featureSchema=je,e.featureSubtypes=Ee,e.fixNullGeometry=ge,e.fixSpatialReference=ye,e.formatDate=ee,e.formatNumber=X,e.getDomain=he,e.getDomainCode=be,e.getDomainValue=pe,e.getType=v,e.greaterThanLessThan=ne,e.isDate=U,e.isDateOnly=H,e.isDictionary=B,e.isDictionaryLike=Y,e.isFeature=L,e.isFeatureSet=j,e.isFeatureSetCollection=V,e.isFunctionParameter=w,e.isGeometry=I,e.isImmutableArray=q,e.isKnowledgeGraph=z,e.isModule=M,e.isObject=$,e.isSimpleType=P,e.isSubtypeGrouplayer=Ge,e.isSubtypeSublayer=Pe,e.isTime=W,e.isVoid=E,e.isVoxel=_,e.lc=Ve,e.multiReplace=J,e.parseGeometryFromJson=de,e.pcCheck=K,e.stableStringify=Ne,e.standardiseDateFormat=te,e.tick=ke,e.toBoolean=me,e.toDate=fe,e.toNumber=ce,e.toNumberArray=ue,e.toString=ae,e.toStringArray=Ce,e.toStringExplicit=se,e.voidOperation=k});