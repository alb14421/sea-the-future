// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../../chunks/tslib.es6","../../analysis/support/AnalysisOriginWebScene","../../core/Collection","../../core/collectionUtils","../../core/Logger","../../core/has","../../core/RandomLCG","../../core/Error","../../core/accessorSupport/decorators/subclass"],function(e,t,s,n,o,i,l,r,a,c,y){"use strict";const u=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"})),d=["slice"];function f(e){return d.includes(e.type)&&e.valid}t.WebSceneAnalysesCollection=class extends o{constructor(e){super(e),this.addHandles([this.on("after-add",e=>{this._setOrigin(e.item)}),this.on("before-remove",e=>{const{origin:t}=e.item;"web-scene"===t?.type&&this._setOrigin(e.item,null)})])}initialize(){for(const e of this.items)this._setOrigin(e)}_setOrigin(e,t=new n){e.origin=t}updateFrom(e){const t=e.analyses.filter(e=>f(e));this.removeAll(),t.length&&this.addMany(t.map(e=>(e.origin=new n,e.clone())))}applyTo(e){e.analyses.destroyMany(e.analyses.filter(({origin:e})=>"web-scene"===e?.type)),e.analyses.addMany(this.map(e=>e.clone()))}toJSON(e){return this.items.filter(f).map(t=>t.toJSON(e))}},t.WebSceneAnalysesCollection=s.__decorate([y.subclass("esri.webscene.support.analysisUtils.WebSceneAnalysesCollection")],t.WebSceneAnalysesCollection);const p={slice:async()=>{const{default:t}=await new Promise((t,s)=>e(["../../analysis/SliceAnalysis"],e=>t(u(e)),s));return t}};t.webSceneAnalysisCollectionProperty=function(e){return{type:t.WebSceneAnalysesCollection,cast:i.castForReferenceSetter,clonable:e=>new t.WebSceneAnalysesCollection({items:e.items.map(e=>e.clone())}),set(s){this._set(e,i.referenceSetter(s,this._get(e),t.WebSceneAnalysesCollection))},json:{read(t,s,n){n?.hooks?.onAfterLoad(()=>async function(e,t,s){if(!t)return;const n=await Promise.allSettled(t.map(e=>async function(e,t){const s=new(await p[e.type]());return s.read(e,t),s}(e,s)));for(const t of n)"fulfilled"===t.status&&e.add(t.value)}(this[e],t,n))},write:{overridePolicy:e=>({enabled:e.length>0})}}}},t.webSceneAnalysisRegistry=p,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});