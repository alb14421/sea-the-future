// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../core/Error","../core/handleUtils","../core/promiseUtils","./locale"],function(e,t,n,s,r){"use strict";const o={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,nn:"no",pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function a(e){if(function(e){return e in o}(e)){const t=o[e];return!0===t?e:t}return null}const i=[],c=new Map;function l(e){for(const t of c.keys())d(e.pattern,t)&&c.delete(t)}function d(e,t){return"string"==typeof e?t.startsWith(e):e.test(t)}r.beforeLocaleChange(()=>{c.clear()});const u=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(e){return this._increase(),e.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=s.createResolver())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)}},h={cache:c,loaders:i};e.fetchMessageBundle=async function(e){const n=r.getLocale();c.has(e)||c.set(e,async function(e,n){const s=[];for(const t of i)if(d(t.pattern,e))try{return await t.fetchMessageBundle(e,n)}catch(e){s.push(e)}if(s.length)throw new t("intl:message-bundle-error",`Errors occurred while loading "${e}"`,{errors:s});throw new t("intl:no-message-bundle-loader",`No loader found for message bundle "${e}"`)}(e,n));const s=c.get(e);return s&&await u.add(s),s},e.messageBundlesLocaleMap=o,e.normalizeMessageBundleLocale=function(e){const t=r.getLocaleLanguage(e);return t?a(e)??a(t):null},e.registerMessageBundleLoader=function(e){return i.includes(e)||(l(e),i.unshift(e)),n.makeHandle(()=>{const t=i.indexOf(e);t>-1&&(i.splice(t,1),l(e))})},e.test=h,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});