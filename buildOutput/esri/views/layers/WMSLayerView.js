// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../chunks/tslib.es6","../../core/Error","../../core/maybe","../../core/promiseUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../layers/support/ExportWMSImageParameters","../../layers/support/timeSupport"],function(e,t,r,o,a,s,p,i,n,c,u,y){"use strict";e.WMSLayerView=e=>{const p=e;let i=class extends p{initialize(){this.exportImageParameters=new u.ExportWMSImageParameters({layer:this.layer})}destroy(){this.exportImageParameters=o.destroyMaybe(this.exportImageParameters)}get exportImageVersion(){return this.exportImageParameters?.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}get timeExtent(){return y.combineTimeExtent(this.layer,this.view?.timeExtent,this._get("timeExtent"))}async fetchPopupFeaturesAtLocation(e,t){const{layer:o}=this;if(!e)throw new r("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:o});const{popupEnabled:s}=o;if(!s)throw new r("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:s});const p=this.createFetchPopupFeaturesQuery(e);if(!p)return[];const{extent:i,width:n,height:c,x:u,y}=p;if(!(i&&n&&c))throw new r("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:i,width:n,height:c});const m=await o.fetchFeatureInfo(i,n,c,u,y);return a.throwIfAborted(t),m}};return t.__decorate([s.property()],i.prototype,"exportImageParameters",void 0),t.__decorate([s.property({readOnly:!0})],i.prototype,"exportImageVersion",null),t.__decorate([s.property()],i.prototype,"layer",void 0),t.__decorate([s.property({readOnly:!0})],i.prototype,"timeExtent",null),i=t.__decorate([c.subclass("esri.views.layers.WMSLayerView")],i),i},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});