// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../core/handleUtils","../../../core/quantityUtils","../../../core/reactiveUtils","../../../core/screenUtils","../../../geometry/Point","../../interactive/tooltip/tooltipCommonUtils","../../interactive/tooltip/infos/MovePointTooltipInfo","../../interactive/tooltip/infos/SelectedVertexTooltipInfo","../../interactive/tooltip/infos/TranslateTooltipInfo","../../interactive/tooltip/infos/TranslateVertexTooltipInfo","../../support/euclideanLengthMeasurementUtils"],function(e,t,o,n,i,a,r,c,l,s,p,u){"use strict";function f(e,t,o){t&&"point"===o?.type&&(e.setLocationFromPoint(o),e.elevation.actual=u.elevationFromPoint(o),e.elevation.visible=!!t.geometry?.hasZ,e.elevation.readOnly=!1,e.elevation.showAsZ=!0)}function y(e){function t(t,o){const n=o?.geometry;if(!n||"point"!==n.type)return;const{dx:i,dy:c,dz:l}=r.getXYZDeltasFromTooltipInfo(t,n);if(0===i&&0===c&&0===l)return;const{x:s,y:p,z:u,m:f,spatialReference:y}=n,m=new a({x:s+i,y:p+c,z:null!=u?u+l:void 0,m:f,spatialReference:y});e.updateGeometry(o,m,n,i,c)}const{activeTooltipInfo:o,graphic:n,selectedVertex:i}=e;switch(o?.type){case"move-point":return t(o,n);case"selected-vertex":return t(o,i)}}function m(e,t,n,{automaticLengthMeasurementUtils:a}){if(!n)return;const{x:r,y:c}=n.origin,l=t.toMap(n),s=t.toMap(i.createScreenPoint(r,c)),p=a.autoDistanceBetweenPoints2D(s,l);e.distance=null!=p?p:o.zeroMeters}e.connectTooltip=function(e,o){function i(){const e=o(),t=e.sketchOptions.tooltips.effectiveEnabled?e.activeTooltipInfo:null;return{...e,activeTooltipInfo:t}}let a=!1;function c(e){a||(a=!0,e(),a=!1)}return t.handlesGroup([n.watch(()=>{const e=i();return{context:e,geometry:e.graphic?.geometry,vertexGeometry:e.selectedVertex?.geometry}},({context:t})=>{c(()=>{!function(e){const t=e.activeTooltipInfo;if(t){switch(t?.type){case"move-point":return function(e,{graphic:t}){f(e,t,t?.geometry)}(t,e);case"selected-vertex":return function(e,{graphic:t,selectedVertex:o,automaticAreaMeasurementUtils:n,automaticLengthMeasurementUtils:i}){f(e,t,o?.geometry);const a=t?.geometry;switch(a?.type){case"polygon":e.geometryType="polygon",e.totalLength.visible=!1,e.area.actual=n.autoArea2D(a);break;case"polyline":e.geometryType="polyline",e.totalLength.actual=i.autoLength2D(a),e.area.visible=!1}}(t,e)}t.sketchOptions=e.sketchOptions}}(t),e.info=t.activeTooltipInfo})},n.syncAndInitial),n.watch(()=>{const e=i(),{activeTooltipInfo:t}=e;if(t&&"key"in t)return{context:e,key:t.key}},(e,t)=>{e&&t&&e.key!==t.key&&c(()=>y(e.context))},n.sync),r.connectPasteEvent(e,{onBeforePaste:()=>{a=!0},onAfterPaste:()=>{y(i()),a=!1}})])},e.createTooltipInfos=function(e){const t={sketchOptions:e,viewType:"2d"};return{movePoint:new c.MovePointTooltipInfo(t),selectedVertex:new l.SelectedVertexTooltipInfo(t),translateGraphic:new s.TranslateTooltipInfo(t),translateVertices:new p.TranslateVertexTooltipInfo(t)}},e.updateTranslateTooltipInfo=function(e,t,o,n){e.clear(),m(e,t,n,o)},e.updateTranslateVertexTooltipInfo=function(e,t,o,n,i){e.clear();const{automaticAreaMeasurementUtils:a,automaticLengthMeasurementUtils:r}=n;"polygon"===o?.type?e.area=a.autoArea2D(o):"polyline"===o?.type&&(e.totalLength=r.autoLength2D(o)),m(e,t,i,n)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});