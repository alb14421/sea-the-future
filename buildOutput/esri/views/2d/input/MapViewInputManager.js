// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../chunks/tslib.es6","../../../core/Accessor","../../../core/has","../../../core/maybe","../../../core/reactiveUtils","../../../core/accessorSupport/decorators/property","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","./handlers/DoubleClickZoom","./handlers/DoubleTapDragZoom","./handlers/DragPan","./handlers/DragRotate","./handlers/GamepadNavigation","./handlers/KeyPan","./handlers/KeyRotate","./handlers/KeyZoom","./handlers/MouseWheelZoom","./handlers/PinchAction","../../input/BrowserEventSource","../../input/InputManager","../../input/handlers/PreventContextMenu","../../input/handlers/support","../../input/recognizers/DoubleTapDrag","../../input/recognizers/Drag","../../input/recognizers/ImmediateDoubleClick","../../input/recognizers/PointerClickHoldAndDrag","../../input/recognizers/SingleAndDoubleClick"],function(e,t,n,i,o,r,a,s,c,l,u,h,p,w,d,g,v,y,m,D,A,_,P,b,M,C,T,k){"use strict";const E={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},Z={zoomIn:["=","+"],zoomOut:["-","_"]},z={clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]},I=Symbol("handles");let R=class extends t{initialize(){const e=()=>this.view?.ready;this.addHandles([o.when(()=>!e(),()=>this._disconnect()),o.when(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){return this._inputManager?.latestPointerType}get latestPointerLocation(){return this._inputManager?.latestPointerLocation}get multiTouchActive(){return this._inputManager?.multiTouchActive??!1}isModifierKeyDown(e){return this._inputManager?.isModifierKeyDown(e)??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(I),this._inputManager=i.destroyMaybe(this._inputManager)}_connect(){const e=this.view.surface,t=new D.BrowserEventSource(e,this.view.input),n=[new C.ImmediateDoubleClick,new T.PointerClickHoldAndDrag,new k.SingleAndDoubleClick,new M.Drag(this.view.navigation),new b.DoubleTapDrag],i=new A.InputManager({eventSource:t,recognizers:n}),r=new h.DragPan(this.view,["primary"]),a=new p.DragRotate(this.view,["secondary"]);i.installHandlers("prevent-context-menu",[new _.PreventContextMenu],A.ViewEventPriorities.INTERNAL),i.installHandlers("navigation",[new m.PinchRotateAndZoom(this.view),new w.GamepadNavigation(this.view),new y.MouseWheelZoom(this.view),new l.DoubleClickZoom(this.view),new l.DoubleClickZoom(this.view,["Control"]),r,new d.KeyPan(this.view,E),new v.KeyZoom(this.view,Z),new g.KeyRotate(this.view,z),a,new u.DoubleTapDragZoom(this.view,"touch")],A.ViewEventPriorities.INTERNAL),this.view.viewEvents.connect(i),this._source=t,this._inputManager=i,this.addHandles([o.watch(()=>this.view?.navigation?.browserTouchPanEnabled,e=>{this._source&&(this._source.browserTouchPanningEnabled=!e)},o.initial),o.watch(()=>{const{actionMap:e}=this.view.navigation;return{panActions:P.getPointerActions("pan",e),rotateActions:P.getPointerActions("rotate",e)}},({panActions:e,rotateActions:t})=>{r.pointerActions=e,a.pointerActions=t},o.syncAndInitial)],I)}get test(){}};return e.__decorate([r.property()],R.prototype,"view",void 0),e.__decorate([r.property()],R.prototype,"latestPointerType",null),e.__decorate([r.property()],R.prototype,"latestPointerLocation",null),e.__decorate([r.property()],R.prototype,"multiTouchActive",null),R=e.__decorate([c.subclass("esri.views.2d.input.MapViewInputManager")],R),R});