// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../../core/libs/gl-matrix-2/factories/mat3f32","../webgl/brushes/WGLBrush"],function(t,e){"use strict";return class extends e{constructor(){super(...arguments),this._visualState={time:0,dvsMat3:t.create(),displayViewMat3:t.create()}}dispose(){}prepareState(t){const{context:e}=t;e.setColorMask(!0,!0,!0,!0),e.setStencilFunction(514,0,255)}draw(t,e){const{requestRender:a,allowDelayedRender:r}=t,{displayData:s}=e;if(null==s)return;if("loaded"===s.state.name&&s.attach({context:t.context,getProgram:(e,a)=>t.painter.materialManager.getProgram(e,a)}),"attached"!==s.state.name)return;const i=s.state.resources;!r||i.ready||null==a?(this._visualState.time=t.time/1e3,this._visualState.dvsMat3=e.transforms.displayViewScreenMat3,this._visualState.displayViewMat3=t.state.displayViewMat3,s.flowStyle.render({context:t.context,getProgram:(e,a)=>t.painter.materialManager.getProgram(e,a)},this._visualState,i),s.flowStyle.animated&&null!=a&&a()):a()}}});