// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../../../core/libs/gl-matrix-2/factories/vec4f32","../Utils","./WGLBrush","../shaders/BackgroundPrograms","../../../../webgl/enums","../../../../webgl/ProgramTemplate"],function(e,r,t,s,a,o){"use strict";return class extends t{constructor(){super(...arguments),this._color=e.fromValues(0,1,0,1)}dispose(){this._program&&this._program.dispose()}prepareState({context:e}){e.setStencilTestEnabled(!0),e.setBlendingEnabled(!1),e.setFaceCullingEnabled(!1),e.setColorMask(!1,!1,!1,!1),e.setStencilOp(7680,7680,7681),e.setStencilWriteMask(255),e.setStencilFunction(519,0,255)}draw(e,t){const{context:i,state:n,requestRender:l,allowDelayedRender:c}=e,u=r.createProgramDescriptor("clip",[{location:0,name:"a_pos",count:2,type:a.DataType.SHORT}]),d=t.getVAO(i,n,u.bufferLayout);null!=d.indexBuffer&&(this._program??=o.createProgram(i,s.background,d.locations),!c||null==l||this._program.compiled?(i.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",n.displayMat3),i.bindVAO(d),i.drawElements(a.PrimitiveType.TRIANGLES,d.indexBuffer.size,a.DataType.UNSIGNED_INT,0),i.bindVAO(null)):l())}}});