// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../definitions","./AFillMeshWriter","./FillMeshWriter","./gradientFillConstants","./GradientSizeHelper","./meshWriterUtils","../../../../../../webgl/enums"],function(e,t,i,r,a,s,n,l){"use strict";const d={createComputedParams:e=>e,optionalAttributes:r.fillVertexSpec.optionalAttributes,attributes:{...r.fillVertexSpec.attributes,bitset:{type:l.DataType.UNSIGNED_BYTE,count:1,pack:({gradientSizeUnits:e,gradientType:t})=>{let i=0;return 1===e&&(i|=n.getBitMask(a.bitset.isAbsolute)),"discrete"===t.toLowerCase()&&(i|=n.getBitMask(a.bitset.isDiscrete)),i}},tlbr:{count:4,type:l.DataType.UNSIGNED_SHORT,pack:({sprite:e})=>{const{rect:i,width:r,height:a}=e,s=i.x+t.spritePadding+t.gradientTextureExternalPadding,n=i.y+t.spritePadding;return[s,n,s+r-2*t.gradientTextureExternalPadding,n+a]}},relativePosition:{count:2,type:l.DataType.HALF_FLOAT,packTessellation:({gradientStats:e},t,i,r)=>e?.getRelativePosition(i,r)??[0,0]},relativeGradientSize:{count:2,type:l.DataType.HALF_FLOAT,packTessellation:({gradientStats:e})=>e?.relativeSize??[1,1]},gradientMethod:{count:1,type:l.DataType.UNSIGNED_BYTE,pack:({gradientMethod:e})=>{switch(e.toLowerCase()){case"rectangular":return a.gradientFillMethods.rectangular;case"circular":return a.gradientFillMethods.circular;default:return a.gradientFillMethods.linear}}}}};class o extends i.AFillMeshWriter{constructor(){super(...arguments),this.vertexSpec=d}get _preventEffectClipping(){return!0}createTesselationParams(e){return{gradientStats:s.getGradientSizeHelper(this._unclippedGeometry,this.evaluatedMeshParams)}}_write(e,t,i){const r=i?.asOptimized()??t.readGeometryForDisplay();this._unclippedGeometry=r;const a=this._clip(r);if(!a)return void(this._unclippedGeometry=null);const s=this.evaluatedMeshParams.sprite?.textureBinding;e.recordStart(this.instanceId,this.attributeLayout,s),this._writeGeometry(e,t,a),this._unclippedGeometry=null,e.recordEnd()}}e.GradientFillMeshWriter=o,e.gradientFillVertexSpec=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});