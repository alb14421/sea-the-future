// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../../../chunks/tslib.es6","../../../GraphShaderModule","../../../graph/glsl"],function(e,t,o,n){"use strict";class i extends o.UniformGroup{}function r(e){const t=n.abs(e),o=n.step(t,new n.Vec2(1,1)).multiply(t),i=new n.Float(2).subtract(t),r=n.step(new n.Float(1),t).multiply(i);return o.add(r)}function c(e,t){const o=new n.Vec4(e[5],e[3],e[7],e[1]).multiply(2),i=new n.Vec3(e[2],o[0],e[8]),r=new n.Vec3(e[0],o[1],e[6]),c=n.dot(i.subtract(r),new n.Vec3(1)),s=new n.Vec3(e[6],o[2],e[8]),a=new n.Vec3(e[0],o[3],e[2]),d=n.dot(s.subtract(a),new n.Vec3(1));return new n.Vec2(c,d).multiply(t)}function s(e){const t=e.sinZsinA.multiply(e.dzxy.y),o=e.sinZcosA.multiply(e.dzxy.x),i=t.subtract(o),r=e.cosZ.add(i).divide(e.dzd);return r.multiply(n.step(new n.Float(0),r)).multiply(e.weights)}t.__decorate([o.uniform(n.FixedArray.ofType(n.Float,6))],i.prototype,"sinZcosAs",void 0),t.__decorate([o.uniform(n.FixedArray.ofType(n.Float,6))],i.prototype,"sinZsinAs",void 0),t.__decorate([o.uniform(n.FixedArray.ofType(n.Float,6))],i.prototype,"cosZs",void 0),t.__decorate([o.uniform(n.FixedArray.ofType(n.Float,6))],i.prototype,"weights",void 0),t.__decorate([o.uniform(n.Float)],i.prototype,"minValue",void 0),t.__decorate([o.uniform(n.Float)],i.prototype,"maxValue",void 0),t.__decorate([o.uniform(n.Vec2)],i.prototype,"factor",void 0),e.HillshadeConfig=i,e.computeDeltaZ=c,e.computeZFactor=function(e,t){const{pixelSizeFactor:o}=e,n=[e.factor[0]/t[0],e.factor[1]/t[1]];if(o>0){const{zFactor:i,pixelSizePower:r,gcsFactor:c}=e,s=t[0]*c,a=t[1]*c;n[0]=(i+s**r*o)/(8*s),n[1]=(i+a**r*o)/(8*a)}return n},e.getSurfaceValues=function(e,t,o){const i=new n.Float(1).divide(o),c=n.texture2D(e,r(i.multiply(new n.Vec2(-1,-1)).add(t))),s=n.texture2D(e,r(i.multiply(new n.Vec2(0,-1)).add(t))),a=n.texture2D(e,r(i.multiply(new n.Vec2(1,-1)).add(t))),d=n.texture2D(e,r(i.multiply(new n.Vec2(-1,0)).add(t))),l=n.texture2D(e,r(t)),u=n.texture2D(e,r(i.multiply(new n.Vec2(1,0)).add(t))),p=n.texture2D(e,r(i.multiply(new n.Vec2(-1,1)).add(t))),y=n.texture2D(e,r(i.multiply(new n.Vec2(0,1)).add(t))),w=n.texture2D(e,r(i.multiply(new n.Vec2(1,1)).add(t))),m=new n.Vec4(c.a,s.a,a.a,d.a),V=new n.Vec4(u.a,p.a,y.a,w.a),f=m.multiply(V),x=f.xy.multiply(f.zw),F=x.x.multiply(x.y).multiply(l.a),Z=new n.FixedArray(new n.Float(0),10);return Z[0]=c.r,Z[1]=s.r,Z[2]=a.r,Z[3]=d.r,Z[4]=l.r,Z[5]=u.r,Z[6]=p.r,Z[7]=y.r,Z[8]=w.r,Z[9]=F,Z},e.hillshade=function(e,t,o){const{factor:i}=t,r=c(e,i),a=n.sqrt(n.dot(r,r).add(1)),d=e[9],{sinZsinAs:l,sinZcosAs:u,cosZs:p,weights:y}=t;if(!o){const e=s({sinZsinA:l[0],sinZcosA:u[0],cosZ:p[0],weights:new n.Float(1),dzxy:r,dzd:a});return new n.Vec4(e,e,e,d)}const w=s({sinZsinA:new n.Vec3(l[0],l[1],l[2]),sinZcosA:new n.Vec3(u[0],u[1],u[2]),cosZ:new n.Vec3(p[0],p[1],p[2]),weights:new n.Vec3(y[0],y[1],y[2]),dzxy:r,dzd:a}),m=s({sinZsinA:new n.Vec3(l[3],l[4],l[5]),sinZcosA:new n.Vec3(u[3],u[5],u[5]),cosZ:new n.Vec3(p[3],p[4],p[5]),weights:new n.Vec3(y[3],y[4],y[5]),dzxy:r,dzd:a}),V=n.dot(w.add(m),new n.Vec3(1));return new n.Vec4(V,V,V,d)},e.mirror=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});