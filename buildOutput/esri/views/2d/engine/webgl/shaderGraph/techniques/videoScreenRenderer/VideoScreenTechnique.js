// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../../core/maybe","../../../meshing/Mesh","../../utils","../Technique","../shaders/VideoScreenShader","../../../../../../webgl/enums","../../../../../../webgl/VertexElementDescriptor"],function(e,t,r,s,n,i,o,a){"use strict";class c extends n.Technique{constructor(){super(...arguments),this.type=27,this._mesh=null,this.shaders={geometry:new i.VideoScreenShader}}render(e,t){const{context:r,painter:n}=e,{texture:i,textureCoords:o}=t,a=this._getMesh(e),c=t.ndcRect[2],u=t.ndcRect[3],h=t.ndcRect[0],d=t.ndcRect[1],l=new Float32Array(180);for(let e=0;e<6;e++){const t=u*e/5;for(let r=0;r<6;r++){const s=c*r/5,{u:n,v:i}=o[6*e+r];l[5*(6*e+r)]=h+s,l[5*(6*e+r)+1]=d-t,l[5*(6*e+r)+2]=n,l[5*(6*e+r)+3]=i,l[5*(6*e+r)+4]=1}}a.vertexBuffers.get("geometry")?.setData(l);const p={texture:{texture:i,unit:0},opacity:t.opacity},m={shader:this.shaders.geometry,uniforms:{config:p},defines:{},optionalAttributes:null,useComputeBuffer:!1};n.setPipelineState(s.simplePipelineState),n.submitDrawMeshUntyped(r,m,a)}shutdown(){t.destroyMaybe(this._mesh)}_getMesh(e){const{context:t}=e,s=new Uint32Array(150);for(let e=0;e<5;e++)for(let t=0;t<5;t++){const r=6*(5*e+t),n=6*(e+1)+t+1,i=n-1,o=n-6,a=n-7;s[r]=n,s[r+1]=i,s[r+2]=o,s[r+3]=i,s[r+4]=a,s[r+5]=o}return this._mesh||(this._mesh=new r.Mesh(t,{vertex:{geometry:{data:new Float32Array(180),layout:[new a.VertexElementDescriptor("position",2,o.DataType.FLOAT,0,20),new a.VertexElementDescriptor("texcoord",2,o.DataType.FLOAT,8,20),new a.VertexElementDescriptor("w",1,o.DataType.FLOAT,16,20)]}},index:{index:{data:s}},groups:[{primitive:o.PrimitiveType.TRIANGLES,index:"index"}],parts:[{group:0,start:0,count:s.length}]})),this._mesh}}e.VideoScreenTechnique=c,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});