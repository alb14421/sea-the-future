// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../core/unitUtils","../../definitions"],function(e,t,i){"use strict";const n={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:e=>e.stencilRef,compare:514,mask:255,op:{fail:7680,zFail:7680,zPass:7681}}}},o={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},s={...n,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function r({pixelRatio:e,state:i,displayLevel:n,requiredLevel:o},s){const r=1/2**(n-s.key.level),l=1/2**(o-s.key.level);return{displayMat3:i.displayMat3,displayViewMat3:i.displayViewMat3,displayViewScreenMat3:s.transforms.displayViewScreenMat3,viewMat3:i.viewMat3,tileMat3:s.transforms.tileMat3,displayZoomFactor:r,requiredZoomFactor:l,tileOffset:[s.x,s.y],currentScale:i.scale,currentZoom:n,metersPerSRUnit:t.getMetersPerUnitForSR(i.spatialReference),rotation:i.rotation,pixelRatio:e}}function l(e){return"highlight"===e.passOptions?.type}function a(e){return"hittest"===e.passOptions?.type}function c(e){if(!a(e))return null;const{position:t,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:o}=e.passOptions;return{position:t,distance:i,smallSymbolDistance:n,smallSymbolSizeThreshold:o}}function p(e){if(!l(e))return null;const{activeReasons:t,highlightAll:i}=e.passOptions;return{activeReasons:t,highlightAll:i?1:0}}e.getFeaturePipelineState=function(e){return a(e)?o:l(e)&&"clear"===e.passOptions.stepType?s:n},e.getFeatureUniforms=function(e,t){const{attributeView:i,context:n}=e;return{storage:i.getUniforms(n),view:r(e,t),hittestRequest:c(e),highlight:p(e)}},e.getLocalTileOffset=function(e){const{row:t,col:n}=e.key,o=n*i.tileSize,s=t*i.tileSize;return{tileOffsetFromLocalOrigin:[o%i.maxRepresentableInt,s%i.maxRepresentableInt],maxIntsToLocalOrigin:[Math.floor(o/i.maxRepresentableInt),Math.floor(s/i.maxRepresentableInt)]}},e.getSelectionDefines=function(e){return{inside:2===e.selection,outside:3===e.selection}},e.getViewUniforms=r,e.isHighlight=l,e.isHittest=a,e.resolveDynamicUniforms=function(e,t,i){const n={};for(const o in i)"function"!=typeof i[o]?n[o]=i[o]:n[o]=i[o](e,t);return n},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});