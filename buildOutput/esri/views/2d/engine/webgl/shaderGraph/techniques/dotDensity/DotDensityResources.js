// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../../core/RandomLCG","../../../definitions","../../../meshing/SimpleMesh","../../../../../../webgl/enums","../../../../../../webgl/FramebufferObject","../../../../../../webgl/Renderbuffer","../../../../../../webgl/RenderbufferDescriptor","../../../../../../webgl/Texture","../../../../../../webgl/TextureDescriptor"],function(e,t,s,i,r,o,n,u,l,d){"use strict";const h={pos:{count:2,type:r.DataType.UNSIGNED_SHORT}};e.DotDensityResources=class{constructor(){this._dotTextureSize=0,this._dotTextures=null,this._dotMesh=null}destroy(){this._disposeTextures(),this._dotFBO&&this._dotFBO.dispose(),this._dotMesh&&this._dotMesh.destroy()}getFBO(e){if(null==this._dotFBO){const t=s.tileSize,i=s.tileSize,l=new d.TextureDescriptor(t,i);l.samplingMode=9728,l.wrapMode=33071;const h=new n.Renderbuffer(e,new u.RenderbufferDescriptor(r.SizedDepthStencilFormat.DEPTH24_STENCIL8,t,i));this._dotFBO=new o.FramebufferObject(e,l,h)}return this._dotFBO}getDotDensityMesh(e){if(null==this._dotMesh){const t=s.tileSize,o=t*t,n=2,u=new Int16Array(o*n);for(let e=0;e<t;e++)for(let s=0;s<t;s++)u[n*(s+e*t)]=s,u[n*(s+e*t)+1]=e;this._dotMesh=i.SimpleMesh.create(e,{primitive:r.PrimitiveType.POINTS,vertex:u,count:o,layout:h})}return this._dotMesh}getDotDensityTextures(e,s,i){if(this._dotTextureSize===s&&this._seed===i||(this._disposeTextures(),this._dotTextureSize=s,this._seed=i),null===this._dotTextures){const r=new t(i);this._dotTextures=[this._allocDotDensityTexture(e,s,r),this._allocDotDensityTexture(e,s,r)]}return this._dotTextures}_disposeTextures(){if(this._dotTextures){for(let e=0;e<this._dotTextures.length;e++)this._dotTextures[e].dispose();this._dotTextures=null}}_allocDotDensityTexture(e,t,s){const i=new Float32Array(t*t*4);for(let e=0;e<i.length;e++)i[e]=s.getFloat();const o=new d.TextureDescriptor(t);return o.dataType=r.PixelType.FLOAT,o.samplingMode=9728,new l.Texture(e,o,i)}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});