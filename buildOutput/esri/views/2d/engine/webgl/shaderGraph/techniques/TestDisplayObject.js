// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../DisplayObject","../../DisplayEntity","../../cpuMapped/MappedMesh","../../util/Reader","../../util/serializationUtils","../../../../../webgl/enums"],function(t,e,n,s,i,r,a){"use strict";class o extends e.DisplayObject{static fromMeshData(t,e,a){const c=new Map;for(const n of t.data){const t=new s.MappedMesh(e,n.layout);t.append(n),t.upload(),c.set(n.instanceId,t)}const d=new i(t.entities),l=r.deserializeList(d,n,{})??[];return new o(l,c,a)}constructor(t,e,n){super(),this.displayObjects=t,this._instanceIdToMesh=e,this._store=n}draw(t,e){if(null==this._activeInstanceId)throw new Error("InternalError: No active instanceId");for(const n of this.displayObjects)for(const s of n.records){if(s.instanceId!==this._activeInstanceId)continue;const n=t.context,i=this._instanceIdToMesh.get(this._activeInstanceId).getGeometryVAO(n,e),r=s.indexStart*Uint32Array.BYTES_PER_ELEMENT;n.bindVAO(i),n.drawElements(a.PrimitiveType.TRIANGLES,s.indexCount,a.DataType.UNSIGNED_INT,r),n.bindVAO(null)}}getStencilReference(){return 0}getAttributePrecisionPackFactors(){return{}}destroy(){super.destroy();for(const t of this._instanceIdToMesh.values())t.destroy();this._instanceIdToMesh.clear()}setActiveMesh(t){this._activeInstanceId=t}getInput(){if(null==this._activeInstanceId)throw new Error("InternalError: No active instanceId");return this._store.getInstance(this._activeInstanceId).getInput()}_createTransforms(){throw new Error("Method not implemented.")}}t.TestDisplayObject=o,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});