// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../Color","../grouping","./infos","./instructions"],function(e,t,o,i,n){"use strict";function s(e){const t=[],o=[];let i=0;for(const s of e){const r=[...s.encode(),...n.instructions.ret.encode()];t.push([i+e.length,0,0,0]),o.push(...r),i+=r.length}return[...t,...o]}function r(e,i,n){const s=e;let c;if("number"==typeof s||"string"==typeof s||"boolean"==typeof s)c=s;else if(Array.isArray(s))c=s.map(e=>r(e,i,n));else if("object"==typeof s)if("type"in s&&null!=s.type&&"Process"===s.type)switch(s.op){case"ArcadeColor":{const e=r(s.value,i,n);a(Array.isArray(e)&&4===e.length),c=[e[0]/255,e[1]/255,e[2]/255,e[3]]}break;case"Transparency":{const e=r(s.value,i,n);a("number"==typeof e),c=1-e/100}break;case"Divide":case"Multiply":case"Add":{const e=r(s.left,i,n);a("number"==typeof e);const t=r(s.right,i,n);switch(a("number"==typeof t),s.op){case"Divide":c=e/t;break;case"Multiply":c=e*t;break;case"Add":c=e+t}}break;case"Random":{const e=r(s.seed,i,n),t=r(s.min,i,n),a=r(s.max,i,n),l=i.getObjectId(),f=o.getStartGroup(l||0);c=t+o.getRandomValue(f,e)*(a-t)}break;case"Cond":{const e=r(s.condition,i,n),t=r(s.ifTrue,i,n),o=r(s.ifFalse,i,n);c=e?t:o}break;case"MatchWinding":{const e=r(s.sign,i,n);let t=r(s.angle,i,n);if(e>0)for(;t<0;)t+=2*Math.PI;else for(;t>0;)t-=2*Math.PI;c=t}}else if("computed"in s)c=function(e){if(!("computed"in e))return e;let o=e.computed.readWithDefault(i,n,[255*e.defaultValue[0],255*e.defaultValue[1],255*e.defaultValue[2],e.defaultValue[3]]);if("string"==typeof o){const e=t.fromString(o);e&&(o=[e.r,e.g,e.b,e.a])}return o}(s);else{c={};for(const e in s)c[e]=r(s[e],i,n)}return c}function a(e){if(!e)throw new Error("Assertion failed.")}e.assert=a,e.compileAnimationParam=async function e(t,o){const i=t;let n;if("number"==typeof i||"string"==typeof i||"boolean"==typeof i)n=i;else if(Array.isArray(i))n=await Promise.all(i.map(t=>e(t,o)));else if("object"==typeof i)if("valueExpressionInfo"in i){const{valueExpressionInfo:e}=i,{expression:t}=e;n={...i,computed:await o.createComputedField({expression:t})}}else{n={};for(const t in i)n[t]=await e(i[t],o)}return n},e.createParamList=function(e){const t=[];return t.push(e.transform),t.push(e.fromColor),t.push(e.toColor),t.push(e.colorMix),t.push(e.toOpacity),t.push(e.opacityMix),e?.shift?t.push(e?.shift):t.push([1,1,1,1]),t},e.encodeParamList=s,e.fromJSON=function(e){return s(e.map(e=>r(e)).map(e=>i.hydrate(e).simplify()))},e.getAnimationExpressions=function*e(t){const o=t;if(Array.isArray(o))for(const t of o)yield*e(t);else if("object"==typeof o)if("type"in o&&null!=o.type&&"Process"===o.type)switch(o.op){case"ArcadeColor":case"Transparency":yield*e(o.value);break;case"Divide":case"Multiply":case"Add":yield*e(o.left),yield*e(o.right);break;case"Random":yield*e(o.seed),yield*e(o.min),yield*e(o.max);break;case"Cond":yield*e(o.condition),yield*e(o.ifTrue),yield*e(o.ifFalse);break;case"MatchWinding":yield*e(o.sign),yield*e(o.angle)}else if("computed"in o)yield o.computed;else for(const t in o)yield*e(o[t])},e.resolveToAnimationInfo=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});