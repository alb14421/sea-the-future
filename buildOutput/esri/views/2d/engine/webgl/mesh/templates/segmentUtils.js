// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../definitions"],function(t,e){"use strict";function n(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function s(t,e){return Math.sqrt(t*t+e*e)}function i(t){const e=s(t[0],t[1]);t[0]/=e,t[1]/=e}function r(t,e){return s(t[0]-e[0],t[1]-e[1])}function h(t,e){return t[e+1]}function a(t){return t.length-1}function u(t){let e=0;for(let n=0;n<a(t);n++)e+=d(t,n);return e}function d(t,e,n=1){let[s,i]=h(t,e);return[s,i]=[Math.round(s),Math.round(i)],Math.sqrt(s*s+i*i)*n}class c{constructor(t,e,n,s,i){this._segments=t,this._index=e,this._distance=n,this._xStart=s,this._yStart=i,this._done=!1}static create(t){return new c(t,0,0,t[0][0],t[0][1])}clone(){return new c(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(t){return this._index===t._index||t._index===this._index-1&&(0===this._distance||1===t._distance)||t._index===this._index+1&&(1===this._distance||0===t._distance)}leq(t){return this._index<t._index||this._index===t._index&&this._distance<=t._distance}geq(t){return this._index>t._index||this._index===t._index&&this._distance>=t._distance}get _segment(){return this._segments[this._index+1]}get angle(){const t=this.dy,e=(0*t+-1*-this.dx)/(1*this.length);let n=Math.acos(e);return t>0&&(n=2*Math.PI-n),n}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:t,dy:e}=this;return Math.sqrt(t*t+e*e)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<a(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(t,e){const n=this.backwardLength;if(t<=n)return this._distance=(n-t)/this.length,this;let s=this.backwardLength;for(;this.prev();){if(s+this.length>t)return this._seekBackwards(t-s);s+=this.length}return this._distance=0,e?this:null}seek(t,e=!1){if(t<0)return this._seekBackwards(Math.abs(t),e);if(t<=this.remainingLength)return this._distance=(this.backwardLength+t)/this.length,this;let n=this.remainingLength;for(;this.next();){if(n+this.length>t)return this.seek(t-n,e);n+=this.length}return this._distance=1,e?this:null}}function o(t,e,n,s,i){if(n<e)return;const r=s.clone().seek(n/2);if(null==r)return;t(r.clone(),n,i),n=(n-e)/2;const h=r.seek(e/2);o(t,e,n,s,i+1),o(t,e,n,h,i+1)}function _(t,e){const s=1e-6;if(e<=0)return;const h=t.length;if(h<3)return;const a=[];let u=0;a.push(0);for(let e=1;e<h;e++)u+=r(t[e],t[e-1]),a.push(u);e=Math.min(e,.2*u);const d=[];d.push(t[0][0]),d.push(t[0][1]);const c=t[h-1][0],o=t[h-1][1],_=n([0,0],t[0],t[1]);i(_),t[0][0]+=e*_[0],t[0][1]+=e*_[1],n(_,t[h-1],t[h-2]),i(_),t[h-1][0]+=e*_[0],t[h-1][1]+=e*_[1];for(let t=1;t<h;t++)a[t]+=e;a[h-1]+=e;const l=.5*e;for(let n=1;n<h-1;n++){let i=0,r=0,u=0;for(let h=n-1;h>=0&&!(a[h+1]<a[n]-l);h--){const d=l+a[h+1]-a[n],c=a[h+1]-a[h],o=a[n]-a[h]<l?1:d/c;if(Math.abs(o)<s)break;const _=o*o,g=o*d-.5*_*c,x=o*c/e,f=t[h+1],y=t[h][0]-f[0],S=t[h][1]-f[1];i+=x/g*(f[0]*o*d+.5*_*(d*y-c*f[0])-_*o*c*y/3),r+=x/g*(f[1]*o*d+.5*_*(d*S-c*f[1])-_*o*c*S/3),u+=x}for(let d=n+1;d<h&&!(a[d-1]>a[n]+l);d++){const h=l-a[d-1]+a[n],c=a[d]-a[d-1],o=a[d]-a[n]<l?1:h/c;if(Math.abs(o)<s)break;const _=o*o,g=o*h-.5*_*c,x=o*c/e,f=t[d-1],y=t[d][0]-f[0],S=t[d][1]-f[1];i+=x/g*(f[0]*o*h+.5*_*(h*y-c*f[0])-_*o*c*y/3),r+=x/g*(f[1]*o*h+.5*_*(h*S-c*f[1])-_*o*c*S/3),u+=x}d.push(i/u),d.push(r/u)}d.push(c),d.push(o);for(let e=0,n=0;e<h;e++)t[e][0]=d[n++],t[e][1]=d[n++]}t.SegmentCursor=c,t.pathDivide=function(t,n,s,i=!0){const r=u(t),h=c.create(t),a=r/2;if(!i)return h.seek(a),void(h.x<e.tileSize&&h.y<e.tileSize&&h.x>=0&&h.y>=0&&s(h.clone(),0,a+0*n,r));const d=Math.max((r-n)/2,0),o=Math.floor(d/n),_=a-o*n;h.seek(_);for(let t=-o;t<=o;t++)h.x<e.tileSize&&h.y<e.tileSize&&h.x>=0&&h.y>=0&&s(h.clone(),t,a+t*n,r),h.seek(n)},t.pathLength=u,t.pathSubdivide=function(t,e,n){o(n,e,u(t),c.create(t),0)},t.segmentAt=h,t.segmentCount=a,t.segmentLength=d,t.smoothPaths=function(t,e){const n=e;for(let e=0;e<t.length;e++){let s=t[e];_(s,n);const i=[];i.push(s[0]);for(let t=1;t<s.length;t++){const[e,n]=s[t-1],[r,h]=s[t],a=r-e,u=h-n;i.push([a,u])}t[e]=i,s=i}return t},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});