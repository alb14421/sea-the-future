// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../../geometry/support/TileClipper"],function(e){"use strict";return class{constructor(e,t,s=0){this.values={},this._geometry=void 0,this._pbfGeometry=null,this.featureIndex=s;const r=t.keys,n=t.values,a=e.asUnsafe();for(;a.next();)switch(a.tag()){case 1:this.id=a.getUInt64();break;case 2:{const e=a.getMessage().asUnsafe(),t=this.values;for(;!e.empty();){const s=e.getUInt32(),a=e.getUInt32();t[r[s]]=n[a]}e.release();break}case 3:this.type=a.getUInt32();break;case 4:this._pbfGeometry=a.getMessage();break;default:a.skip()}}getGeometry(t){if(void 0!==this._geometry)return this._geometry;if(!this._pbfGeometry)return null;const s=this._pbfGeometry.asUnsafe();let r,n;this._pbfGeometry=null,t?t.reset(this.type):r=[];let a,o=1,i=0,l=0,h=0;for(;!s.empty();){if(0===i){const e=s.getUInt32();o=7&e,i=e>>3}switch(i--,o){case 1:l+=s.getSInt32(),h+=s.getSInt32(),t?t.moveTo(l,h):r&&(n&&r.push(n),n=[],n.push(new e.Point(l,h)));break;case 2:l+=s.getSInt32(),h+=s.getSInt32(),t?t.lineTo(l,h):n&&n.push(new e.Point(l,h));break;case 7:t?t.close():n&&!n[0].equals(l,h)&&n.push(n[0].clone());break;default:throw s.release(),new Error("Invalid path operation")}}return t?a=t.result():r&&(n&&r.push(n),a=r),s.release(),this._geometry=a,a}}});