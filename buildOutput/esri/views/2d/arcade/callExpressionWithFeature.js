// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../core/Error","../../../core/Logger","../../../geometry/support/quantizationUtils"],function(e,r,t){"use strict";const n=new Map;return function(o,a,u,i,s,c){if(null==o)return null;const l=o.references("geometry")&&c?function(o,a,u){const{transform:i,hasZ:s,hasM:c}=u;n.has(a)||n.set(a,function(n){const o={};switch(n){case"esriGeometryPoint":return(e,r,n,a)=>t.unquantizePoint(r,o,e,n,a);case"esriGeometryPolygon":return(e,r,n,a)=>t.unquantizePolygon(r,o,e,n,a);case"esriGeometryPolyline":return(e,r,n,a)=>t.unquantizePolyline(r,o,e,n,a);case"esriGeometryMultipoint":return(e,r,n,a)=>t.unquantizeMultipoint(r,o,e,n,a);default:return r.getLogger("esri.views.2d.support.arcadeOnDemand").error(new e("mapview-arcade",`Unable to handle geometryType: ${n}`)),e=>e}}(a));const l=n.get(a)(o.geometry,i,s,c);return{...o,geometry:l}}(a,i,c):a,g=o.repurposeFeature(l,s);try{return o.evaluate(g,u)}catch(e){return r.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}});