// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../chunks/tslib.es6","../../core/a11yUtils","../../core/Accessor","../../core/Error","../../core/Logger","../../core/promiseUtils","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../ViewAnimation","./viewpointUtils"],function(e,t,o,i,r,a,n,s,c,l,d,g,h,p){"use strict";e.GoToManager=class extends i{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,t){if(!e)return void a.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new h;this.view.animation=i,await s.whenOnce(()=>this.view.ready,t);const r={...t,animate:t?.animate??!o.prefersReducedMotion(),animationMode:t?.animationMode??"auto"},{extent:n,spatialReference:c,size:l,viewpoint:d,constraints:g,padding:w,allLayerViews:u}=this.view,v=p.create(e,{extent:n,spatialReference:c,size:l,viewpoint:d,constraints:g,padding:w,allLayerViews:u,pickClosestTarget:t?.pickClosestTarget??!0});return i?.update(v),this._gotoTask={},r.animate?this._gotoAnimated(v,r):this._gotoImmediate(v,r)}_gotoImmediate(e,t){const o=this._gotoTask,i=this.view.animation,a=e.then(e=>{if(n.throwIfAborted(t),o!==this._gotoTask)throw new r("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=i.target=e,i.finish()});return this._cancellableGoTo(o,i,a,t)}_gotoAnimated(e,t){const o=this._gotoTask,i=this.view.animation;if(!i)return Promise.resolve();const a=e.then(e=>{if(n.throwIfAborted(t),o!==this._gotoTask)throw new r("view:goto-interrupted","Goto was interrupted");return i.update(e),this.view.animationManager.animate(i,this.view.viewpoint,t),i.when().then(()=>{},()=>{})});return this._cancellableGoTo(o,i,a,t)}_cancellableGoTo(e,t,o,i){const r=()=>e===this._gotoTask;return n.whenOrAbort(o,i).finally(()=>{r()&&(t.done||t.stop())})}},t.__decorate([c.property({constructOnly:!0})],e.GoToManager.prototype,"view",void 0),e.GoToManager=t.__decorate([g.subclass("esri.views.2d.GoToManager")],e.GoToManager),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});