// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","./Manipulation","../../../../interactive/dragEventPipeline","../../../../interactive/GraphicManipulator","../../../../interactive/support/utils"],function(t,i,a,e,r){"use strict";class n extends i.Manipulation{constructor(t){super(),this._view=t.view,this._tool=t.tool,this._graphic=t.graphic,this._manipulator=this._createManipulator(),this.forEachManipulator(t=>this._tool.manipulators.add(t))}destroy(){this.forEachManipulator(t=>{this._tool.manipulators.remove(t),t.destroy()}),this._tool=null,this._view=null,this._manipulator=null,this._graphic=null}forEachManipulator(t){t(this._manipulator,0)}createDragPipeline(t,i){let e=null,n=null,o=0,s=0,l=0;const{offsetX:p,offsetY:c,size:u}=r.getSymbolInfo(this._graphic.symbol);return a.createManipulatorDragEventPipeline(this._manipulator,(r,h)=>{h.next(i=>{if("start"===i.action){const i=t();e=i.editGeometryOperations,n=i.constraints}return i}).next(a.screenToMap(this._view)).next(t=>{const{x:a,y:r,z:h}=t.mapEnd;if(n&&(a+p<n.xmin||r+c-u<n.ymin||a+p>n.xmax||r+c-u>n.ymax))return t;("start"===t.action||0===o&&0===s&&0===l)&&(o=t.mapStart.x,s=t.mapStart.y,l=t.mapStart.z);const m=a-o,_=r-s,v=h-l;o=a,s=r,l=h;const f="start"===t.action?0:1,g=e.move(m,_,v,f);return i(t,g),t})})}_createManipulator(){const t=this._view,i=this._graphic;return new e.GraphicManipulator({view:t,graphic:i,selectable:!0,cursor:"move"})}}t.DragManipulation=n,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});