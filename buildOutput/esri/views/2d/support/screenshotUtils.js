// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../support/screenshotUtils"],function(t,e){"use strict";const i={flipY:!0,premultipliedAlpha:!0};function n(t,i){const n=h(i||{},(o=t.stage,a=t.size,Math.min(4,e.getMaximumResolutionScale(a,Math.min(4096,o.context.parameters.maxTextureSize)))),t.size,t.padding);var o,a;const r=function(t={},e){if(!t.layers)return;const i=[];return t.layers.forEach(t=>{const n=e.find(e=>e.layer.id===t.id);n?.container&&i.push(n.container)}),i}(i,t.allLayerViews);return t.stage.takeScreenshot(n,r,t.backgroundColor,i?.rotation)}function h(t,e,i,n){t.ignorePadding&&(n={left:0,right:0,top:0,bottom:0});let h=null;null!=t.width&&null!=t.height?h=[t.width,t.height]:null==t.width&&null!=t.height?h=[t.height,t.height]:null!=t.width&&null==t.height?h=[t.width,t.width]:null==t.width&&null==t.height&&(h=null);const o=i[0]-(n.left+n.right),a=i[1]-(n.top+n.bottom);let r,l,u=t.area||{x:0,y:0,width:o,height:a};if(h){const t=o/a,e=h[0]/h[1];if(e>t){const t=u.width/e;u={x:u.x,y:Math.round(u.y+(u.height-t)/2),width:u.width,height:Math.round(t)}}else{const t=u.height*e;u={x:Math.round(u.x+(u.width-t)/2),y:u.y,width:Math.round(t),height:u.height}}}else h=[u.width,u.height];return h[0]>u.width?(r=Math.min(h[0]/u.width,e),l=h[0]/u.width/r):(r=1,l=h[0]/u.width),{cropArea:{x:Math.round((u.x+n.left)*r),y:Math.round((u.y+n.top)*r),width:Math.round(u.width*r),height:Math.round(u.height*r)},outputScale:l,resolutionScale:r}}t.createScreenshotRegion=h,t.takeRawScreenshot=async function(t,h){const o=await n(t,h);return e.encodeData(o,i)},t.takeScreenshot=async function(t,h){const o=await n(t,h),{format:a,quality:r}=e.getFormatAndQuality(h?.format,h?.quality);return e.encode(o,{format:a,quality:r},i)},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});