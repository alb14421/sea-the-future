// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../core/unitUtils","../../../geometry/Point","../../../geometry/Polyline","../../../geometry/SpatialReference","../../../geometry/support/geodesicUtils","../../../geometry/support/normalizeUtils","../../../geometry/support/spatialReferenceUtils","../../../geometry/support/webMercatorUtils","./constants"],function(e,t,r,o,n,i,s,a,c,l){"use strict";function p(e){const{isGeographic:t,isWebMercator:r}=e;return!t&&!r}e.getScaleFactor=function(e,t,r){const o=1===e?10:e;var n,i;return o**(r?Math.round((n=l.pixelsPerCell/t,i=o,Math.log(n)/Math.log(i))):0)},e.measureMetersPerUnitAtReferencePoint=function(e,l,u){const g="number"==typeof e?null:e,y=u??g?.spatialReference;if(null==y||!a.isValid(y)||p(y))return t.getMetersPerUnitForSR(y);let f=g?.x??e,h=g?.y??l;const M=1/Math.sqrt(2);let m=f+M,d=h+M;const{isWebMercator:P,isGeographic:R}=y;let S=R&&!i.isSupported(y)?n.WGS84:y;if(P){let e=new r({x:f,y:h,spatialReference:y});c.webMercatorToGeographic(e,!0,e),f=e.x,h=e.y,e=new r({x:m,y:d,spatialReference:y}),c.webMercatorToGeographic(e,!0,e),m=e.x,d=e.y,S=n.WGS84}const U=new o({paths:[[[f,h],[m,d]]],spatialReference:S}),b=s.straightLineDensify(U,10);let x;try{[x]=i.geodesicLengths([b],"meters")}catch{return t.getMetersPerUnitForSR(y)}return x},e.shouldUsePlanar=p,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});