// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../chunks/tslib.es6","../../../Graphic","../../../core/arrayUtils","../../../core/Collection","../../../core/handleUtils","../../../core/maybe","../../../core/reactiveUtils","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/accessorSupport/decorators/subclass","./LayerView2D","./graphics/GraphicContainer","./graphics/GraphicsView2D","../../layers/LayerView","../../support/highlightOptionsUtils"],function(e,i,t,s,r,a,h,c,p,o,g,n,l,d,w,u){"use strict";let y=class extends(n.LayerView2DMixin(w)){attach(){this.graphicsView=new d({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:this.layer.graphics,container:new l(this.view.featuresTilingScheme),layerId:this.layer.id}),this.container.addChild(this.graphicsView.container),this.addAttachHandles([this.layer.on("graphic-update",this.graphicsView.graphicUpdateHandler),h.when(()=>this.layer?.visible,()=>{this.graphicsView.update({state:this.view.state}),this.graphicsView.pushUpdate()})]),this._processHighlight()}detach(){this.container.removeAllChildren(),this.graphicsView=a.destroyMaybe(this.graphicsView)}async hitTest(e){return this.graphicsView?this.graphicsView.hitTest(e).map(i=>({type:"graphic",graphic:i,mapPoint:e,layer:this.layer})):null}queryGraphics(){return Promise.resolve(this.graphicsView.graphics)}update(e){this.graphicsView.processUpdate(e)}viewChange(){this.graphicsView.viewChange()}moveEnd(){}isUpdating(){return!this.graphicsView||this.graphicsView.updating}highlight(e,a){let h;"number"==typeof e?h=[e]:e instanceof i?h=[e.uid]:Array.isArray(e)&&e.length>0?h="number"==typeof e[0]?e:e.map(e=>e&&e.uid):s.isCollection(e)&&e.length>0&&(h=e.map(e=>e&&e.uid).toArray());const c=h?.filter(t.isSome);if(!c?.length)return r.makeHandle();const p=u.getHighlightName(a);return this._addHighlights(c,p),r.makeHandle(()=>!this.destroyed&&this._removeHighlights(c,p))}_processHighlight(){const e=this._getHighlights();this.graphicsView?.setHighlight(e)}};return e.__decorate([c.property()],y.prototype,"graphicsView",void 0),y=e.__decorate([g.subclass("esri.views.2d.layers.GraphicsLayerView2D")],y),y});