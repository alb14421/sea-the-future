// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","./VisualVariablesSchema","./symbols/SymbolSchema"],function(e,a,i){"use strict";e.createMatcherSchema=async function(e,s){if(!s)return{type:"simple",meshes:[]};switch(s.type){case"simple":return async function(e,s){const n=s.symbols,t=n.length?n[0]:null,l=a.createVisualVariableUniforms(s);return{type:"simple",meshes:await i.createSymbolMeshSchemas(t,{schemaOptions:e,uniforms:l})}}(e,s);case"dot-density":return async function(e,s){const n=a.createVisualVariableUniforms(s);return{type:"dot-density",meshes:await i.createDotDensityMeshSchemas(s,{schemaOptions:e,uniforms:n})}}(e,s);case"class-breaks":return async function(e,s){const n=a.createVisualVariableUniforms(s),t=s.backgroundFillSymbol,l=s.normalizationType,r="log"===l?"esriNormalizeByLog":"percent-of-total"===l?"esriNormalizeByPercentOfTotal":"field"===l?"esriNormalizeByField":null,o=s.classBreakInfos.map(async a=>({meshes:await i.createSymbolMeshSchemas(a.symbol,{path:`renderer-stop-${a.minValue}-${a.maxValue}`,schemaOptions:e,uniforms:n}),min:a.minValue,max:a.maxValue})),c=(await Promise.all(o)).sort((e,a)=>e.min-a.min),m=await i.createSymbolMeshSchemas(t,{schemaOptions:e,uniforms:{...a.noVisualVariables,visualVariableSizeOutlineScaleStops:n.visualVariableSizeOutlineScaleStops}}),u=await i.createSymbolMeshSchemas(s.defaultSymbol,{schemaOptions:e,uniforms:n});return{type:"interval",field:s.field,expression:s.valueExpression,backgroundFill:m,defaultSymbol:u,intervals:c,normalizationField:s.normalizationField,normalizationTotal:s.normalizationTotal,normalizationType:r,isMaxInclusive:s.isMaxInclusive}}(e,s);case"unique-value":return async function(e,s){const n=[],t=a.createVisualVariableUniforms(s),l=await i.createSymbolMeshSchemas(s.backgroundFillSymbol,{schemaOptions:e,uniforms:{...a.noVisualVariables,visualVariableSizeOutlineScaleStops:t.visualVariableSizeOutlineScaleStops}}),r=await i.createSymbolMeshSchemas(s.defaultSymbol,{schemaOptions:e,uniforms:t});for(const a of s.uniqueValueInfos??[]){const s=await i.createSymbolMeshSchemas(a.symbol,{path:`renderer-unique-value-${a.value}`,schemaOptions:e,uniforms:t});n.push({value:""+a.value,symbol:s})}return{type:"map",field:s.field,expression:s.valueExpression,field2:s.field2,field3:s.field3,fieldDelimiter:s.fieldDelimiter,backgroundFill:l,defaultSymbol:r,map:n}}(e,s);case"dictionary":return async function(e){const i=a.createVisualVariableUniforms(e),s=await e.getDictionaryInfo(),n=e.scaleExpression,t=null!=n&&"1"!==n?{valueExpressionInfo:{type:"CIMExpressionInfo",expression:e.scaleExpression,returnType:"Numeric"},defaultValue:1}:void 0;return{type:"dictionary",dictionaryInfo:s,userConfig:e.config??{},fieldMap:e.fieldMap??{},scaleExpression:t,visualVariableUniforms:i}}(s);case"heatmap":return async function(e,a){return{type:"heatmap",meshes:await i.createHeatmapMeshSchemas(a,e)}}(e,s);case"pie-chart":return async function(e,a){return{type:"pie-chart",meshes:await i.createPieChartMeshSchemas(a,e)}}(e,s)}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});