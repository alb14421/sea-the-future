// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports"],function(n){"use strict";function t(n,t,e,m,x=m){let i=0,r=0n,{xmin:a,ymin:u,xmax:c,ymax:s}=n;for(;i!==x;){const n=(a+c)/2;let x=0;t>n?(x=1,a=n):c=n;const y=(u+s)/2;let f=0;e>y?(f=1,u=y):s=y,r+=o(x|f<<1,i,m),i+=1}return r}function e(n,t){let e=0n;for(let m=0;m<n.length;m++)e+=o(n[m],m,t);return e}function m(n){const t=n.xmax-n.xmin,e=n.ymax-n.ymin;return{xmin:n.xmin,ymin:n.ymin,xmax:n.xmax+t,ymax:n.ymax+e}}function o(n,t,e){return BigInt(n)*function(n,t){return(4n**(BigInt(n)-BigInt(t))-1n)/3n}(e,t)+1n}function x(n,t){return!(n.xmax<=t.xmin||n.xmin>=t.xmax||n.ymax<=t.ymin||n.ymin>=t.ymax)}function i(n,t){return t.xmin>=n.xmin&&t.xmax<=n.xmax&&t.ymin>=n.ymin&&t.ymax<=n.ymax}function r(n){const t=(n.xmin+n.xmax)/2,e=(n.ymin+n.ymax)/2;return[{xmin:n.xmin,xmax:t,ymin:n.ymin,ymax:e},{xmin:t,xmax:n.xmax,ymin:n.ymin,ymax:e},{xmin:n.xmin,xmax:t,ymin:e,ymax:n.ymax},{xmin:t,xmax:n.xmax,ymin:e,ymax:n.ymax}]}function a(n){if(0===n.length)return[];n.sort((n,t)=>n.start===t.start?n.end<t.end?-1:1:n.start<t.start?-1:1);const t=[];let e=n[0];for(let m=1;m<n.length;m++){const o=n[m];e.end+1n>=o.start?e={start:e.start,end:e.end>o.end?e.end:o.end}:(t.push(e),e=o)}return t.push(e),t}n.getExtentXZCode=function(n,e,m){const o=n.xmax-n.xmin,x=n.ymax-n.ymin,i=e.xmax-e.xmin,r=e.ymax-e.ymin,a=Math.log2(o/i),u=Math.log2(x/r),c=Math.floor(Math.min(a,u))+1;let s=Math.min(c,m);const y=o/2**s,f=x/2**s,d=Math.floor(e.xmin/y),l=Math.floor(e.xmax/y),h=Math.floor(e.ymin/f),g=Math.floor(e.ymax/f);return(l-d+1>2||g-h+1>2)&&(s-=1),t(n,e.xmin,e.ymin,m,s)},n.getPointXZCode=t,n.getQueryXZCodeRanges=function(n,t,e){return a(function(n,t,e){const m=[],a=[{extent:n,codeSum:0n,depth:0}];for(;a.length;){const{extent:n,codeSum:u,depth:c}=a.pop();if(!x(n,t))continue;if(i(t,n)){const n=u;let t=u;for(let n=c;n<e;n++)t+=o(3,n,e);m.push({start:n,end:t});continue}if(c===e){m.push({start:u,end:u});continue}const s=r(n);for(let n=0;n<s.length;n++)a.push({extent:s[n],codeSum:u+o(n,c,e),depth:c+1})}return m}(n,t,e))},n.getQueryXZCodeRangesExpanded=function(n,t,e,u=e){return a(function(n,t,e,a){const u=[],c=[{extent:n,codeSum:0n,depth:0}];for(;c.length;){const{extent:n,codeSum:s,depth:y}=c.pop();if(!x(m(n),t))continue;if(i(t,m(n))){const n=s;let t=s;for(let n=y;n<e;n++)t+=o(3,n,e);u.push({start:n,end:t});continue}if(u.push({start:s,end:s}),y===a)continue;const f=r(n);for(let n=0;n<f.length;n++)c.push({extent:f[n],codeSum:s+o(n,y,e),depth:y+1})}return u}(n,t,e,Math.min(u,e)))},n.getXZCodeForSequence=e,n.getXZInterval=function(n,t){const m=[...n];for(let e=n.length;e<t;e++)m.push(3);return{start:e(n,t),end:e(m,t)}},Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});