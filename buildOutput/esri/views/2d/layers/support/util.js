// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/jsonMap","../../engine/webgl/effects/highlight/HighlightGradient","../../engine/webgl/effects/highlight/MultiHighlightGradient","../../engine/webgl/shaderGraph/techniques/featureTechniqueUtils"],function(e,t,i,n,l){"use strict";const r=new t.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});e.analyzeRings=function(e,t,i){const n=[],l=[];let r=0,a=0;for(const s of e){const e=a;let o=s[0][0],h=s[0][1];n[a++]=o,n[a++]=h;let g=0;for(let e=1;e<s.length;++e){const t=o,i=h;o=s[e][0],h=s[e][1],g+=h*t-o*i,n[a++]=o,n[a++]=h}t(g/2),g>0?(e-r>0&&(i(r,e,n,l),r=e),l.length=0):g<0&&e-r>0?l.push(.5*(e-r)):a=e}a-r>0&&i(r,a,n,l)},e.canUseMajorityInterpolationOnDataSource=function(e){const{bandCount:t,attributeTable:i,colormap:n,pixelType:l}=e.raster.rasterInfo;return 1===t&&(null!=i||null!=n||"u8"===l||"s8"===l)},e.createOrReuseHighlightGradient=function(e,t){return null==t?(e?.destroy(),null):("single"===e?.type&&Array.isArray(t)&&(e.destroy(),e=null),"multi"!==e?.type||Array.isArray(t)||(e.destroy(),e=null),e||(e=Array.isArray(t)?new n.MultiHighlightGradient:new i),Array.isArray(t)?"multi"===e.type&&e.setHighlightOptions(t):"single"===e.type&&e.setHighlightOptions(t),e)},e.renderHighlight=function(e,t,i,n){const{painter:r,highlightGradient:a}=e,{highlight:s}=r.effects;if(!a)return;const o=e.passOptions,h=a.getReasonsWithGradients();for(let a=0;a<h.length;a++){const o={...e,passOptions:{type:"highlight",activeGradient:null!=n?h[n].activeGradient:h[a].activeGradient,activeReasons:h[a].activeReasons,stepType:"burn",highlightAll:t}};if(s.bind(o),i(o),a<h.length-1){let l=0;for(let e=a+1;e<h.length;e++)l|=h[e].activeReasons;i({...e,passOptions:{type:"highlight",activeGradient:null!=n?h[n].activeGradient:h[a].activeGradient,activeReasons:l,stepType:"clear",highlightAll:t}})}const g={...e,passOptions:{type:"highlight",activeGradient:null!=n?h[n].activeGradient:h[a].activeGradient,activeReasons:h[a].activeReasons,stepType:"draw",highlightAll:t}};r.setPipelineState(l.getFeaturePipelineState(e)),r.updatePipelineState(e.context),s.draw(g),s.unbind()}e.passOptions=o},e.toJSONGeometryType=function(e){return r.toJSON(e)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});