// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/has","../../../../core/lang","../../../../core/LRUCache","../../../../core/promiseUtils","../../../../core/string"],function(e,t,n,c,o,s){"use strict";class r{async fetch(){return[]}notifySymbologyChange(){}}class a{constructor(e){this._getSymbologyCandidates=e,this._candidatesCache=new c.LRUCache(1024),this._cacheVersion=0}async fetch(e,t){if(0===e.length)return[];const c=[],s=[],r=this._candidatesCache;for(const t of e){const e=i(t),o=r.get(e);if(o)for(const e of o)s.push(n.clone(e));else c.push(t),r.put(e,[],1)}if(0===c.length)return s;const a=this._cacheVersion,{candidates:h,sourceCandidateIndices:d}=await this._getSymbologyCandidates(c,t);if(o.throwIfAborted(t),a!==this._cacheVersion)return this.fetch(e,t);const g=[],{length:u}=h;for(let e=0;e<u;++e){const t=h[e],o=i(c[d[e]]),s=r.get(o);s.push(t),r.put(o,s,s.length),g.push(n.clone(t))}return s.concat(g)}notifySymbologyChange(){this._candidatesCache.clear(),this._cacheVersion++}}function i(e){switch(e.type){case"vertex":{const{objectId:t,target:n}=e,c=`${t}-vertex-${n.x}-${n.y}-${n.z??0}`;return s.numericHash(c).toString()}case"edge":{const{objectId:t,start:n,end:c}=e,o=`${t}-edge-${n.x}-${n.y}-${n.z??0}-to-${c.x}-${c.y}-${c.z??0}`;return s.numericHash(o).toString()}default:return""}}e.getSymbologySnappingCandidatesFetcher=function(e=!1,t){return e?new a(t):new r},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});