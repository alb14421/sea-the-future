// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../chunks/tslib.es6","../../../core/Accessor","../../../core/arrayUtils","../../../core/Collection","../../../core/Logger","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/accessorSupport/decorators/subclass","./FeatureSnappingLayerSource","./Settings"],function(e,t,r,o,a,l,d,i,s,n,u){"use strict";function c(e){return"subtype-group"===e.layer.type}function p(e){return"subtype-group"!==e.layer.type}function f(e){return"subtype-sublayer"===e.layer.type}return e.default=class extends r{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new a,this.distance=u.defaults.distance,this.touchSensitivityMultiplier=u.defaults.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){const e=this.featureSources;e.some(c)&&l.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const t=e.filter(f),r=this._get("_effectiveFeatureSources")?.filter(c)??new a;for(const e of t){const t=r.find(t=>t.layer===e.layer.parent);if(t)t.sublayerSources.includes(e)||t.sublayerSources.add(e);else if(e.layer.parent){const t=new n({layer:e.layer.parent});t.sublayerSources.add(e),r.add(t)}}for(const e of r){const r=e.sublayerSources.filter(e=>!t.includes(e));e.sublayerSources.removeMany(r)}r.removeMany(r.filter(e=>0===e.sublayerSources.length));const d=e.filter(p),i=this._get("_effectiveFeatureSources")??new a,{added:s,removed:u}=o.difference(i.toArray(),[...d,...r]);return i.removeMany(u),i.addMany(s),i}},t.__decorate([d.property()],e.default.prototype,"enabled",void 0),t.__decorate([d.property()],e.default.prototype,"enabledToggled",void 0),t.__decorate([d.property()],e.default.prototype,"forceDisabled",void 0),t.__decorate([d.property()],e.default.prototype,"selfEnabled",void 0),t.__decorate([d.property()],e.default.prototype,"featureEnabled",void 0),t.__decorate([d.property()],e.default.prototype,"gridEnabled",void 0),t.__decorate([d.property()],e.default.prototype,"attributeRulesEnabled",void 0),t.__decorate([d.property({type:a.ofType(n)})],e.default.prototype,"featureSources",void 0),t.__decorate([d.property()],e.default.prototype,"distance",void 0),t.__decorate([d.property()],e.default.prototype,"touchSensitivityMultiplier",void 0),t.__decorate([d.property({readOnly:!0})],e.default.prototype,"effectiveEnabled",null),t.__decorate([d.property({readOnly:!0})],e.default.prototype,"effectiveGridEnabled",null),t.__decorate([d.property({readOnly:!0})],e.default.prototype,"effectiveSelfEnabled",null),t.__decorate([d.property({readOnly:!0})],e.default.prototype,"effectiveFeatureEnabled",null),t.__decorate([d.property({readOnly:!0})],e.default.prototype,"_effectiveFeatureSources",null),e.default=t.__decorate([s.subclass("esri.views.interactive.snapping.SnappingOptions")],e.default),e.default});