// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../core/arrayUtils","../../core/handleUtils","../../core/MapUtils","../input/InputManager","../input/keys"],function(e,t,i,o,r,n){"use strict";const s={cancel:"Escape",complete:"Enter"},a={...s,redo:"r",undo:"z",center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},c={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:n.primaryKey,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},editSourcePoints:{key:"Alt",continuePropagation:!0},undo:"z",redo:"r"};class p{constructor(e,t,i,o,r){this.key=e,this.modifiers=t,this.repeats=i,this.continuePropagation=o,this.callback=r}process(e,t){if(!(t.key!==this.key||"repeat"in t&&t.repeat&&!this.repeats)){for(const t of this.modifiers)if(!e.isModifierKeyDown(t))return;this.continuePropagation||t.stopPropagation(),this.callback(t)}}static fromDefinition(e,t){if("string"==typeof e)return new p(e,[],!1,!1,t);const{key:i,modifier:o,repeats:r,continuePropagation:n}=e;return new p(i,o?Array.isArray(o)?o:[o]:[],!!r,!!n,t)}}e.KeyBindings=class{constructor(){this._bindings=new Map}add(e,t){return this.addToggle(e,e=>{"key-down"===e.type&&t(e)})}addToggle(e,r){const n=p.fromDefinition(e,r),s=o.getOrCreateMapValue(this._bindings,n.key,()=>[]);return s.push(n),i.makeHandle(()=>t.remove(s,n))}register(e,t=r.ViewEventPriorities.WIDGET){return i.handlesGroup([e.on("key-down",t=>this.dispatch(e.inputManager,t),t),e.on("key-up",t=>this.dispatch(e.inputManager,t),t)])}dispatch(e,t){const i=t.key,o=this._bindings.get(i);if(o)for(const i of o)i.process(e,t)}},e.interactiveToolKeys=s,e.mediaKeys=c,e.selectionKeys={invertType:["Control","Meta"]},e.sketchKeys=a,e.snappingKeys={toggle:"Control"},e.tooltipKeys={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});