// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../geometry/support/curves/curveUtils","../EditGeometry"],function(e,t,i){"use strict";e.AppendVertex=class{constructor(e,t,i){this._editGeometry=e,this._part=t,this._posOrCurveDef=i,this._addedVertex=null,this._originalSegment=null,this._left=null,this._right=null}apply(){let e="redo";const{_part:r,_editGeometry:s,_posOrCurveDef:n}=this;null==this._addedVertex&&(e="apply",this._addedVertex=new i.Vertex(r));const d=r.getLastVertex(),l=s.coordinateHelper.arrayToVector(t.getEndpoint(n));if(null==d)r.vertices.push(this._addedVertex),this._addedVertex.pos=l,this._addedVertex.index=0;else{let e=null;d.rightSegment&&(this._originalSegment=d.rightSegment,e=this._originalSegment.rightVertex,r.segments.splice(r.segments.indexOf(this._originalSegment),1)),r.vertices.push(this._addedVertex),this._addedVertex.pos=l,this._left??=i.createConnectingSegment(r,d,this._addedVertex,n),r.segments.push(this._left),d.rightSegment=this._left,null!=this._originalSegment&&null!=e&&(this._right??=new i.LineSegment(this._part,this._addedVertex,e),r.segments.push(this._right),e.leftSegment=this._right),r.updateVertexIndex(this._addedVertex,d.index+1)}this._editGeometry.notifyChanges({operation:e,addedVertices:[this._addedVertex]})}undo(){const{_addedVertex:e,_part:t,_left:i,_right:r,_originalSegment:s}=this;null!=e&&(t.vertices.splice(t.vertices.indexOf(e),1),null!=i&&(t.segments.splice(t.segments.indexOf(i),1),i.leftVertex.rightSegment=null),null!=r&&(t.segments.splice(t.segments.indexOf(r),1),r.rightVertex.leftSegment=null),null!=s&&(t.segments.push(s),s.leftVertex.rightSegment=s,s.rightVertex.leftSegment=s),null!=i?t.updateVertexIndex(i.leftVertex,i.leftVertex.index):t.updateVertexIndex(e,0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[e]}))}accumulate(){return!1}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});