// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../geometry/support/aaBoundingRect","../../../../geometry/support/DoubleArray","../../../../geometry/support/FloatArray","../../webgl-engine/lib/Attribute","../../webgl-engine/lib/Geometry","../../webgl-engine/lib/GeometryUtil"],function(t,e,r,n,i,o,h){"use strict";function u(t,e){return h.createSquareGeometry(t,[[e[0],e[1],-1],[e[2],e[1],-1],[e[2],e[3],-1],[e[0],e[3],-1]])}const a=[0,0,1];t.computeImageExportSize=function(t,r,n){const i=e.width(t)/e.height(t),o={width:n,height:n};return i>1.0001?o.height=n/i:i<.9999&&(o.width=n*i),o.width=Math.round(o.width/(e.width(t)/e.width(r))),o.height=Math.round(o.height/(e.height(t)/e.height(r))),o},t.createGeometryForExtent=u,t.createOuterImageGeometry=function(t,h,g){if(!e.intersects(h,g))return u(t,g);const l=[h[1]-g[1],Math.min(h[3],g[3])-Math.max(h[1],g[1]),g[3]-h[3],123456],c=[h[0]-g[0],Math.min(h[2],g[2])-Math.max(h[0],g[0]),g[2]-h[2],123456],m=g[2]-g[0],w=g[3]-g[1],y=c[0]>0&&c[2]>0?3:2,s=l[0]>0&&l[2]>0?3:2,b=(s+1)*(y+1),d=r.newDoubleArray(3*b),p=n.newFloatArray(2*b),f=new Array(6*(s*y-1));let A=0,M=0,G=0,x=0,S=0;for(let t=0;t<4;t++){const e=l[t];if(e<=0)continue;let r=0;for(let e=0;e<4;e++){const n=c[e];n<=0||(d[M++]=g[0]+r,d[M++]=g[1]+A,d[M++]=-1,p[G++]=r/m,p[G++]=A/w,e<3&&t<3&&(1!==e||1!==t)&&(f[S++]=x,f[S++]=x+1,f[S++]=x+y+1,f[S++]=x+1,f[S++]=x+y+2,f[S++]=x+y+1),x++,r+=n)}A+=e}const F=new Array(f.length);return new o.Geometry(t,[["position",new i.Attribute(d,f,3,!0)],["normal",new i.Attribute(a,F,3,!0)],["uv0",new i.Attribute(p,f,2,!0)]])},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});