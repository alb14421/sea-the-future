// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/tslib.es6","../../../../core/Accessor","../../../../core/AsyncUpdate","../../../../core/Logger","../../../../core/accessorSupport/decorators/property","../../../../core/has","../../../../core/RandomLCG","../../../../core/accessorSupport/decorators/subclass","../../../../layers/support/fieldUtils"],function(e,r,i,s,t,l,d,o,c,n){"use strict";e.SceneLayerViewRequiredFields=class extends(s.AsyncUpdateMixin(i)){get layer(){return this.layerView.layer}get requiredFields(){const{layerView:{layer:{fieldsIndex:e},definitionExpressionFields:r},rendererFields:i,labelingFields:s,viewFilterFields:t}=this;return n.fixFields(e,[...r??[],...i??[],...s??[],...t??[]])}constructor(e){super(e)}initialize(){this.addHandles([this.autoUpdateAsync("rendererFields",async()=>{const{fieldsIndex:e,renderer:r}=this.layer;return r?this._getFieldsAsync(i=>r.collectRequiredFields(i,e)):null}),this.autoUpdateAsync("labelingFields",async()=>{const{layer:e}=this;return e.labelsVisible?this._getFieldsAsync(r=>n.collectLabelingFields(r,e)):null}),this.autoUpdateAsync("viewFilterFields",()=>{const{layer:e,mergedFilter:r}=this.layerView;return this._getFieldsAsync(i=>n.collectFilterFields(i,e,r))})])}async _getFieldsAsync(e){const r=new Set;try{return await e(r),Array.from(r).sort()}catch(e){return t.getLogger(this).error(e),null}}},r.__decorate([l.property()],e.SceneLayerViewRequiredFields.prototype,"layerView",void 0),r.__decorate([l.property()],e.SceneLayerViewRequiredFields.prototype,"layer",null),r.__decorate([l.property()],e.SceneLayerViewRequiredFields.prototype,"requiredFields",null),r.__decorate([l.property()],e.SceneLayerViewRequiredFields.prototype,"rendererFields",void 0),r.__decorate([l.property()],e.SceneLayerViewRequiredFields.prototype,"labelingFields",void 0),r.__decorate([l.property()],e.SceneLayerViewRequiredFields.prototype,"viewFilterFields",void 0),e.SceneLayerViewRequiredFields=r.__decorate([c.subclass("esri.views.3d.layers.support.SceneLayerViewRequiredFields")],e.SceneLayerViewRequiredFields),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});