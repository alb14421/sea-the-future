// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/tslib.es6","../../../../core/accessorSupport/decorators/property","../../../../core/has","../../../../core/Logger","../../../../core/RandomLCG","../../../../core/accessorSupport/decorators/subclass","../../../../layers/graphics/data/timeSupport","../../../../layers/support/FeatureFilter","../../../../layers/support/timeSupport","../i3s/I3SBinaryReader","../i3s/I3SUtil"],function(e,t,r,n,i,s,l,o,u,a,c,p){"use strict";class d{constructor(e){this.attributeData=e}getAttribute(e,t){return c.getCachedAttributeValue(this.attributeData[t],e)}getAttributeAsTimestamp(e,t){const r=this.getAttribute(e,t);return"string"==typeof r?new Date(r).getTime():"number"==typeof r||null==r?r:null}}e.TemporalSceneLayerView=e=>{const n=e;let i=class extends n{get timeExtent(){return a.combineTimeExtent(this.i3slayer,this.view?.timeExtent,this._get("timeExtent"))}get mergedFilter(){const{filter:e,timeExtent:t}=this;if(null==t)return e;const r=e?.clone()??new u;return null!=t&&(r.timeExtent=r.timeExtent?.intersection(t)??t),r}getTimeFilterDependencies(){const{timeInfo:e}=this.i3slayer;if(null==e)return[];const{startField:t,endField:r}=e;return[t,r]}addTimeFilter(e,t){if(null==t)return;const{timeInfo:r}=this.i3slayer;if(null==r)return;const{startField:n,endField:i,useTime:s}=r;if(!s||null==n&&null==i)return;const l=r.toJSON(),u=t.toJSON();e.push((e,t)=>function(e,t,r,n){const i=t.attributeInfo?.attributeData;if(null==i)return;const{startTimeField:s,endTimeField:l}=r;if(null!=s&&null==i[s]||null!=l&&null==i[l])return;const u=o.getTimeOperator(r,n,new d(i));if(null==u)return;const{featureIds:a}=t;p.filterInPlace(e,a,u)}(e,t,l,u))}};return t.__decorate([r.property({readOnly:!0})],i.prototype,"timeExtent",null),t.__decorate([r.property()],i.prototype,"mergedFilter",null),i=t.__decorate([l.subclass("esri.views.3d.layers.support.TemporalSceneLayerView")],i),i},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});