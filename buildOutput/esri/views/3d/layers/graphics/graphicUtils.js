// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/unitUtils","../../../../core/libs/gl-matrix-2/math/mat4","../../../../core/libs/gl-matrix-2/factories/mat4f64","../../../../core/libs/gl-matrix-2/factories/vec3f64","../../../../chunks/vec42","../../../../core/libs/gl-matrix-2/factories/vec4f64","../../../../geometry/projectionUtils","../../../../geometry/support/aaBoundingBox","../../../../geometry/support/aaBoundingRect","../../../../geometry/support/centroid","../../../../geometry/support/coordsUtils","../../../../geometry/support/meshVertexSpaceUtils","../../../../layers/graphics/dehydratedPoint","../../../../layers/graphics/hydratedFeatures"],function(e,t,n,r,i,o,a,l,u,s,c,m,h,p,d){"use strict";function y(e){const t=e.paths[0];if(!t||0===t.length)return null;const n=m.getPointOnPath(t,m.getPathLength(t)/2);return p.makeDehydratedPoint(n[0],n[1],n[2],e.spatialReference)}function f(e,t,n){const r=n?e:d.clonePoint(e);return t&&e?l.projectPoint(e,r,t)?r:null:r}function g(e){const t=e=>null==e||e>=0;return Array.isArray(e)?e.every(t):t(e)}e.computeCentroid=function(e,t){if("point"===e.type)return f(e,t,!1);if(d.isHydratedGeometry(e))switch(e.type){case"extent":return f(e.center,t,!1);case"polygon":return f(e.centroid,t,!1);case"polyline":return f(y(e),t,!0);case"mesh":return f(h.vertexSpaceOriginToPoint(e.vertexSpace,e.spatialReference)??e.extent.center,t,!1);case"multipoint":return}else switch(e.type){case"extent":return f(function(e){return p.makeDehydratedPoint(.5*(e.xmax+e.xmin),.5*(e.ymax+e.ymin),null!=e.zmin&&null!=e.zmax&&isFinite(e.zmin)&&isFinite(e.zmax)?.5*(e.zmax+e.zmin):void 0,e.spatialReference)}(e),t,!0);case"polygon":return f(function(e){const t=e.rings[0];if(!t||0===t.length)return null;const n=c.ringsCentroid(e.rings,!!e.hasZ);return p.makeDehydratedPoint(n[0],n[1],n[2],e.spatialReference)}(e),t,!0);case"polyline":return f(y(e),t,!0);case"multipoint":return}},e.computeMaxZ=function(e){if(!e)return 0;switch(e.type){case"point":return e.z;case"extent":return e.zmax;case"polygon":return e.hasZ?e.rings.reduce((e,t)=>t.reduce((e,t)=>Math.max(e,t[2]),e),-1/0):void 0;case"polyline":return e.hasZ?e.paths.reduce((e,t)=>t.reduce((e,t)=>Math.max(e,t[2]),e),-1/0):void 0;case"mesh":return e.extent.zmax;case"multipoint":return}},e.computeObjectRotation=function(e,t,i,o=r.create()){return e&&n.rotateZ(o,o,-e/180*Math.PI),t&&n.rotateX(o,o,t/180*Math.PI),i&&n.rotateY(o,o,i/180*Math.PI),o},e.computeObjectScale=function(e=i.ONES,t,n,r=1){const o=new Array(3);if(null==t||null==n)o[0]=1,o[1]=1,o[2]=1;else{let r,i=0;for(let a=2;a>=0;a--){const l=e[a],u=null!=l,s=0===a&&!r&&!u,c=n[a];let m;"symbol-value"===l||s?m=0!==c?t[a]/c:1:u&&"proportional"!==l&&isFinite(l)&&(m=0!==c?l/c:1),null!=m&&(o[a]=m,r=m,i=Math.max(i,Math.abs(m)))}for(let e=2;e>=0;e--)null==o[e]?o[e]=r:0===o[e]&&(o[e]=.001*i)}for(let e=2;e>=0;e--)o[e]/=r;return i.fromArray(o)},e.demResolutionForBoundingBox=function(e,n,r){if(null!=r.minDemResolution)return r.minDemResolution;const i=t.getMetersPerUnitForSR(n),o=u.width(e)*i,a=u.depth(e)*i,l=u.height(e)*(n.isGeographic?1:i);return 0===o&&0===a&&0===l?r.minDemResolutionForPoints:.01*Math.max(o,a,l)},e.enlargeExtent=function(e,t,n,r=0){if(e){t||(t=s.create());const i=e;let a=.5*i.width*(n-1),l=.5*i.height*(n-1);return i.width<1e-7*i.height?a+=l/20:i.height<1e-7*i.width&&(l+=a/20),o.set(t,i.xmin-a-r,i.ymin-l-r,i.xmax+a+r,i.ymax+l+r),t}return null},e.isValidSize=g,e.mixinColorAndOpacity=function(e,t,n=null){const r=a.clone(a.ONES);return null!=e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],e.length>3&&(r[3]=e[3])),null!=t&&(r[3]=t),n&&o.scale(r,r,n),r},e.overrideColor=function(e,t,n,r,i,o){for(let t=0;t<3;++t)o[t]=null!=e?.[t]?e[t]:null!=n?.[t]?n[t]:i[t];return o[3]=null!=t?t:null!=r?r:i[3],o},e.validateSymbolLayerSize=function(e){return g(null!=e.isPrimitive?[e.width,e.depth,e.height]:e)?null:"Symbol sizes may not be negative values"},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});