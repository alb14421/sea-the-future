// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../libs/lyr3d/Lyr3DModule"],function(s,t){"use strict";let e,r;function n(){return r?Promise.resolve():(e||(e=t.loadLyr3DWorkerWASM().then(s=>{r=s,r.initialize_lyr3d_worker_wasm(),e=null})),e)}s.destroyWasm=function(){r&&(r.uninitialize_lyr3d_worker_wasm(),r=null)},s.initialize=n,s.process=async function(s){await n();const t={status:1,error:"",jobDescJson:"",data:new Uint8Array(0),missingInputUrls:[]};if(s.inputs.length<1)return{result:t,transferList:[]};const e={ptrs:[],sizes:[]};for(const t of s.inputs){const s=r._malloc(t.byteLength);new Uint8Array(r.HEAPU8.buffer,s,t.byteLength).set(new Uint8Array(t)),e.ptrs.push(s),e.sizes.push(t.byteLength)}const i=r.process(s.jobDescJson,s.id,e,s.isMissingResourceCase);t.status=i.status,t.missingInputUrls=i.missingInputUrls.slice();const o=0===i.status&&i.data,l=2===t.status&&t.missingInputUrls.length>0;t.jobDescJson=i.jobDescJson.slice(),t.error=i.error.slice(),o?t.data=i.data.slice():l&&(t.originalInputs=s.inputs.slice());for(let s=0;s<e.ptrs.length;++s)r._free(e.ptrs[s]);const u=[];if(o)u.push(t.data.buffer);else if(l)for(const t of s.inputs)u.push(t);return{result:t,transferList:u}},Object.defineProperty(s,Symbol.toStringTag,{value:"Module"})});