// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../core/Error","../../../layers/ILyr3DWasmPerSceneView"],function(e,r,t,i){"use strict";const a=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));let n,l=null;const s=new Map;r.addLayerViewToWasm=async function(r){null==l&&(null==n&&(n=new Promise((r,t)=>e(["../../../layers/Lyr3DWasmPerSceneView"],e=>r(a(e)),t))),l=await n);const o=r.view;let d=s.get(o);d||(d=new l.default({view:o}),s.set(o,d));const u=!!o.stage.renderView.renderingContext.capabilities.compressedTextureS3TC,w=!!o.stage.renderView.renderingContext.capabilities.compressedTextureETC;await d.initializeWasm(u,w);const c=d.add3DTilesLayerView(r);if(c.wasmLayerId<0)throw d.getValidLayerViewCount()<1&&(s.delete(o),0===s.size&&(n=null,l=null)),c.wasmLayerId===i.wasmFailedToInit?new t("tiles3d:addLayer-failure","The 3d tiles layer web assembly module failed to download.",{}):new t("tiles3d:addLayer-failure",c.check?.errorDescription??"The 3d tiles layer description was invalid.",{});return c.wasmLayerId},r.getLyr3DWasm=function(e){return s.get(e)},r.removeLayerViewFromWasm=function(e){const r=e.view,t=s.get(r);t&&t.remove3DTilesLayerView(e)<1&&(s.delete(r),0===s.size&&(n=null,l=null))},Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});