// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/vec32","../../../../core/libs/gl-matrix-2/factories/vec3f64","../../../../geometry/support/ray","../../../../chunks/sphere","./common"],function(t,e,n,r,i,o){"use strict";function c(t,e,n=o.defaultConstraintOptions){if(!t.state.isLocal)return 0;const r=t.state.constraints.distance;if(!t.pointsOfInterest.surfaceOrigin.renderLocation||r===1/0)return 0;s.min=0,s.max=r,function(t,e,n){const r=e.interactionType;if(0===r)return;const{min:i,max:s}=n,{interactionStartCamera:u,interactionFactor:f}=e;if(!u)return;const d=1===r||4===r,m=c(t,u),p=0===m?0:a(t,u);n.min=i,n.max=s;const l=.05*p;o.adjustRangeForInteraction(m,p,d,f,l,n)}(t,n,s);const i=a(t,e),u=s.max-i;return u>=-1e-6?0:u}function a(t,n){const r=t.pointsOfInterest.surfaceOrigin;return r.renderLocation?e.distance(n.eye,r.renderLocation):0}const s={min:0,max:0},u=n.create(),f=n.create(),d=n.create(),m=n.create(),p=n.create();t.applyDistanceConstraint=function(t,n,s=o.defaultConstraintOptions){const l=c(t,n,s);if(0===l)return!1;const y=t.pointsOfInterest.surfaceOrigin;if(!y.renderLocation)return!1;const g=a(t,n)+l,C=e.copy(u,n.eye),O=o.interactionDirectionTowardsConstraintMinimization(n,s.interactionDirection,function(t,n,r){return e.direction(r,t.eye,n)}(n,y.renderLocation,m),d);if(!i.intersectRay(i.fromCenterAndRadius(y.renderLocation,g),r.wrap(n.eye,O),p))return!1;n.eye=p;const x=e.subtract(f,n.eye,C);n.center=e.add(p,n.center,x);const L=t.renderCoordsHelper.getAltitude(n.center),I=t.renderCoordsHelper.intersectInfiniteManifold(n.ray,L,p);return null!=I&&(n.center=I),!0},t.getDistanceConstraintError=c,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});