// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../state/controllers/PinchAndPanControllerGlobal","../../state/controllers/PinchAndPanControllerLocal","../../../input/InputHandler","../../../input/handlers/support"],function(t,e,n,s,i){"use strict";class r extends s.InputHandler{constructor(t,e,n){super(!0),this._view=t,this.pointerActions=e,this._lastEndTimestamp=0,this._lastTimestamp=0,this.registerIncoming("drag",n,t=>this._handleDrag(t))}_handleDrag(t){if("mouse"===t.data.pointerType&&!i.eventMatchesMousePointerActions(t.data,this.pointerActions))return;const e=t.timestamp-this._lastEndTimestamp,n=this._momentum&&this._momentum.running&&e<40;switch(t.data.action){case"start":case"update":if(n)break;this._controller&&this._controller.running?t.data.timestamp-this._lastTimestamp>2&&(this._controller.update(t.data),this._lastTimestamp=t.timestamp):this._startController(t);break;case"end":case"removed":this._endController(t,!0);break;case"added":this._endController(t,!1),this._startController(t)}t.stopPropagation()}_endController(t,e){if(this._controller?.running){this._lastEndTimestamp=t.timestamp;const n=this._controller.end(t.data);e&&n&&(this._momentum=n,this._view.state.switchCameraController(this._momentum))}this._controller=null}_startController(t){this._controller=this._createController(),this._view.state.switchCameraController(this._controller),this._controller.begin(t.data),this._lastTimestamp=t.timestamp}_createController(){return this._view.state.isGlobal?new e.PinchAndPanControllerGlobal({view:this._view}):new n.PinchAndPanControllerLocal({view:this._view})}}t.PinchAndPanNavigation=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});