// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/tslib.es6","../../../../core/Evented","../../../../core/handleUtils","../../../../core/reactiveUtils","../../../../core/accessorSupport/decorators/property","../../../../core/has","../../../../core/Logger","../../../../core/RandomLCG","../../../../core/accessorSupport/decorators/subclass","./media/MediaElementControllerControlPoints","./media/MediaElementControllerShape","./media/MediaElementManipulator3D","./media/mediaElementUtils"],function(e,t,r,o,l,n,i,a,d,s,c,p,u,m){"use strict";const y=Symbol();e.ManipulatedObject3DMediaElement=class extends r.EventedAccessor{get operations(){return this._controller?.operations}get elevationInfo(){return{mode:"on-the-ground",offset:0}}get _layerView(){const e=this.view.allLayerViews.find(e=>e.layer===this.layer);return"media-3d"===e?.type?e:null}get visible(){return m.isMediaElementVisibleLayerView(this._layerView,this.element)}get isDraped(){return!0}get origin(){return null}get updating(){return!!this._controller?.updating}get _controllerClass(){return"transform"===this.tool||"control-points"!==this.element.georeference?.type?p.MediaElementControllerShape:c.MediaElementControllerControlPoints}constructor(e){super(e),this.tool="transform"}initialize(){this.addHandles([l.watch(()=>this._controllerClass,e=>this._updateController(e),l.syncAndInitial),l.on(()=>this._layerView,"element-render-changed",({element:e})=>{this.element===e&&this.emit("committed")})])}toMap(e){const{layer:t,element:r}=this;return this.view.toMap(e,{include:{layer:t,element:r}})}createManipulator(e){const{view:t,layer:r,element:o}=this;return new u.MediaElementManipulator3D({view:t,layer:r,element:o,...e})}_updateController(e){if(this._controller&&this._controller instanceof e)return;this.removeHandles(y);const{view:t,layer:r,element:l}=this,n=()=>{this.emit("modified-externally")};this._controller=new e({view:t,layer:r,element:l,onModifiedExternally:n}),n(),this.addHandles(o.destroyHandle(this._controller),y)}},t.__decorate([n.property({constructOnly:!0})],e.ManipulatedObject3DMediaElement.prototype,"view",void 0),t.__decorate([n.property({constructOnly:!0})],e.ManipulatedObject3DMediaElement.prototype,"layer",void 0),t.__decorate([n.property({constructOnly:!0})],e.ManipulatedObject3DMediaElement.prototype,"element",void 0),t.__decorate([n.property()],e.ManipulatedObject3DMediaElement.prototype,"tool",void 0),t.__decorate([n.property()],e.ManipulatedObject3DMediaElement.prototype,"_controller",void 0),t.__decorate([n.property()],e.ManipulatedObject3DMediaElement.prototype,"elevationInfo",null),t.__decorate([n.property()],e.ManipulatedObject3DMediaElement.prototype,"_layerView",null),t.__decorate([n.property()],e.ManipulatedObject3DMediaElement.prototype,"visible",null),t.__decorate([n.property()],e.ManipulatedObject3DMediaElement.prototype,"updating",null),t.__decorate([n.property()],e.ManipulatedObject3DMediaElement.prototype,"_controllerClass",null),e.ManipulatedObject3DMediaElement=t.__decorate([s.subclass("esri.views.3d.interactive.editingTools.ManipulatedObject3DMediaElement")],e.ManipulatedObject3DMediaElement),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});