// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../chunks/tslib.es6","../../../../../../core/Accessor","../../../../../../core/arrayUtils","../../../../../../core/reactiveUtils","../../../../../../core/accessorSupport/decorators/property","../../../../../../core/has","../../../../../../core/Logger","../../../../../../core/accessorSupport/decorators/subclass","../../../../../../layers/support/TileKey","../../../../../interactive/snapping/featureSources/featureServiceSource/tileUtils"],function(e,t,r,i,s,o,l,n,c,a,u){"use strict";function p({lij:[e,t,r],extent:i}){return new a.TileKey(`${e}/${t}/${r}`,e,t,r,i)}e.FeatureServiceTiles3D=class extends r{get _sortedTilesCoveringView(){const e=(this.view.featureTiles?.tiles?.toArray()??[]).map(p),t=this._effectivePointOfInterest;return null!=t&&e.sort((e,r)=>u.distanceToTile(t,e)-u.distanceToTile(t,r)),e}get tileInfo(){return this.view.featureTiles?.tilingScheme?.toTileInfo()??null}get tileSize(){return this.view.featureTiles?.tileSize??256}get _effectivePointOfInterest(){const e=this.pointOfInterest;return null!=e?e:this.view.pointsOfInterest?.focus.location}constructor(e){super(e),this.tiles=[],this.pointOfInterest=null}initialize(){this.addHandles([this.view.enableFeatureTiles(),s.watch(()=>this._sortedTilesCoveringView,e=>this._set("tiles",e),{initial:!0,equals:(e,t)=>i.equals(e,t,(e,t)=>e.id===t.id)})])}},t.__decorate([o.property({readOnly:!0})],e.FeatureServiceTiles3D.prototype,"tiles",void 0),t.__decorate([o.property({readOnly:!0})],e.FeatureServiceTiles3D.prototype,"_sortedTilesCoveringView",null),t.__decorate([o.property({readOnly:!0})],e.FeatureServiceTiles3D.prototype,"tileInfo",null),t.__decorate([o.property({readOnly:!0})],e.FeatureServiceTiles3D.prototype,"tileSize",null),t.__decorate([o.property({constructOnly:!0})],e.FeatureServiceTiles3D.prototype,"view",void 0),t.__decorate([o.property()],e.FeatureServiceTiles3D.prototype,"pointOfInterest",void 0),t.__decorate([o.property()],e.FeatureServiceTiles3D.prototype,"_effectivePointOfInterest",null),e.FeatureServiceTiles3D=t.__decorate([c.subclass("esri.views.3d.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles3D")],e.FeatureServiceTiles3D),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});