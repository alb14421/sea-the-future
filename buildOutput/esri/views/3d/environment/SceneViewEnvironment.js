// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../chunks/tslib.es6","../../../core/compilerUtils","../../../core/handleUtils","../../../core/lang","../../../core/accessorSupport/decorators/property","../../../core/accessorSupport/decorators/cast","../../../core/accessorSupport/decorators/subclass","../../../core/accessorSupport/ensureType","./lightingUtils","./SunLighting","./VirtualLighting","../../../webscene/Environment","../../../webscene/SunLighting","../../../webscene/VirtualLighting"],function(t,e,i,n,r,s,g,h,o,l,c,a,u,p){"use strict";var b;let d=class extends a{static{b=this}constructor(t){super(t),this.lighting=this.castLighting(),this._computeWeatherAvailable=void 0,this.cachedCameraTrackingEnabled=null}static fromWebsceneEnvironment(t){const e=t.cloneConstructProperties();return new b({...e,lighting:e.lighting?"virtual"===e.lighting.type?c.fromWebsceneLighting(e.lighting):l.fromWebsceneLighting(e.lighting):void 0})}get weatherAvailable(){return this._computeWeatherAvailable?.()??!1}setComputeWeatherAvailable(t){this._computeWeatherAvailable=t}castLighting(t){return this._convertLightingWithDestroy(t)}applyLighting(t){this.lighting=this._convertLightingWithDestroy(t)}_convertLightingWithDestroy(t){const e=this._convertLighting(t);return e!==t&&this.addHandles(i.destroyHandle(e)),e}_convertLighting(t){return t?t instanceof l||t instanceof c?t:t instanceof u?this.lighting&&"virtual"!==this.lighting.type?this.lighting.cloneWithWebsceneLighting(t):new l({...t.cloneConstructProperties(),...this.lighting?.cloneNonPersistentConstructProperties()}):t instanceof p?this.lighting&&"virtual"===this.lighting.type?this.lighting.cloneWithWebsceneLighting(t):new c({...t.cloneConstructProperties(),...this.lighting?.cloneNonPersistentConstructProperties()}):h.ensureOneOfType(o.lightingTypes,t):new l}clone(){return new b({lighting:this.lighting.clone(),weather:this.weather.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:n.clone(this.background)})}cloneWithWebsceneEnvironment(t){return new b({weather:this.weather.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:n.clone(this.background),...t.cloneConstructProperties(),lighting:this._getLighting(t)})}_getLighting(t){switch(t.lighting.type){case"sun":return this.lighting&&"sun"===this.lighting.type?this.lighting.cloneWithWebsceneLighting(t.lighting):l.fromWebsceneLighting(t.lighting);case"virtual":return this.lighting&&"virtual"===this.lighting.type?this.lighting.cloneWithWebsceneLighting(t.lighting):c.fromWebsceneLighting(t.lighting);default:return e.neverReached(t.lighting),l.fromWebsceneLighting(t.lighting)}}};return t.__decorate([r.property({nonNullable:!0})],d.prototype,"lighting",void 0),t.__decorate([r.property()],d.prototype,"_computeWeatherAvailable",void 0),t.__decorate([r.property({readOnly:!0})],d.prototype,"weatherAvailable",null),t.__decorate([s.cast("lighting")],d.prototype,"castLighting",null),d=b=t.__decorate([g.subclass("esri.views.3d.environment.SceneViewEnvironment")],d),d});