// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/tslib.es6","../../../../core/mathUtils","../../../../core/accessorSupport/decorators/property","../../../../core/has","../../../../core/Logger","../../../../core/RandomLCG","../../../../core/accessorSupport/decorators/subclass","../../../../core/libs/gl-matrix-2/math/mat4","../../../../core/libs/gl-matrix-2/factories/mat4f64","../../../../core/libs/gl-matrix-2/factories/vec4f64","../../webgl/RenderCamera","./Util"],function(e,t,r,s,a,o,i,n,c,l,h,p,g){"use strict";e.ViewshedFaceCamera=class extends p{constructor(){super(...arguments),this.sectionAngles=h.create()}get sectionAnglesDeg(){return h.fromArray(this.sectionAngles.map(e=>r.rad2deg(e)))}set sectionAnglesDeg(e){this.sectionAngles=h.fromArray(e.map(e=>r.deg2rad(e)))}get projectionMatrix(){return c.mul(l.create(),this.sectionMatrix,this._projectionMatrixInternal)}get sectionMatrix(){const e=this.sectionAngles[0],t=this.sectionAngles[1],r=this.sectionAngles[2],s=this.sectionAngles[3];g.assert(e<=t),g.assert(r<=s);const a=2*Math.tan(this.fovX/2),o=2*Math.tan(this.fovY/2),i=Math.tan(e),n=Math.tan(t),h=Math.tan(r),p=n-i,d=Math.tan(s)-h,m=a/p,u=o/d,M=-(i+p/2)/a*2,_=-(h+d/2)/o*2,y=l.create();c.fromTranslation(y,[M,_,0]);const A=l.create();c.fromScaling(A,[m,u,1]);const f=l.create();return c.mul(f,A,y)}get _sectionRatioX(){const e=Math.tan(this.sectionAngles[0]),t=Math.tan(this.sectionAngles[1]),r=2*Math.tan(this.fovX/2);return Math.min(1,(t-e)/r)}setViewport(e,t){const r=t*this._sectionRatioX;return this.viewport=[e[0],e[1],r,t],r}},t.__decorate([s.property()],e.ViewshedFaceCamera.prototype,"sectionAngles",void 0),t.__decorate([s.property()],e.ViewshedFaceCamera.prototype,"sectionAnglesDeg",null),t.__decorate([s.property()],e.ViewshedFaceCamera.prototype,"projectionMatrix",null),t.__decorate([s.property()],e.ViewshedFaceCamera.prototype,"sectionMatrix",null),t.__decorate([s.property()],e.ViewshedFaceCamera.prototype,"_sectionRatioX",null),e.ViewshedFaceCamera=t.__decorate([n.subclass("esri.views.3d.webgl-engine.lib.ViewshedFaceCamera")],e.ViewshedFaceCamera),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});