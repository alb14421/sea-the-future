// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/maybe","../../../../core/promiseUtils","./GLMaterial","../../../webgl/NoParameters"],function(e,t,s,r,i){"use strict";class u extends i.NoParameters{constructor(e=null){super(),this.textureEmissive=e}}class l extends u{constructor(e,t,s,r,i,u,l){super(s),this.texture=e,this.textureNormal=t,this.textureOcclusion=r,this.textureMetallicRoughness=i,this.scale=u,this.normalTextureTransformMatrix=l}}e.GLEmissiveTexturePassParameters=u,e.GLTextureMaterial=class extends r{constructor(e){super(e),this._numLoading=0,this._disposed=!1,this._textures=e.textures,this.updateTexture(e.textureId),this._acquire(e.normalTextureId,e=>this._textureNormal=e),this._acquire(e.emissiveTextureId,e=>this._textureEmissive=e),this._acquire(e.occlusionTextureId,e=>this._textureOcclusion=e),this._acquire(e.metallicRoughnessTextureId,e=>this._textureMetallicRoughness=e)}dispose(){super.dispose(),this._texture=t.releaseMaybe(this._texture),this._textureNormal=t.releaseMaybe(this._textureNormal),this._textureEmissive=t.releaseMaybe(this._textureEmissive),this._textureOcclusion=t.releaseMaybe(this._textureOcclusion),this._textureMetallicRoughness=t.releaseMaybe(this._textureMetallicRoughness),this._disposed=!0}ensureResources(e){return 0===this._numLoading?2:1}get textureBindParameters(){return new l(this._texture?.glTexture??null,this._textureNormal?.glTexture??null,this._textureEmissive?.glTexture??null,this._textureOcclusion?.glTexture??null,this._textureMetallicRoughness?.glTexture??null)}updateTexture(e){null!=this._texture&&e===this._texture.id||(this._texture=t.releaseMaybe(this._texture),this._acquire(e,e=>this._texture=e))}_acquire(e,r){if(null==e)return void r(null);const i=this._textures.acquire(e);if(s.isPromiseLike(i))return++this._numLoading,void i.then(e=>{if(this._disposed)return t.releaseMaybe(e),void r(null);r(e)}).finally(()=>--this._numLoading);r(i)}},e.GLTextureMaterialBindParameters=l,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});