// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../Color","../../../../core/fontUtils","../../../../core/Logger","../../../../core/screenUtils","../../../../core/libs/gl-matrix-2/factories/vec4f64"],function(o,e,t,i,n,r){"use strict";class l{constructor(o){this.definition=o,this.key=JSON.stringify(o),this.haloSize=Math.round(o.halo.size),this.textStyle=a(o.color),this.haloStyle=`rgb(${o.halo.color.slice(0,3).map(o=>Math.floor(255*o)).toString()})`,this.backgroundStyle=0!==o.background.color[3]?a(o.background.color):null}fontString(o){const e=this.definition.font;return`${e.style} ${e.weight} ${o}px ${e.family}, sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji`}setFontProperties(o,e){o.font=this.fontString(e),o.textAlign="left",o.textBaseline="alphabetic"}static async fromSymbol(o,a){const c=o?.material?.color,f=e.toUnitRGBA(c)??r.ZEROS,g=null!=o.size?n.pt2px(o.size):12,u=o.lineHeight,d=null!=o.background?e.toUnitRGBA(o.background.color):r.ZEROS,m={family:o.font?.family??"sans-serif",decoration:o.font?.decoration??"none",weight:o.font?.weight??"normal",style:o.font?.style??"normal"},h=o.halo,y=null!=h?.color&&h.size>0?{size:n.pt2px(h.size),color:e.toUnitRGBA(h.color)}:{size:0,color:r.ZEROS},b=new l({color:f,size:g,background:{color:d,padding:null!=o.background?[.65*g,.5*g]:[0,0],borderRadius:null!=o.background?g*(6/16):0},lineSpacingFactor:u,font:m,halo:y,pixelRatio:a});if(o.font){let e=!1;const n=b.fontString(g);try{e=(await document.fonts.load(n)).some(o=>!t.isCachedFontFace(o))}catch(o){i.getLogger("esri.views.3d.webgl-engine.lib.TextRenderParameters").warnOnce(`Failed to preload font '${n}'. Some text symbology may be rendered using the default browser font.`)}if(!e&&!s.has(o.font.family))try{await t.loadFont(o.font)}catch(o){}}return b}}function a(o){return`rgba(${o.slice(0,3).map(o=>Math.floor(255*o)).toString()},${o[3]})`}const s=new Set(["Arial","Times New Roman","Courier New","serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]);o.TextRenderParameters=l,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});