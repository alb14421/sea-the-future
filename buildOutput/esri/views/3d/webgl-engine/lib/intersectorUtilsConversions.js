// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/libs/gl-matrix-2/math/mat4","../../../../core/libs/gl-matrix-2/factories/vec3f64","../../../../geometry/support/aaBoundingBox","../../../../chunks/sphere","../../layers/i3s/Intersector","../../terrain/Intersector","./HUDIntersectorResult","./ObjectIntersectorResult","./lodRendering/Intersector"],function(e,t,r,n,s,i,l,c,u,a){"use strict";function o(e,t,r={}){if(null==e)return null;if(u.isObjectIntersectorResult(e)||c.isHUDIntersectorResult(e))return g(e.target?.object,t,r);if(i.isPclIntersectorResult(e)){const t=e.target.createGraphic();return{type:"graphic",graphic:t,layer:t.layer}}if(i.isVoxelIntersectorResult(e)){const t=e.target.createVoxelGraphic();return{type:"graphic",graphic:t,layer:t.layer}}if(i.isTiles3DIntersectorResult(e)){const t=e.target.createTiles3DGraphic();return{type:"graphic",graphic:t,layer:t.layer}}return l.isOverlayIntersectorResult(e)||a.isLodIntersectorResult(e)?g(e.target,t,r):i.isI3sIntersectorResult(e)?function(e,t,r){const n=p(e,t);if(null==n)return null;const s=t.allLayerViews.find(e=>e.layer===n);if(!s||s.suspended||!("getGraphicFromIntersectorTarget"in s))return null;const i=r.defer;return d(s.getGraphicFromIntersectorTarget(e,{defer:i?e=>i(async()=>d(await e())):void 0}))}(e.target,t,r):null}function g(e,t,r){if(null==e?.graphicUid)return null;const n=p(e,t);if(null==n)return null;if(n===t.graphics)return null==t.graphicsView||"number"!=typeof e.graphicUid?null:t.graphicsView.getHit(e.graphicUid,r);const s=t.allLayerViews.find(e=>e.layer===n);return!s||s.suspended||null==e.graphicUid?null:"getHit"in s?s.getHit(e.graphicUid,r):null}function d(e){return null!=e?{type:"graphic",graphic:e,layer:e.layer}:null}function p(e,t){return null==e?.layerViewUid?null:null!=t.graphicsView&&e.layerViewUid===t.graphicsView.uid?t.graphics:t.allLayerViews.find(t=>t.uid===e.layerViewUid)?.layer}const f=r.create();e.getIntersectedFeatureBSRadius=function(e,r){if(u.isObjectIntersectorResult(e)||c.isHUDIntersectorResult(e))return s.getRadius(e.target.object.boundingVolumeWorldSpace.bounds);if(a.isLodIntersectorResult(e)){t.getScale(f,e.transformation);const r=Math.max(f[0],f[1],f[2]);return e.target.baseBoundingSphere.radius*r}if(i.isI3sIntersectorResult(e)){const t=function(e,t){const r=p(e,t);if(null==r)return null;const n=t.allLayerViews.find(e=>e.layer===r);return n&&!n.suspended&&"getAABBFromIntersectorTarget"in n?n.getAABBFromIntersectorTarget(e):null}(e.target,r);return t?.5*n.diameter(t):null}return null},e.hasLod=function(e){return!u.isObjectIntersectorResult(e)&&!c.isHUDIntersectorResult(e)&&(a.isLodIntersectorResult(e)?e.target.numLodLevels>1:!!i.isI3sIntersectorResult(e))},e.toGraphic=function(e,t){const r=o(e,t);return"graphic"===r?.type?r.graphic:null},e.toHit=o,e.toOwner=function(e,t){return u.isObjectIntersectorResult(e)||c.isHUDIntersectorResult(e)?p(e.target?.object,t):l.isTerrainIntersectorResult(e)?t.map?.ground:i.isPclIntersectorResult(e)||i.isI3sIntersectorResult(e)||l.isOverlayIntersectorResult(e)||i.isVoxelIntersectorResult(e)?p(e.target,t):null},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});