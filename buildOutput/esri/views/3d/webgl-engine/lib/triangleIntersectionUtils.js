// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/vec32","../../../../core/libs/gl-matrix-2/factories/vec3f64"],function(t,n,e){"use strict";function r(t,e,r){const o=n.dot(t,e)-r;return Math.abs(o)<=1e-5}function o(t,r,o){const a=e.create(),c=e.create();n.sub(c,r,t);const i=e.create();return n.sub(i,o,t),n.cross(a,c,i),n.normalize(a,a),a}function a(t,a,c,i){const s=[a,c,i],u=o(a,c,i);if(!r(t,u,n.dot(s[0],u)))return!1;for(let t=0;t<3;++t){const r=s[t],o=s[(t+1)%3],a=s[(t+2)%3],c=e.create();n.sub(c,o,r),n.normalize(c,c);const i=e.create();n.sub(i,a,r);const u=n.dot(i,c),l=e.create();n.scaleAndAdd(l,r,c,u);const d=e.create();n.sub(d,a,l),n.normalize(d,d);const f=n.dot(r,d);if(!(n.dot(d,l)-f>=-1e-4))return!1}return!0}function c(t){const r=e.create();n.sub(r,t[1],t[0]),n.normalize(r,r);const o=e.create();n.sub(o,t[2],t[0]),n.normalize(o,o);const a=e.create();return n.cross(a,r,o),n.normalize(a,a),a}function i(t,r,o){const a=e.create();n.sub(a,o,r),n.normalize(a,a);const c=e.create();n.sub(c,t,r);const i=n.dot(c,a),s=e.create();return n.scaleAndAdd(s,r,a,i),s}function s(t,r,o){const a=e.create();n.sub(a,o,r);const c=n.len(a);n.normalize(a,a);const i=e.create();n.sub(i,t,r);const s=n.dot(i,a);if(s<0)return n.dist(r,t);if(s>c)return n.dist(o,t);const u=e.create();return n.scaleAndAdd(u,r,a,s),n.dist(u,t)}function u(t,e,r){return n.dot(t,e)-r}function l(t,r,o){const a=e.create(),c=e.create();n.sub(c,r,t);const i=e.create();return n.sub(i,o,t),n.cross(a,c,i),n.normalize(a,a),{normal:a,d:n.dot(a,t)}}function d(t,r,o,c){const{normal:i,d}=l(r,o,c),f=u(t,i,d),m=e.create();return n.scaleAndAdd(m,t,i,-f),a(m,r,o,c)?f:Math.min(s(t,r,o),s(t,o,c),s(t,c,r))}function f(t){return t<128?Uint8Array:t<32768?Uint16Array:t<1<<31?Uint32Array:Array}t.binarySearchSortedArray=function(t,n){const e=t.length;if(0===e)return 0;if(n<t[0])return-1;if(n>=t[e-1])return e;let r=0,o=e-1;for(;o-r>1;){const e=Math.floor(.5*(o+r));n>=t[e]?r=e:o=e}return r},t.calculateNormalFromVertices=c,t.createUintArray=function(t,n){return new(f(t))(n)},t.distancePointLine=function(t,e,r){const o=i(t,e,r);return n.dist(o,t)},t.distancePointPlane=u,t.distancePointSegment=s,t.distancePointTriangle=d,t.elevationAlignVertexGlobal=function(t,n,e,r){const[o,a,c]=r??t,i=c-e,s=n/Math.sqrt(o*o+a*a+i*i);t[0]+=o*s,t[1]+=a*s,t[2]+=i*s},t.elevationAlignVertexLocal=function(t,n){t[2]+=n},t.generateTriangleAabbsGlobal=function(t,n,e,r,o,a,c){const i=a-c,s=n-t,u=new Float64Array(4*s);for(let n=0;n<s;++n){const a=3*(n+t),s=o*e[a+0],l=r[s+0],d=r[s+1],f=i/(r[s+2]-c),m=l*f,b=d*f,A=o*e[a+1],g=r[A+0],h=r[A+1],M=i/(r[A+2]-c),y=g*M,P=h*M,z=o*e[a+2],x=r[z+0],T=r[z+1],v=i/(r[z+2]-c),S=x*v,F=T*v,L=4*n;u[L+0]=Math.min(m,y,S),u[L+1]=Math.min(b,P,F),u[L+2]=Math.max(m,y,S),u[L+3]=Math.max(b,P,F)}return u},t.generateTriangleAabbsLocal=function(t,n,e,r,o){const a=n-t,c=new Float64Array(4*a);for(let n=0;n<a;++n){const a=3*(n+t),i=o*e[a+0],s=r[i+0],u=r[i+1],l=o*e[a+1],d=r[l+0],f=r[l+1],m=o*e[a+2],b=r[m+0],A=r[m+1],g=4*n;c[g+0]=Math.min(s,d,b),c[g+1]=Math.min(u,f,A),c[g+2]=Math.max(s,d,b),c[g+3]=Math.max(u,f,A)}return c},t.getConstructorForValueCount=f,t.getNearestPointOnLine=i,t.getRayTriangleIntersectionDistance=function(t,r,o){const i=e.create();n.sub(i,r,t);const s=c(o),u=n.dot(s,o[0]),l=n.dot(s,t)-u,f=n.dot(s,r)-u;if(l*f>0)return 1/0;const m=e.create(),b=(0-l)/(f-l);return n.scaleAndAdd(m,t,i,b),a(m,o[0],o[1],o[2])?0:d(m,o[0],o[1],o[2])},t.getTriangleNormal=o,t.getTrianglePlane=l,t.isPointInPlane=r,t.isPointInTriangle=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});