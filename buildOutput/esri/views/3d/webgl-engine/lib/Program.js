// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/has","../../../webgl/checkWebGLError"],function(t,e,r){"use strict";t.Program=class{constructor(t,e,i){this._context=t,this.locations=i,this._textures=new Map,this.source=r.webglDebugEnabled()?e:null,e.attributeNames.forEach(t=>{i.has(t)||console.error(`Missing VertexAttributeLocation for ${t} used in shader`)}),this._glProgram=t.programCache.acquire(e.generate("vertex",!0),e.generate("fragment",!0),i),this._glProgram.stop=()=>{throw new Error("Wrapped _glProgram used directly")},this.bind=e.generateBind(this),this.bindPass=e.generateBindPass(this),this.bindDraw=e.generateBindDraw(this)}dispose(){this._glProgram.dispose()}get glName(){return this._glProgram.glName}get hasTransformFeedbackVaryings(){return this._glProgram.hasTransformFeedbackVaryings}get compiled(){return this._glProgram.compiled}setUniform1b(t,e){this._glProgram.setUniform1i(t,e?1:0)}setUniform1i(t,e){this._glProgram.setUniform1i(t,e)}setUniform1f(t,e,r){this._glProgram.setUniform1f(t,e,r)}setUniform2fv(t,e,r){this._glProgram.setUniform2fv(t,e,r)}setUniform3fv(t,e,r){this._glProgram.setUniform3fv(t,e,r)}setUniform4fv(t,e,r){this._glProgram.setUniform4fv(t,e,r)}setUniformMatrix3fv(t,e,r){this._glProgram.setUniformMatrix3fv(t,e,!1,r)}setUniformMatrix4fv(t,e,r){this._glProgram.setUniformMatrix4fv(t,e,!1,r)}setUniform1fv(t,e,r){this._glProgram.setUniform1fv(t,e,r)}setUniform1iv(t,e){this._glProgram.setUniform1iv(t,e)}setUniform2iv(t,e){this._glProgram.setUniform2iv(t,e)}setUniform3iv(t,e){this._glProgram.setUniform3iv(t,e)}setUniform4iv(t,e){this._glProgram.setUniform4iv(t,e)}assertCompatibleVertexAttributeLocations(t,e){let r=t.locations;if(e){const t=new Map(r);e.forEach((e,i)=>t.set(i,r.size+e)),r=t}r.size!==this.locations.size&&console.error(`VertexAttributeLocations are incompatible: ${r}, ${this.locations}`),this.locations.forEach((t,e)=>{r.get(e)!==t&&console.error(`VertexAttributeLocations are incompatible: Program has ${e} at position ${t}, VAO has it at position ${r.get(e)}.`)})}stop(){this._textures.clear()}bindTexture(t,e){e?.glName||(r.webglDebugEnabled()&&console.error(`Texture sampler ${t} has no given Texture in ${(new Error).stack} `),e=this._context.emptyTexture);const i=this._ensureTextureUnit(t,e);this._context.useProgram(this),this.setUniform1i(t,i.unit),this._context.bindTexture(e,i.unit)}_ensureTextureUnit(t,e){let r=this._textures.get(t);return null==r?(r={texture:e,unit:this._textures.size},this._textures.set(t,r)):r.texture=e,r}},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});