// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/mathUtils","../../../../chunks/vec32","../../../../core/libs/gl-matrix-2/factories/vec3f64","../../../../geometry/support/FloatArray","../../../../geometry/support/ShortArray"],function(t,r,e,o,n,a){"use strict";function s(t,r,e,o,n,a=2){const s=1/(Math.abs(e)+Math.abs(o)+Math.abs(n)),c=e*s,u=o*s,m=n<=0?(c>=0?1:-1)*(1-Math.abs(u)):c,f=n<=0?(u>=0?1:-1)*(1-Math.abs(c)):u,h=r*a;t[h]=l(m),t[h+1]=l(f)}function c(t,r,o,n=2){const a=o*n,s=u(r[a]),c=u(r[a+1]),l=1-Math.abs(s)-Math.abs(c);return t[2]=l,l<0?(t[0]=(s>=0?1:-1)*(1-Math.abs(c)),t[1]=(c>=0?1:-1)*(1-Math.abs(s))):(t[0]=s,t[1]=c),e.normalize(t,t)}function l(t){return r.clamp(Math.round(32767*t),-32767,32767)}function u(t){return r.clamp(t/32767,-1,1)}t.compressAndTransformNormals=function(t,r){const n=t.length/3,a=new Int16Array(2*n);let c=0;const l=o.create();for(let o=0;o<n;++o)l[0]=t[c++],l[1]=t[c++],l[2]=t[c++],e.transformMat3(l,l,r),s(a,o,l[0],l[1],l[2]);return a},t.compressNormal=s,t.compressNormals=function(t){const r=t.length/3,e=a.newShortArray(2*r);let o=0;for(let n=0;n<r;++n)s(e,n,t[o++],t[o++],t[o++]);return e},t.decodeInt16=u,t.decompressNormal=c,t.decompressNormals=function(t,r=2){const e=t.length/r,a=n.newFloatArray(3*e),s=o.create();let l=0;for(let o=0;o<e;++o)c(s,t,o,r),a[l++]=s[0],a[l++]=s[1],a[l++]=s[2];return a},t.encodeInt16=l,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});