// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/libs/gl-matrix-2/math/vec2","../../../../core/libs/gl-matrix-2/factories/vec2f64","../lib/GLMaterial","../lib/Material","./internal/bufferWriterUtils","../shaders/HeatmapDensityTechnique","../shaders/HeatmapDensityTechniqueConfiguration"],function(t,e,i,s,r,a,n,o){"use strict";class u extends n.HeatmapDensityPassParameters{constructor(){super(...arguments),this.isAttributeDriven=!1,this.usesHalfFloats=!1}}class l extends r.Material{constructor(t){super(t,u),this.produces=new Map([[18,t=>0===t]]),this._configuration=new o.HeatmapDensityTechniqueConfiguration}getConfiguration(t,e){return super.getConfiguration(t,e,this._configuration),this._configuration.isAttributeDriven=this.parameters.isAttributeDriven,this._configuration.usesHalfFloat=this.parameters.usesHalfFloats,this._configuration}get visible(){return!0}createGLMaterial(t){return new c(t)}intersect(){}intersectDraped(t,i,s,r,a){const n=t.attributes.get("position"),{parameters:o}=this,{searchRadius:u}=o,{screenToWorldRatio:l}=t,c=u*l+2*l,f=c*c,g=n.data.length/n.size;for(let t=0;t<g;t++){const i=t*n.size,o=e.set(h,n.data[i],n.data[i+1]);e.squaredDistance(o,s)<f&&r(a.distance,a.normal,-1)}}createBufferWriter(){return new f(this.parameters.isAttributeDriven?n.attributeDrivenLayout:n.layout)}}class c extends s{beginSlot(t){return this.getTechnique(n.HeatmapDensityTechnique,t)}}class f{constructor(t){this.layout=t}elementCount(t){return t.get("position").indices.length*g}write(t,e,i,s,r,n){a.writePosition(i.get("position"),t,r.position,n,g);const o=i.get("position").indices.length,u=r.uv0;let l=n;for(let t=0;t<o;++t)u.setValues(l++,-1,-1),u.setValues(l++,1,-1),u.setValues(l++,1,1),u.setValues(l++,1,1),u.setValues(l++,-1,1),u.setValues(l++,-1,-1);const c="featureAttribute"in r?r.featureAttribute:null;return c&&a.writeBufferFloat(i.get("featureAttribute"),c,n,g),null}}const g=6,h=i.create();t.HeatmapDensityMaterial=l,t.Parameters=u,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});