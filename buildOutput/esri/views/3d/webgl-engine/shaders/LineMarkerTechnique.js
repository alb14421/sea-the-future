// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../../support/buffer/InterleavedLayout","../core/shaderLibrary/ShaderOutput","../core/shaderTechnique/ReloadableShaderModule","../core/shaderTechnique/ShaderTechnique","../lib/OrderIndependentTransparency","../lib/StencilUtils","../../../../chunks/LineMarker.glsl","../../../webgl/renderState"],function(e,t,i,l,r,n,a,s,o,u){"use strict";class c extends n.ShaderTechnique{constructor(t,i){super(t,i,new r.ReloadableShaderModule(o.LineMarker,()=>new Promise((t,i)=>e(["./LineMarker.glsl"],t,i))),p(i).locations)}_makePipelineState(e,t){const{output:i,oitPass:r,space:o,hasOccludees:c}=e;return u.makePipelineState({blending:l.isColorOrColorEmission(i)?a.blending(r):null,depthTest:0===o?null:{func:a.oitDepthTest(r)},depthWrite:a.depthWrite(e),drawBuffers:n.depthOnlyOutputBuffersOr(i,a.getDrawBuffers(r,i)),colorWrite:u.defaultColorWrite,stencilWrite:c?s.stencilWriteMaskOn:null,stencilTest:c?t?s.stencilToolMaskBaseParams:s.stencilBaseAllZerosParams:null,polygonOffset:{factor:0,units:-10}})}initializePipeline(e){return e.occluder?(this._occluderPipelineTransparent=u.makePipelineState({blending:u.unpremultipliedAlphaToPremultipliedAlpha,depthTest:s.depthCompareAlways,depthWrite:null,colorWrite:u.defaultColorWrite,stencilWrite:null,stencilTest:s.stencilToolTransparentOccluderParams}),this._occluderPipelineOpaque=u.makePipelineState({blending:u.unpremultipliedAlphaToPremultipliedAlpha,depthTest:s.depthCompareAlways,depthWrite:null,colorWrite:u.defaultColorWrite,stencilWrite:s.stencilWriteMaskOff,stencilTest:s.stencilToolMaskOccluderParams}),this._occluderPipelineMaskWrite=u.makePipelineState({blending:null,depthTest:s.depthCompareLess,depthWrite:null,colorWrite:null,stencilWrite:s.stencilWriteMaskOn,stencilTest:s.stencilToolMaskBaseParams})):this._occluderPipelineTransparent=this._occluderPipelineOpaque=this._occluderPipelineMaskWrite=null,this._occludeePipelineState=this._makePipelineState(e,!0),this._makePipelineState(e,!1)}getPipeline(e,t){return e?this._occludeePipelineState:11===t?this._occluderPipelineTransparent??super.getPipeline():10===t?this._occluderPipelineOpaque??super.getPipeline():this._occluderPipelineMaskWrite??super.getPipeline()}}function p(e){const t=i.newLayout().vec3f("position").vec4f16("previousDelta").vec2f16("uv0");return e.hasVVColor?t.f32("colorFeatureAttribute"):t.vec4u8("color",{glNormalized:!0}),e.hasVVOpacity&&t.f32("opacityFeatureAttribute"),e.hasVVSize?t.f32("sizeFeatureAttribute"):t.f16("size"),e.worldSpace&&t.vec3f16("normal"),t.freeze()}t.LineMarkerTechnique=c,t.getLayout=p,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});