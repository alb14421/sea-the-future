// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../chunks/tslib.es6","../../../core/Accessor","../../../core/has","../../../core/maybe","../../../core/accessorSupport/decorators/property","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../../support/getDefaultUnitForView","./AnalysisView3D","./AreaMeasurement/support/AreaMeasurementController","./AreaMeasurement/support/AreaMeasurementPathHelper","./AreaMeasurement/support/AreaMeasurementVisualization","./AreaMeasurement/support/utils","../interactive/measurementTools/areaMeasurement3D/AreaMeasurement3DTool","../../analysis/analysisViewUtils","../../support/geodesicAreaMeasurementUtils","../../support/geodesicLengthMeasurementUtils"],function(e,t,r,a,s,i,o,n,l,p,u,d,y,c,h,m,_,g){"use strict";let v=class extends(p.AnalysisView3D(t)){constructor(e){super(e),this.type="area-measurement-view-3d",this.analysis=null,this.measurementData=null,this.lastDraggedVertex=null,this.stagedPoint=null,this.mode=0,this.tool=null,this.userOperation=null}initialize(){const{analysis:e,view:t}=this;this.path=new d.AreaMeasurement3DPathHelper({view:t,areaMeasurement:e}),this._analysisVisualization=new y.AreaMeasurementVisualization({view:t,analysis:e,analysisViewData:this}),this.addResolvingPromise(Promise.all([_.loadGeodesicAreaMeasurementUtils(),g.loadGeodesicLengthMeasurementUtils()]).then(([r,a])=>{this.destroyed||(this._analysisController=new u.AreaMeasurementController({view:t,analysis:e,analysisViewData:this,geodesicAreaMeasurementUtils:r,geodesicLengthMeasurementUtils:a}))})),this.addHandles(m.connectAnalysisViewToTool(this,h))}destroy(){m.removeAnalysisViewTool(this),this.userOperation=a.abortMaybe(this.userOperation),this._analysisController=a.destroyMaybe(this._analysisController),this._analysisVisualization=a.destroyMaybe(this._analysisVisualization),this.path.destroy()}get visible(){return super.visible}set visible(e){super.visible=e}get interactive(){return super.interactive}set interactive(e){super.interactive=e}get updating(){return!!this._analysisVisualization?.loadingMessages}get result(){const{measurementData:e}=this;if(null==e)return{area:null,mode:null,perimeter:null};const{unit:t}=this;if("euclidean"===e.actualMeasurementMode){const{area:r,perimeterLength:a}=e;return{area:null!=r?c.toPreferredAreaUnit(r,t):null,perimeter:null!=a?c.toPreferredLengthUnit(a,t):null,mode:"euclidean"}}const{geodesicArea:r,pathLength:a}=e;return{area:null!=r?c.toPreferredAreaUnit(r,t):null,perimeter:null!=a?c.toPreferredLengthUnit(a,t):null,mode:"geodesic"}}get viewData(){return this._analysisVisualization.viewData}get areaLabel(){return this._analysisVisualization.areaLabel}get perimeterLengthLabel(){return this._analysisVisualization.perimeterLengthLabel}get validMeasurement(){return this.path.isValidPolygon}get unit(){return this.analysis.unit??l.getDefaultUnitForView(this.view)}get testData(){}place(e){return m.startPlaceOperation(this,{placementOptions:e})}};return e.__decorate([s.property()],v.prototype,"_analysisVisualization",void 0),e.__decorate([s.property()],v.prototype,"_analysisController",void 0),e.__decorate([s.property({readOnly:!0})],v.prototype,"type",void 0),e.__decorate([s.property({constructOnly:!0,nonNullable:!0})],v.prototype,"analysis",void 0),e.__decorate([s.property()],v.prototype,"updating",null),e.__decorate([s.property()],v.prototype,"result",null),e.__decorate([s.property()],v.prototype,"measurementData",void 0),e.__decorate([s.property()],v.prototype,"viewData",null),e.__decorate([s.property()],v.prototype,"areaLabel",null),e.__decorate([s.property()],v.prototype,"perimeterLengthLabel",null),e.__decorate([s.property()],v.prototype,"validMeasurement",null),e.__decorate([s.property()],v.prototype,"path",void 0),e.__decorate([s.property()],v.prototype,"lastDraggedVertex",void 0),e.__decorate([s.property()],v.prototype,"stagedPoint",void 0),e.__decorate([s.property()],v.prototype,"mode",void 0),e.__decorate([s.property()],v.prototype,"unit",null),e.__decorate([s.property()],v.prototype,"tool",void 0),e.__decorate([s.property()],v.prototype,"userOperation",void 0),v=e.__decorate([n.subclass("esri.views.3d.analysis.AreaMeasurementAnalysisView3D")],v),v});