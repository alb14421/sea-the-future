// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/tslib.es6","../../../../core/Accessor","../../../../core/handleUtils","../../../../core/Logger","../../../../core/mapCollectionUtils","../../../../core/reactiveUtils","../../../../core/unitUtils","../../../../core/accessorSupport/decorators/property","../../../../core/has","../../../../core/RandomLCG","../../../../core/accessorSupport/decorators/subclass","../../../../support/getDefaultUnitForView","./lengthDimensionUtils","../../../support/geodesicMeasurementUtils"],function(e,t,o,i,n,r,s,a,l,c,p,d,u,m,y){"use strict";e.DimensionController=class extends o{constructor(e){super(e)}initialize(){const e=r.mapCollection(()=>this.analysisViewData.computations,({computation:e})=>this._watchComputation(e));this.addHandles(i.destroyHandle(e))}get analysis(){return this.analysisViewData.analysis}get _defaultUnit(){return u.getDefaultUnitForView(this.view)}_watchComputation(e){return s.watch(()=>m.computationToGeometryDependencies(e),t=>{const{measureType:o}=t;if(m.isGeodesicDimension(t)&&"direct"!==o){const t=Math.round(a.convertUnit(y.geodesicDistanceThreshold,"meters","kilometers"));return n.getLogger(this).warnOnce(`A ${o} dimension in the analysis (id: '${this.analysis.id}') will not display, because only direct dimensions can measure lengths greater than ${t} km. Update the measureType of the affected dimension to "direct" to display it.`),void(e.geometry=null)}const i=m.computeGeometryFromDimension(t,this.view.renderCoordsHelper,e.geometry);e.geometry=i,e.result.length=m.computeLength(i,o,this._defaultUnit,this.automaticLengthMeasurementUtils)},s.syncAndInitial)}},t.__decorate([l.property({constructOnly:!0})],e.DimensionController.prototype,"analysisViewData",void 0),t.__decorate([l.property({constructOnly:!0})],e.DimensionController.prototype,"view",void 0),t.__decorate([l.property({constructOnly:!0})],e.DimensionController.prototype,"automaticLengthMeasurementUtils",void 0),t.__decorate([l.property()],e.DimensionController.prototype,"analysis",null),t.__decorate([l.property()],e.DimensionController.prototype,"_defaultUnit",null),e.DimensionController=t.__decorate([d.subclass("esri.views.3d.analysis.Dimension.DimensionController")],e.DimensionController),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});