// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../geometry/projection/projectBuffer","../../../../geometry/support/DoubleArray","../../../../geometry/support/triangulationUtils","../../layers/graphics/elevationAlignmentUtils","../../terrain/OverlayRenderer"],function(o,n,e,t,i,s){"use strict";function r(o,n,t=null){return o.filter(({count:o})=>o>1).map(({index:o,count:i})=>{const s=3*o,r=3*i;return null!=t?new p(o,i,e.doubleSubArray(n,s,r),e.doubleSubArray(t,s,r)):new u(o,i,e.doubleSubArray(n,s,r))})}function l(o,n,t=null){const i=new Array;for(const{index:s,count:r,holeIndices:l,pathLengths:u}of o){if(r<=1)continue;const o=3*s,p=3*r,g=l.map(o=>o-s),h=null!=t?new a(s,r,e.doubleSubArray(n,3*s,3*r),e.doubleSubArray(t,o,p),g,u):new c(s,r,e.doubleSubArray(n,3*s,3*r),g,u);i.push(h)}return i}class u{constructor(o,n,e){this.index=o,this.count=n,this.position=e}}class p extends u{constructor(o,n,e,t){super(o,n,e),this.mapPositions=t}}class a extends p{constructor(o,n,e,t,i,s){super(o,n,e,t),this.holeIndices=i,this.pathLengths=s}}class c extends u{constructor(o,n,e,t,i){super(o,n,e),this.holeIndices=t,this.pathLengths=i}}class g{constructor(o,n,e,t,i,s){this.position=o,this.mapPositions=n,this.polygons=e,this.outlines=t,this.projectionSuccess=i,this.sampledElevation=s}}o.PolygonRenderInfo=g,o.PolygonVertexData=a,o.PolygonVertexDataDraped=c,o.geometryToRenderInfo=function(o,n,s,u){const p=t.ringsToTriangulationInfo(o.rings,!!o.hasZ&&"on-the-ground"!==u.mode,1,o.spatialReference),a=e.newDoubleArray(p.position.length),c=i.applyPerVertexElevationAlignment(p.position,o.spatialReference,0,a,0,p.position,0,p.position.length/3,n,s,u),h=null!=c;return new g(p.position,a,l(p.polygons,p.position,a),r(p.outlines,p.position,a),h,c)},o.geometryToRenderInfoDraped=function(o,e){const i=t.ringsToTriangulationInfo(o.rings,!1,1),u=n.projectBuffer(i.position,o.spatialReference,0,i.position,e,0);for(let o=2;o<i.position.length;o+=3)i.position[o]=s.drapedZ;return{position:i.position,polygons:l(i.polygons,i.position),outlines:r(i.outlines,i.position),projectionSuccess:u}},Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});