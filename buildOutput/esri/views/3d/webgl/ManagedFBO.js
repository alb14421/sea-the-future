// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../core/MapUtils","../../../core/maybe","../webgl","./ManagedDepthTexture","./ManagedFBOResource","../../webgl/enums"],function(t,e,h,r,s,o){"use strict";class a extends s.ManagedFBOResource{constructor(t,e,r,s,o,a){super(t,a),this.fbo=r,this.type=0,this._colors=new Map,this._name=h.RenderCategory.COMPOSITE,this.acquireColor=null,this.acquireDepth=null,this._name=e,this.acquireColor=s,this.acquireDepth=o}dispose(){this.fbo?.dispose()}get cachedMemory(){return this.fbo?.usedMemory||0}get numberOfColorAttachments(){return this._colors.size}get name(){return this._name}setName(t){this._name=t}getTexture(t=o.ColorAttachment0){return t===o.DepthStencilAttachment?this.fbo?.depthStencilTexture:this.fbo?.getColorTexture(t)}get depthTexture(){return this.getTexture(o.DepthStencilAttachment)}getAttachment(t=o.ColorAttachment0){return t===o.DepthStencilAttachment?this._depth:this._colors.get(t)}hasAttachment(e){return t.someMap(this._colors,t=>t.name===e)}attachDepth(t){return t?.retain(),this.detachDepth(),t&&this.fbo?.attachDepthStencil(t.attachment),this._depth=t,this}detachDepth(){this.fbo?.detachDepthStencilTexture(),this.fbo?.detachDepthStencilBuffer(),this._depth=e.releaseMaybe(this._depth)}obtainDepthTexture(){const t=this._depth;return r.isManagedDepthTexture(t)?(this.fbo?.detachDepthStencilTexture(),this._depth=null,t):null}attachColor(t,e){return t.retain(),this.detachColor(e),this.fbo?.attachColorTexture(t.attachment,e),this._colors.set(e,t),this}detachColor(t){this.fbo?.detachColorTexture(t);const e=this._colors.get(t);this._colors.delete(t),e?.release()}detachAllColors(){this._colors.forEach((t,e)=>this.detachColor(e))}detachAll(){this.detachAllColors(),this.detachDepth()}detachAllColorsBut0(){this._colors.forEach((t,e)=>{e!==o.ColorAttachment0&&this.detachColor(e)})}detachAllButColor0(){this.detachAllColorsBut0(),this.detachDepth()}}return a});