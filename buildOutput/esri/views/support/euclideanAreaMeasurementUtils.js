// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../core/quantityUtils","../../core/unitUtils","../../chunks/earcut","../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64","../../geometry/projection/projectVectorToVector","../../geometry/support/plane","../../geometry/support/triangle","./measurementUtils"],function(e,t,r,n,o,c,a,i,l,s){"use strict";function u(e,n,u=e.hasZ){const g=s.computeEuclideanMeasurementSR(e.spatialReference),m=r.areaUnitFromSpatialReference(g);if(null==m)return null;const h=(e,t)=>!(t.length<2||(o.set(e,t[0],t[1],u&&t[2]||0),0));let A=0;for(const t of e.rings){const r=t.length;if(r<3)continue;const{positionsWorldCoords:s}=n;for(;s.length<r;)s.push(c.create());const u=f,m=o.set(p,0,0,0),P=1/r;for(let n=0;n<r;n++){if(!h(u,t[n]))return null;if(!a.projectVectorToVector(u,e.spatialReference,s[n],g))return null;o.scaleAndAdd(m,m,s[n],P)}const y=i.fromPoints(s[0],s[1],m,i.wrap());if(0===o.squaredLength(i.getNormal(y)))continue;for(let e=0;e<r;e++)i.projectPointLocal(y,m,s[e],s[e]);const j=d(s);for(let e=0;e<j.length;e+=3)A+=l.areaPoints2d(s[j[e]],s[j[e+1]],s[j[e+2]])}return t.createArea(A,m)}const f=c.create(),p=c.create();function d(e){return n.earcut(function(e){const t=new Float64Array(2*e.length);for(let r=0;r<e.length;++r){const n=e[r],o=2*r;t[o]=n[0],t[o+1]=n[1]}return t}(e),[],2)}e.computeEuclideanPlanarArea=u,e.createEuclideanPlanarAreaCache=function(){return{positionsWorldCoords:[]}},e.euclideanHorizontalPlanarArea=function(e,t={positionsWorldCoords:[]}){return u(e,t,!1)},e.euclideanPlanarArea=function(e,t={positionsWorldCoords:[]}){return u(e,t)},e.triangulate=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});