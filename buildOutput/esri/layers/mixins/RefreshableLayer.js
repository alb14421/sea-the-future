// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../chunks/tslib.es6","../../core/has","../../core/Logger","../../core/promiseUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/layerContainerType","./refresh"],function(e,r,t,s,a,o,n,h,i,c,p){"use strict";e.RefreshableLayer=e=>{const t=e;let h=class extends t{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=a.debounce(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||p.registerLayer(this)},()=>{})}destroy(){p.unregisterLayer(this)}castRefreshInterval(e){return e>=.1?e:e<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){a.ignoreAbortErrors(this._debounceHasDataChanged()).then(r=>{r&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:r})},e=>{s.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})})}async hasDataChanged(){return!0}get test(){}};return r.__decorate([o.property({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:c.excludeTables}}}}})],h.prototype,"refreshInterval",void 0),r.__decorate([n.cast("refreshInterval")],h.prototype,"castRefreshInterval",null),r.__decorate([o.property({readOnly:!0})],h.prototype,"refreshTimestamp",void 0),r.__decorate([o.property({readOnly:!0})],h.prototype,"refreshParameters",null),h=r.__decorate([i.subclass("esri.layers.mixins.RefreshableLayer")],h),h},e.isRefreshableLayer=function(e){return null!=e&&"object"==typeof e&&"refreshTimestamp"in e&&"refresh"in e},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});