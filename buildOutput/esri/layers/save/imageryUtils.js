// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","./utils","../support/rasterDatasets/datasetUtils","../../portal/support/portalItemUtils"],function(e,t,r,a){"use strict";const s="Image Service";function i(e){if("imagery"===e.type||"wcs"===e.type)return{isValid:!0};const{raster:t}=e,a=r.getPrimaryRasters(t)[0];return{isValid:"RasterTileServer"===a?.datasetFormat&&("Raster"===a.tileType||"Map"===a.tileType),errorMessage:"imagery tile layer should be created from a tiled image service."}}function y(e){const t=e.layerJSON;return Promise.resolve(t&&Object.keys(t).length?t:null)}async function l(e,t){const{parsedUrl:r,title:s,fullExtent:i}=e;t.url=r.path,t.title||=s;try{t.extent=await a.getWGS84ExtentForItem(i)}catch{t.extent=void 0}a.removeTypeKeyword(t,a.typeKeyword.METADATA),a.toggleTypeKeyword(t,a.typeKeyword.TILED_IMAGERY,"imagery-tile"===e.type)}e.save=async function(e,r){const a="imagery"===e.type?"imagery-layer-save":"imagery-tile"===e.type?"imagery-tile-layer-save":"wcs-layer-save",l={layer:e,itemType:"wcs"===e.type?"WCS":s,validateLayer:i,createItemData:y,errorNamePrefix:a};return t.save(l,r)},e.saveAs=async function(e,r,a){const o="imagery"===e.type?"imagery-layer-save-as":"imagery-tile"===e.type?"imagery-tile-layer-save-as":"wcs-layer-save-as",n={layer:e,itemType:"wcs"===e.type?"WCS":s,validateLayer:i,createItemData:y,errorNamePrefix:o,newItem:r,setItemProperties:l};return t.saveAs(n,a)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});