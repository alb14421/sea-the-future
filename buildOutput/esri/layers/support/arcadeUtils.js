// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports"],function(e){"use strict";function n(e,n){const r=[];if(!e)return r;if("valueExpression"in e&&e.valueExpression){const t={expression:e.valueExpression,title:e.valueExpressionTitle,profileInfo:{name:"visualization",context:`${e.type}-renderer`,source:n}};r.push(t)}if("visualVariables"in e&&e.visualVariables){const t=e.visualVariables.filter(({valueExpression:e})=>e&&"$view.scale"!==e).map(({valueExpression:e,valueExpressionTitle:r,type:t})=>({expression:e,title:r,profileInfo:{name:"visualization",context:`${t}-variable`,source:n}}));r.push(...t)}if("attributes"in e&&e.attributes){const t=e?.attributes.filter(({valueExpression:e})=>e).map(({valueExpression:r,valueExpressionTitle:t})=>({expression:r,title:t,profileInfo:{name:"visualization",context:`${e.type}-renderer`,source:n}}));r.push(...t)}return r}function r(e,n){const r=[];if(e?.expressionInfos){const t=e?.expressionInfos.map(({title:e,name:r,expression:t,returnType:o})=>({title:e,name:r,expression:t,profileInfo:{name:"layer"===n?"popup":"popup-feature-reduction",context:"popup-template",returnType:o,source:n}}));r.push(...t)}if(e?.content&&Array.isArray(e.content)){const t=e?.content.filter(({type:e})=>"expression"===e).map(({expressionInfo:e})=>({title:e.title,expression:e.expression,profileInfo:{name:"layer"===n?"popup-element":"popup-element-feature-reduction",context:"popup-expression-content",returnType:e.returnType,source:n}}));r.push(...t)}return r}function t(e){const n=[];if(e){const r=e.filter(({onStatisticExpression:e,isAutoGenerated:n})=>e&&!n).map(({onStatisticExpression:{expression:e,title:n}})=>({expression:e,title:n,profileInfo:{name:"aggregate-field",context:"aggregate-field",source:"feature-reduction"}}));n.push(...r)}return n}function o(e,n){const r=[];if(e){const t=e.filter(({labelExpressionInfo:e})=>e?.expression).map(({labelExpressionInfo:e})=>({expression:e?.expression,title:e?.title,profileInfo:{name:"labeling",context:"label-class",source:n}}));r.push(...t)}return r}e.getExpressionsFromLayer=function(e){const s=[...o(e.labelingInfo,"layer"),...r(e.popupTemplate,"layer"),...n(e.renderer,"layer")];var i;if("elevationInfo"in e&&s.push(...function(e){const n=[];if(e?.featureExpressionInfo?.expression){const r={expression:e?.featureExpressionInfo?.expression,profileInfo:{name:"feature-z",context:"elevation-info",source:"layer"}};n.push(r)}return n}(e.elevationInfo)),"featureReduction"in e&&s.push(...(i=e.featureReduction,[...r(i?.popupTemplate,"feature-reduction"),...o(i?.labelingInfo,"feature-reduction"),...n(i?.renderer,"feature-reduction"),...t(i?.fields)])),"trackInfo"in e){const t=e.trackInfo;s.push(...n(t?.latestObservations.renderer),...n(t?.previousObservations.renderer),...n(t?.trackLines.renderer),...o(t?.latestObservations.labelingInfo),...o(t?.previousObservations.labelingInfo),...o(t?.trackLines.labelingInfo),...r(t?.popupTemplate))}return"orderBy"in e&&s.push(...function(e){const n=[];if(e){const r=e.filter(({valueExpression:e})=>e).map(({valueExpression:e})=>({expression:e,profileInfo:{name:"feature-z",context:"order-by",source:"layer"}}));n.push(...r)}return n}(e.orderBy)),"formTemplate"in e&&s.push(...function(e){const n=[];if(e?.expressionInfos){const r=e?.expressionInfos.map(({title:e,name:n,expression:r,returnType:t})=>({title:e,name:n,expression:r,profileInfo:{name:"boolean"===t?"form-constraint":"form-calculation",context:"form-template",returnType:t,source:"layer"}}));n.push(...r)}return n}(e.formTemplate)),s},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});