// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../core/mathUtils","../../core/sql"],function(e,t,n){"use strict";function*r(e,t,n){if("manual"===l(e)){const t=e.filters.find(t=>t.id===e.activeFilterId);t&&(yield t)}else{"object"==typeof t&&(t=t.scale);for(const r of e.filters)a(r.minScale,r.maxScale,t,n)&&(yield r)}}function a(e,n,r,a){return e=o(e),r=o(r),n=i(n),!(!t.floatEqualAbsolute(r,e)&&(a??r)>e||t.floatGreaterThanOrEqual(n,r)||void 0!==a&&t.floatEqualAbsolute(a,e))}function l(e){return"mode"in e?e.mode:e.filterMode}function o(e){return e||Number.POSITIVE_INFINITY}function i(e){return e||0}e.createDisplayFilterJSONContext=function(e,t){return{...t,filterMode:e.mode}},e.getClauseForScaleRange=function(e,a,u){const f=function(e){if("manual"===l(e))return null;const t=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:n,maxScale:r}of e.filters)t[0]=Math.max(t[0],o(n)),t[1]=Math.min(t[1],i(r));return t}(e);if(f&&(t.floatGreaterThan(a,f[0])||t.floatLessThan(u,f[1])))return"";const c=Array.from(r(e,a,u)),s=function(e,n,r){if(0===e.length)return!0;const a=o(e.at(0)?.minScale),l=i(e.at(-1)?.maxScale);if(t.floatLessThan(a,n)||t.floatGreaterThan(l,r))return!0;for(let n=0;n<e.length-1;n++){const r=e[n],a=e[n+1];if(t.floatLessThan(o(a.minScale),i(r.maxScale)))return!0}return!1}(c,a,u)?"1=1":c.map(e=>e.where||"1=1").reduce((e,t)=>n.sqlOr(e,t),"");return s&&"1=1"!==s?s:""},e.getEffectiveDisplayFilter=function(e,t){return r(e,t).next().value??null},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});