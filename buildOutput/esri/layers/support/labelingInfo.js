// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../core/Error","../../core/Logger","./LabelClass"],function(e,o,r,t){"use strict";const n=()=>r.getLogger("esri.layers.support.labelingInfo"),l=/\[([^[\]]+)\]/gi,i=["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],a={esriGeometryPoint:i,esriGeometryMultiPatch:["always-horizontal"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:i,esriGeometryEnvelope:null};e.reader=function(e,o,r){return e?e.map(e=>{const n=new t;if(n.read(e,r),n.labelExpression){const e=o.fields||o.layerDefinition?.fields||this.fields;n.labelExpression=n.labelExpression.replaceAll(l,(o,r)=>`[${function(e,o){if(!o)return e;const r=e.toLowerCase();for(let e=0;e<o.length;e++){const t=o[e].name;if(t.toLowerCase()===r)return t}return e}(r,e)}]`)}return n}):null},e.validateLabelingInfo=function(e,r){const t=[];for(const l of e){const e=l.labelPlacement,i=a[r];if(!l.symbol)return n().warn("No ILabelClass symbol specified."),[];if(!i)return n().error(new o("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${r}' is not supported`)),[];if(i.includes(e))t.push(l);else{const o=i[0];e&&n().warn(`Found invalid label placement type ${e} for ${r}. Defaulting to ${o}`);const a=l.clone();a.labelPlacement=o,t.push(a)}}return t},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});