// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","./layerUtils","../../support/requestPresets"],function(e,r,t){"use strict";const a=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);function n(e){const{type:r}=e;return!!r&&a.has(r)}function c(e){return"Table"===e.type}function s(e){e.layers=e.layers?.filter(n),e.tables=e.tables?.filter(c)}function i(e){e.type||="Feature Layer"}function o(e){e.type||="Table"}function y(e){e.layers?.forEach(i),e.tables?.forEach(o)}e.fetchFeatureService=async function(e,a){const{loadContext:n,...c}=a||{},i=n?await n.fetchServiceMetadata(e,c):await t.fetchArcGISServiceJSON(e,c),o=r.getPreferredHost();y(i),s(i);const u={serviceJSON:i,preferredHost:o};if((i.currentVersion??0)<10.5)return u;const l=`${r.getPreferredUrl()??e}/layers`,f=n?await n.fetchServiceMetadata(l,c):await t.fetchArcGISServiceJSON(l,c);return y(f),s(f),u.layersJSON={layers:f.layers,tables:f.tables},u},e.getLayerModuleType=function(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});