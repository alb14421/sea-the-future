// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../core/urlUtils","../../chunks/persistableUrlUtils"],function(e,r,t){"use strict";const s={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},l=Object.values(s),n=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${l.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),i=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${l.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),a=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function u(e){if(null==e)return null;const t=r.urlToObject(e),l=t?.path.match(n)||t?.path.match(i);if(!l)return null;const[,a,u,o,v]=l,d=u.indexOf("/");return{title:c(-1!==d?u.slice(d+1):u),serverType:s[o.toLowerCase()],sublayer:null!=v&&""!==v?parseInt(v,10):null,url:{path:a}}}function o(e){const t=r.urlToObject(e).path.match(a);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function c(e){return(e=e.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}e.cleanTitle=c,e.isArcGISUrl=function(e){return n.test(e)},e.isHostedAgolService=function(e){let t=r.getOrigin(e,!0);return!!t&&(t=t.toLowerCase(),t.endsWith(".arcgis.com")&&(t.startsWith("services")||t.startsWith("tiles")||t.startsWith("features")||/^[a-z\d-]+\.svcs[a-z\d-]*\./.test(t)))},e.isServerOrServicesAGOLUrl=function(e){if(!e)return!1;const t=new r.Url(r.makeAbsolute(e)),s=t.authority?.toLowerCase();return"server.arcgisonline.com"===s||"services.arcgisonline.com"===s},e.isWmsServer=function(e){if(!e)return!1;const r=e.toLowerCase(),t=r.includes("/services/"),s=r.includes("/mapserver/wmsserver"),l=r.includes("/imageserver/wmsserver"),n=r.includes("/wmsserver");return t&&(s||l||n)},e.parse=u,e.parseNonStandardSublayerUrl=o,e.sanitizeUrl=function(e,t){return e?r.removeTrailingSlash(r.removeQueryParameters(e,t)):e},e.sanitizeUrlWithLayerId=function(e){let{url:t}=e;if(!t)return{url:t};t=r.removeQueryParameters(t,e.logger);const s=r.urlToObject(t),l=u(s.path);let n;if(null!=l)null!=l.sublayer&&null==e.layer.layerId&&(n=l.sublayer),t=l.url.path;else if(e.nonStandardUrlAllowed){const e=o(s.path);null!=e&&(t=e.serviceUrl,n=e.sublayerId)}return{url:r.removeTrailingSlash(t),layerId:n}},e.serverTypes=l,e.titleFromUrlAndName=function(e,r){const t=[];if(e){const r=u(e);null!=r&&r.title&&t.push(r.title)}if(r){const e=c(r);t.push(e)}if(2===t.length){if(t[0].toLowerCase().includes(t[1].toLowerCase()))return t[0];if(t[1].toLowerCase().includes(t[0].toLowerCase()))return t[1]}return t.join(" - ")},e.writeUrlWithLayerId=function(e,s,l,n,i){t.write(s,n,"url",i),n.url&&null!=e.layerId&&(n.url=r.join(n.url,l,e.layerId.toString()))},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});