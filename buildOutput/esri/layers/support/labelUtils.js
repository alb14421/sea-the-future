// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../core/string"],function(e,n){"use strict";const r="__begin__",t="__end__",s=new RegExp(r,"ig"),l=new RegExp(t,"ig"),i=new RegExp("^"+r,"i"),o=new RegExp(t+"$","i");function a(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function p(e){const n={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(n.expression=e.labelExpressionInfo.value,n.type="conventional"):e.labelExpressionInfo.expression&&(n.expression=e.labelExpressionInfo.expression,n.type="arcade"):null!=e.labelExpression&&(n.expression=a(e.labelExpression),n.type="conventional"),n}function c(e){let a;return e?(a=n.replace(e,e=>r+'$feature["'+e+'"]'+t),a=i.test(a)?a.replace(i,""):'"'+a,a=o.test(a)?a.replace(o,""):a+'"',a=a.replaceAll(s,'" + ').replaceAll(l,' + "')):a='""',a}const u=/^\s*\{([^}]+)\}\s*$/i;function x(e){const n=e?.match(u);return n?.[1].trim()||null}const g=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,f=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,E=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function d(e){if(!e)return null;let n=g.exec(e)||f.exec(e);return n?n[1]||n[3]:(n=E.exec(e),n?n[2]:null)}e.convertTemplatedStringToArcade=c,e.getLabelExpression=p,e.getLabelExpressionArcade=function(e){const n=p(e);if(!n)return null;switch(n.type){case"conventional":return c(n.expression);case"arcade":return n.expression}return null},e.getLabelExpressionSingleField=function(e){const n=p(e);if(!n)return null;switch(n.type){case"conventional":return x(n.expression);case"arcade":return d(n.expression)}return null},e.getSingleFieldArcadeExpression=d,e.getSingleFieldTemplatedString=x,e.sqlToTemplateString=a,e.templateStringToSql=function(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});