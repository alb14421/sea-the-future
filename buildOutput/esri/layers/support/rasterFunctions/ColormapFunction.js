// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../chunks/tslib.es6","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../rasterFormats/pixelRangeUtils","./BaseRasterFunction","./ColormapFunctionArguments","./colormaps","../../../renderers/support/colorRampUtils","../../../rest/support/colorRamps"],function(o,e,r,t,s,p,n,c,a,i,u,l){"use strict";let m=class extends c{constructor(){super(...arguments),this.functionName="Colormap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const o=this.sourceRasterInfos[0];if(o.bandCount>1)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let{colormap:e,colormapName:r,colorRamp:t,colorRampName:s}=this.functionArguments;if(!e?.length)if(t)this.colorRamp=t,e=u.convertColorRampToColormap(t,{interpolateAlpha:!0});else if(s){const o=u.getColorRampJSON(s);o&&(e=u.convertColorRampToColormap(o),this.colorRamp=l.fromJSON(o))}else r&&(e=i.getColormapByName(r));if(!e?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};const p=this._getOutputPixelType(o.pixelType);this.outputPixelType=p.startsWith("f")?"s32":p;const n=o.clone();return n.pixelType=this.outputPixelType,n.colormap=e,n.bandCount=1,this.rasterInfo=n,{success:!0,supportsGPU:!0}}_processPixels(o){let e=o.pixelBlocks?.[0];return!e||n.isIntegerPixelType(e.pixelType)||(e=e.clone(),e.clamp(this.outputPixelType)),e}};return o.__decorate([e.property({json:{write:!0,name:"rasterFunction"}})],m.prototype,"functionName",void 0),o.__decorate([e.property({type:a,json:{write:!0,name:"rasterFunctionArguments"}})],m.prototype,"functionArguments",void 0),o.__decorate([e.property()],m.prototype,"rasterArgumentNames",void 0),o.__decorate([e.property()],m.prototype,"isNoopProcess",void 0),o.__decorate([e.property({json:{write:!0}})],m.prototype,"indexedColormap",void 0),o.__decorate([e.property()],m.prototype,"colorRamp",void 0),m=o.__decorate([p.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],m),m});