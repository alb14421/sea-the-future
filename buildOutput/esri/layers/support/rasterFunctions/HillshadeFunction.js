// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../../chunks/tslib.es6","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../rasterFormats/pixelRangeUtils","./BaseRasterFunction","./HillshadeFunctionArguments","./surfaceUtils"],function(e,t,s,r,i,o,n,a,c,u){"use strict";let p=class extends a{constructor(){super(...arguments),this.functionName="Hillshade",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){const e=this.sourceRasterInfos[0];if(e.bandCount>1)return{success:!1,supportsGPU:!1,error:"hillshade-function: source data must be single band"};this.outputPixelType=this._getOutputPixelType("u8");const t=e.clone();return this._removeStatsHistColormapVAT(t),t.pixelType=this.outputPixelType,t.bandCount=1,t.statistics=[{min:0,max:255,avg:60,stddev:10}],this.rasterInfo=t,this.isGCS=t.spatialReference?.isGeographic??!1,{success:!0,supportsGPU:!0}}_processPixels(e){const t=e.pixelBlocks?.[0];if(!t)return null;const{extent:s,primaryPixelSizes:r}=e,i=r?.[0],o=i??(s?{x:s.width/t.width,y:s.height/t.height}:{x:1,y:1}),n=u.getHillshadeOptions(this.functionArguments,o,this.isGCS),a=u.hillshade(t,n);return a.pixelType=this.outputPixelType,a}_getWebGLParameters(){const e=u.getHillshadeOptions(this.functionArguments,{x:1,y:1},this.isGCS),t=u.calculateHillshadeParams(e),{slopeType:s,zFactor:r,pixelSizeFactor:i,pixelSizePower:o}=this.functionArguments,a="scaled"===s,c=n.isIntegerPixelType(this.outputPixelType);return{...t,zFactor:r,gcsFactor:this.isGCS?u.gcsFactor:1,pixelSizeFactor:a?i:0,pixelSizePower:a?o:0,isOutputRounded:c}}};return e.__decorate([t.property({json:{write:!0,name:"rasterFunction"}})],p.prototype,"functionName",void 0),e.__decorate([t.property({type:c,json:{write:!0,name:"rasterFunctionArguments"}})],p.prototype,"functionArguments",void 0),e.__decorate([t.property()],p.prototype,"rasterArgumentNames",void 0),e.__decorate([t.property({json:{write:!0}})],p.prototype,"isGCS",void 0),p=e.__decorate([o.subclass("esri.layers.support.rasterFunctions.HillshadeFunction")],p),p});