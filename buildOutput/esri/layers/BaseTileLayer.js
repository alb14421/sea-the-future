// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../chunks/tslib.es6","../request","../core/Error","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../geometry/Extent","../geometry/SpatialReference","../geometry/support/aaBoundingRect","./Layer","./mixins/BlendLayer","./mixins/RefreshableLayer","./mixins/ScaleRangeLayer","./support/imageBitmapUtils","./support/TileInfo","./support/TileKey"],function(e,t,r,a,o,s,i,l,n,p,c,d,u,y,f,h,g,m,T){"use strict";var b;const v=new T.TileKey("0/0/0",0,0,0,void 0);return e.default=b=class extends(y.BlendLayer(h.ScaleRangeLayer(f.RefreshableLayer(u)))){constructor(){super(...arguments),this.tileInfo=m.create({spatialReference:c.WebMercator,size:256}),this.type="base-tile",this.fullExtent=new p(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,c.WebMercator),this.spatialReference=c.WebMercator}addResolvingPromise(e){super.addResolvingPromise(e)}getTileBounds(e,t,r,a){const o=a||d.create();return v.level=e,v.row=t,v.col=r,v.extent=o,this.tileInfo.updateTileInfo(v),v.extent=void 0,o}fetchTile(e,t,a,o={}){const{signal:s}=o,i=this.getTileUrl(e,t,a),l={responseType:"image",signal:s,query:{...this.refreshParameters}};return r(i??"",l).then(e=>e.data)}async fetchImageBitmapTile(e,t,a,o={}){const{signal:s}=o;if(this.fetchTile!==b.prototype.fetchTile){const r=await this.fetchTile(e,t,a,o);return g.createTileBitmap(r,e,t,a,s)}const i=this.getTileUrl(e,t,a)??"",l={responseType:"blob",signal:s,query:{...this.refreshParameters}},{data:n}=await r(i,l);return g.createTileBitmap(n,e,t,a,s)}getTileUrl(){throw new a("basetilelayer:gettileurl-not-implemented","getTileUrl() is not implemented")}},t.__decorate([o.property({type:m})],e.default.prototype,"tileInfo",void 0),t.__decorate([o.property({type:["show","hide"]})],e.default.prototype,"listMode",void 0),t.__decorate([o.property({readOnly:!0,value:"base-tile"})],e.default.prototype,"type",void 0),t.__decorate([o.property({nonNullable:!0})],e.default.prototype,"fullExtent",void 0),t.__decorate([o.property()],e.default.prototype,"spatialReference",void 0),e.default=b=t.__decorate([n.subclass("esri.layers.BaseTileLayer")],e.default),e.default});