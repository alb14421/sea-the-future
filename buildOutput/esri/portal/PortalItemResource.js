// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../chunks/tslib.es6","../core/Accessor","../core/Error","../core/Logger","../core/urlUtils","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/has","../core/RandomLCG","../core/accessorSupport/decorators/subclass"],function(t,e,r,o,s,a,l,p,u,c,i,n){"use strict";function h(t,e){return null==t?t:(t=t.replace(/^\/+/,""),null!=e&&l.isAbsolute(t)&&(t=l.makeRelative(t,e.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}return e.default=class extends o{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t?.portalItem&&t.path?{...t,path:h(t.path,t.portalItem)}:t}set path(t){null!=t&&l.isAbsolute(t)?a.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}_castPath(t){return h(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(t="json",e){const r=this.cdnUrl;if(null==r)throw new s("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(r,{responseType:t,query:{token:this.portalItem.apiKey,_ts:e?.cacheBust?Date.now():null},signal:e?.signal})}async update(e,r){const{addOrUpdateResources:o}=await new Promise((e,r)=>t(["./support/resourceUtils"],e,r));return await o(this.portalItem,[{resource:this,content:e,compress:r?.compress,access:r?.access}],"update",r),this}hasPath(){return null!=this.path}},r.__decorate([p.property()],e.default.prototype,"portalItem",void 0),r.__decorate([p.property({type:String,value:null})],e.default.prototype,"path",null),r.__decorate([u.cast("path")],e.default.prototype,"_castPath",null),r.__decorate([p.property({type:String,readOnly:!0})],e.default.prototype,"url",null),r.__decorate([p.property({type:String,readOnly:!0})],e.default.prototype,"cdnUrl",null),r.__decorate([p.property({type:String,readOnly:!0})],e.default.prototype,"itemRelativeUrl",null),e.default=r.__decorate([n.subclass("esri.portal.PortalItemResource")],e.default),e.default});