// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","./arcadeEnvironment","./executionError","../core/has","../core/Logger","../core/SetUtils"],function(e,t,r,o,n,a){"use strict";const c=()=>n.getLogger("esri.arcade.compilerUtils");function l(e,r,o){switch(e.type){case"VariableDeclaration":for(const o of e.declarations)r.add(t.toSymbolId(o.id));return;case"BlockStatement":for(const t of e.body)l(t,r,o);return;case"ExportNamedDeclaration":{const t=new Set;l(e.declaration,t,o);for(const e of t)r.add(e),o.add(e);return}case"ForInStatement":case"ForOfStatement":return"VariableDeclaration"===e.left.type&&l(e.left,r,o),void l(e.body,r,o);case"ForStatement":return"VariableDeclaration"===e.init?.type&&l(e.init,r,o),void l(e.body,r,o);case"FunctionDeclaration":return void r.add(t.toSymbolId(e.id));case"IfStatement":return l(e.consequent,r,o),void(e.alternate&&l(e.alternate,r,o));case"ImportDeclaration":for(const o of e.specifiers)r.add(t.toSymbolId(o.local));return;case"WhileStatement":return void l(e.body,r,o);case"BreakStatement":case"ContinueStatement":case"EmptyStatement":case"ExpressionStatement":case"ReturnStatement":return}}e.collectDeclaredGlobalNames=function(e){const t=new Set,o=new Set;for(const r of e.body)l(r,t,o);if(!a.isSubsetOf(o,t))throw c().error(`Internal error: exported undeclared symbols {${Array.from(a.difference(o,t)).join(", ")}}`),new r.ArcadeCompilationError(null,"NeverReach",null);return{globals:t,exports:o}},e.collectDeclaredLocalNames=function(e){const t=new Set,o=new Set;if(l(e.body,t,o),o.size>0)throw c().error(`Internal error: cannot export locals {${Array.from(o.values()).join(", ")}}`),new r.ArcadeCompilationError(null,"NeverReach",null);return t},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});