// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","./Dictionary","./executionError","./ImmutablePathArray","./ImmutablePointArray","../chunks/languageUtils","../core/Accessor","../support/guards"],function(e,a,t,r,n,s,i,c){"use strict";const l={point:["hasZ","hasM","spatialReference","type","x","y","z","m"],multipoint:["hasZ","hasM","spatialReference","type","points"],polyline:["hasZ","hasM","spatialReference","type","paths"],polygon:["hasZ","hasM","spatialReference","type","rings"],extent:["hasZ","hasM","spatialReference","type","xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]};let o=0;function u(e,s,c,l,u=1){let h;switch(s=s.toLowerCase()){case"hasz":{const a=e.hasZ;return void 0!==a&&a}case"hasm":{const a=e.hasM;return void 0!==a&&a}case"spatialreference":{let t=e.spatialReference._arcadeCacheId;if(void 0===t){let a=!0;i.isFrozen(e.spatialReference)&&(a=!1),a&&(o++,e.spatialReference._arcadeCacheId=o,t=o)}const r=new a({__proto__:null,wkt:e.spatialReference.wkt,wkid:e.spatialReference.wkid});return void 0!==t&&(r._arcadeCacheId="SPREF"+t.toString()),r}}switch(e.type){case"extent":switch(s){case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":case"mmin":case"mmax":{const a=e[s];return void 0!==a?a:null}case"type":return"Extent"}break;case"polygon":switch(s){case"rings":return h=e.cache._arcadeCacheId,void 0===h&&(o++,h=o,e.cache._arcadeCacheId=h),new r(e.rings,e.spatialReference,!0===e.hasZ,!0===e.hasM,h);case"type":return"Polygon"}break;case"point":switch(s){case"x":case"y":case"z":case"m":return e[s]??null;case"type":return"Point"}break;case"polyline":switch(s){case"paths":return h=e.cache._arcadeCacheId,void 0===h&&(o++,h=o,e.cache._arcadeCacheId=h),new r(e.paths,e.spatialReference,!0===e.hasZ,!0===e.hasM,h);case"type":return"Polyline"}break;case"multipoint":switch(s){case"points":return h=e.cache._arcadeCacheId,void 0===h&&(o++,h=o,e.cache._arcadeCacheId=h),new n(e.points,e.spatialReference,!0===e.hasZ,!0===e.hasM,h,1);case"type":return"Multipoint"}}if(1===u)throw new t.ArcadeExecutionError(c,"InvalidIdentifier",l);return 2===u?{keystate:"notfound"}:null}e.geometryMember=u,e.getGeometryKeys=function(e){return l[e.type]},e.getNestedOptionalValue=function(e,a){let t,r=e;if(null==r)return null;if(c.isArray(a))t=a;else if(s.isImmutableArray(a))t=a.toArray();else{if(null==a)return null;t=[a]}for(const e of t){if(s.isDictionaryLike(r)){if(!1===c.isString(e))return null;if(!r.hasField(e))return null;r=r.field(e)}else if(s.isGeometry(r)){if(!1===c.isString(e))return null;r=u(r,e,null,null,0)}else if(c.isArray(r)){if(!1===c.isNumber(e))return null;r=e>=0?r[e]:r[r.length+e]}else{if(!s.isImmutableArray(r))return null;if(!1===c.isNumber(e))return null;r=e>=0?r.get(e):r.get(r.length()+e)}if(null==r)return null}return r},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});