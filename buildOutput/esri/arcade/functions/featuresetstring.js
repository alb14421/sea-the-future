// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../Dictionary","../executionError","../../chunks/languageUtils","../featureset/support/shared"],function(e,n,t,a,r){"use strict";function o(e,t){return e&&e.domain?"coded-value"===e.domain.type||"codedValue"===e.domain.type?n.convertObjectToArcadeDictionary({type:"codedValue",name:e.domain.name,dataType:r.layerFieldEsriConstants[e.field.type],codedValues:e.domain.codedValues.map(e=>({name:e.name,code:e.code}))},a.defaultTimeZone(t)):n.convertObjectToArcadeDictionary({type:"range",name:e.domain.name,dataType:r.layerFieldEsriConstants[e.field.type],min:e.domain.minValue,max:e.domain.maxValue},a.defaultTimeZone(t)):null}e.registerFunctions=function(e){"async"===e.mode&&(e.functions.domain=function(n,r){return e.standardFunctionAsync(n,r,async(e,i,c)=>{if(a.pcCheck(c,2,3,n,r),a.isFeature(c[0]))return o(a.featureFullDomain(c[0],a.toString(c[1]),void 0===c[2]?void 0:c[2]),n);if(a.isFeatureSet(c[0]))return await c[0]._ensureLoaded(),o(a.getDomain(a.toString(c[1]),c[0],null,void 0===c[2]?void 0:c[2]),n);throw new t.ArcadeExecutionError(n,"InvalidParameter",r)})},e.functions.subtypes=function(r,o){return e.standardFunctionAsync(r,o,async(e,i,c)=>{if(a.pcCheck(c,1,1,r,o),a.isFeature(c[0])){const e=a.featureSubtypes(c[0]);return e?n.convertObjectToArcadeDictionary(e,a.defaultTimeZone(r)):null}if(a.isFeatureSet(c[0])){await c[0]._ensureLoaded();const e=c[0].subtypeMetaData();return e?n.convertObjectToArcadeDictionary(e,a.defaultTimeZone(r)):null}throw new t.ArcadeExecutionError(r,"InvalidParameter",o)})},e.functions.domainname=function(n,r){return e.standardFunctionAsync(n,r,async(e,o,i)=>{if(a.pcCheck(i,2,4,n,r),a.isFeature(i[0]))return a.featureDomainValueLookup(i[0],a.toString(i[1]),i[2],void 0===i[3]?void 0:i[3]);if(a.isFeatureSet(i[0])){await i[0]._ensureLoaded();const e=a.getDomain(a.toString(i[1]),i[0],null,void 0===i[3]?void 0:i[3]);return a.getDomainValue(e,i[2])}throw new t.ArcadeExecutionError(n,"InvalidParameter",r)})},e.signatures.push({name:"domainname",min:2,max:4}),e.functions.domaincode=function(n,r){return e.standardFunctionAsync(n,r,async(e,o,i)=>{if(a.pcCheck(i,2,4,n,r),a.isFeature(i[0]))return a.featureDomainCodeLookup(i[0],a.toString(i[1]),i[2],void 0===i[3]?void 0:i[3]);if(a.isFeatureSet(i[0])){await i[0]._ensureLoaded();const e=a.getDomain(a.toString(i[1]),i[0],null,void 0===i[3]?void 0:i[3]);return a.getDomainCode(e,i[2])}throw new t.ArcadeExecutionError(n,"InvalidParameter",r)})},e.signatures.push({name:"domaincode",min:2,max:4}),e.functions.text=function(n,r){return e.standardFunctionAsync(n,r,async(e,o,i)=>{if(a.pcCheck(i,1,2,n,r),a.isFeatureSet(i[0])){const o=a.defaultUndefined(i[1],"");if(""===o)return i[0].castToText();if("schema"===o.toLowerCase())return i[0].convertToText("schema",e.abortSignal);if("featureset"===o.toLowerCase())return i[0].convertToText("featureset",e.abortSignal);throw new t.ArcadeExecutionError(n,"InvalidParameter",r)}return a.toStringExplicit(i[0],i[1])})},e.functions.gdbversion=function(n,r){return e.standardFunctionAsync(n,r,async(e,o,i)=>{if(a.pcCheck(i,1,1,n,r),a.isFeature(i[0]))return i[0].gdbVersion();if(a.isFeatureSet(i[0]))return(await i[0].load()).gdbVersion;throw new t.ArcadeExecutionError(n,"InvalidParameter",r)})},e.functions.schema=function(r,o){return e.standardFunctionAsync(r,o,async(e,i,c)=>{if(a.pcCheck(c,1,1,r,o),a.isFeatureSet(c[0]))return await c[0].load(),n.convertObjectToArcadeDictionary(c[0].schema(),a.defaultTimeZone(r));if(a.isFeature(c[0])){const e=a.featureSchema(c[0]);return e?n.convertObjectToArcadeDictionary(e,a.defaultTimeZone(r)):null}throw new t.ArcadeExecutionError(r,"InvalidParameter",o)})})},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});