// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../Color","../../symbols/SimpleFillSymbol","../../symbols/SimpleLineSymbol","../../symbols/SimpleMarkerSymbol","../../views/support/layerViewUtils"],function(e,r,t,n,o,i){"use strict";function l(e){return e&&"blendMode"in e&&"effect"in e}function a(e){return"catalog"===e.layer.type}function f(e){return"group"===e.layer.type}e.createMultipointLayer=function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}},e.createPointLayer=function(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},e.createPolygonLayer=function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}},e.createPolylineLayer=function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},e.getContextBoundingBox=function(e,r=15){const t=e.canvas.width,n=e.canvas.height,o=e.getImageData(0,0,t,n).data;let i,l,a,f,y,u;e:for(l=n;l--;)for(i=t;i--;)if(o[4*(t*l+i)+3]>r){u=l;break e}if(!u)return null;e:for(i=t;i--;)for(l=u+1;l--;)if(o[4*(t*l+i)+3]>r){y=i;break e}e:for(i=0;i<=y;++i)for(l=u+1;l--;)if(o[4*(t*l+i)+3]>r){a=i;break e}e:for(l=0;l<=u;++l)for(i=a;i<=y;++i)if(o[4*(t*l+i)+3]>r){f=l;break e}return{x:a,y:f,width:y-a,height:u-f}},e.getCopyright=function(e){if(!e.attributionVisible)return;let r;return"function"==typeof e.originOf&&"user"===e.originOf("copyright")&&(r=e.copyright),r||!e.hasAttributionData?(r??=e.portalItem?.accessInformation,r??=e.copyright,r??void 0):void 0},e.getSelectionSymbol=function(e,i){const l=i.color?.clone()??new r([0,255,255]),a=i.haloColor?.clone()??l.clone();switch(e){case"envelope":case"polygon":return l.a*=i.fillOpacity??.25,new t({color:l,outline:new n({color:a}),style:"solid"});case"polyline":return new n({color:a});default:return a.a=1,new o({color:a,outline:null})}},e.getVisibleLayerViews=function(e,r){const t=e.allLayerViews.items;if(r===e.scale)return t.filter(e=>!e.suspended);const n=new Array;for(const e of t){const t=e.parent;t&&t!==e.view&&(a(t)||f(t))&&!n.includes(t)||e.visible&&e.visibleAtCurrentTimeExtent&&i.isInEffectiveScaleRange(e.layer.effectiveScaleRange,r)&&n.push(e)}return n},e.isBingMapsLayer=function(e){return"bing-maps"===e?.type},e.isBlendLayer=l,e.isScreenshotRequired=function(e){const r=e.layer;if(l(r)){const t=r.blendMode;if((!t||"normal"===t)&&(r.effect||"featureEffect"in e&&e.featureEffect))return!0}return!(!function(e){return e&&"trackInfo"in e}(r)||!r.trackInfo?.enabled)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});