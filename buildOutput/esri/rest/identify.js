// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../request","../geometry/support/normalizeUtils","./utils","./operations/identify","./support/IdentifyParameters","./support/IdentifyResult"],function(e,t,r,n,s,o,i){"use strict";function a(e){const t=e.data;return t.results=t.results||[],t.exceededTransferLimit=Boolean(t.exceededTransferLimit),t.results=t.results.map(e=>i.fromJSON(e)),t}e.identify=async function(e,i,u){const f=(i=function(e){return o.from(e)}(i)).geometry?[i.geometry]:[],l=n.parseUrl(e);return l.path+="/identify",r.normalizeCentralMeridian(f).then(e=>{const r=s.identifyToIdentifyRESTParameters(i,{geometry:e?.[0]}),o=n.encode({...l.query,f:"json",...r}),f=n.asValidOptions(o,u);return t(l.path,f).then(a).then(e=>function(e,t){if(!t?.length)return e;const r=new Map;t.forEach(function e(t){r.set(t.id,t),t.sublayers&&t.sublayers.forEach(e)});for(const t of e.results)t.feature.sourceLayer=r.get(t.layerId);return e}(e,i.sublayers))})},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});