// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../config","../kernel","../core/lang","../core/urlUtils","../support/apiKeyUtils"],function(e,t,n,i,r,o,u){"use strict";const s=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));function l(e,t){return e?t&&u.supportsApiKey(e)?t:u.getApiKey(e)??i.id?.findCredential(e)?.token:null}t.asValidOptions=function(e,t){return t?{...t,query:{...e??{},...t.query}}:{query:e}},t.encode=function e(t,n,i){const r={};for(const o in t){if("declaredClass"===o)continue;const u=t[o];if(null!=u&&"function"!=typeof u)if(Array.isArray(u))r[o]=u.map(t=>e(t));else if("object"==typeof u)if(u.toJSON){const e=u.toJSON(i?.[o]);r[o]=n?e:JSON.stringify(e)}else r[o]=n?u:JSON.stringify(u);else r[o]=u}return r},t.findToken=l,t.getToken=async function(t,r,o){const u=l(t,r);if(u)return u;!i.id&&n.request.useIdentity&&await new Promise((t,n)=>e(["../identity/IdentityManager"],e=>t(s(e)),n));const c=await i.id.getCredential(t,o);return c?.token},t.parseUrl=function(e){return"string"==typeof e?o.urlToObject(e):r.clone(e)},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});