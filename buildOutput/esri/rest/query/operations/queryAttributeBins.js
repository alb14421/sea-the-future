// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../request","../../../core/urlUtils","../../../geometry/support/jsonUtils","../../../geometry/support/normalizeUtils","../../../geometry/support/spatialReferenceUtils","../../operations/urlUtils"],function(e,t,n,i,r,o,u){"use strict";function a(e){const t=e.geometry,n=e.toJSON(),r=n;let u,a,s;if(null!=t&&(a=t.spatialReference,s=o.srToRESTValue(a),r.geometryType=i.getJsonType(t),r.geometry=JSON.stringify(t),r.inSR=s),n.outSR?(r.outSR=o.srToRESTValue(n.outSR),u=e.outSpatialReference):t&&(r.outSR=r.inSR,u=a),r.bin&&=JSON.stringify(r.bin),r.quantizationParameters&&=JSON.stringify(r.quantizationParameters),r.outStatistics&&=JSON.stringify(r.outStatistics),r.outTimeReference&&=JSON.stringify(r.outTimeReference),n.timeExtent){const e=n.timeExtent,{start:t,end:i}=e;null==t&&null==i||(r.time=t===i?t:`${t??"null"},${i??"null"}`),delete n.timeExtent}return e.defaultSpatialReference&&o.equals(a,u)&&(r.defaultSR=r.inSR,delete r.inSR,delete r.outSR),r}e.executeAttributeBinsQuery=async function(e,i,o){return null!=i.timeExtent&&i.timeExtent.isEmpty?{data:{features:[]}}:await async function(e,i,o={}){const s="string"==typeof e?n.urlToObject(e):e,l=i.geometry?[i.geometry]:[],y=await r.normalizeCentralMeridian(l,null,{signal:o.signal}),m=y?.[0];null!=m&&((i=i.clone()).geometry=m);const S=u.mapParameters({...s.query,f:"json",...a(i)});return t(n.join(s.path,"queryBins"),{...o,query:{...S,...o.query}})}(e,i,o)},e.queryToQueryStringParameters=a,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});