// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../../chunks/tslib.es6","../../../../core/arrayUtils","../../../../core/maybe","../../../../core/accessorSupport/decorators/property","../../../../core/has","../../../../core/Logger","../../../../core/accessorSupport/decorators/subclass","../../../Widget","./MeasuredContentGroup","./OverflowGroup","./ResponsiveToolbarManager","./SplitButton","../../../../chunks/componentsUtils","../../../support/widgetUtils","../../../support/jsxFactory"],function(e,r,t,a,s,o,l,i,n,d,c,u,p,_,h,g,m){"use strict";const y="esri-responsive-toolbar",b={rulerBase:`${y}__ruler`,rulerBarHorizontal:`${y}__ruler--bar`,rulerBarVertical:`${y}__ruler--bar--vertical`,rulerPadVertical:`${y}__ruler--pad--vertical`,rulerPadHorizontal:`${y}__ruler--pad--horizontal`,bar:`${y}__bar`,barHorizontal:`${y}__bar--horizontal`,barVertical:`${y}__bar--vertical`,pad:`${y}__pad`,padVertical:`${y}__pad--vertical`,padHorizontal:`${y}__pad--horizontal`};return r.default=class extends d{constructor(e){super(e),this.scale="m",this.barStyle="floating",this._measurementManager=new p,this._managedWidgets=new Map}loadDependencies(){return h.loadCalciteComponents({"action-bar":()=>new Promise((r,t)=>e(["../../../../chunks/index46"],r,t))})}destroy(){this._measurementManager=s.destroyMaybe(this._measurementManager),this._managedWidgets.forEach(e=>e.destroy()),this._managedWidgets.clear()}set layout(e){const r=this._get("layout");this._set("layout",e),this._measurementManager&&(this._measurementManager.layout=e),r!==e&&this.scheduleRender()}get _barClasses(){const e="docked"===this.barStyle,r="vertical"===this.layout;return{[b.barHorizontal]:e&&!r,[b.barVertical]:e&&r,[b.bar]:e,[b.padHorizontal]:!e&&!r,[b.padVertical]:!e&&r,[b.pad]:!e}}render(){const{layout:e,scale:r,barStyle:t}=this,a={layout:e,scale:r,expandDisabled:!0,key:"measured-toolbar"},s="docked"===t?"vertical"===e?b.rulerBarVertical:b.rulerBarHorizontal:"horizontal"===e?b.rulerPadHorizontal:b.rulerPadVertical;return m.tsx("div",null,m.tsx("div",{afterCreate:e=>{this._measurementManager?.connect(e)},class:this.classes(b.rulerBase,s)}),m.tsx("calcite-action-bar",{...a,classes:this._barClasses,floating:"docked"!==t,overflowActionsDisabled:!0},this._renderChildren()))}_renderChildren(){if(!this.children)return;const e=this.children.filter(e=>void 0!==e.properties?.key&&"group-kind"in e.properties),r=new Set,t=e.map(e=>{const t=e.properties,a=t.key;r.add(a);const s="docked"===this.barStyle?t.slot??void 0:void 0,o=t.priority??0,l=t["group-kind"]??"overflow-group",i=t["allow-collapse"]??!0,n=this._managedWidgets.get(a);if(n)return n.children=e.children,n.priority=o,"allowCollapse"in n&&(n.allowCollapse=i),n.slot=s,n.layout=this.layout,n.scale=this.scale,n.measurementManager=this._measurementManager,n;const d={scale:this.scale,priority:o,measurementManager:this._measurementManager,children:e.children,slot:s,layout:this.layout};switch(l){case"split-button":{const e=new _.SplitButton({...d,allowCollapse:i});return this._managedWidgets.set(a,e),e}case"overflow-group":{const e=new u({...d,allowCollapse:i});return this._managedWidgets.set(a,e),e}case"measured-content":{const e=new c({...d});return this._managedWidgets.set(a,e),e}}}).filter(a.isSome);return Array.from(this._managedWidgets.keys()).filter(e=>!r.has(e)).forEach(e=>{this._managedWidgets.get(e)?.destroy(),this._managedWidgets.delete(e)}),this._measurementManager?.allocate(),t.map(e=>e.render())}},t.__decorate([o.property()],r.default.prototype,"scale",void 0),t.__decorate([o.property({value:"horizontal"})],r.default.prototype,"layout",null),t.__decorate([o.property()],r.default.prototype,"barStyle",void 0),t.__decorate([o.property()],r.default.prototype,"_measurementManager",void 0),t.__decorate([o.property()],r.default.prototype,"_managedWidgets",void 0),t.__decorate([o.property()],r.default.prototype,"_barClasses",null),r.default=t.__decorate([n.subclass("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbar")],r.default),r.default});