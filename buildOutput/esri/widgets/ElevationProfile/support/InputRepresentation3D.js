// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../core/asyncUtils","../../../core/handleUtils","../../../core/maybe","../../../core/promiseUtils","../../../core/reactiveUtils","../../../support/elevationInfoUtils","../../../views/3d/interactive/editingTools/settings","../../../views/3d/interactive/visualElements/OutlineVisualElement","../../../views/3d/layers/graphics/GraphicState","../../../views/support/layerViewUtils"],function(e,t,i,s,l,a,n,h,r,o,g){"use strict";function c(e){return null!=e.geometry&&"polyline"===e.geometry.type}e.InputRepresentation3D=class{constructor(e){this._params=e,this._highlightTask=null,this._highlightHandle=null,this._visualElementHandle=null,this._settings=new h.Settings({getTheme:()=>this._params.view.effectiveTheme})}destroy(){this.remove()}remove(){this._highlightTask=s.abortMaybe(this._highlightTask),this._highlightHandle=s.removeMaybe(this._highlightHandle),this._visualElementHandle=s.removeMaybe(this._visualElementHandle)}showHighlight(e){if(this.remove(),null==e||!c(e))return;const i=e.layer;this._highlightTask=t.createTask(async t=>{const s=await this._params.view.whenLayerView(i);l.throwIfAborted(t),g.highlightsSupported(s)&&(this._highlightHandle=s.highlight(e))})}showReshaping(e){if(this.remove(),null==e)return;const t=this._params.view,s=new r.OutlineVisualElement({view:t,geometry:c(e)?e.geometry:null,attached:!1,elevationInfo:n.getGraphicEffectiveElevationInfo(e),renderOccluded:8,isDecoration:!0}),l=new o.GraphicState({graphic:e}),h=[a.watch(()=>l.isDraped,e=>{s.isDraped=e}),l.on("changed",()=>{s.geometry=c(e)?e.geometry:null}),t.trackGraphicState(l),t.maskOccludee(e),i.destroyHandle(s)];this._settings.visualElements.lineObjects.outline.apply(s),s.attached=!0,this._visualElementHandle=i.handlesGroup(h)}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});