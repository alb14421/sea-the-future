// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","../chunks/tslib.es6","../core/deprecate","../core/Logger","../core/memoize","../core/accessorSupport/decorators/property","../core/has","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../views/3d/environment/weather","./Widget","../chunks/componentsUtils","./support/globalCss","./support/Heading","./support/widgetUtils","./support/decorators/messageBundle","./support/jsxFactory","./Weather/css","./Weather/LabeledSlider","./Weather/VisibleElements","./Weather/WeatherViewModel"],function(e,t,r,s,o,n,a,i,l,c,d,p,u,g,h,y,v,b,w,C,m){"use strict";const _={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};let x=class extends d{constructor(e){super(e),this.viewModel=new m({isDefaultViewModel:!0}),this.headingLevel=4,this.visibleElements=new C,this._renderWeatherTypeButton=e=>{const t=this.viewModel,r=this.messages[e].label,s="disabled"===t.state,o=!s&&t.current.type===e;return v.tsx("calcite-button",{appearance:o?"solid":"outline","aria-checked":o?"true":"false",disabled:s,iconStart:_[e],key:`${e}-type-button`,kind:o?"brand":"neutral",label:r,onclick:()=>{o||t.setWeatherByType(e)},scale:"l",title:r})},this._memoizedCallbacks=o.memoize(e=>({onCloudCoverChange:t=>{"cloudCover"in e&&(e.cloudCover=t)},onPrecipitationChange:t=>{"precipitation"in e&&(e.precipitation=t)},onFogStrengthChange:t=>{"fogStrength"in e&&(e.fogStrength=t)},onSnowCoverChange:e=>{this.viewModel.setSnowCoverEnabled(e.currentTarget.checked)}})),r.deprecateWidget(s.getLogger(this),"Weather","arcgis-weather",{version:"4.33"})}render(){const e="disabled"===this.viewModel.state;return v.tsx("div",{"aria-label":this.messages.widgetLabelAccessible,class:this.classes(b.css.base,u.globalCss.widget,e&&u.globalCss.widgetDisabled),role:"region"},this._renderContent())}loadDependencies(){return p.loadCalciteComponents({button:()=>new Promise((t,r)=>e(["../chunks/index2"],t,r)),checkbox:()=>new Promise((t,r)=>e(["../chunks/index44"],t,r)),icon:()=>new Promise((t,r)=>e(["../chunks/index7"],t,r)),label:()=>new Promise((t,r)=>e(["../chunks/index5"],t,r))})}get view(){return this.viewModel?.view}set view(e){this.viewModel&&(this.viewModel.view=e)}get icon(){return"partly-cloudy"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get _errorMessage(){const e=this.messages.error;switch(this.viewModel.error){case"local-scene":return e.localScene;case"no-atmosphere":return e.noAtmosphere;case"unsupported-view":return e.unsupported;default:return null}}get _warningMessage(){return"not-visible"===this.viewModel.error&&null!=this.view&&"3d"===this.view?.type&&this.view.environment.atmosphereEnabled?this.messages.error.notVisible:null}_renderContent(){const{headingLevel:e,messages:t,viewModel:r,visibleElements:s}=this,o=this._warningMessage,n=r.current,a="error"===r.state;return v.tsx(v.tsxFragment,null,s.header?v.tsx(g.Heading,{level:e},t.widgetLabel):null,a?v.tsx("div",{class:b.css.error,key:"error"},this._errorMessage):null,v.tsx("div",{class:h.classes({[b.css.content]:!0,[b.css.hasError]:a}),key:"content"},v.tsx("div",{"aria-label":t.weatherType,class:b.css.selector,key:"type-selector",role:"radiogroup"},c.weatherTypesArray.map(this._renderWeatherTypeButton)),Object.values(r.weatherByType).map(e=>v.tsx("div",{class:h.classes({[b.css.options]:!0,[b.css.optionsHidden]:e.type!==n?.type}),key:"options-container"},this._renderOptions(e))),null!=o?this._renderWarning(o):null))}_renderOptions(e){const{viewModel:t,messages:r}=this,s="disabled"===t.state,o=this._memoizedCallbacks(e);switch(e.type){case"sunny":return v.tsx(w.LabeledSlider,{disabled:s,key:"sunny-cover",label:r.sunny.cloudCover,value:e.cloudCover,onChange:o.onCloudCoverChange});case"cloudy":return v.tsx(w.LabeledSlider,{disabled:s,key:"cloudy-cover",label:r.cloudy.cloudCover,value:e.cloudCover,onChange:o.onCloudCoverChange});case"rainy":return v.tsx(v.tsxFragment,null,v.tsx(w.LabeledSlider,{disabled:s,key:"rainy-cover",label:r.rainy.cloudCover,value:e.cloudCover,onChange:o.onCloudCoverChange}),v.tsx(w.LabeledSlider,{disabled:s,key:"rainy-precipitation",label:r.rainy.precipitation,value:e.precipitation,onChange:o.onPrecipitationChange}));case"snowy":return v.tsx(v.tsxFragment,null,v.tsx(w.LabeledSlider,{disabled:s,key:"snowy-cloud-cover",label:r.snowy.cloudCover,value:e.cloudCover,onChange:o.onCloudCoverChange}),v.tsx(w.LabeledSlider,{disabled:s,key:"snowy-precipitation",label:r.snowy.precipitation,value:e.precipitation,onChange:o.onPrecipitationChange}),v.tsx("calcite-label",{key:"snow-cover",layout:"inline",scale:"s",title:r.snowy.snowCoverTooltip},v.tsx("calcite-checkbox",{checked:"enabled"===e.snowCover,disabled:s,onCalciteCheckboxChange:o.onSnowCoverChange}),r.snowy.snowCover));case"foggy":return v.tsx(w.LabeledSlider,{disabled:s,key:"foggy-cover",label:r.foggy.fogStrength,value:e.fogStrength,onChange:o.onFogStrengthChange})}}_renderWarning(e){return v.tsx("div",{class:b.css.warning,key:"warning"},v.tsx("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),e)}};return t.__decorate([n.property()],x.prototype,"viewModel",void 0),t.__decorate([n.property()],x.prototype,"view",null),t.__decorate([n.property()],x.prototype,"headingLevel",void 0),t.__decorate([n.property({type:C,nonNullable:!0})],x.prototype,"visibleElements",void 0),t.__decorate([n.property()],x.prototype,"icon",null),t.__decorate([n.property()],x.prototype,"label",null),t.__decorate([n.property(),y.messageBundle("esri/widgets/Weather/t9n/Weather")],x.prototype,"messages",void 0),t.__decorate([n.property()],x.prototype,"_errorMessage",null),t.__decorate([n.property()],x.prototype,"_warningMessage",null),x=t.__decorate([l.subclass("esri.widgets.Weather")],x),x});