// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../chunks/tslib.es6","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../intl/substitute","./Grid/Column","./Grid/ColumnCSS","./support/tableUtils"],function(e,t,o,r,i,l,s,a,p,n){"use strict";let c=class extends a{constructor(e){super(e),this.flexGrow=1,this.icon="link",this.layer=null,this.relatedLayer=null,this.relationshipId=null,this.renderFunction=({root:e,rowData:t})=>{if(!t)return;const o=t.item,{layer:r,relatedLayer:i}=this;if(!o?.feature||!n.isIFeatureTableSupportedLayerWithRelationships(r)||!n.isIFeatureTableSupportedLayerWithRelationships(i))return;const{messages:l}=this,{index:a}=t,{feature:c,objectId:d}=o,{collapsed:h,showRelatedTableCallback:u,relationshipId:y}=this,_=o.relatedRecords,b=_?.find(e=>e.relationshipId===y)?.count??0,f=!h&&u&&l?.recordsCount?s.substitute(l.recordsCount,{count:b}):`${b}`,C=e=>{e.preventDefault(),h||this.showRelatedTableCallback?.({feature:c,index:a,layer:r,objectId:d,relatedLayer:i,relationshipId:y})},g=h?"":"chevron-right";if(e.firstChild){const t=e.firstChild;return t.textContent=f,t.onclick=C,void(t.iconEnd=g)}const v=this.createCalciteButton({className:`esri-column__show-related-records-button ${p.css.contentFull}`,iconEnd:g,iconFlipRtl:"both",scale:"m",textContent:f,title:f,onclick:C});this.removeCellContent(e),e.appendChild(v)},this.resizable=!0,this.showRelatedTableCallback=null,this.textAlign="center",this.width="200px"}get _relationshipLabel(){return this.label||this.originRelationship?.name||this.layer.title||""}get collapsed(){return this._get("collapsed")||!1}set collapsed(e){e?this.set({flexGrow:0,resizable:!1,width:"80px"}):this.set({flexGrow:1,resizable:!0,width:"200px"}),this._set("collapsed",e)}get effectiveLabel(){return this.collapsed?"":this._relationshipLabel}get iconNode(){const{icon:e}=this;return e?this.createCalciteIcon({icon:e,textLabel:this._relationshipLabel}):null}get originRelationship(){const e=this.relationshipId;return this.relatedLayer.relationships?.find(({id:t})=>t===e)}get relationship(){return n.findRelationship(this.layer,this.relationshipId)}};return e.__decorate([t.property()],c.prototype,"_relationshipLabel",null),e.__decorate([t.property()],c.prototype,"collapsed",null),e.__decorate([t.property()],c.prototype,"effectiveLabel",null),e.__decorate([t.property()],c.prototype,"flexGrow",void 0),e.__decorate([t.property()],c.prototype,"icon",void 0),e.__decorate([t.property()],c.prototype,"iconNode",null),e.__decorate([t.property()],c.prototype,"layer",void 0),e.__decorate([t.property()],c.prototype,"originRelationship",null),e.__decorate([t.property()],c.prototype,"relatedLayer",void 0),e.__decorate([t.property()],c.prototype,"relationship",null),e.__decorate([t.property()],c.prototype,"relationshipId",void 0),e.__decorate([t.property()],c.prototype,"renderFunction",void 0),e.__decorate([t.property()],c.prototype,"resizable",void 0),e.__decorate([t.property()],c.prototype,"showRelatedTableCallback",void 0),e.__decorate([t.property()],c.prototype,"textAlign",void 0),e.__decorate([t.property()],c.prototype,"width",void 0),c=e.__decorate([l.subclass("esri.widgets.FeatureTable.RelationshipColumn")],c),c});