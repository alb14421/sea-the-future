// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../chunks/tslib.es6","../../intl","../../core/arrayUtils","../../core/Collection","../../core/collectionUtils","../../core/deprecate","../../core/Error","../../core/Handles","../../core/Logger","../../core/maybe","../../core/promiseUtils","../../core/reactiveUtils","../../core/throttle","../../core/accessorSupport/decorators/property","../../core/has","../../core/accessorSupport/decorators/subclass","../../layers/support/fieldUtils","../../layers/support/layerUtils","../../support/popupUtils","../../tables/AttributeTableTemplate","../../tables/support/FieldOrder","../../views/support/HighlightDefaults","../../views/support/layerViewUtils","../../views/support/selectionUtils","./ActionColumn","./AttachmentsColumn","./FieldColumn","./RelationshipColumn","./Grid/Column","./Grid/Grid","./Grid/GridViewModel","./Grid/GroupColumn","./support/AttachmentsColumnTemplate","./support/AttachmentsViewOptions","./support/columnUtils","./support/exportUtils","./support/FeatureStore","./support/FieldColumnTemplate","./support/RelationshipColumnTemplate","./support/TableTemplate","./support/tableUtils","./support/templateUtils","../support/goToUtils","../support/widgetUtils","../support/decorators/messageBundle","../../intl/locale","../../intl/substitute","../../intl/messages"],function(e,t,i,s,l,o,r,n,a,h,d,c,p,m,u,g,b,y,f,_,T,w,C,I,v,E,A,S,F,R,x,U,O,j,V,z,W,L,N,P,H,B,Z,G,k,q,D,M){"use strict";const $="80px";let Q=class extends x{constructor(e){super(e),this._currentTemporaryHighlight=null,this._highlights=new n,this._refreshDebounced=d.debounce(()=>this._refresh()),this._syncTemplateThrottled=p.throttle(()=>this._syncAttributeTableTemplate()),this._temporaryHighlightAbortController=null,this.attachmentsViewOptions=new j,this.attributeTableTemplate=null,this.autoRefreshEnabled=!0,this.columns=new s,this.dataProvider=async(e,t)=>{const{layer:i,store:s}=this;if(!t)return;if(!i||!s)return void(t&&t([]));await i.load();const{objectIds:l}=this;if(this.filterBySelectionEnabled&&!this.highlightIds.length||1===l.length&&-1===l.items[0])return void t([]);"loaded"!==s.state&&"loading"!==s.state&&await s.load();const o=this.paginationEnabled?this.pageIndex:e.page,r=await s.fetchItems({...e,page:o});t&&t(r)},this.grid=null,this.highlightEnabled=!0,this.layers=null,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.messagesURIUtils=null,this.prompt=null,this.relatedTables=new s,this.relationshipColumnConfigs=null,this.selectionSource="table",this.showRelatedTableCallback=null,this.store=null,this.syncTemplateOnChangesEnabled=!0,this.tableController=null,this.tableParent=null,this.tableTemplate=null,this.tableTemplateOverride=null,this._onLayerRefresh=this._onLayerRefresh.bind(this),this._onShowPromptCallback=this._onShowPromptCallback.bind(this),this._set("store",new W),this._set("grid",new R({viewModel:this}))}initialize(){const e=async()=>{this.messages=await M.fetchMessageBundle("esri/widgets/FeatureTable/t9n/FeatureTable"),this.messagesCommon=await M.fetchMessageBundle("esri/t9n/common"),this.messagesUnits=await M.fetchMessageBundle("esri/core/t9n/Units"),this.messagesURIUtils=await M.fetchMessageBundle("esri/widgets/support/t9n/uriUtils")};e(),this.addHandles([q.onLocaleChange(()=>{e(),this._generateColumns()}),c.watch(()=>[this.messages,this.messagesCommon,this.messagesURIUtils],()=>{const e=this.messages;this.grid&&(this.grid.messages=e),this.allColumns.forEach(t=>{t.messages=e,t.messagesCommon=this.messagesCommon,t.messagesURIUtils=this.messagesURIUtils}),this.refreshCellContent()},c.initial),c.on(()=>this.highlightIds,"change",e=>this._onHighlightIdsChange(e),{onListenerAdd:()=>this._syncSelection(),onListenerRemove:()=>this._highlights.removeAll()}),c.watch(()=>this.grid?.temporaryHighlightId,e=>{this._temporaryHighlightAbortController?.abort(),this._temporaryHighlightAbortController=new AbortController,d.ignoreAbortErrors(this._syncTemporaryHighlight(e,this._temporaryHighlightAbortController.signal))}),c.watch(()=>this.attachmentsEnabled,()=>this.layer?.loaded&&this._generateColumns()),c.watch(()=>this._viewSelection,()=>{this._viewSelectionReady&&(this.highlightIds.items=this._viewSelection)}),c.watch(()=>[this._tableHighlightsReady,this._viewSelectionReady],()=>this._syncSelection()),c.watch(()=>this.layer,async(e,t)=>{const i=this.grid;i&&(i.clearSort(),e&&t&&await this.reset()),this.goToPage(0),this._drainColumns(),this.store.layer=e,e&&(e.loaded?this._onLayerLoad():e.load().catch(()=>{})),t&&null!=this.attachmentsViewOptions.objectId&&(this.attachmentsViewOptions.objectId=null)}),c.watch(()=>this.layer?.loaded,e=>e&&this._onLayerLoad()),c.watch(()=>this.store.state,e=>{"loaded"===e&&(this.scrollToTop(),this.refreshCellContent())}),c.watch(()=>this._effectiveTableTemplate,()=>{this.scrollLeft(),this.layer?.loaded&&this._generateColumns()}),c.watch(()=>this.editingEnabled,e=>{this.editableColumns.forEach(t=>t.tableEditingEnabled=e),this.refreshCellContent()}),c.watch(()=>this.timeZone??this.view?.timeZone,()=>this.refreshCellContent()),c.watch(()=>this.layer?.definitionExpression,(e,t)=>(e||t)&&"loaded"===this.store.state&&this.reset()),c.watch(()=>this.layer?.timeExtent,(e,t)=>(e||t)&&!this.timeExtent&&"loaded"===this.store.state&&this.reset()),c.on(()=>this.layer,"refresh",e=>this._onLayerRefresh(e)),c.on(()=>this.grid,["cell-click","cell-dblclick","cell-pointerover","cell-pointerout","cell-keydown","column-reorder"],({index:e,item:t,native:i,path:s,type:l})=>{const o=t?.feature,r=o?.getObjectId(),n="cell-keydown"===l&&i&&i instanceof KeyboardEvent&&"Enter"===i.key;this.emit(l,{feature:o,index:e,native:i,type:l,fieldName:s??void 0,objectId:r}),(n||"cell-click"===l)&&this._onCellInteraction(r)}),c.watch(()=>this.actionColumnConfig,e=>{const{actionColumn:t,columns:i}=this;t?e?t.set(e):i.remove(t):e&&i.length&&i.add(this._generateActionColumn(),!1!==e.frozenToEnd?void 0:this._getIndexOfFirstFrozenToEndColumn())}),c.watch(()=>this.relatedRecordsEnabled,()=>this.layer?.loaded&&this._generateColumns()),c.on(()=>this.objectIds,"change",()=>this._onObjectIdsChange(),{onListenerAdd:()=>this._onObjectIdsChange()}),c.watch(()=>[this.paginationEnabled,this.pageIndex],()=>this.refreshPageCache()),c.watch(()=>this.activeSortOrders,e=>{this.store.sortOrders=e,this._syncTemplateThrottled()}),c.watch(()=>this.allVisibleColumns,()=>this._syncTemplateThrottled()),c.watch(()=>this.pageCount,()=>{this.pageIndex>=this.pageCount&&this.goToPage(0)}),c.watch(()=>this.state,e=>{"disabled"===e&&this.relatedTables.length&&this.drainRelatedTables()}),c.on(()=>this.tableParent?.highlightIds,"change",({added:e})=>{const{relationshipConfig:t}=this,i=e[0];if(null==i||!t)return;const{relatedLayer:s,relationshipId:l}=t;this.relationshipConfig={objectId:i,relatedLayer:s,relationshipId:l}}),c.on(()=>this.tableParent,"cell-click",e=>{const{tableParent:t}=this,{objectId:i}=e;t&&null!=i&&t.highlightIds.add(i)}),c.watch(()=>this.attachmentsViewOptions.objectId,(e,t)=>{null!=e?null==t&&this.showAttachmentsView({objectId:e}):this.hideAttachmentsView()})])}destroy(){this._drainColumns(),this._highlights.removeAll(),this._highlights.destroy(),this._currentTemporaryHighlight?.handle.remove(),this._temporaryHighlightAbortController=h.abortMaybe(this._temporaryHighlightAbortController),this.grid?.destroy(),this.columns.destroyed||this.columns.destroy(),this.layer=null,this.view=null}get _defaultHiddenFields(){return b.getLowerCaseDefaultHiddenFields(this.layer)}get _effectiveTableTemplate(){return this.tableTemplateOverride||this.tableTemplate}get _effectiveAttributeTableTemplate(){return this.attributeTableTemplate||this.layer?.attributeTableTemplate}get _highlightableLayerView(){const e=this.layerView;return C.highlightsSupported(e)?e:null}get _selectionManager(){const{view:e}=this;return!e||e.destroyed?null:e.selectionManager?.sources?.length?e.selectionManager:null}get _selectableLayer(){const{layer:e}=this;if(I.isSelectableLayer(e)||y.isSubtypeSublayer(e)){const t=e;return this._selectionManager?.sources?.includes(t)?t:null}return null}get _subtypes(){return y.getSubtypesFromLayer(this.layer)}get _tableHighlightsReady(){return!("table"!==this.selectionSource||!this.highlightEnabled||!this._highlightableLayerView)}get _viewSelection(){const{_selectableLayer:e}=this;return e?this._selectionManager?.getSelection(e)??[]:[]}get _viewSelectionReady(){return!(!this.layer||"view"!==this.selectionSource||!this._selectionManager)}get actionColumn(){return super.actionColumn}get activeFilters(){const{filterGeometry:e,objectIds:t,filterBySelectionEnabled:i,highlightIds:l}=this,o=new s;return e&&o.push({type:"geometry",geometry:e}),i?o.push({type:"selection",objectIds:l.toArray()}):t.length&&o.push({type:"objectId",objectIds:t.toArray()}),o}get activeSortOrders(){return this.grid?.sortOrders?this.grid.sortOrders.map(({path:e,direction:t})=>({fieldName:e,direction:t})).filter(e=>e.fieldName&&e.direction):[]}get allColumns(){return super.allColumns}get allRelatedTablesVisible(){return!!(this.relatedRecordsEnabled&&this.relatedTables.length&&this.showAllRelatedTables)}get attachmentsColumns(){return this.allColumns.filter(e=>V.isAttachmentsColumn(e))}get attachmentsEnabled(){return this.store.attachmentsEnabled}set attachmentsEnabled(e){this.store.attachmentsEnabled=e}get clearPrompt(){return()=>this.prompt=null}set clearPrompt(e){this._overrideIfSome("clearPrompt",e)}get definitionExpression(){return this.store.where}set definitionExpression(e){this.store.where=e}get effectiveSize(){return super.effectiveSize}get fieldColumns(){return this.allColumns.filter(e=>V.isFieldColumn(e))}get filterGeometry(){return this.store.filterGeometry}set filterGeometry(e){this.store.filterGeometry=e}get filterBySelectionEnabled(){return!!this._get("filterBySelectionEnabled")}set filterBySelectionEnabled(e){const{objectIds:t}=this,i=t.length;e?(i&&(t.removeAll(),this._logWarning("Selection filter has been applied with an objectID filter. Object ID filter has been removed.")),this.filterGeometry&&this._logWarning("Selection filter has been applied with a geometry filter. Results may appear inconsistent"),this._syncObjectIdsWithStore(this.highlightIds.toArray())):i||this._syncObjectIdsWithStore(null),this._set("filterBySelectionEnabled",e)}get groupColumns(){return super.groupColumns}get hiddenFields(){return this._get("hiddenFields")??new s}set hiddenFields(e){this._set("hiddenFields",l.referenceSetter(e,this._get("hiddenFields"),s))}get highlightIds(){return super.highlightIds}set highlightIds(e){super.highlightIds=e}get initialSize(){return this.store.initialSize}set initialSize(e){this.store.initialSize=e}get isEditing(){return super.isEditing}get isQuerying(){return super.isQuerying}get isSyncing(){return super.isSyncing}get isQueryingOrSyncing(){return this.isQuerying||this.isSyncing||this.relatedTables.some(e=>!!e.isQueryingOrSyncing)}get isSyncingAttachments(){return this.store.isSyncingAttachmentEdits||this.relatedTables.some(e=>!!e.isSyncingAttachments)}get layer(){return this._get("layer")}set layer(e){this._highlights.removeAll(),this.drainRelatedTables(),this._set("layer",e)}get layerView(){return this.store.layerView}get outFields(){return this.store.outFields}set outFields(e){this.store.outFields=e}get pageCount(){return super.pageCount}get pageIndex(){return super.pageIndex}set pageIndex(e){super.pageIndex=e}get pageSize(){return super.pageSize}set pageSize(e){super.pageSize=e}get relatedRecordsEnabled(){return this.store.relatedRecordsEnabled}set relatedRecordsEnabled(e){this.store.relatedRecordsEnabled=e}get relatedTable(){return this.relatedTables.at(-1)}get relationship(){const e=this.relationshipConfig?.relationshipId;return null==e?null:this.relationships?.find(({id:t})=>t===e)}get relationshipColumns(){return this.allColumns.filter(e=>V.isRelationshipColumn(e))}get relationshipConfig(){return this.store.relationshipConfig}set relationshipConfig(e){this.highlightIds.removeAll(),this.objectIds.removeAll(),this.filterBySelectionEnabled=!1,this.store.relationshipConfig=e}get relationshipInfos(){const{layer:e,layers:t,relationships:i,tableController:s}=this,l=this.store.relationshipInfos;if(l.length||!H.isIFeatureTableSupportedLayerWithRelationships(e)||!i?.length)return l;const o=[],r=s?.layers||t||[];return i.forEach(t=>{const i=H.findRelatedLayerInSources(e,r,t);i&&(i.load(),o.push({layer:e,relatedLayer:i,relationshipId:t.id}))}),o}get relationships(){return this.store.relationships}get returnGeometryEnabled(){return this.store.returnGeometry}set returnGeometryEnabled(e){this.store.returnGeometry=e}get returnMEnabled(){return this.store.returnM}set returnMEnabled(e){this.store.returnM=e}get returnZEnabled(){return this.store.returnZ}set returnZEnabled(e){this.store.returnZ=e}get rowHighlightIds(){return super.rowHighlightIds}set rowHighlightIds(e){super.rowHighlightIds=e}get showAllRelatedTables(){return this._get("showAllRelatedTables")}set showAllRelatedTables(e){const{relatedTable:t}=this;this._set("showAllRelatedTables",e),t&&(e?this._showAllRelatedTables(t):this._hideAllRelatedTables(t))}get showPrompt(){return e=>{this.prompt?.cancel?.(),this.prompt=e}}set showPrompt(e){this._overrideIfSome("showPrompt",e)}get size(){return super.size}get state(){return super.state}get supportsAttachments(){return this.store.supportsAttachments}get supportsAddAttachments(){const{store:{supportsAddingAttachments:e,supportsEditing:t}}=this;return this.editingEnabled&&t&&e}get supportsDeleteAttachments(){const{store:{supportsDeletingAttachments:e,supportsEditing:t}}=this;return this.editingEnabled&&t&&e}get supportsResizeAttachments(){return this.store.supportsResizeAttachments}get supportsUpdateAttachments(){const{store:{supportsUpdateAttachments:e,supportsEditing:t}}=this;return this.editingEnabled&&t&&e}get timeExtent(){return this.store.timeExtent}set timeExtent(e){this.store.timeExtent=e}get timeZone(){return this._get("timeZone")}set timeZone(e){this.allColumns.forEach(t=>t.tableTimeZone=e),this._set("timeZone",e)}get view(){return this.store.view}set view(e){this.store.view=e,this.fieldColumns.forEach(t=>t.view=e),this.refreshCellContent()}get visibleColumns(){return super.visibleColumns}async addAttachment(e,t){const{attachmentsViewOptions:i,store:s}=this,l=i.objectId===e;await s.addAttachment(e,t).catch(e=>{l&&e&&"object"==typeof e&&"error"in e&&e.error instanceof r&&(this._logWarning(`Unable to add attachment. ${e.error.name} ${e.error.message}`),i.error=e.error)}),l&&!i.error&&(i.onEditComplete(),i.attachmentInfos=await s.getAttachmentsByObjectId(e,!0)),this.refreshCellContent()}async deleteAttachments(e,t){const{attachmentsViewOptions:i,store:s}=this,l=i.objectId===e;await s.deleteAttachments(e,t).catch(e=>{l&&e&&"object"==typeof e&&"error"in e&&e.error instanceof r&&(this._logWarning(`Unable to delete attachment(s). ${e.error.name} ${e.error.message}`),i.error=e.error)}),l&&!i.error&&(i.onEditComplete(),i.attachmentInfos=await s.getAttachmentsByObjectId(e,!0)),this.refreshCellContent()}collapseRelatedTable(e,t){const{relatedLayer:i,objectId:l,relationshipId:o}=t,{objectIdField:r}=i,n=H.findRelationship(i,o),a=i.displayField||n?.keyField||r;e.set({highlightIds:new s([l]),multipleSelectionEnabled:!1,tableTemplateOverride:this._getTableTemplateForRelatedTableView(e,a,o)});const h=e.hiddenFields;h.includes(H.uniqueColumnNames.action)||h.add(H.uniqueColumnNames.action),h.includes(H.uniqueColumnNames.attachments)||h.add(H.uniqueColumnNames.attachments),e.scrollLeft()}async deleteSelection(){const e=this.highlightIds.toArray();if(!e?.length)return;const{deleteFeatureResults:t}=await this.store.deleteRowsByObjectId(e),i=t.filter(e=>!e.error).map(e=>e.objectId);i.length&&(this.highlightIds.removeMany(i),await this.refresh())}async downloadAttachmentById(e,t){const i=(await this.store.getAttachmentsByObjectId(e,!0)).find(e=>e.id===t);await z.downloadAttachmentInfo(i)}drainRelatedTables(){this.relatedTables.drain(e=>e.destroy()),this.set({multipleSelectionEnabled:!0,relationshipColumnConfigs:null,showAllRelatedTables:!1,tableTemplateOverride:null}),this.hiddenFields.removeMany([H.uniqueColumnNames.action,H.uniqueColumnNames.attachments])}drainRelatedTablesAboveIndex(e){const{relatedTables:t}=this,i=t.slice(e+1);t.removeMany(i).forEach(e=>e.destroy());const s=t.at(-1);s&&(s.attachmentsViewOptions.objectId=null,this.allRelatedTablesVisible?this._showAllRelatedTables(s):this._hideAllRelatedTables(s))}async exportSelectionToCSV(e){const{highlightIds:t,layer:i,outFields:s}=this;i&&t.length?await z.exportToCSV({layer:i,objectIds:t.toArray(),outFields:s,includeGeometry:e}):this._logWarning("Export failed.")}filterBySelection(){this.filterBySelectionEnabled?this._logWarning("Property 'filterBySelectionEnabled' is already 'true'. This method has no effect."):(o.deprecatedFunction(a.getLogger(this),"`FeatureTable.filterBySelection` is deprecated in favor of 'filterBySelectionEnabled' and 'objectIds'",{replacement:"FeatureTable.filterBySelectionEnabled or FeatureTable.objectIds",version:"4.30",warnOnce:!0}),this.objectIds.addMany(this.highlightIds.toArray()))}getObjectIdIndex(e){return this.store.getItemIndexByObjectId(e)}getValue(e,t){const i=this.store.getItemByObjectId(e);return i?.feature?.attributes[t]}getVirtualPageIndex(){return this.grid?.getVirtualPageIndex()??0}goToPage(e){if(null==e||!Number.isInteger(e))return void this._logWarning("Invalid 'page' parameter provided to 'goToPage()'. Current page will remain the same.");const{pageCount:t}=this;(e>=t||-1===e)&&(e=t-1),e<-1&&(e=0),e!==this.pageIndex&&(this.pageIndex=e),this.paginationEnabled||this.scrollToIndex(e*this.pageSize)}hideAttachmentsView(){this.attachmentsViewOptions.objectId=null,this.set({relationshipColumnConfigs:null,multipleSelectionEnabled:!0,tableTemplateOverride:null}),this.hiddenFields.remove(H.uniqueColumnNames.action)}nextPage(){const e=this.paginationEnabled?this.pageIndex:this.getVirtualPageIndex();this.goToPage(e+1)}previousPage(){const e=this.paginationEnabled?this.pageIndex:this.getVirtualPageIndex();this.goToPage(e-1)}async refresh(){await Promise.all([...this.relatedTables.map(e=>e.refresh()),d.ignoreAbortErrors(this._refreshDebounced())])}refreshCellContent(){this.grid?.requestContentUpdate()}refreshPageCache(){this.grid?.refreshPageCache()}async reset(){this.goToPage(0),await(this.grid?.reset())}scrollLeft(){this.grid?.scrollLeft(0)}scrollToBottom(){this.grid?.scrollToBottom()}scrollToIndex(e){this.grid?.scrollToIndex(e)}scrollToRow(e){const t=this.store.getItemIndexByObjectId(e);t>-1?this.grid?.scrollToIndex(t):this._logWarning("Row not found. Associated data may not be loaded yet.")}scrollToTop(){this.grid?.scrollToTop()}async saveAttachmentsViewForm(){const{attachmentId:e,form:t,objectId:i}=this.attachmentsViewOptions;null!=i&&t&&(null!=e?await this.updateAttachment(i,e,t):await this.addAttachment(i,t))}async showAttachmentsView({objectId:e}){const{attachmentsViewOptions:t,hiddenFields:i,layer:l}=this;if(!this.attachmentsEnabled||!l)return void this._logWarning("The 'attachmentsEnabled' property is currently false.");await l.load();const o=this._getDefaultLayerDisplayField(l),r=await this.store.getAttachmentsByObjectId(e,!0),n=this.store.getItemIndexByObjectId(e);t.set({attachmentInfos:r,mode:r.length?"list":"file",objectId:e}),this.set({highlightIds:new s([e]),multipleSelectionEnabled:!1,relationshipColumnConfigs:[],tableTemplateOverride:this._getTableTemplateForAttachmentsView(o)}),i.includes(H.uniqueColumnNames.action)||i.add(H.uniqueColumnNames.action),null!=n&&this.scrollToIndex(n)}syncAttributeTableTemplate(){this._syncAttributeTableTemplate(!0)}clearSelectionFilter(){o.deprecatedFunction(a.getLogger(this),"`FeatureTable.clearSelectionFilter` is deprecated in favor of 'filterBySelectionEnabled' and 'objectIds'",{replacement:"FeatureTable.filterBySelectionEnabled or FeatureTable.objectIds",version:"4.30",warnOnce:!0}),this.objectIds.removeAll()}async updateAttachment(e,t,i){const{attachmentsViewOptions:s,store:l}=this,o=s.objectId===e;await l.updateAttachment(e,t,i).catch(e=>{o&&e&&"object"==typeof e&&"error"in e&&e.error instanceof r&&(this._logWarning(`Unable to update attachment. ${e.error.name} ${e.error.message}`),s.error=e.error)}),o&&!s.error&&(s.onEditComplete(),s.attachmentInfos=await l.getAttachmentsByObjectId(e,!0)),this.refreshCellContent()}async zoomToSelection(){const{layer:e,view:t}=this,i=this.highlightIds.toArray();if(!e||!t||!i.length)return;const s=e.createQuery();s.objectIds=i,s.returnGeometry=!0;const l=await e.queryFeatures(s);try{await Z.goTo(t,l.features)}catch(e){"AbortError"!==e.name&&console.error(e)}}_syncAttributeTableTemplate(e=!1){const{_effectiveAttributeTableTemplate:t,layer:i,tableTemplateOverride:s,syncTemplateOnChangesEnabled:l}=this;if(!i||!t||!l&&!e||s||this.tableParent||this.relatedTable||null!==this.attachmentsViewOptions.objectId)return;const{activeSortOrders:o,allColumns:r,columns:n}=this,a=[],h=B.createAttributeTableElements(n.toArray());o.forEach(({fieldName:e,direction:t})=>{e&&t&&a.push(new T({field:e,order:t}))}),r.forEach(({fieldName:e,direction:t})=>{t&&!a.some(t=>t.field===e)&&a.push(new T({field:e,order:t}))}),t.elements=h,t.orderByFields=a}async _refresh(){await this.store.refresh();const e=this.highlightIds.toArray();e.length&&(await this.store.verifyFeaturesByObjectId(e)).forEach((t,i)=>{t||this.highlightIds.remove(e[i])}),this.refreshPageCache();const t=this.attachmentsViewOptions;null!=t?.objectId&&(t.attachmentInfos=await this.store.getAttachmentsByObjectId(t.objectId,!0))}async _onLayerLoad(){const{layer:e,pageSize:t}=this;if(!e)return;e.parent&&y.isSubtypeGroupLayer(e.parent)&&await e.parent.loadAll();const i=e.capabilities.query?.maxRecordCount,s=i&&i<t,l=s?i:t;s&&(this._logWarning("The value for 'pageSize' has been adjusted due to the provided layer's max record count."),this.pageSize=l),this.grid?.set("pageSize",l),this.store.load(),this._generateColumns()}_onLayerRefresh(e){this.autoRefreshEnabled&&e.dataChanged&&this.refresh()}_generateColumns(){this._drainColumns();const{_effectiveTableTemplate:e,_effectiveAttributeTableTemplate:t}=this,i=e?.columnTemplates,s=this._generateColumnsFromColumnTemplates(i)??this._generateColumnsFromAttributeTableTemplate(t)??this._generateDefaultFieldColumns();s.length&&(this.attachmentsEnabled&&!s.some(e=>V.isAttachmentsColumn(e))&&s.push(this._generateDefaultAttachmentsColumn()),this.relatedRecordsEnabled&&this.relationshipInfos.length&&!s.some(e=>V.isRelationshipColumn(e))&&s.push(...this._generateDefaultRelationshipColumns()),this.actionColumnConfig&&s.push(this._generateActionColumn()),s.sort((e,t)=>e.frozen&&t.frozen||e.frozenToEnd&&t.frozenToEnd?0:e.frozen||t.frozenToEnd?-1:0),this.columns.addMany(s))}_generateColumnsFromAttributeTableTemplate(e){const{layer:t}=this;if(!e||!t)return null;const{elements:s,orderByFields:l}=e,o=f.createFieldInfos(t),r=[];r.push(...this._generateColumnsFromAttributeTableElements(s,l));const n=o.map(e=>{if(!e.fieldName||H.hasColumnForField(e.fieldName,r))return null;const{fieldName:i}=e,s=H.findField(t,i);return s?this._generateDefaultFieldColumn(s,{hidden:!0,orderByFields:l}):(this._logTemplateWarning("A valid 'field' could not be found for the provided template."),null)}).filter(i.isSome);return r.push(...n),this.attachmentsEnabled&&H.isIFeatureTableSupportedLayerWithAttachments(t)&&!r.some(e=>V.isAttachmentsColumn(e))&&r.push(this._generateDefaultAttachmentsColumn({hidden:!0})),this.relatedRecordsEnabled&&H.isIFeatureTableSupportedLayerWithRelationships(t)&&t.relationships?.forEach(({id:e},t)=>{const i=this.relationshipInfos.find(t=>t.relationshipId===e);i&&!r.some(t=>V.isRelationshipColumn(t)&&t.relationshipId===e)&&r.push(this._generateDefaultRelationshipColumn({hidden:!0,info:i,index:t}))}),r.length?r:null}_generateColumnsFromAttributeTableElements(e,t){const{layer:i}=this;return i?e?.map((e,i)=>{switch(e.type){case"field":return this._createFieldColumnFromElement({element:e,orderByFields:t});case"group":return this._createGroupColumnFromElement({element:e,orderByFields:t});case"attachment":return this._createAttachmentColumnFromElement({element:e,index:i});case"relationship":return this._createRelationshipColumnFromElement({element:e,index:i})}}).filter(e=>!!e)??[]:[]}_createFieldColumnFromElement(e){const{layer:t}=this;if(!t)return null;const{element:i,orderByFields:s}=e,{fieldName:l}=i;if(null==l)return this._logTemplateWarning("A valid 'fieldName' must be provided."),null;const o=H.findField(t,l);if(!o)return this._logTemplateWarning("A valid 'field' could not be found for the provided template."),null;const{description:r,label:n}=i,a=s?.findIndex(({field:e})=>e&&e===l)??-1,h=a>-1?s?.at(a)?.order:void 0,d=a>-1?a:void 0,{editingEnabled:c,grid:p,messages:m,messagesCommon:u,messagesURIUtils:g,store:b,timeZone:y,view:f}=this;return new A({description:r,direction:h,field:o,fieldName:l,grid:p,initialSortPriority:d,label:n,layer:t,messages:m,messagesCommon:u,messagesURIUtils:g,store:b,tableEditingEnabled:c,tableTimeZone:y,view:f,onShowPromptCallback:this._onShowPromptCallback})}_createGroupColumnFromElement(e){const{element:t,orderByFields:i}=e,{description:s,label:l}=t;if(!l)return this._logTemplateWarning("Group columns require a label."),null;if(!t.elements.length)return this._logTemplateWarning("Group columns require child columns."),null;const{grid:o,messages:r,messagesCommon:n,messagesURIUtils:a,store:h,timeZone:d}=this;return new U({columns:this._generateColumnsFromAttributeTableElements(t.elements,i),description:s,grid:o,label:l,messages:r,messagesCommon:n,messagesURIUtils:a,store:h,tableTimeZone:d})}_createAttachmentColumnFromElement(e){if(!this.attachmentsEnabled)return void this._logTemplateWarning("The 'attachmentsEnabled' property is currently false.");const{element:t,index:i}=e,{description:s,label:l}=t,{grid:o,layer:r,messages:n,messagesCommon:a,messagesURIUtils:h,store:d,timeZone:c}=this;return new E({description:s,fieldName:`${H.uniqueColumnNames.attachments}-${i}`,grid:o,label:l,layer:r,messages:n,messagesCommon:a,messagesURIUtils:h,store:d,tableTimeZone:c,onShowAttachments:e=>this._onShowAttachments(e)})}_createRelationshipColumnFromElement(e){if(!this.relatedRecordsEnabled)return void this._logTemplateWarning("Relationship columns require related records to be enabled on the table.");const{element:t,index:i}=e,{description:s,label:l,relationshipId:o}=t,r=this.relationshipInfos.find(e=>e.relationshipId===o);if(!r)return this._logTemplateWarning("Unable to find valid related layer target based on the provided relationship id."),null;const{grid:n,messages:a,messagesCommon:h,messagesURIUtils:d,store:c,timeZone:p}=this;return new S({description:s,fieldName:`${H.uniqueColumnNames.relationship}-${o}-${i}`,grid:n,label:l,messages:a,messagesCommon:h,messagesURIUtils:d,relationshipId:o,store:c,tableTimeZone:p,layer:r.relatedLayer,relatedLayer:r.layer,showRelatedTableCallback:e=>this._onShowRelatedTable(e)})}_generateColumnsFromColumnTemplates(e){const{editingEnabled:t,grid:i,layer:s,messages:l,messagesCommon:o,messagesURIUtils:r,store:n,timeZone:a,view:h}=this;if(!e?.length||!s)return null;const d=[];return e.forEach((e,c)=>{const{autoWidth:p,description:m,direction:u,flexGrow:g,fieldName:b,formatFunction:y,frozen:f,frozenToEnd:_,icon:T,iconText:w,initialSortPriority:C,invalid:I,label:v,labelTooltipText:E,menuConfig:S,resizable:R,sortable:x,textAlign:O,textWrap:j,timeZone:V,type:z,width:W}=e;if(!z)return void this._logTemplateWarning("Property 'type' is missing from the provided template.");if(f&&_)return void this._logTemplateWarning("Properties 'frozen' and 'frozenToEnd' cannot both be true for the same column.");const L=!1===e.visible;if("group"===z){if(!e.columnTemplates?.length)return void this._logTemplateWarning("Group columns must contain column templates.");if(!e.label)return void this._logTemplateWarning("Group columns require a label.");const t=this._generateColumnsFromColumnTemplates(e.columnTemplates),s=L||this._isFieldHidden(e.label);d.push(new U({autoWidth:p,columns:t,description:m,flexGrow:g,frozen:f,frozenToEnd:_,grid:i,hidden:s,icon:T,iconText:w,invalid:I,label:v,labelTooltipText:E,menuConfig:S,messages:l,messagesCommon:o,messagesURIUtils:r,resizable:R,tableTimeZone:a,textAlign:O,textWrap:j,timeZone:V,width:W}))}else if("attachment"===z){if(!this.attachmentsEnabled)return void this._logTemplateWarning("Attachment columns require attachments to be enabled on the table.");d.push(this._generateAttachmentsColumnFromTemplate(e,c))}else if("relationship"===z){if(!this.relatedRecordsEnabled)return void this._logTemplateWarning("Relationship columns require related records to be enabled on the table.");const{relationshipId:t}=e;if(null==t)return void this._logTemplateWarning("Property 'relationshipId' is missing from the provided template.");const i=this.relationshipInfos.find(e=>e.relationshipId===t);if(!i)return void this._logTemplateWarning("Unable to find valid related layer target based on the provided relationship id.");d.push(this._generateRelationshipColumnFromTemplate(i,e,c))}else if(!b)return void this._logTemplateWarning("Value for 'fieldName' property was missing from the provided template.");const N=L||this._isFieldHidden(b);if("column"===z)d.push(new F({autoWidth:p,description:m,direction:u,fieldName:b,flexGrow:g,formatFunction:y,frozen:f,frozenToEnd:_,grid:i,hidden:N,icon:T,iconText:w,initialSortPriority:C,invalid:I,label:v,labelTooltipText:E,menuConfig:S,messages:l,messagesCommon:o,messagesURIUtils:r,resizable:R,sortable:x,tableTimeZone:a,textAlign:O,textWrap:j,timeZone:V,width:W}));else if("field"===z){const c=H.findField(s,e.fieldName);if(!c)return void this._logTemplateWarning("A valid 'field' could not be found for the provided template.");const{editable:b,required:F}=e;d.push(new A({autoWidth:p,description:m,direction:u,editable:b,field:c,fieldName:c.name,flexGrow:g,formatFunction:y,frozen:f,frozenToEnd:_,grid:i,hidden:N,icon:T,iconText:w,initialSortPriority:C,invalid:I,label:v,labelTooltipText:E,layer:s,messages:l,messagesCommon:o,messagesURIUtils:r,menuConfig:S,required:F,resizable:R,sortable:x,store:n,tableEditingEnabled:t,tableTimeZone:a,template:e,textAlign:O,textWrap:j,timeZone:V,width:W,view:h,onShowPromptCallback:this._onShowPromptCallback}))}}),d.length?d:null}_generateDefaultFieldColumns(){return this.layer?.fields?.map(e=>this._generateDefaultFieldColumn(e)).filter(i.isSome)??[]}_generateDefaultFieldColumn(e,t){const{editingEnabled:i,grid:s,layer:l,messages:o,messagesCommon:r,messagesURIUtils:n,store:a,timeZone:h,view:d}=this,c=t?.orderByFields;if(!e.visible||"geometry"===e.type)return null;const p=e.name,m=c?.findIndex(({field:e})=>e&&e===p)??-1,u=m>-1?c?.at(m)?.order:void 0,g=m>-1?m:void 0;return new A({direction:u,field:e,fieldName:p,grid:s,hidden:t?.hidden||this._isFieldHidden(p),initialSortPriority:g,layer:l,messages:o,messagesCommon:r,messagesURIUtils:n,store:a,tableEditingEnabled:i,tableTimeZone:h,view:d,onShowPromptCallback:this._onShowPromptCallback})}_generateAttachmentsColumnFromTemplate(e,t){const{grid:i,layer:s,messages:l,messagesCommon:o,messagesURIUtils:r,store:n,timeZone:a}=this,{attachmentsViewEnabled:h,autoWidth:d,description:c,flexGrow:p,fieldName:m,formatFunction:u,frozen:g,frozenToEnd:b,icon:y,iconText:f,invalid:_,label:T,labelTooltipText:w,menuConfig:C,resizable:I,textAlign:v,textWrap:A,thumbnailAppearance:S,thumbnailCount:F,thumbnailIconScale:R,thumbnailsEnabled:x,timeZone:U,width:O}=e;return new E({attachmentsViewEnabled:h,autoWidth:d,description:c,fieldName:`${H.uniqueColumnNames.attachments}-${t}`,flexGrow:p,formatFunction:u,frozen:g,frozenToEnd:b,grid:i,hidden:!1===e.visible||this._isFieldHidden(T)||this._isFieldHidden(m),icon:y,iconText:f,invalid:_,label:T,labelTooltipText:w,layer:s,menuConfig:C,messages:l,messagesCommon:o,messagesURIUtils:r,resizable:I,store:n,tableTimeZone:a,textAlign:v,textWrap:A,thumbnailAppearance:S,thumbnailCount:F,thumbnailIconScale:R,thumbnailsEnabled:x,timeZone:U,width:O,onShowAttachments:e=>this._onShowAttachments(e)})}_generateDefaultAttachmentsColumn(e){const{grid:t,layer:i,messages:s,messagesCommon:l,messagesURIUtils:o,store:r,timeZone:n}=this,a=H.uniqueColumnNames.attachments;return new E({fieldName:a,grid:t,hidden:e?.hidden||this._isFieldHidden(a),layer:i,messages:s,messagesCommon:l,messagesURIUtils:o,store:r,tableTimeZone:n,onShowAttachments:e=>this._onShowAttachments(e)})}_generateRelationshipColumnFromTemplate(e,t,i){const{grid:s,messages:l,messagesCommon:o,messagesURIUtils:r,store:n,timeZone:a}=this,{autoWidth:h,collapsed:d,description:c,flexGrow:p,fieldName:m,formatFunction:u,frozen:g,frozenToEnd:b,icon:y,iconText:f,invalid:_,label:T,labelTooltipText:w,menuConfig:C,relationshipId:I,resizable:v,textAlign:E,textWrap:A,timeZone:F,width:R}=t;return new S({autoWidth:h,collapsed:d,description:c,fieldName:`${H.uniqueColumnNames.relationship}-${I}-${i}`,flexGrow:p,formatFunction:u,frozen:g,frozenToEnd:b,grid:s,hidden:!1===t.visible||this._isFieldHidden(T)||this._isFieldHidden(m),icon:y,iconText:f,invalid:_,label:T,labelTooltipText:w,menuConfig:C,messages:l,messagesCommon:o,messagesURIUtils:r,relationshipId:I,resizable:v,store:n,tableTimeZone:a,textAlign:E,textWrap:A,timeZone:F,width:R,layer:e.relatedLayer,relatedLayer:e.layer,showRelatedTableCallback:e=>this._onShowRelatedTable(e)})}_generateDefaultRelationshipColumns(){const{relationshipInfos:e,relationshipColumnConfigs:t}=this,i=[];return e?.length?(t?t.forEach((t,s)=>{const{relationshipId:l}=t,o=e.find(e=>e.relationshipId===l);o&&i.push(this._generateDefaultRelationshipColumn({config:t,index:s,info:o}))}):e.forEach((e,t)=>i.push(this._generateDefaultRelationshipColumn({index:t,info:e}))),i):i}_generateDefaultRelationshipColumn(e){const{config:t,hidden:i,index:s,info:l}=e,{grid:o,messages:r,messagesCommon:n,messagesURIUtils:a}=this,{relationshipId:h}=l;return new S({...t,fieldName:`${H.uniqueColumnNames.relationship}-${h}-${s}`,grid:o,hidden:i,messages:r,messagesCommon:n,messagesURIUtils:a,layer:l.relatedLayer,relatedLayer:l.layer,relationshipId:h,showRelatedTableCallback:e=>this._onShowRelatedTable(e)})}_generateActionColumn(){return new v({hidden:this._isFieldHidden(H.uniqueColumnNames.action),...this.actionColumnConfig})}_isFieldHidden(e){const t=e?.toLowerCase();return(this.hiddenFields??this._defaultHiddenFields).some(e=>e.toLowerCase()===t)}_addTableHighlight(e){if(!this.highlightEnabled)return;const{_highlightableLayerView:t,layer:i}=this;if(t&&i){const s=this.store.getItemByObjectId(e),l=s?.feature??e;this._highlights.add(t.highlight(l,{name:w.defaultHighlightName}),H.getTableHighlightKey(i,e))}}_removeTableHighlight(e){const{layer:t}=this;t&&this._highlights.remove(H.getTableHighlightKey(t,e))}async _syncTemporaryHighlight(e,t){if(!this.highlightEnabled)return this._currentTemporaryHighlight?.handle.remove(),void(this._currentTemporaryHighlight=null);if(await d.after(25),d.throwIfAborted(t),!this._currentTemporaryHighlight&&!e)return;const{id:i}=this._currentTemporaryHighlight??{};if(i===e)return;this._currentTemporaryHighlight?.handle?.remove(),this._currentTemporaryHighlight=null;const{_highlightableLayerView:s,layer:l,highlightEnabled:o}=this;e&&s&&l&&o&&(this._currentTemporaryHighlight={id:e,handle:s.highlight(e,{name:w.temporaryHighlightName})})}_syncSelection(){this._highlights.removeAll(),this._tableHighlightsReady?this.highlightIds.forEach(e=>this._addTableHighlight(e)):this._viewSelectionReady&&(this.highlightIds.items=this._viewSelection)}_appendToViewSelection(e){const{_selectableLayer:t}=this;t&&this._selectionManager?.appendToSelection(t,e)}_removeFromViewSelection(e){const{_selectableLayer:t}=this;t&&this._selectionManager?.removeFromSelection(t,e)}async _onHighlightIdsChange(e){const{added:t,removed:i}=e,{attachmentsViewOptions:s}=this;if(this._tableHighlightsReady?(i.forEach(e=>this._removeTableHighlight(e)),t.forEach(e=>this._addTableHighlight(e))):this._viewSelectionReady&&(this._removeFromViewSelection(i),this._appendToViewSelection(t)),this.filterBySelectionEnabled&&this._syncObjectIdsWithStore(this.highlightIds.toArray()),null!=s.objectId){const e=this.highlightIds.at(0);if(null!=e){const t=await this.store.getAttachmentsByObjectId(e,!0);s.set({attachmentInfos:t,objectId:e,mode:t.length?"list":"file"})}}}_onShowRelatedTable(e){const{highlightIds:t}=this,{objectId:i}=e;t.removeAll(),t.add(i),this.showRelatedTableCallback?this.showRelatedTableCallback(e):this.emit("show-related-table",e)}_onObjectIdsChange(){const e=this.objectIds.toArray();e.length&&this.filterBySelectionEnabled&&(this.filterBySelectionEnabled=!1,this._logWarning("Object ID filter was applied while a selection filter was applied. Selection filter has been removed.")),this._syncObjectIdsWithStore(e)}_syncObjectIdsWithStore(e){this.store.objectIds=e,this.refreshPageCache()}_drainColumns(){this.columns.drain(e=>!e.destroyed&&e.destroy())}_showAllRelatedTables(e){const t=e.layer;if(!t)return;const i=this._getDefaultLayerDisplayField(t);e.set({relationshipColumnConfigs:[],tableTemplateOverride:this._getTableTemplateForShowAllTablesView(e,i)});const s=e.hiddenFields;s.includes(H.uniqueColumnNames.action)||s.add(H.uniqueColumnNames.action),s.includes(H.uniqueColumnNames.attachments)||s.add(H.uniqueColumnNames.attachments)}_hideAllRelatedTables(e){const{layer:t,relationship:i}=e;if(t&&null!=i?.id)if(null!=e.attachmentsViewOptions.objectId){const i=this._getDefaultLayerDisplayField(t);e.set({multipleSelectionEnabled:!1,relationshipColumnConfigs:[],showAllRelatedTables:!1,tableTemplateOverride:this._getTableTemplateForAttachmentsView(i)})}else e.set({multipleSelectionEnabled:!0,relationshipColumnConfigs:H.getRelationshipIdsToShow(t,i.id),showAllRelatedTables:!1,tableTemplateOverride:null}),e.hiddenFields.removeMany([H.uniqueColumnNames.action,H.uniqueColumnNames.attachments])}_getTableTemplateForRelatedTableView(e,t,i){return new P({columnTemplates:[new L({fieldName:t,editable:!1,menuConfig:{selectionMode:"single",icon:"chevron-down",items:this._extractFieldColumnInfosFromTableTemplate(e.viewModel).map(([s,l])=>({selected:s===t,label:l||s,clickFunction:()=>{e.tableTemplateOverride=this._getTableTemplateForRelatedTableView(e,s,i)}}))},resizable:!1}),new N({autoWidth:!1,collapsed:!0,flexGrow:0,label:"",resizable:!1,relationshipId:i,width:$})]})}_getTableTemplateForShowAllTablesView(e,t){const i=[new L({fieldName:t,editable:!1,menuConfig:{selectionMode:"single",icon:"chevron-down",items:this._extractFieldColumnInfosFromTableTemplate(e.viewModel).map(([i,s])=>({selected:i===t,label:s||i,clickFunction:()=>{e.tableTemplateOverride=this._getTableTemplateForShowAllTablesView(e,i)}}))},resizable:!1})];return null!=e.attachmentsViewOptions.objectId&&i.push(new O({attachmentsViewEnabled:!1,autoWidth:!1,flexGrow:0,label:"",resizable:!1,thumbnailsEnabled:!1,width:$})),new P({columnTemplates:i})}async _onShowPromptCallback(e){const{column:t,objectId:i,oldValue:s,value:l}=e,{_subtypes:o,layer:r}=this;if(!r||!o.length)return void t.cancel();const n=o.find(e=>e.code===l);if(!n)return void t.cancel();const a=d.createResolver(),h=this._createSubtypeEditPrompt(s,n,a),c=!!r.parent;try{this.showPrompt(h);const e=await a.promise,s=[{fieldName:t.fieldName,value:l}];switch(e){case"update-fields":for(const[e,t]of Object.entries(n.defaultValues))null!=t&&s.push({fieldName:e,value:t});await t.updateItems({objectId:i,updates:s}),c&&this.refresh();break;case"keep-existing":await t.updateItems({objectId:i,updates:s}),c&&this.refresh();break;case"undo":t.cancel()}}finally{this.clearPrompt()}}_createSubtypeEditPrompt(e,t,i){const{_subtypes:s,messages:l,messagesCommon:o}=this,r=s.find(t=>t.code===e)?.name??`${e}`;let n="update-fields";const a=[{label:l.subtypes.useDefaultValuesOption,value:"update-fields"},{label:l.subtypes.keepCurrentValuesOption,value:"keep-existing"}];return{context:"info",title:l.subtypes.changeWarningTitle,message:D.substitute(l.subtypes.changeWarning,{originalType:r,newType:t.name}),radios:a,defaultRadioSelection:"update-fields",onRadioSelection:e=>{n=e},actions:{primary:{label:o.apply,action:()=>i.resolve(n),type:"positive"},secondary:{label:o.cancel,type:"neutral",action:()=>i.resolve("undo")}},cancel:()=>i.reject()}}_onShowAttachments({objectId:e}){this.attachmentsViewOptions.objectId=e}_getTableTemplateForAttachmentsView(e){return new P({columnTemplates:[new L({fieldName:e,editable:!1,menuConfig:{selectionMode:"single",icon:"chevron-down",items:this._extractFieldColumnInfosFromTableTemplate(this).map(([t,i])=>({selected:t===e,label:i||t,clickFunction:()=>{this.tableTemplateOverride=this._getTableTemplateForAttachmentsView(t)}}))},resizable:!1}),new O({attachmentsViewEnabled:!1,autoWidth:!1,flexGrow:0,label:"",resizable:!1,thumbnailsEnabled:!1,width:$})]})}_extractFieldColumnInfosFromTableTemplate(e){const t=e??this,{layer:i,tableTemplate:s}=t;return s?s.columnTemplates.filter(({type:e})=>"field"===e||"column"===e).map(({fieldName:e,label:t})=>[e,t]):i?.fields.map(e=>[e.name,e.alias])??[]}_getDefaultLayerDisplayField(e){const{displayField:t,objectIdField:i}=e;return t&&""!==t.trim()?t:i||(e.fields.length?e.fields[0].name:"")}_getIndexOfFirstFrozenToEndColumn(){const e=this.columns.findIndex(e=>e.frozenToEnd);return e>-1?e:void 0}_logWarning(e,t){t?a.getLogger(this).warnOnce(e):a.getLogger(this).warn(e)}_logTemplateWarning(e){this._logWarning(`${e} Skipped generating a column using the provided template.`,!0)}_onCellInteraction(e){null!=e&&null!=this.attachmentsViewOptions.objectId&&this.highlightIds.add(e)}};return e.__decorate([m.property()],Q.prototype,"_defaultHiddenFields",null),e.__decorate([m.property()],Q.prototype,"_effectiveTableTemplate",null),e.__decorate([m.property()],Q.prototype,"_effectiveAttributeTableTemplate",null),e.__decorate([m.property()],Q.prototype,"_highlights",void 0),e.__decorate([m.property()],Q.prototype,"_highlightableLayerView",null),e.__decorate([m.property()],Q.prototype,"_selectionManager",null),e.__decorate([m.property()],Q.prototype,"_selectableLayer",null),e.__decorate([m.property()],Q.prototype,"_subtypes",null),e.__decorate([m.property()],Q.prototype,"_tableHighlightsReady",null),e.__decorate([m.property()],Q.prototype,"_viewSelection",null),e.__decorate([m.property()],Q.prototype,"_viewSelectionReady",null),e.__decorate([m.property()],Q.prototype,"activeFilters",null),e.__decorate([m.property({readOnly:!0})],Q.prototype,"activeSortOrders",null),e.__decorate([m.property()],Q.prototype,"allRelatedTablesVisible",null),e.__decorate([m.property()],Q.prototype,"attachmentsColumns",null),e.__decorate([m.property()],Q.prototype,"attachmentsEnabled",null),e.__decorate([m.property()],Q.prototype,"attachmentsViewOptions",void 0),e.__decorate([m.property({type:_})],Q.prototype,"attributeTableTemplate",void 0),e.__decorate([m.property()],Q.prototype,"autoRefreshEnabled",void 0),e.__decorate([m.property()],Q.prototype,"clearPrompt",null),e.__decorate([m.property({readOnly:!0})],Q.prototype,"columns",void 0),e.__decorate([m.property()],Q.prototype,"dataProvider",void 0),e.__decorate([m.property()],Q.prototype,"definitionExpression",null),e.__decorate([m.property()],Q.prototype,"fieldColumns",null),e.__decorate([m.property()],Q.prototype,"filterGeometry",null),e.__decorate([m.property()],Q.prototype,"filterBySelectionEnabled",null),e.__decorate([m.property({readOnly:!0})],Q.prototype,"grid",void 0),e.__decorate([m.property()],Q.prototype,"hiddenFields",null),e.__decorate([m.property()],Q.prototype,"highlightEnabled",void 0),e.__decorate([m.property()],Q.prototype,"initialSize",null),e.__decorate([m.property()],Q.prototype,"isQueryingOrSyncing",null),e.__decorate([m.property()],Q.prototype,"isSyncingAttachments",null),e.__decorate([m.property()],Q.prototype,"layer",null),e.__decorate([m.property()],Q.prototype,"layers",void 0),e.__decorate([m.property()],Q.prototype,"layerView",null),e.__decorate([m.property()],Q.prototype,"messages",void 0),e.__decorate([m.property(),k.messageBundle("esri/t9n/common")],Q.prototype,"messagesCommon",void 0),e.__decorate([m.property(),k.messageBundle("esri/core/t9n/Units")],Q.prototype,"messagesUnits",void 0),e.__decorate([m.property(),k.messageBundle("esri/widgets/support/t9n/uriUtils")],Q.prototype,"messagesURIUtils",void 0),e.__decorate([m.property()],Q.prototype,"outFields",null),e.__decorate([m.property()],Q.prototype,"prompt",void 0),e.__decorate([m.property()],Q.prototype,"relatedRecordsEnabled",null),e.__decorate([m.property()],Q.prototype,"relatedTable",null),e.__decorate([m.property()],Q.prototype,"relatedTables",void 0),e.__decorate([m.property()],Q.prototype,"relationship",null),e.__decorate([m.property()],Q.prototype,"relationshipColumnConfigs",void 0),e.__decorate([m.property()],Q.prototype,"relationshipColumns",null),e.__decorate([m.property()],Q.prototype,"relationshipConfig",null),e.__decorate([m.property()],Q.prototype,"relationshipInfos",null),e.__decorate([m.property()],Q.prototype,"relationships",null),e.__decorate([m.property()],Q.prototype,"returnGeometryEnabled",null),e.__decorate([m.property()],Q.prototype,"returnMEnabled",null),e.__decorate([m.property()],Q.prototype,"returnZEnabled",null),e.__decorate([m.property()],Q.prototype,"selectionSource",void 0),e.__decorate([m.property()],Q.prototype,"showAllRelatedTables",null),e.__decorate([m.property()],Q.prototype,"showPrompt",null),e.__decorate([m.property()],Q.prototype,"showRelatedTableCallback",void 0),e.__decorate([m.property({readOnly:!0,type:W})],Q.prototype,"store",void 0),e.__decorate([m.property()],Q.prototype,"supportsAttachments",null),e.__decorate([m.property()],Q.prototype,"supportsAddAttachments",null),e.__decorate([m.property()],Q.prototype,"supportsDeleteAttachments",null),e.__decorate([m.property()],Q.prototype,"supportsResizeAttachments",null),e.__decorate([m.property()],Q.prototype,"supportsUpdateAttachments",null),e.__decorate([m.property()],Q.prototype,"syncTemplateOnChangesEnabled",void 0),e.__decorate([m.property()],Q.prototype,"tableController",void 0),e.__decorate([m.property()],Q.prototype,"tableParent",void 0),e.__decorate([m.property({type:P})],Q.prototype,"tableTemplate",void 0),e.__decorate([m.property()],Q.prototype,"tableTemplateOverride",void 0),e.__decorate([m.property()],Q.prototype,"timeExtent",null),e.__decorate([m.property()],Q.prototype,"timeZone",null),e.__decorate([m.property()],Q.prototype,"view",null),Q=e.__decorate([g.subclass("esri.widgets.FeatureTable.FeatureTableViewModel")],Q),Q});