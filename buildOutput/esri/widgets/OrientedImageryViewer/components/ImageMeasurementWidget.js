// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","../../../chunks/tslib.es6","../../../core/unitUtils","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../Widget","../css","../mixins/TriangulatedImageMeasurementMixin","../../../chunks/componentsUtils","../../support/jsxFactory","../../support/UnitSelect","../../support/decorators/messageBundle"],function(e,t,a,s,n,r,c,i,l,u,o,m,g,d,h){"use strict";let p=class extends(o.TriangulatedImageMeasurementMixin(l)){constructor(e){super(e),this.messagesCommon=null}loadDependencies(){return m.loadCalciteComponents({action:()=>new Promise((t,a)=>e(["../../../chunks/index12"],t,a)),panel:()=>new Promise((t,a)=>e(["../../../chunks/index51"],t,a)).then(e=>e.index),button:()=>new Promise((t,a)=>e(["../../../chunks/index2"],t,a)),table:()=>new Promise((t,a)=>e(["../../../chunks/index39"],t,a)),icon:()=>new Promise((t,a)=>e(["../../../chunks/index7"],t,a)),"table-row":()=>new Promise((t,a)=>e(["../../../chunks/index42"],t,a)),"table-header":()=>new Promise((t,a)=>e(["../../../chunks/index41"],t,a)),"table-cell":()=>new Promise((t,a)=>e(["../../../chunks/index40"],t,a))})}get _measurementResult(){const{measurementType:e,oiViewModel:t}=this,{areaMeasurementResult:a,heightMeasurementResult:s,distanceMeasurementResult:n}=t;switch(e){case"area":return a;case"height":return s;case"distance":return n}}get _measurementAccuracy(){const{measurementType:e,oiViewModel:t}=this,{areaMeasurementAccuracy:a,heightMeasurementAccuracy:s,distanceAccuracyArray:n}=t;switch(e){case"area":return a;case"height":return s;case"distance":return n}}get _measurementUnit(){const{measurementType:e,pixelAreaMeasurementUnit:t,pixelMeasurementUnit:a}=this;return"area"===e?t:a}get _measurementUnitOptions(){const{measurementType:e}=this;return"area"===e?a.measurementAreaUnits:a.measurementLengthUnits}_convertedMeasurement(){const{measurementType:e}=this;switch(e){case"area":return this.getConvertedAreaString("measurement");case"height":return this.getConvertedHeightString("measurement");case"distance":return this.getConvertedDistanceString("measurement")}}_measurementUnitChangeHandler(e){const{measurementType:t}=this;"area"===t?this.pixelAreaMeasurementUnit=e:this.pixelMeasurementUnit=e}_renderUnitSelect(){const{_measurementUnit:e,_measurementResult:t,_measurementUnitOptions:a,oiViewModel:s,messagesCommon:n}=this,{triangularMeasurementActive:r}=s;return t?g.tsx("div",{class:u.css.measurementsBar},g.tsx(d.UnitSelect,{options:a,selectLabel:"",value:e,onChange:e=>this._measurementUnitChangeHandler(e)}),t?g.tsx("calcite-action",{bind:this,icon:"copy-to-clipboard",label:"copy",onclick:()=>this.copyActiveMeasurementResults(this.measurementType,r),scale:"s",text:"",title:n.copy}):null):null}_renderMeasurementResults(){const{_measurementResult:e,_measurementAccuracy:t,messages:a,measurementType:s}=this,{measurementTable:n,value:r,accuracy:c}=a;return e?g.tsx("calcite-table",{bordered:!0,caption:n,class:u.css.measurementsTable,scale:"s"},g.tsx("calcite-table-row",{slot:"table-header"},g.tsx("calcite-table-header",{alignment:"center",heading:r}),g.tsx("calcite-table-header",{alignment:"center",heading:c})),g.tsx("calcite-table-row",null,g.tsx("calcite-table-cell",{alignment:"center"},this._convertedMeasurement()),g.tsx("calcite-table-cell",{alignment:"center"},"distance"===s&&Array.isArray(t)&&t?.length||"area"===s&&t||"height"===s&&t?this.getAccuracy(this.measurementType):g.tsx("calcite-icon",{icon:"hourglass-active",scale:"s"})))):null}_renderActiveMeasurementResults(){const{oiViewModel:e}=this,{triangularMeasurementActive:t,measureType:a}=e;if(t)switch(a){case"area":return this._renderTriangularAreaMeasurementResults();case"distance":return this._renderTriangularDistanceMeasurementResults()}return this._renderMeasurementResults()}_renderNewMeasurementButton(){const{messages:e,measurementType:t}=this;return g.tsx("calcite-button",{class:u.css.measurementsButton,onclick:()=>this.oiViewModel.initializeMeasurement(t)},e.newMeasurement)}_renderStartMeasurementMessage(){const{oiViewModel:{displayNewMeasurementButton:e},messages:t,_measurementResult:a}=this;return!e&&!a&&g.tsx("div",{class:u.css.measurementDisplay,key:`start-measurement-${this.measurementType}`},t.startMeasurement)}_renderTriangularAreaMeasurementResults(){const{messages:e,oiViewModel:t}=this,{measurementTable:a,value:s,accuracy:n}=e,{triangulatedAreaMeasurement:r}=t;return r?g.tsx("calcite-table",{bordered:!0,caption:a,class:u.css.measurementsTable,scale:"s"},g.tsx("calcite-table-row",{slot:"table-header"},g.tsx("calcite-table-header",{alignment:"center",heading:s}),g.tsx("calcite-table-header",{alignment:"center",heading:n})),g.tsx("calcite-table-row",null,this._renderTriangularAreaCell("measurement"),this._renderTriangularAreaCell("accuracy"))):null}_renderTriangularDistanceAccuracyCell(){const{oiViewModel:e}=this,{triangulatedDistanceAccuracy:t}=e;return g.tsx("calcite-table-cell",{alignment:"center"},t?.distanceAccuracy?this.getConvertedTriangularDistanceMeasurementString(t.distanceAccuracy):g.tsx("calcite-icon",{icon:"hourglass-active",scale:"s"}))}_renderTriangularAreaCell(e){const{oiViewModel:t}=this,{triangulatedAreaMeasurement:a}=t;return g.tsx("calcite-table-cell",{alignment:"center"},a?this.getConvertedTriangularAreaString(e):g.tsx("calcite-icon",{icon:"hourglass-active",scale:"s"}))}_renderTriangularDistanceAngleAccuracyCell(){const{oiViewModel:e}=this,{triangulatedDistanceAccuracy:t}=e;return g.tsx("calcite-table-cell",{alignment:"center"},t?.angleAccuracy?this.getConvertedTriangularDistanceAngularResultsString(t.angleAccuracy):g.tsx("calcite-icon",{icon:"hourglass-active",scale:"s"}))}_renderTriangularDistanceMeasurementResults(){const{oiViewModel:e,messages:t}=this,{distance:a,horizontal:s,vertical:n,slope:r,aspect:c,measurementTable:i,value:l,accuracy:o}=t,{triangulatedDistanceMeasurement:m,triangularMeasurementActive:d,measureType:h}=e;return d&&"distance"===h&&m?g.tsx("calcite-table",{bordered:!0,caption:i,class:u.css.measurementsTable,scale:"s"},g.tsx("calcite-table-row",{slot:"table-header"},g.tsx("calcite-table-header",{alignment:"center",heading:"Type"}),g.tsx("calcite-table-header",{alignment:"center",heading:l}),g.tsx("calcite-table-header",{alignment:"center",heading:o})),g.tsx("calcite-table-row",null,g.tsx("calcite-table-cell",{alignment:"center"},a),g.tsx("calcite-table-cell",{alignment:"center"},m?.distance?this.getConvertedTriangularDistanceMeasurementString(m.distance):g.tsx("calcite-icon",{icon:"hourglass-active",scale:"s"})),this._renderTriangularDistanceAccuracyCell()),g.tsx("calcite-table-row",null,g.tsx("calcite-table-cell",{alignment:"center"},s),g.tsx("calcite-table-cell",{alignment:"center"},m?.horizontalDistance?this.getConvertedTriangularDistanceMeasurementString(m.horizontalDistance):g.tsx("calcite-icon",{icon:"hourglass-active",scale:"s"})),this._renderTriangularDistanceAccuracyCell()),g.tsx("calcite-table-row",null,g.tsx("calcite-table-cell",{alignment:"center"},n),g.tsx("calcite-table-cell",{alignment:"center"},m?.verticalDistance?this.getConvertedTriangularDistanceMeasurementString(m.verticalDistance):g.tsx("calcite-icon",{icon:"hourglass-active",scale:"s"})),this._renderTriangularDistanceAccuracyCell()),g.tsx("calcite-table-row",null,g.tsx("calcite-table-cell",{alignment:"center"},r),g.tsx("calcite-table-cell",{alignment:"center"},m?.slope?this.getConvertedTriangularDistanceAngularResultsString(m.slope):g.tsx("calcite-icon",{icon:"hourglass-active",scale:"s"})),this._renderTriangularDistanceAngleAccuracyCell()),g.tsx("calcite-table-row",null,g.tsx("calcite-table-cell",{alignment:"center"},c),g.tsx("calcite-table-cell",{alignment:"center"},m?.aspect?this.getConvertedTriangularDistanceAngularResultsString(m.aspect):g.tsx("calcite-icon",{icon:"hourglass-active",scale:"s"})),this._renderTriangularDistanceAngleAccuracyCell())):null}render(){return g.tsx("calcite-panel",{class:u.css.measurementResults,key:`measurement-result-container-${this.measurementType}`},this._renderStartMeasurementMessage(),this._renderNewMeasurementButton(),this._renderUnitSelect(),this._renderActiveMeasurementResults())}};return t.__decorate([s.property(),h.messageBundle("esri/t9n/common")],p.prototype,"messagesCommon",void 0),t.__decorate([s.property()],p.prototype,"_measurementResult",null),t.__decorate([s.property()],p.prototype,"_measurementAccuracy",null),t.__decorate([s.property()],p.prototype,"_measurementUnit",null),t.__decorate([s.property()],p.prototype,"_measurementUnitOptions",null),p=t.__decorate([i.subclass("esri.widgets.OrientedImageryViewer.components.ImageMeasurementWidget")],p),p});