// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","../chunks/tslib.es6","../assets","../core/deprecate","../core/Logger","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/has","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../support/basemapUtils","./Widget","./BasemapGallery/BasemapGalleryViewModel","./BasemapGallery/css","../chunks/componentsUtils","./support/globalCss","./support/Heading","./support/decorators/accessibleHandler","./support/decorators/messageBundle","./support/jsxFactory","./support/widgetUtils"],function(e,s,t,a,i,r,o,l,n,d,c,p,m,g,h,u,b,y,v,_,w){"use strict";let B=class extends p{constructor(e,s){super(e,s),this.disabled=!1,this.headingLevel=2,this.messages=null,this.viewModel=new m,this._focusBasemapItemEnabled=!1,a.deprecateWidget(i.getLogger(this),"Basemap Gallery","arcgis-basemap-gallery",{version:"4.32"})}initialize(){this.addHandles(r.when(()=>this.source,()=>this.viewModel.loadSource(),{sync:!0,initial:!0}))}loadDependencies(){return h.loadCalciteComponents({scrim:()=>new Promise((s,t)=>e(["../chunks/index10"],s,t)),chip:()=>new Promise((s,t)=>e(["../chunks/index11"],s,t))})}get activeBasemap(){return this.viewModel.activeBasemap}set activeBasemap(e){this.viewModel.activeBasemap=e}get icon(){return"basemap"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get source(){return this.viewModel.source}set source(e){this.viewModel.source=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e="loading"===this.source.state,s=this.disabled||"disabled"===this.viewModel.state,t={[g.css.sourceLoading]:e,[u.globalCss.disabled]:s};return _.tsx("div",{class:this.classes(g.css.base,u.globalCss.widget,u.globalCss.panel,t),key:"container"},this._getContext())}_getContext(){if("unsupported"===this.viewModel.state)return _.tsx("div",{class:u.globalCss.empty,key:"empty-message"},_.tsx(b.Heading,{level:this.headingLevel},this.messages.unsupported));if("loading"===this.source.state)return _.tsx("div",{class:g.css.loader,key:"loader"});const e=this.viewModel.items;return e.length>0?_.tsx("ul",{"aria-disabled":this.disabled,"aria-label":this.label,bind:this,class:g.css.itemContainer,key:"item-container",onkeydown:this._handleKeyDown,role:"radiogroup"},e.map((e,s)=>this._renderBasemapGalleryItem(e,s)).toArray()):_.tsx("div",{class:u.globalCss.empty,key:"empty-message"},_.tsx(b.Heading,{level:this.headingLevel},this.messages.noBasemaps))}_getRoundRobinIndex(e,s){return(e+s)%s}_handleKeyDown(e){const{key:s}=e;if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(s))return;e.preventDefault();const{items:t,activeBasemapIndex:a}=this.viewModel,i="ArrowUp"===s||"ArrowLeft"===s?this._getRoundRobinIndex(Math.max(a-1,-1),t.length):this._getRoundRobinIndex(a+1,t.length),r=t.at(i);"ready"===r?.state&&(this.viewModel.activeBasemap=r.basemap),this._focusBasemapItemEnabled=!0}_focusBasemapItem(e){this._focusBasemapItemEnabled&&0===e.tabIndex&&(e.focus(),this._focusBasemapItemEnabled=!1)}_handleClick(e){const s=e.currentTarget["data-item"];"ready"===s.state&&(this.viewModel.activeBasemap=s.basemap)}_renderBasemapGalleryItem(e,s){const a=c.getBasemapThumbnailUrl(e.basemap)||t.getAssetUrl("esri/themes/base/images/basemap-toggle-64.svg"),i=e.basemap.title,r=e.basemap.portalItem?.snippet,o=e.error?.message||r||i,{viewModel:{state:l,activeBasemapIndex:n}}=this,d=this.disabled||"disabled"===l,p=n===s,m=p||-1===n&&0===s?0:-1,h="loading"===l,b={[g.css.selectedItem]:p,[g.css.itemError]:"error"===e.state},y=`basemapgallery-item-${e.uid}`;return _.tsx("li",{afterUpdate:this._focusBasemapItem,"aria-checked":p.toString(),"aria-disabled":d.toString(),"aria-labelledby":y,bind:this,class:this.classes(g.css.item,b),"data-item":e,key:e.uid,onclick:this._handleClick,onkeydown:this._handleClick,role:"radio",tabIndex:m,title:o},_.tsx("img",{alt:"",class:g.css.itemThumbnail,src:a}),_.tsx("div",{class:g.css.itemContent,key:"content"},_.tsx("div",{class:g.css.itemTitle,key:"title"},_.tsx("span",{id:y},i)),c.isBasemap3D(e.basemap)?this._renderTags(e.basemap):null),"loading"===e.state||p&&h?_.tsx("calcite-scrim",null,_.tsx("span",{"aria-hidden":"true",class:u.globalCss.loaderAnimation,key:"loader",role:"presentation"})):null)}_renderTags(e){return _.tsx("div",{class:g.css.itemTagsContainer,key:"tag"},this._render3DTag(),c.isBasemapInBeta(e)?this._renderBetaTag():null)}_render3DTag(){const{messages:e}=this;return _.tsx("calcite-chip",{key:"tag-3d",label:e.tag3D,scale:"s"},this.messages.tag3D)}_renderBetaTag(){const{messages:e}=this;return _.tsx("calcite-chip",{appearance:"outline-fill",key:"tag-beta",label:e.tagBeta,scale:"s"},this.messages.tagBeta)}};return s.__decorate([o.property()],B.prototype,"activeBasemap",null),s.__decorate([o.property()],B.prototype,"disabled",void 0),s.__decorate([o.property()],B.prototype,"headingLevel",void 0),s.__decorate([o.property()],B.prototype,"icon",null),s.__decorate([o.property()],B.prototype,"label",null),s.__decorate([o.property(),v.messageBundle("esri/widgets/BasemapGallery/t9n/BasemapGallery")],B.prototype,"messages",void 0),s.__decorate([o.property()],B.prototype,"source",null),s.__decorate([o.property()],B.prototype,"view",null),s.__decorate([o.property()],B.prototype,"viewModel",void 0),s.__decorate([o.property()],B.prototype,"_focusBasemapItemEnabled",void 0),s.__decorate([y.accessibleHandler()],B.prototype,"_handleClick",null),B=s.__decorate([d.subclass("esri.widgets.BasemapGallery")],B),B});