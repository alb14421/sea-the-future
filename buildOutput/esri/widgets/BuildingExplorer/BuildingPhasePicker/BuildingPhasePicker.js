// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","../../../chunks/tslib.es6","../../../core/reactiveUtils","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../Widget","./css","../../../chunks/componentsUtils","../../support/globalCss","../../support/widgetUtils","../../support/jsxFactory"],function(e,s,t,r,o,i,n,a,c,h,l,u,p,d){"use strict";const _={nextPhase:"nextPhase",previousPhase:"previousPhase"};let P=class extends c{constructor(e,s){super(e,s),this._phasesContainer=null,this._shouldScrollCurrentPhaseIntoView=!0,this._shouldFocusCurrentPhase=!1,this._onKeyDown=e=>{const{vm:s}=this;switch(e.key){case"ArrowDown":case"ArrowLeft":e.stopPropagation(),e.preventDefault(),s.previous(),this._shouldFocusCurrentPhase=!0;break;case"ArrowUp":case"ArrowRight":e.stopPropagation(),e.preventDefault(),s.next(),this._shouldFocusCurrentPhase=!0}},this._onArrowLeftClick=()=>{this.vm.previous()},this._onArrowRightClick=()=>{this.vm.next()},this._onPhasesContainerAfterCreate=e=>{this._phasesContainer=e,requestAnimationFrame(this._scrollOrFocusPhase)},this._scrollOrFocusPhase=()=>{const e=this._phasesContainer;if(this.destroyed||null==e)return;const s=e.querySelector(`.${h.css.phaseCurrent}`);if(s){if(this._shouldScrollCurrentPhaseIntoView){const t=e.offsetWidth,r=s.offsetLeft,o=s.offsetWidth;e.scrollLeft=-t/2+r+o/2,this._shouldScrollCurrentPhaseIntoView=!1}this._shouldFocusCurrentPhase&&(s.focus(),this._shouldFocusCurrentPhase=!1)}}}loadDependencies(){return l.loadCalciteComponents({action:()=>new Promise((s,t)=>e(["../../../chunks/index12"],s,t))})}initialize(){this.addHandles([t.watch(()=>[this._currentPhase,this._phasesContainer,this.container],()=>{this._shouldScrollCurrentPhaseIntoView=!0,requestAnimationFrame(this._scrollOrFocusPhase)},t.initial),t.watch(()=>({container:this.container,numPhases:this._phases.length}),({container:e,numPhases:s})=>{e&&e.style.setProperty("--num-phases",String(s))},t.initial)])}get _phases(){return this.vm.allowedValues}get _currentPhase(){const{vm:e}=this;return e.enabled?e.value:null}render(){if(this._phases.length<2)return d.tsx("div",{key:"no-phases"});const{vm:e,messages:s}=this,{previousPhase:t,nextPhase:r}=s??_;return d.tsx("div",{class:this.classes(u.globalCss.widget,h.css.base),key:this,onkeydown:this._onKeyDown},v({className:h.css.arrowLeft,disabled:!e.hasPrevious,icon:"chevron-left",onClick:this._onArrowLeftClick,text:t}),d.tsx("div",{afterCreate:this._onPhasesContainerAfterCreate,class:h.css.phasesContainer},this._renderPhaseButtons()),v({className:h.css.arrowRight,disabled:!e.hasNext,icon:"chevron-right",onClick:this._onArrowRightClick,text:r}))}_renderPhaseButtons(){const e=this._phases,s=this._currentPhase,t=[];for(let r=0;r<e.length;++r){const o=e[r],i={phase:o,active:null!=s&&o<=s,current:null!=s&&o===s};r>0&&t.push(this._renderDivider(i)),t.push(this._renderPhaseButton(i))}return t}_renderPhaseButton({phase:e,active:s,current:t}){const{vm:r}=this,o=r.getValueLabel(e);return d.tsx("button",{"aria-label":o,class:this.classes(h.css.phase,{[h.css.phaseActive]:s,[h.css.phaseCurrent]:t}),key:`phase-${e}`,onclick:()=>r.select(e),title:o,type:"button"},e)}_renderDivider({phase:e,active:s}){return d.tsx("div",{class:this.classes(h.css.divider,{[h.css.dividerActive]:s}),key:`phase-divider-${e}`})}};function v(e){return d.tsx("calcite-action",{appearance:"transparent",class:e.className,disabled:e.disabled,icon:e.icon,iconFlipRtl:!0,key:e.className,onclick:e.onClick,scale:"s",text:e.text,textEnabled:!1,title:e.text})}return s.__decorate([r.property({nonNullable:!0})],P.prototype,"vm",void 0),s.__decorate([r.property()],P.prototype,"messages",void 0),s.__decorate([r.property()],P.prototype,"_phases",null),s.__decorate([r.property()],P.prototype,"_currentPhase",null),s.__decorate([r.property()],P.prototype,"_phasesContainer",void 0),P=s.__decorate([a.subclass("esri.widgets.BuildingExplorer.BuildingPhasePicker.BuildingPhasePicker")],P),P});