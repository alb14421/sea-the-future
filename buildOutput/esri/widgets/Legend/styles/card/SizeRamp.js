// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../../chunks/tslib.es6","../../../../core/screenUtils","../../../../core/accessorSupport/decorators/property","../../../../core/has","../../../../core/Logger","../../../../core/RandomLCG","../../../../core/accessorSupport/decorators/subclass","../../../Widget","./css","../support/sizeRampUtils","../../support/styleUtils","../../../support/widgetUtils","../../../support/jsxFactory"],function(e,t,s,r,i,o,n,a,l,c,d,p,u,y){"use strict";const m=window.devicePixelRatio;return e.default=class extends l{constructor(e,t){super(e,t),this.hasIndicators=!1,this.legendElement=null,this.opacity=1}render(){if("spike"===this.legendElement.theme)return y.tsx("div",{styles:{display:"flex",flex:"1",justifyContent:"center"}},d.renderSpikeRamp(this.legendElement));const{legendElement:e,hasIndicators:t,opacity:s}=this,r=e.infos,i=r.at(0),o=r.at(-1);if(!i||!o)return null;const{label:n,...a}=i,{label:l,...u}=o;let m=a.preview,f=u.preview;const h={"flex-direction":t?"column":"row-reverse"};if(!m||!f)return null;m=m.cloneNode(!0),m.style.display="flex",f=f.cloneNode(!0),f.style.display="flex";const x={opacity:`${s??""}`};return y.tsx("div",{class:this.classes(c.css.layerRow,{[c.css.sizeRampRow]:t})},y.tsx("div",{class:c.css.rampLabel},t?n:l),y.tsx("div",{class:c.css.sizeRampContainer,styles:h},y.tsx("div",{afterCreate:p.attachToNode,bind:m,class:c.css.sizeRampPreview,styles:x}),this._renderSizeRampLines(e),y.tsx("div",{afterCreate:p.attachToNode,bind:f,class:c.css.sizeRampPreview,styles:x})),y.tsx("div",{class:c.css.rampLabel},t?l:n))}_renderSizeRampLines(e){const t=e.infos,r=t.at(0),i=t.at(-1);if(!r||!i)return null;const o=r.symbol,n=this.hasIndicators,a=r.size&&"number"==typeof r.size?r.size:0,l=i.size&&"number"==typeof i.size?i.size:0,c=r.outlineSize||0,d=i.outlineSize||0,u=s.pt2px(a+c)*m,f=s.pt2px(l+d)*m,h=n?u:u+50*m,x=n?u/2+50*m:u,g=function(e){if(e){if(e.type.includes("3d")){if(!e.symbolLayers?.length)return;const t=e.symbolLayers.at(-1),s=t?.resource?.primitive;return"triangle"===s||"cone"===s||"tetrahedron"===s}return"triangle"===e.style}}(o),v=function(e){if(!e)return;if(e.type.includes("3d")){if(!e.symbolLayers?.length)return;const t=e.symbolLayers.at(-1),s=t.resource?.primitive;return"circle"===s||"cross"===s||"kite"===s||"sphere"===s||"cube"===s||"diamond"===s}const t=e.style;return"circle"===t||"diamond"===t||"cross"===t}(o),b=document.createElement("canvas");b.width=h,b.height=x,b.style.width=b.width/m+"px",b.style.height=b.height/m+"px";const z=b.getContext("2d");if(n){z.beginPath();const e=0,t=0,s=h/2-f/2,r=x;z.moveTo(e,t),z.lineTo(s,r);const i=h,o=0,n=h/2+f/2,a=x;z.moveTo(i,o),z.lineTo(n,a)}else{z.beginPath();const e=0,t=x/2-f/2,s=h,r=0;z.moveTo(e,t),z.lineTo(s,r);const i=0,o=x/2+f/2,n=h,a=x;z.moveTo(i,o),z.lineTo(n,a)}return z.strokeStyle="#ddd",z.stroke(),y.tsx("div",{afterCreate:p.attachToNode,bind:b,styles:n?{display:"flex",marginTop:`-${g?0:v?u/2:0}px`,marginBottom:`-${g?f:v?f/2:0}px`}:{display:"flex",marginRight:`-${g?0:v?u/2:0}px`,marginLeft:`-${g?0:v?f/2:0}px`}})}},t.__decorate([r.property()],e.default.prototype,"hasIndicators",void 0),t.__decorate([r.property()],e.default.prototype,"legendElement",void 0),t.__decorate([r.property()],e.default.prototype,"messages",void 0),t.__decorate([r.property()],e.default.prototype,"opacity",void 0),e.default=t.__decorate([a.subclass("esri.widgets.Legend.styles.card.SizeRamp")],e.default),e.default});