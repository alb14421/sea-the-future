// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../Color","../../../core/arrayUtils","./utils"],function(l,e,o,t,n){"use strict";const r=new o([64,64,64]);function a(l,e){const o=[],t=l.length-1;return 5===l.length?o.push(0,2,4):o.push(0,t),l.map((l,r)=>o.includes(r)?n.createStopLabel(l,r,t,e):null)}function u(l,e){const{startIndex:t,endIndex:n,weight:r}=function(l,e){let o=0,t=e.length-1;return e.some((e,n)=>l<e.value?(t=n,!0):(o=n,!1)),{startIndex:o,endIndex:t,weight:(l-e[o].value)/(e[t].value-e[o].value)}}(l,e);if(t===n)return e[t].color;const a=o.blendColors(e[t].color,e[n].color,r);return new o(a)}e.getColorFromPointCloudStops=u,e.getRampStops=async function(e,n,u){let s=!1,i=[],c=[];if(e.stops){const l=e.stops;i=l.map(l=>l.value),s=l.some(l=>!!l.label),s&&(c=l.map(l=>l.label))}const p=i[0],m=i[i.length-1];if(null==p&&null==m)return null;const v=s?null:a(i,u);return(await Promise.all(i.map(async(t,a)=>{const u="opacity"===e.type?await async function(e,t,n){const a=new o(n??r),u=(await new Promise((e,o)=>l(["../../../renderers/visualVariables/support/visualVariableUtils"],e,o))).getOpacity(t,e);return null!=u&&(a.a=u),a}(t,e,n):(await new Promise((e,o)=>l(["../../../renderers/visualVariables/support/visualVariableUtils"],e,o))).getColor(e,t),i=s?c[a]:v?.[a]??"";return null==u?null:{value:t,color:u,label:i}}))).filter(t.isSome).reverse()},e.getRampStopsForPointCloud=function(l){let e=!1,o=[],t=[];o=l.map(l=>l.value),e=l.some(l=>!!l.label),e&&(t=l.map(l=>l.label??""));const n=o[0],r=o[o.length-1];if(null==n&&null==r)return null;const s=e?null:a(o);return o.map((o,n)=>({value:o,color:u(o,l),label:e?t[n]:s?.[n]??""})).reverse()},e.getStretchRampStops=function(l,e){let t=[];if(l&&"multipart"===l.type)l.colorRamps.reverse().forEach((n,r)=>{0===r?t.push({value:e.max,color:new o(n.toColor),label:"high"}):t.push({value:null,color:new o(n.toColor),label:""}),r===l.colorRamps.length-1?t.push({value:e.min,color:new o(n.fromColor),label:"low"}):t.push({value:null,color:new o(n.fromColor),label:""})});else{let n,r;l&&"algorithmic"===l.type?(n=l.fromColor,r=l.toColor):(n=[0,0,0,1],r=[255,255,255,1]),t=[{value:e.max,color:new o(r),label:"high"},{value:e.min,color:new o(n),label:"low"}]}return t},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});