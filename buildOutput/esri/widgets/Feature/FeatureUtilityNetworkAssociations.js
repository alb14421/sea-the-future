// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../../chunks/tslib.es6","../../core/maybe","../../core/reactiveUtils","../../core/string","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../Widget","./FeatureUtilityNetworkAssociations/VisibleElements","./support/FeatureElementInfo","../../chunks/componentsUtils","../support/globalCss","../support/widgetUtils","../support/decorators/messageBundle","../support/jsxFactory","../support/UtilityNetworkAssociations/FeatureUtilityNetworkAssociationsViewModel"],function(e,t,i,s,o,n,r,a,l,c,d,p,u,y,h,_,m,g,f,v){"use strict";const w="esri-feature-utility-network-associations",k=`${w}__loading-container`,C={base:w,listContainer:`${w}__list`,loadingContainer:k,loadingContainerSticky:`${k}--sticky`};return t.default=class extends p{constructor(e,t){super(e,t),this._featureElementInfo=null,this.onSelectAssociationType=()=>{},this.flowType="feature-utility-network-associations",this.flowItems=null,this.parentFeatureViewModel=null,this.headingLevel=5,this.viewModel=new v,this.messages=null,this.messagesCommon=null,this.visibleElements=new u}initialize(){this._featureElementInfo=new y,this.addHandles([o.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),o.initial)])}loadDependencies(){return h.loadCalciteComponents({icon:()=>new Promise((t,i)=>e(["../../chunks/index7"],t,i)),list:()=>new Promise((t,i)=>e(["../../chunks/index16"],t,i)),"list-item":()=>new Promise((t,i)=>e(["../../chunks/index20"],t,i)),loader:()=>new Promise((t,i)=>e(["../../chunks/index32"],t,i)),notice:()=>new Promise((t,i)=>e(["../../chunks/index6"],t,i))})}destroy(){this._featureElementInfo=s.destroyMaybe(this._featureElementInfo)}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){const{state:e}=this.viewModel;return f.tsx("div",{class:this.classes(C.base,_.globalCss.widget)},this._featureElementInfo?.render(),"loading"===e?this._renderLoading():"disabled"===e?this._renderAssociationNotFound():this._renderContent())}_renderStickyLoading(){return"querying"===this.viewModel.state?f.tsx("div",{class:C.loadingContainerSticky,key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return f.tsx("calcite-loader",{inline:!0,label:this.messagesCommon.loading})}_renderLoading(){return f.tsx("div",{class:C.loadingContainer,key:"loading-container"},this._renderLoadingIcon())}_renderAssociationNotFound(){return f.tsx("calcite-notice",{icon:"information",key:"association-not-found",kind:"info",open:!0,scale:"s",width:"full"},f.tsx("div",{slot:"message"},this.messages?.noAssociations))}_renderAssociationType(e){const{viewModel:t}=this,i=this._getAssociationTypeTitle(e);return f.tsx("calcite-list-item",{description:n.stripHTML(e.description),key:`association-type-${e.type}`,label:n.stripHTML(i),value:e.type,onCalciteListItemSelect:()=>this.onSelectAssociationType({viewModel:t,listType:e,title:i})},f.tsx("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderAssociations(e){const{viewModel:t}=this;return"featureForm"===t.source||t.getFeatureCountForAssociationType(e.type)>0?this._renderAssociationType(e):void 0}_renderContent(){const{messages:e,viewModel:t}=this,{state:i,associationTypes:s}=t;return f.tsx("div",{class:C.listContainer,key:"list-container"},"ready"===i?f.tsx("div",null,f.tsx("calcite-list",{displayMode:"flat",label:e?.associationsList},s.map(e=>this._renderAssociations(e)))):null,this._renderStickyLoading())}_getAssociationTypeTitle(e){const{messages:t}=this;if(e.title)return e.title;switch(e.type){case"attachment":return t.associationsAttachments;case"connectivity":return t.associationsConnectivity;case"structure":return t.associationsStructure;case"content":return t.associationsContents;case"container":return t.associationsContainer}}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,i=t.description&&this.description,s=t.title&&this.title;this._featureElementInfo?.set({description:i,title:s,headingLevel:e})}},i.__decorate([r.property({constructOnly:!0})],t.default.prototype,"onSelectAssociationType",void 0),i.__decorate([r.property()],t.default.prototype,"flowType",void 0),i.__decorate([r.property()],t.default.prototype,"flowItems",void 0),i.__decorate([r.property()],t.default.prototype,"parentFeatureViewModel",void 0),i.__decorate([r.property()],t.default.prototype,"featureVisibleElements",void 0),i.__decorate([r.property()],t.default.prototype,"description",null),i.__decorate([r.property()],t.default.prototype,"headingLevel",void 0),i.__decorate([r.property()],t.default.prototype,"title",null),i.__decorate([r.property({type:v})],t.default.prototype,"viewModel",void 0),i.__decorate([r.property(),g.messageBundle("esri/widgets/Feature/t9n/Feature")],t.default.prototype,"messages",void 0),i.__decorate([r.property(),g.messageBundle("esri/t9n/common")],t.default.prototype,"messagesCommon",void 0),i.__decorate([r.property({type:u,nonNullable:!0})],t.default.prototype,"visibleElements",void 0),t.default=i.__decorate([d.subclass("esri.widgets.Feature.FeatureUtilityNetworkAssociations")],t.default),t.default});