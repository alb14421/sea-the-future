// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/LayerList/css":function(){define(["exports"],function(e){"use strict";const t="esri-layer-list",i=`${t}__item`,r={base:t,actionMenu:`${t}__action-menu`,actionGroup:`${t}__action-group`,filterNoResults:`${t}__filter-no-results`,item:i,itemActive:`${i}--active`,itemContentBottom:`${i}-content-bottom`,itemMessage:`${i}-message`,itemActionIcon:`${i}-action-icon`,itemActionImage:`${i}-action-image`,itemTemporaryIcon:`${i}-temporary-icon`,itemTableIcon:`${i}-table-icon`,itemCatalogIcon:`${i}-catalog-icon`,statusIndicator:`${t}__status-indicator`,publishing:`${t}__publishing`,updating:`${t}__updating`,connectionStatus:`${t}__connection-status`,connectionStatusConnected:`${t}__connection-status--connected`,visibleToggle:`${t}__visible-toggle`,visibleIcon:`${t}__visible-icon`};e.css=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListItem":function(){define(["require","../../chunks/tslib.es6","../../intl","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../layers/catalog/catalogUtils","../../support/actions/actionUtils","../Widget","./support/layerListUtils","../../chunks/componentsUtils","../support/jsxFactory","../support/widgetUtils","../../intl/substitute"],function(e,t,i,r,o,s,n,a,l,c,d,p,y,u,h,_){"use strict";var m;let g=class extends d{static{m=this}constructor(e){super(e),this.dragEnabled=!1,this.listModeDisabled=!1,this.parent=null,this.parentTitles=null,this.viewModel=null,this._onActionMenuOpen=e=>{this.item.actionsOpen=e.currentTarget.open},this._setTooltipReference=e=>{this.onTooltipReferenceChange?.(this.item.layer?.uid,e)},this._removeTooltipReference=()=>{this.onTooltipReferenceChange?.(this.item.layer?.uid,null)}}loadDependencies(){return y.loadCalciteComponents({"action-group":()=>new Promise((t,i)=>e(["../../chunks/index18"],t,i)).then(e=>e.index),"action-menu":()=>new Promise((t,i)=>e(["../../chunks/index19"],t,i)).then(e=>e.index),action:()=>new Promise((t,i)=>e(["../../chunks/index12"],t,i)),icon:()=>new Promise((t,i)=>e(["../../chunks/index7"],t,i)),"list-item":()=>new Promise((t,i)=>e(["../../chunks/index20"],t,i)),list:()=>new Promise((t,i)=>e(["../../chunks/index16"],t,i)),notice:()=>new Promise((t,i)=>e(["../../chunks/index6"],t,i))})}static{this.vnodeSelector="calcite-list-item"}render(){const e=this.parentTitles??[],{_title:t,item:i,activeItem:r,selectionMode:o,selectedItems:s,messages:n,parent:a,css:l,dragDisabled:c}=this,d="visibleAtCurrentTimeExtent"in i&&"layerInvisibleAtTime"in n&&!i.visibleAtCurrentTimeExtent?`${t} (${n.layerInvisibleAtTime})`:"visibleAtCurrentScale"in i&&"layerInvisibleAtScale"in n&&!i.visibleAtCurrentScale?`${t} (${n.layerInvisibleAtScale})`:t,p="parent"in i&&"catalog"===i.parent?.layer?.type,{layer:y}=i,h="visibleAtCurrentScale"in i&&!i.visibleAtCurrentScale||"visibleAtCurrentTimeExtent"in i&&!i.visibleAtCurrentTimeExtent;return u.tsx("calcite-list-item",{afterCreate:e=>this._focusSelectedDragEl(e,i),afterUpdate:e=>this._focusSelectedDragEl(e,i),class:this.classes(l.item,"itemActive"in l&&{[l.itemActive]:r===i}),"data-item":i,"data-layer-id":y?.id,dragDisabled:!i.sortable||p||c,expanded:"open"in i&&i.open,id:y?.uid,key:`list-item-${y?.uid}`,label:t,metadata:{parentTitles:e,_title:t},selected:"none"!==o&&s.includes(i),title:d,unavailable:h,value:y?.uid,onCalciteListItemSelect:e=>"visible"in i&&this._handleCalciteListItemSelect(e,i,a),onCalciteListItemToggle:e=>"open"in i&&this._handleCalciteListItemToggle(e,i)},this._renderedCatalogFootprintIcon,this._renderedCatalogDynamicIcon,this._renderedItemStatus,this._renderedItemToggle,this._renderedCatalogSelectNode,this._renderedItemTemporaryIcon,this._renderedChildList,this._renderedItemMessage,this._renderedPanel,this._renderedPanelAction,this._renderedActions)}get _title(){const{messages:e}=this;return this.item.title||("untitledTable"in e?e.untitledTable:e.untitledLayer)}get _renderedItemStatus(){const{item:e,parent:t,visibleElements:i,css:r}=this;if(!i.statusIndicators)return null;const{publishing:o}=e,s="updating"in e&&e.updating&&!t,n="connectionStatus"in e?e.connectionStatus:void 0,a=!!n;return u.tsx("calcite-icon",{class:this.classes(r.statusIndicator,{[r.publishing]:o},"updating"in r&&{[r.updating]:s},"connectionStatus"in r&&{[r.connectionStatus]:a},"connectionStatusConnected"in r&&{[r.connectionStatusConnected]:a&&"connected"===n}),icon:p.getStatusIcon({connectionStatus:n,publishing:o}),key:"layer-item-status",scale:"s",slot:"content-end"})}get _renderedItemTemporaryIcon(){const{item:e,visibleElements:t,css:i}=this,{layer:r}=e,o="temporaryLayerIndicators"in t&&t.temporaryLayerIndicators,s="temporaryTableIndicators"in t&&t.temporaryTableIndicators,n=r&&"persistenceEnabled"in r&&(l.isLayerFromCatalog(r)||!r.persistenceEnabled);return(o||s)&&n?u.tsx("calcite-icon",{class:i.itemTemporaryIcon,icon:"temporary",key:"temporary-icon",scale:"s",slot:"content-start",title:this.messages.temporary}):null}get _renderedItemToggle(){const{_title:e,item:t,parent:i,messages:r,visibilityAppearance:o,css:s}=this;if(!("visible"in t&&"layerVisibility"in r&&"showLayer"in r&&"hideLayer"in r&&"visibleToggle"in s&&o))return null;const{visible:n}=t,a=this._getParentVisibilityMode(i);if("inherited"===a)return null;const l=p.getVisibilityIcon({visible:n,exclusive:"exclusive"===a,visibilityAppearance:o}),c="checkbox"===o,d=r.layerVisibility,y=_.substitute(n?r.hideLayer:r.showLayer,{layerName:e});return u.tsx("calcite-action",{appearance:"transparent",class:s.visibleToggle,icon:c?l:void 0,key:"visibility-toggle",label:y,onclick:()=>this._toggleVisibility(t,i),scale:"s",slot:c?"actions-start":"actions-end",text:d,title:y},c?null:u.tsx("calcite-icon",{class:this.classes({[s.visibleIcon]:"exclusive"!==a&&n}),icon:l,scale:"s"}))}get _renderedPanel(){const{panel:e}=this.item;return!e?.open||e.disabled||e.flowEnabled?null:u.tsx("div",{class:this.css.itemContentBottom,key:`content-panel-${e.uid}`,slot:"content-bottom"},e.render())}get _renderedPanelAction(){const{panel:e}=this.item;if(!e?.visible)return null;const{open:t,title:i,disabled:r}=e;return u.tsx("calcite-action",{active:t,appearance:"transparent",disabled:r,icon:c.getActionIcon(e),key:`action-${e.uid}`,onclick:()=>this._togglePanel(e),scale:"s",slot:"actions-end",text:i??"",title:i??void 0},this._renderFallbackIcon(e))}get _renderedActions(){switch(this._actionsCount){case 0:return null;case 1:return this._singleAction;default:return this._renderedActionMenu}}get _renderedActionMenu(){const{item:e,messagesCommon:t}=this,i=t.options;return u.tsx("calcite-action-menu",{appearance:"transparent",key:"item-action-menu",label:t.menu,open:e.actionsOpen,overlayPositioning:"fixed",placement:"bottom-end",scale:"s",slot:"actions-end",onCalciteActionMenuOpen:this._onActionMenuOpen},u.tsx("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:"s",slot:"trigger",text:i,title:i}),this._renderedActionMenuContent)}get _renderedActionMenuContent(){return this._filteredSections.toArray().map(e=>u.tsx("calcite-action-group",{key:`action-section-${e.uid}`},e.toArray().map(e=>this._renderAction({action:e,textEnabled:!0}))))}get _renderedCatalogFootprintIcon(){const{css:e}=this,t=this.item.layer,i="catalog-footprint"===t?.type,r="sublayer"===t?.type&&l.isCatalogSublayer(t,"footprints");return"itemCatalogIcon"in e&&(i||r)?u.tsx("calcite-icon",{class:e.itemCatalogIcon,icon:"footprint",key:"footprint",scale:"s",slot:"content-start"}):null}get _renderedCatalogDynamicIcon(){const{css:e}=this,t=this.item.layer,i="catalog-dynamic-group"===t?.type,r="sublayer"===t?.type&&l.isCatalogSublayer(t,"layers-in-view");return"itemCatalogIcon"in e&&(i||r)?u.tsx("calcite-icon",{class:e.itemCatalogIcon,icon:"catalog-dataset",key:"catalog-dataset",scale:"s",slot:"content-start"}):null}get _renderedCatalogSelectNode(){const{_title:e,item:t,visibleElements:i}=this;if(!("visible"in t))return;const{layer:r}=t,o="catalog-dynamic-group"===r?.type;return"catalogLayerList"in i&&i.catalogLayerList&&o?u.tsx("calcite-action",{appearance:"transparent",disabled:!r.visible,icon:"chevron-right",iconFlipRtl:!0,onclick:()=>this._triggerOnCatalogOpen(t),scale:"s",slot:"actions-end",text:e}):null}get _renderedChildList(){const{dragEnabled:e,item:t,rootGroupUid:i,listModeDisabled:r,selectionMode:o,displayMode:s}=this;if(!("children"in t))return;const n=[...this.parentTitles??[],t.title],{children:a,layer:l}=t,c="catalog-dynamic-group"!==l?.type&&p.listItemHasChildren(t),d=!r&&p.areChildrenHidden(l),y="group"===l?.type,h=!d&&!c&&e&&y,_=!!e&&"childrenSortable"in t&&t.childrenSortable&&p.canSortSublayers(t);return c||h?u.tsx("calcite-list",{canPull:e=>!!this.canMove&&this.canMove(e,"pull"),canPut:e=>!!this.canMove&&this.canMove(e,"put"),"data-item":t,"data-layer-type":i,displayMode:s,dragEnabled:_,group:y?i:`${i}-${l?.uid}`,key:`child-list-${l?.uid}`,label:t.title,selectionAppearance:"border",selectionMode:o},a?.filter(e=>!e.hidden&&(this.visibleElements.errors||!e.error)).toArray().map(e=>this._renderItem(e,t,n)),this._renderedTablesItem):null}get _hasTables(){const{layerTablesEnabled:e}=this,t=this.item.layer;if(!e||!t)return!1;switch(t.type){case"knowledge-graph":return e.includes(t.type)&&"tables"in t&&!!t.tables?.length;case"map-image":case"tile":return e.includes(t.type)&&"subtables"in t&&!!t.subtables?.length;default:return!1}}get _renderedTablesItem(){const{item:e,messages:t,css:i}=this,{layer:r}=e;return"itemTableIcon"in i&&"visible"in e&&"tables"in t&&this._hasTables?u.tsx("calcite-list-item",{class:i.item,"data-layer-id":r?.id,dragDisabled:!0,key:`list-item-table-list-tables-${r?.uid}`,label:t.tables,title:t.tables,onCalciteListItemSelect:()=>this._triggerOnTablesOpen(e)},u.tsx("calcite-icon",{class:i.itemTableIcon,icon:"table",scale:"s",slot:"content-start"}),u.tsx("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"})):null}get _renderedItemMessage(){const{item:e,messages:t,css:i}=this;return e.error?u.tsx("div",{class:i.itemMessage,key:"esri-layer-list__error",slot:"content-bottom"},u.tsx("calcite-notice",{icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",width:"full"},u.tsx("div",{slot:"message"},"tableError"in t?t.tableError:t.layerError))):"incompatible"in e&&e.incompatible&&"layerIncompatible"in t?u.tsx("div",{class:i.itemMessage,key:"esri-layer-list__incompatible",slot:"content-bottom"},u.tsx("calcite-notice",{afterCreate:this._setTooltipReference,afterRemoved:this._removeTooltipReference,bind:this,icon:"exclamation-mark-triangle",kind:"warning",open:!0,scale:"s",tabIndex:0,width:"full"},u.tsx("div",{slot:"message"},t.layerIncompatible))):null}get _singleAction(){return this._renderAction({action:p.getSingleAction(this._filteredSections),textEnabled:!1})}get _filteredSections(){return this.item.actionsSections.map(e=>e.filter(e=>e.visible))}get _actionsCount(){return this.item.actionsSections.reduce((e,t)=>e+t.length,0)}_renderAction(e){const{item:t}=this,{action:i,textEnabled:r}=e;if(!i)return null;const{active:o,disabled:s,title:n,type:a,indicator:l}=i;return u.tsx("calcite-action",{active:"toggle"===a&&i.value,appearance:"transparent","data-action-id":i.id,disabled:s,icon:c.getActionIcon(i),indicator:l,key:`action-${i.uid}`,loading:o,onclick:()=>this._triggerAction(t,i),scale:"s",slot:r?void 0:"actions-end",text:n??"",textEnabled:r,title:n??void 0},this._renderFallbackIcon(i))}_renderFallbackIcon(e){const{css:t}=this,{icon:i}=e,r="className"in e?e.className:void 0;if(i)return null;const o="image"in e?e.image:void 0,s={[t.itemActionIcon]:!!r,[t.itemActionImage]:!!o};return r&&(s[r]=!0),o||r?u.tsx("span",{"aria-hidden":"true",class:this.classes(t.itemActionIcon,s),key:"icon",styles:c.getActionStyles(o)}):null}_renderItem(e,t,i=[]){return u.tsx(m,{activeItem:this.activeItem,canMove:this.canMove,css:this.css,displayMode:this.displayMode,dragEnabled:this.dragEnabled,item:e,key:`layerListItem-${e.layer?.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:t,parentTitles:i,rootGroupUid:this.rootGroupUid,selectedDragItemLayerUid:this.selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this.onAction,onCatalogOpen:this.onCatalogOpen,onPanelOpen:this.onPanelOpen,onSelectedDragItemLayerUidChange:this.onSelectedDragItemLayerUidChange,onTablesOpen:this.onTablesOpen,onTooltipReferenceChange:this.onTooltipReferenceChange})}_triggerAction(e,t){t&&e&&("toggle"===t.type&&(t.value=!t.value),this.onAction(t,e))}_triggerOnTablesOpen(e){e&&this.onTablesOpen&&this.onTablesOpen(e)}_triggerOnCatalogOpen(e){e&&this.onCatalogOpen?.(e)}_focusSelectedDragEl(e,t){this.selectedDragItemLayerUid===t.layer?.uid&&(h.setFocus(e),this.onSelectedDragItemLayerUidChange?.(null))}_handleCalciteListItemToggle(e,t){e.stopPropagation(),t.open=e.target.expanded}_getParentVisibilityMode(e){return e&&"visibilityMode"in e?e.visibilityMode:null}_handleCalciteListItemSelect(e,t,i){if(p.getItem(e.target)!==t)return;const r=this._getParentVisibilityMode(i);"none"===this.selectionMode&&"inherited"!==r&&this._toggleVisibility(t,i)}_togglePanel(e){e.open=!e.open,e.open&&this.onPanelOpen()}_toggleVisibility(e,t){e&&"visible"in e&&("exclusive"===this._getParentVisibilityMode(t)&&e.visible||(e.visible=!e.visible))}};return t.__decorate([r.property()],g.prototype,"activeItem",void 0),t.__decorate([r.property()],g.prototype,"canMove",void 0),t.__decorate([r.property()],g.prototype,"css",void 0),t.__decorate([r.property()],g.prototype,"displayMode",void 0),t.__decorate([r.property()],g.prototype,"dragEnabled",void 0),t.__decorate([r.property()],g.prototype,"dragDisabled",void 0),t.__decorate([r.property()],g.prototype,"item",void 0),t.__decorate([r.property()],g.prototype,"layerTablesEnabled",void 0),t.__decorate([r.property()],g.prototype,"listModeDisabled",void 0),t.__decorate([r.property()],g.prototype,"messages",void 0),t.__decorate([r.property()],g.prototype,"messagesCommon",void 0),t.__decorate([r.property()],g.prototype,"onAction",void 0),t.__decorate([r.property()],g.prototype,"onPanelOpen",void 0),t.__decorate([r.property()],g.prototype,"onCatalogOpen",void 0),t.__decorate([r.property()],g.prototype,"onTablesOpen",void 0),t.__decorate([r.property()],g.prototype,"onSelectedDragItemLayerUidChange",void 0),t.__decorate([r.property()],g.prototype,"onTooltipReferenceChange",void 0),t.__decorate([r.property()],g.prototype,"parent",void 0),t.__decorate([r.property()],g.prototype,"parentTitles",void 0),t.__decorate([r.property()],g.prototype,"rootGroupUid",void 0),t.__decorate([r.property()],g.prototype,"selectionMode",void 0),t.__decorate([r.property()],g.prototype,"selectedItems",void 0),t.__decorate([r.property()],g.prototype,"selectedDragItemLayerUid",void 0),t.__decorate([r.property()],g.prototype,"visibleElements",void 0),t.__decorate([r.property()],g.prototype,"visibilityAppearance",void 0),t.__decorate([r.property()],g.prototype,"_title",null),t.__decorate([r.property()],g.prototype,"_renderedItemStatus",null),t.__decorate([r.property()],g.prototype,"_renderedItemTemporaryIcon",null),t.__decorate([r.property()],g.prototype,"_renderedItemToggle",null),t.__decorate([r.property()],g.prototype,"_renderedPanel",null),t.__decorate([r.property()],g.prototype,"_renderedPanelAction",null),t.__decorate([r.property()],g.prototype,"_renderedActions",null),t.__decorate([r.property()],g.prototype,"_renderedActionMenu",null),t.__decorate([r.property()],g.prototype,"_renderedActionMenuContent",null),t.__decorate([r.property()],g.prototype,"_renderedCatalogFootprintIcon",null),t.__decorate([r.property()],g.prototype,"_renderedCatalogDynamicIcon",null),t.__decorate([r.property()],g.prototype,"_renderedCatalogSelectNode",null),t.__decorate([r.property()],g.prototype,"_renderedChildList",null),t.__decorate([r.property()],g.prototype,"_hasTables",null),t.__decorate([r.property()],g.prototype,"_renderedTablesItem",null),t.__decorate([r.property()],g.prototype,"_renderedItemMessage",null),t.__decorate([r.property()],g.prototype,"_singleAction",null),t.__decorate([r.property()],g.prototype,"_filteredSections",null),t.__decorate([r.property()],g.prototype,"_actionsCount",null),g=m=t.__decorate([a.subclass("esri.widgets.LayerList.LayerListItem")],g),g})},"esri/support/actions/actionUtils":function(){define(["require","exports","../../intl","../../chunks/componentsUtils","../../widgets/support/widgetUtils","../../widgets/support/jsxFactory","../../intl/substitute"],function(e,t,i,r,o,s,n){"use strict";function a(e){return e.icon?e.icon:"image"in e&&e.image||e.className?void 0:"question"}t.getActionIcon=a,t.getActionStyles=function(e){return e?{backgroundImage:`url(${e})`}:{}},t.loadActionUtilsComponents=()=>r.loadCalciteComponents({action:()=>new Promise((t,i)=>e(["../../chunks/index12"],t,i))}),t.renderAction=function(e,t,i){const{title:r,textEnabled:o}=t,{type:n,active:l,uid:c,disabled:d,indicator:p}=e;return e.visible?s.tsx("calcite-action",{...t,active:"toggle"===n&&e.value,appearance:"solid","data-action-id":e.id,"data-action-uid":c,disabled:d,icon:a(e),indicator:p,loading:l,scale:"s",text:r??"",title:o?void 0:r},i):null},t.substituteActionImage=function({action:e,feature:t}){const i=t?.attributes,r="image"in e?e.image:void 0;return r&&i?n.substitute(r,i):r??""},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/support/layerListUtils":function(){define(["exports"],function(e){"use strict";function t(e){return e?.listMode??void 0}function i(e){return null!=e&&"minScale"in e&&null!=e.minScale?e.minScale:void 0}function r(e){return null!=e&&"maxScale"in e&&null!=e.maxScale?e.maxScale:void 0}function o(e){if(e&&(!("type"in e)||"wmts"!==e.type))return"sublayers"in e?"sublayers":"layers"in e?"layers":void 0}function s(e,t){e?.sort((e,i)=>{const r="uid"in e?t.indexOf(e.uid):-1,o="uid"in i?t.indexOf(i.uid):-1;return r>o?-1:r<o?1:0})}function n(e){return null!=e&&"layer"in e&&null!=e.layer}function a(e){return e&&"capabilities"in e&&null!=e.capabilities&&"exportMap"in e.capabilities?e.capabilities.exportMap:void 0}function l(e){return e?.["data-item"]}e.areChildrenHidden=function(e){return"hide-children"===e?.listMode},e.canDisplayLayer=function(e){return"hide"!==t(e)},e.canSortSublayers=function(e){const t=(e?.layer&&n(e.layer)?e.layer.layer:void 0)??e?.layer;return!!t&&"catalog"!==t.type&&(function(e){const t=a(e);return null!=t&&"supportsDynamicLayers"in t?t.supportsDynamicLayers:void 0}(t)??!0)},e.findLayerListMode=t,e.findLayerMaxScale=r,e.findLayerMinScale=i,e.findLayerVisibilityMode=function(e){if(!e)return"inherited";const t=function(e){const t=a(e);return null!=t&&"supportsSublayerVisibility"in t?t.supportsSublayerVisibility:void 0}(n(e)?e.layer:e);return null!=t?t?"independent":"inherited":"visibilityMode"in e&&null!=e.visibilityMode?e.visibilityMode:"independent"},e.getItem=l,e.getItemLayers=function(e){const t=e?.layer;return t&&"layers"in t?t.layers:null},e.getLayerType=function(e){return e?.getAttribute("data-layer-type")},e.getNormalizedChildLayerProperty=o,e.getSingleAction=function(e){for(const t of e)for(const e of t)if("button"===e.type||"toggle"===e.type)return e},e.getStatusIcon=function({connectionStatus:e,publishing:t}){return e?"connected"===e?"beacon":"offline":t?"square":"bullet-point"},e.getVisibilityIcon=function({exclusive:e,visible:t,visibilityAppearance:i}){const r="checkbox"===i;return t?e?"circle-f":r?"check-square-f":"view-visible":e?"circle":r?"square":"view-hide"},e.isLayerOutsideScaleRange=function(e,t){if(!e||null==t||isNaN(t))return!1;const o=i(e),s=r(e),n=null!=o&&!isNaN(o)&&o>0&&t>o,a=null!=s&&!isNaN(s)&&s>0&&t<s;return n||a},e.isSublayer=n,e.listItemHasChildren=function(e){const{children:t,error:i}=e,r="incompatible"in e&&e.incompatible;return!!t?.filter(e=>!e.hidden).length&&!i&&!r},e.minDragEnabledItems=2,e.minFilterItems=10,e.removeDestroyedListItems=function(e){e?.removeMany(e.filter(e=>e?.destroyed))},e.setFilterPredicate=function(e,t){e&&(e.filterPredicate=t?e=>t(l(e)):void 0)},e.sortChildLayersToIds=function(e,t){const i=e?.layer;if(!i)return;const r=o(i);if(!r)return;let n;"layers"===r&&"layers"in i?n=i.layers:"sublayers"===r&&"sublayers"in i&&(n=i.sublayers),s(n,t)},e.sortLayersToIds=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/LayerListViewModel":function(){define(["../../chunks/tslib.es6","../../core/Collection","../../core/Evented","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../linkChart/utils","./ListItem","./support/layerListUtils"],function(e,t,i,r,o,s,n,a,l,c,d,p){"use strict";const y="view-layers",u="map-layers",h="layer-views",_="layer-list-mode",m=t.ofType(d);let g=class extends i.EventedAccessor{constructor(e){super(e),this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.operationalItems=new m,this.view=null}initialize(){this.addHandles([r.watch(()=>!0===this.view?.ready,()=>this._viewHandles(),r.initial),r.watch(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled,this.listModeDisabled],()=>this._recompileList()),r.watch(()=>c.isLinkChartView(this.view)?this.view.inGeographicLayout:null,()=>this._compileList())],"view")}destroy(){this._removeAllItems(),this.view=null}get state(){const{view:e}=this;return e?.ready?"ready":e?"loading":"disabled"}get totalItems(){return this.operationalItems.flatten(e=>e.children).length}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e,t,i,r){const o=e?.layer;if(!o||"subtype-sublayer"===o.type||"sublayer"===o.type)return;const s=this.view?.map?.layers,n=t?p.getItemLayers(t):s,a=i?p.getItemLayers(i):s;if(!n||!a)return;const{operationalItems:l}=this,c=t?.children||l,d=i?.children||l,y=a.length-r;e.parent=i||null,c.remove(e),n.remove(o),d.includes(e)||d.add(e,y),a.includes(o)||a.add(o,y),this._compileList()}_createLayerViewHandles(e){this.removeHandles(h),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),h)}_createMapLayerHandles(e){this.removeHandles(u),this._compileList(),e&&this.addHandles(e.on("change",()=>this._compileList()),u)}_createListItem(e){const{view:t,listItemCreatedFunction:i,checkPublishStatusEnabled:r,listModeDisabled:o}=this;return new d({checkPublishStatusEnabled:r,listModeDisabled:o,layer:e,listItemCreatedFunction:i,view:t})}_removeAllItems(){this.operationalItems.destroyAll()}_getViewableLayers(e){return e?this.listModeDisabled?e:e.filter(e=>"hide"!==p.findLayerListMode(e)):void 0}_watchLayersListMode(e){this.removeHandles(_),e&&!this.listModeDisabled&&this.addHandles(r.watch(()=>e.filter(e=>"listMode"in e).map(e=>e.listMode).toArray(),()=>this._compileList()),_)}_compileList(){const e=this.view?.map?.layers,t=c.isLinkChartView(this.view)&&!this.view.inGeographicLayout?e?.filter(({type:e})=>"link-chart"===e):e;this._watchLayersListMode(t);const i=this._getViewableLayers(t);i?.length?(this._createNewItems(i),this._removeItems(i),this._sortItems(i)):this._removeAllItems()}_createNewItems(e){const{operationalItems:t}=this;e.forEach(e=>{t.some(t=>t.layer===e)||t.add(this._createListItem(e))})}_removeItems(e){const{operationalItems:t}=this,i=[];t.forEach(t=>{t&&e&&e.includes(t.layer)||i.push(t)}),t.destroyMany(i)}_sortItems(e){const{operationalItems:t}=this;t.sort((t,i)=>{const r=e.indexOf(t.layer),o=e.indexOf(i.layer);return r>o?-1:r<o?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{view:e}=this;this.removeHandles([u,h,y]),e?.ready?this.addHandles([r.watch(()=>this.view?.map?.allLayers,e=>this._createMapLayerHandles(e),r.initial),r.watch(()=>this.view?.allLayerViews,e=>this._createLayerViewHandles(e),r.initial)],y):this._removeAllItems()}};return e.__decorate([o.property()],g.prototype,"checkPublishStatusEnabled",void 0),e.__decorate([o.property()],g.prototype,"listItemCreatedFunction",void 0),e.__decorate([o.property({nonNullable:!0})],g.prototype,"listModeDisabled",void 0),e.__decorate([o.property({type:m})],g.prototype,"operationalItems",void 0),e.__decorate([o.property({readOnly:!0})],g.prototype,"state",null),e.__decorate([o.property()],g.prototype,"totalItems",null),e.__decorate([o.property()],g.prototype,"view",void 0),g=e.__decorate([l.subclass("esri.widgets.LayerList.LayerListViewModel")],g),g})},"esri/linkChart/utils":function(){define(["exports"],function(e){"use strict";e.isLinkChartView=function(e){return null!=e&&"object"==typeof e&&"2d"===e.type&&"linkchart"===e.view2dType},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/LayerList/ListItem":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/arrayUtils","../../core/Collection","../../core/Identifiable","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/has","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/get","../../support/actions/ActionBase","../../support/actions/ActionButton","../../support/actions/ActionToggle","./ListItemPanel","./support/layerListUtils"],function(e,t,i,r,o,s,n,a,l,c,d,p,y,u,h,_){"use strict";var m;const g=r.ofType({key:"type",defaultKeyValue:"button",base:p,typeMap:{button:y,toggle:u}}),b=r.ofType(g),v="layer",f="child-list-mode";let L=m=class extends(o.IdentifiableMixin(t)){constructor(e){super(e),this.actionsSections=new b,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(r.ofType(m)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.listItemCreatedFunction=null,this.listModeDisabled=!1,this.open=!1,this.parent=null,this.view=null}initialize(){if(this.addHandles([s.watch(()=>[this.layer,this.layer?.listMode,this.listModeDisabled],()=>this._watchLayerProperties(this.layer),s.initial),s.watch(()=>this.checkPublishStatusEnabled,e=>this._updateChildrenPublishing(e),s.initial),s.watch(()=>this.view,e=>this._updateChildrenView(e),s.initial),s.watch(()=>this.panel,e=>this._setListItemOnPanel(e),s.initial)]),"function"==typeof this.listItemCreatedFunction){const e={item:this};this.listItemCreatedFunction.call(null,e)}}destroy(){this.panel?.destroy(),this.children.destroyAll(),this.view=null}get connectionStatus(){const{layerView:e,publishing:t}=this;if(!t&&e&&"connectionStatus"in e)return e.connectionStatus}get error(){return this.layer?.loadError}get incompatible(){const{layerView:e}=this;return!(!e||!("spatialReferenceSupported"in e)||e.spatialReferenceSupported)}get layerView(){const{layer:e,view:t}=this;if(!e||!t||"sublayer"===e.type)return null;const i="subtype-sublayer"===e.type?e.parent:e;return t.allLayerViews.find(e=>e.layer===i)??null}set panel(e){const t=this._get("panel");e!==t&&e&&t?.destroy(),this._set("panel",e)}castPanel(e){return this.panel?.open&&!e.hasOwnProperty("open")&&(e.open=!0),e?new h(e):null}get sortable(){return"knowledge-graph-sublayer"!==this.layer?.type&&this._get("sortable")}set sortable(e){this._set("sortable",e)}get title(){const e=d.get(this,"layer.layer");return(!e||e&&d.get(this,"layer.layer.loaded"))&&d.get(this,"layer.title")||d.get(this,"layer.attributes.title")||""}set title(e){this._override("title",e)}get publishing(){const{layer:e,checkPublishStatusEnabled:t}=this;return!!(t&&e&&"publishingInfo"in e&&"publishing"===e.publishingInfo?.status)}get updating(){const{layerView:e,connectionStatus:t,layer:i,publishing:r}=this;return!r&&!t&&(e?e.updating:"loading"===i?.loadStatus||!1)}get visible(){return!!this.layer?.visible}set visible(e){const t=this.layer;t&&(t.visible=e)}get visibleAtCurrentScale(){return this.layerView?.visibleAtCurrentScale??!_.isLayerOutsideScaleRange(this.layer,this.view?.scale)}get visibleAtCurrentTimeExtent(){return this.layerView?.visibleAtCurrentTimeExtent??!0}get visibilityMode(){return _.findLayerVisibilityMode(this.layer)}clone(){return new m({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),childrenSortable:this.childrenSortable,hidden:this.hidden,layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,open:this.open,panel:this.panel,parent:this.parent,sortable:this.sortable,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(e){e&&(e.listItem=this)}_updateChildrenPublishing(e){this.children?.forEach(t=>t.checkPublishStatusEnabled=e)}_updateChildrenView(e){const t=this.children;t&&t.forEach(t=>t.view=e)}_createChildren(e){const{listModeDisabled:t,children:i}=this,r=e.filter(e=>!i.some(t=>t.layer===e));i.addMany(this._createChildItems(r,t))}_destroyChildren(e){const{children:t}=this,i=t.filter(t=>!!t.layer&&!e.includes(t.layer));t.destroyMany(i)}_sortChildren(e){this.children.sort((t,i)=>e.indexOf(i.layer)-e.indexOf(t.layer))}_destroyAllChildren(){this.removeHandles(f),this.children.destroyAll()}_watchChildLayerListMode(e){this.removeHandles(f),this.listModeDisabled||this.addHandles(e.toArray().map(t=>s.watch(()=>t.listMode,()=>this._compileChildren(e))),f)}_compileChildren(e){const t=this.listModeDisabled?e:e?.filter(e=>"hide"!==_.findLayerListMode(e));e?.length?(this._createChildren(t),this._destroyChildren(t),this._sortChildren(t),this._watchChildLayerListMode(e)):this._destroyAllChildren()}_watchSublayerChanges(e){e&&this.addHandles(e.on("change",()=>this._compileChildren(e)),v)}_initializeChildLayers(e){this._compileChildren(e),this._watchSublayerChanges(e)}_createChildItems(e,t){return e.reverse().map(e=>t||_.canDisplayLayer(e)?new m({layer:e,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,listModeDisabled:this.listModeDisabled,parent:this,view:this.view}):null).filter(i.isSome)}_watchLayerProperties(e){if(this.removeHandles(v),this.removeHandles(f),!e)return;if("hide-children"===(!this.listModeDisabled&&_.findLayerListMode(e)))return void this.children.destroyAll();const t=_.getNormalizedChildLayerProperty(e);t&&this.addHandles(s.watch(()=>e[t],i=>{e.hasOwnProperty(t)&&this._initializeChildLayers(i)},s.initial),v)}};return e.__decorate([n.property({type:b})],L.prototype,"actionsSections",void 0),e.__decorate([n.property()],L.prototype,"actionsOpen",void 0),e.__decorate([n.property()],L.prototype,"checkPublishStatusEnabled",void 0),e.__decorate([n.property({type:r.ofType(L)})],L.prototype,"children",void 0),e.__decorate([n.property()],L.prototype,"childrenSortable",void 0),e.__decorate([n.property({readOnly:!0})],L.prototype,"connectionStatus",null),e.__decorate([n.property({readOnly:!0})],L.prototype,"error",null),e.__decorate([n.property()],L.prototype,"hidden",void 0),e.__decorate([n.property({readOnly:!0})],L.prototype,"incompatible",null),e.__decorate([n.property()],L.prototype,"layer",void 0),e.__decorate([n.property({readOnly:!0})],L.prototype,"layerView",null),e.__decorate([n.property()],L.prototype,"listItemCreatedFunction",void 0),e.__decorate([n.property({nonNullable:!0})],L.prototype,"listModeDisabled",void 0),e.__decorate([n.property()],L.prototype,"open",void 0),e.__decorate([n.property({type:h})],L.prototype,"panel",null),e.__decorate([a.cast("panel")],L.prototype,"castPanel",null),e.__decorate([n.property()],L.prototype,"parent",void 0),e.__decorate([n.property({value:!0})],L.prototype,"sortable",null),e.__decorate([n.property()],L.prototype,"title",null),e.__decorate([n.property({readOnly:!0})],L.prototype,"publishing",null),e.__decorate([n.property({readOnly:!0})],L.prototype,"updating",null),e.__decorate([n.property()],L.prototype,"view",void 0),e.__decorate([n.property()],L.prototype,"visible",null),e.__decorate([n.property({readOnly:!0})],L.prototype,"visibleAtCurrentScale",null),e.__decorate([n.property({readOnly:!0})],L.prototype,"visibleAtCurrentTimeExtent",null),e.__decorate([n.property({readOnly:!0})],L.prototype,"visibilityMode",null),L=m=e.__decorate([c.subclass("esri.widgets.LayerList.ListItem")],L),L})},"esri/widgets/LayerList/ListItemPanel":function(){define(["require","../../chunks/tslib.es6","../../core/Identifiable","../../core/maybe","../../core/reactiveUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../Widget","./support/layerListUtils","../support/widget","../support/jsxFactory"],function(e,t,i,r,o,s,n,a,l,c,d,p,y,u){"use strict";const h=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));let _=class extends(i.IdentifiableMixin(d)){constructor(e,t){super(e,t),this._legend=null,this.content=null,this.flowEnabled=!1,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles([o.watch(()=>this._canCreateLegend,()=>this._createLegend(),o.initial),o.watch(()=>[this._legend,this._legendOptions],()=>this._updateLegend(),o.initial)])}destroy(){this._legend=r.destroyMaybe(this._legend)}get _canCreateLegend(){const{content:e,listItem:t}=this;if(!t)return!1;const i="legend";return e===i||null!=e&&!!Array.isArray(e)&&e.includes(i)}get _legendOptions(){const{listItem:e,_legendLayerInfo:t}=this,i=e?.view;return t&&i?{view:i,layerInfos:[t]}:{}}get _legendLayerInfo(){const e=this.listItem?.layer;if(!e||"subtype-sublayer"===e.type)return null;const t=p.isSublayer(e)?e:null,i=e?.parent,r=null!=i&&"type"in i&&"map-image"===i.type?t?.source:null;return r&&i?{layer:i,title:"",sublayerIds:[r.mapLayerId]}:{layer:e,title:""}}get disabled(){const{listItem:e,_legend:t,content:i}=this;return!(e&&(Array.isArray(i)&&i.length>1||!t||t.activeLayerInfos?.length&&e.visibleAtCurrentScale&&e.visible))}set disabled(e){this._overrideIfSome("disabled",e)}get icon(){const{image:e}=this,t=this._getFirstWidget();return this._get("icon")??(!e&&t?t.icon:null)}set icon(e){this._overrideIfSome("icon",e)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(e){this._override("title",e)}render(){return u.tsx("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(e){const{_legend:t,disabled:i,open:r}=this;return e&&!i&&r?"legend"===e&&t?u.tsx("div",{key:"legend-widget"},t.render()):"string"==typeof e?u.tsx("div",{innerHTML:e,key:e}):y.isWidget(e)?u.tsx("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?u.tsx("div",{afterCreate:this._attachToNode,bind:e,key:"content-element"}):null:null}_renderContents(){const{content:e,open:t}=this;return t?Array.isArray(e)?e.map(e=>this._renderContent(e)):this._renderContent(e):null}async _createLegend(){if(r.destroyMaybe(this._legend),this._legend=null,!this._canCreateLegend)return;const{default:t}=await new Promise((t,i)=>e(["../Legend"],e=>t(h(e)),i)),i=new t(this._legendOptions);this._legend=i}_attachToNode(e){e.appendChild(this)}_updateLegend(){const e=this._legend;e&&e.set(this._legendOptions)}_getWidget(e){return"legend"===e?this._legend:y.isWidget(e)?e:null}_getFirstWidget(){const{content:e}=this;return Array.isArray(e)?e.map(e=>this._getWidget(e)).find(e=>e):this._getWidget(e)}};return t.__decorate([s.property()],_.prototype,"_legend",void 0),t.__decorate([s.property()],_.prototype,"_canCreateLegend",null),t.__decorate([s.property()],_.prototype,"_legendOptions",null),t.__decorate([s.property()],_.prototype,"_legendLayerInfo",null),t.__decorate([s.property()],_.prototype,"content",void 0),t.__decorate([s.property()],_.prototype,"disabled",null),t.__decorate([s.property()],_.prototype,"flowEnabled",void 0),t.__decorate([s.property()],_.prototype,"icon",null),t.__decorate([s.property()],_.prototype,"image",void 0),t.__decorate([s.property()],_.prototype,"listItem",void 0),t.__decorate([s.property()],_.prototype,"open",void 0),t.__decorate([s.property()],_.prototype,"title",null),t.__decorate([s.property()],_.prototype,"visible",void 0),_=t.__decorate([c.subclass("esri.widgets.LayerList.ListItemPanel")],_),_})},"esri/widgets/LayerList/LayerListVisibleElements":function(){define(["../../chunks/tslib.es6","../../core/Accessor","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,i,r,o,s,n){"use strict";let a=class extends t{constructor(){super(...arguments),this.catalogLayerList=!0,this.closeButton=!1,this.collapseButton=!1,this.errors=!1,this.filter=!1,this.flow=!0,this.heading=!1,this.statusIndicators=!0,this.temporaryLayerIndicators=!1}};return e.__decorate([i.property({type:Boolean,nonNullable:!0})],a.prototype,"catalogLayerList",void 0),e.__decorate([i.property({type:Boolean,nonNullable:!0})],a.prototype,"closeButton",void 0),e.__decorate([i.property({type:Boolean,nonNullable:!0})],a.prototype,"collapseButton",void 0),e.__decorate([i.property({type:Boolean,nonNullable:!0})],a.prototype,"errors",void 0),e.__decorate([i.property({type:Boolean,nonNullable:!0})],a.prototype,"filter",void 0),e.__decorate([i.property({type:Boolean,nonNullable:!0})],a.prototype,"flow",void 0),e.__decorate([i.property({type:Boolean,nonNullable:!0})],a.prototype,"heading",void 0),e.__decorate([i.property({type:Boolean,nonNullable:!0})],a.prototype,"statusIndicators",void 0),e.__decorate([i.property({type:Boolean,nonNullable:!0})],a.prototype,"temporaryLayerIndicators",void 0),a=e.__decorate([n.subclass("esri.widgets.LayerList.LayerListVisibleElements")],a),a})},"esri/widgets/support/globalCss":function(){define(["exports"],function(e){"use strict";e.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",primaryTickLabelKeepAll:"primary-tick__label--keep-all",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/listUtils":function(){define(["exports"],function(e){"use strict";e.calciteListFilterProps=["label","description","metadata"],Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"*noref":1}}),define(["require","../chunks/tslib.es6","../core/Collection","../core/Identifiable","../core/ReactiveMap","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./Widget","./LayerList/css","./LayerList/LayerListItem","./LayerList/LayerListViewModel","./LayerList/LayerListVisibleElements","./LayerList/ListItem","./LayerList/support/layerListUtils","../chunks/componentsUtils","./support/globalCss","./support/listUtils","./support/widgetUtils","./support/decorators/messageBundle","./support/decorators/vmEvent","./support/jsxFactory"],function(e,t,i,r,o,s,n,a,l,c,d,p,y,u,h,_,m,g,b,v,f,L,I,w,C){"use strict";const M=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"})),S=i.ofType(m),A="nested";let x=class extends(r.IdentifiableMixin(p)){constructor(e,t){super(e,t),this._rootListEl=null,this._activeItem=null,this._tooltipReferenceMap=new o,this._focusRootFlowItem=!1,this._focusPanelFlowItem=!1,this._focusLayerFlowItem=null,this._layerListMap=new o,this._lastDragDetail=null,this._selectedDragItemLayerUid=null,this._rootGroupUid=`operational-${this.uid}`,this._openedLayersController=null,this.catalogLayerList=null,this.catalogOptions=null,this.collapsed=!1,this.dragEnabled=!1,this.filterPlaceholder="",this.filterPredicate=null,this.filterText="",this.headingLevel=2,this.knowledgeGraphOptions=null,this.layerTablesEnabled=new i(["knowledge-graph"]),this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.mapImageOptions=null,this.messages=null,this.messagesCommon=null,this.minDragEnabledItems=g.minDragEnabledItems,this.minFilterItems=g.minFilterItems,this.openedLayers=new i,this.openedLayerLists=new i,this.selectedItems=new S,this.selectionMode="none",this.tableList=null,this.tileOptions=null,this.viewModel=new h,this.visibilityAppearance="default",this.visibleElements=new _,this._canMove=({dragEl:e,fromEl:t,toEl:i},r)=>{const o="pull"===r?this.listItemCanGiveFunction:this.listItemCanReceiveFunction,s=g.getItem(e);if(!s?.sortable)return!1;const n=g.getItem(t),a=g.getLayerType(t),l=g.getItem(i),c=g.getLayerType(i),d=!!a&&!!c&&a===c,p={selected:s,from:n,to:l},y=t.group,u=i.group,h=n?.layer?.type??"",_=l?.layer?.type??"",m=new Set(["map-image","catalog","knowledge-graph"]);return y&&u&&"function"==typeof o?o.call(null,p):d&&!m.has(h)&&!m.has(_)&&"sublayer"!==s?.layer?.type},this._onCatalogOpen=e=>{this.openedLayers.push(e.layer?.parent),this._focusLayerFlowItem=e.layer?.uid},this._onTablesOpen=e=>{this.openedLayers.push(e.layer),this._focusLayerFlowItem=e.layer?.uid},this._onPanelOpen=()=>{this._focusPanelFlowItem=!0},this._onTooltipReferenceChange=(e,t)=>{t?this._tooltipReferenceMap.set(e,t):this._tooltipReferenceMap.delete(e)},this._onSelectedDragItemLayerUidChange=e=>{this._selectedDragItemLayerUid=e},this._onTriggerAction=(e,t)=>{this.triggerAction(e,t)},this._clearActiveItem=()=>{this._activeItem=null},this._setActiveItem=e=>{if("default"!==this.visibilityAppearance)return;const t=Array.from(e.composedPath()).find(e=>e.classList?.contains(y.css.item));this._activeItem=g.getItem(t)},this._onCalciteListOrderChange=e=>{const{_lastDragDetail:t}=this,{toEl:i,fromEl:r,dragEl:o,newIndex:s}=e;if(r&&i&&(t?.newIndex!==s||t?.dragEl!==o||t?.toEl!==i||t?.fromEl!==r)){if(this._lastDragDetail=e,this._selectedDragItemLayerUid=o.value,r===i){const e=Array.from(r.children).filter(e=>e?.matches("calcite-list-item")).map(e=>e.value);return void this._sortLayers(r,e)}this._moveLayerFromChildList({toEl:i,fromEl:r,dragEl:o,newIndex:s})}}}initialize(){this.addHandles([s.on(()=>this.openedLayers,"change",()=>this._handleOpenedLayersChange(),s.initial),s.on(()=>this.viewModel.operationalItems,"change",()=>g.removeDestroyedListItems(this.selectedItems),s.initial),s.watch(()=>[this.filterPredicate,this._rootListEl],()=>g.setFilterPredicate(this._rootListEl,this.filterPredicate))])}loadDependencies(){return b.loadCalciteComponents({button:()=>new Promise((t,i)=>e(["../chunks/index2"],t,i)),flow:()=>new Promise((t,i)=>e(["../chunks/index14"],t,i)),"flow-item":()=>new Promise((t,i)=>e(["../chunks/index15"],t,i)),list:()=>new Promise((t,i)=>e(["../chunks/index16"],t,i)),notice:()=>new Promise((t,i)=>e(["../chunks/index6"],t,i)),tooltip:()=>new Promise((t,i)=>e(["../chunks/index17"],t,i))})}destroy(){this._destroyOpenedLayerLists(),this._tooltipReferenceMap.clear()}get _totalItems(){return this.viewModel.operationalItems.flatten(e=>e.children.filter(e=>"catalog-dynamic-group"!==e.layer?.type)).length}get _visibleItems(){return this.operationalItems?.filter(e=>!e.hidden&&(this.visibleElements.errors||!e.error))}get _openedPanelItems(){return this._visibleItems.flatten(e=>e.children).filter(({hidden:e,panel:t})=>!e&&t?.open&&!t.disabled&&t.flowEnabled)}get _dragEnabled(){return this._totalItems>=this.minDragEnabledItems&&this.dragEnabled}get _filterEnabled(){return this._totalItems>=this.minFilterItems&&this.visibleElements.filter}get _renderedOpenLayerFlowItems(){const{openedLayers:e}=this;return e.toArray().map((t,i)=>this._renderLayerFlowItem(t,i===e.length-1))}get icon(){return"layers"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){const e=this.viewModel?.state,t={[v.globalCss.hidden]:"loading"===e,[v.globalCss.disabled]:"disabled"===e};return C.tsx("div",{class:this.classes(y.css.base,v.globalCss.widget,v.globalCss.panel,t)},this._renderItemTooltips(),this._renderItems())}async _createFlowList(e,t){const{_layerListMap:i}=this,r=i.get(e);if(r)return r;const o="catalog"===e.type?await this._createCatalogLayerList(e):await this._createTableList(e);return t.aborted||i.set(e,o),o}async _handleOpenedLayersChange(){const{_layerListMap:e,openedLayers:t,openedLayerLists:i}=this;this._openedLayersController?.abort();const r=new AbortController,{signal:o}=r;this._openedLayersController=r,e.forEach((i,r)=>{t.includes(r)||(i.destroy(),e.delete(r))});const s=await Promise.all(t.map(e=>this._createFlowList(e,o)));if(o.aborted)return;i.removeAll(),i.addMany(s);const n=i.at(-1);n?"catalogLayer"in n?(this._set("catalogLayerList",n),this._set("tableList",null)):(this._set("catalogLayerList",null),this._set("tableList",n)):(this._set("catalogLayerList",null),this._set("tableList",null))}_destroyOpenedLayerLists(){this.openedLayerLists.destroyAll(),this.openedLayers.removeAll(),this._layerListMap.clear()}_renderItemTooltip(e){const{_tooltipReferenceMap:t,messages:i}=this;return e?C.tsx("calcite-tooltip",{key:`tooltip-${e.layer?.uid}`,overlayPositioning:"fixed",referenceElement:t.get(e.layer?.uid)},i.layerIncompatibleTooltip):null}_renderItemTooltipNodes(e){return e.incompatible?this._renderItemTooltip(e):e.children?.filter(e=>!e.hidden).toArray().map(e=>this._renderItemTooltipNodes(e))}_renderItemTooltips(){return this._visibleItems?.toArray().map(e=>this._renderItemTooltipNodes(e))}_renderNoItemsMessage(){return C.tsx("div",{slot:"message"},this.messages.noItemsToDisplay)}_renderNoItems(){return C.tsx("div",{class:y.css.itemMessage,key:"esri-layer-list__no-items"},C.tsx("calcite-notice",{icon:"information",kind:"info",open:!0,width:"full"},this._renderNoItemsMessage()))}async _createCatalogLayerList(t){const{default:i}=await new Promise((t,i)=>e(["./CatalogLayerList"],e=>t(M(e)),i)),{headingLevel:r,catalogOptions:o,view:s,filterPlaceholder:n,listItemCreatedFunction:a,minFilterItems:l,selectionMode:c,visibilityAppearance:d,_onCatalogOpen:p,_onTablesOpen:y,layerTablesEnabled:u}=this;return new i({headingLevel:r,view:s,filterPlaceholder:n,listItemCreatedFunction:a,minFilterItems:l,selectionMode:c,visibilityAppearance:d,...o,catalogLayer:t,layerTablesEnabled:u,onCatalogOpen:p,onTablesOpen:y})}_getTableListParams(e){switch(e.type){case"knowledge-graph":return{...this.knowledgeGraphOptions,tables:e.tables};case"map-image":return{...this.mapImageOptions,tables:e.subtables};case"tile":return{...this.tileOptions,tables:e.subtables};default:return null}}async _createTableList(t){const{default:i}=await new Promise((t,i)=>e(["./TableList"],e=>t(M(e)),i)),{headingLevel:r,selectionMode:o,dragEnabled:s}=this;return new i({headingLevel:r,selectionMode:o,dragEnabled:s,...this._getTableListParams(t)})}_renderLayerFlowItem(e,t){const{messages:i,openedLayers:r}=this,o=e.title||this.messages.untitledLayer;return C.tsx("calcite-flow-item",{afterCreate:this._focusLayerFlowItemNode,afterUpdate:this._focusLayerFlowItemNode,bind:this,"data-layer-uid":e.uid,description:o,heading:i["catalog"===e.type?"catalogLayers":"tables"],headingLevel:this.headingLevel,key:`flow-layer-list-${e.uid}`,selected:t,onCalciteFlowItemBack:e=>{e.preventDefault(),r.pop();const t=r.at(-1);t?this._focusLayerFlowItem=t.uid:this._focusRootFlowItem=!0}},this._layerListMap.get(e)?.render())}_renderPanelFlowItems(){const{_openedPanelItems:e,openedLayers:t}=this;return e.toArray().map(({title:i,panel:r},o)=>{const s=()=>this._handlePanelFlowItemBack(r);return C.tsx("calcite-flow-item",{afterCreate:this._focusPanelFlowItemNode,afterUpdate:this._focusPanelFlowItemNode,bind:this,description:i,heading:r.title,headingLevel:this.headingLevel,key:`flow-panel-${r.uid}`,selected:!t.length&&o===e.length-1,onCalciteFlowItemBack:e=>{e.preventDefault(),s()}},r.render(),C.tsx("calcite-button",{appearance:"transparent",onclick:s,slot:"footer-actions",width:"full"},this.messagesCommon.back))})}_handlePanelFlowItemBack(e){e.open=!1,this._focusRootFlowItem=!0}_focusRootFlowItemNode(e){this._focusRootFlowItem&&(this._focusRootFlowItem=!1,L.setFocus(e))}_focusLayerFlowItemNode(e){this._focusLayerFlowItem===e.dataset.layerUid&&(this._focusLayerFlowItem=null,L.setFocus(e))}_focusPanelFlowItemNode(e){this._focusPanelFlowItem&&(this._focusPanelFlowItem=!1,L.setFocus(e))}_renderItems(){const{visible:e,collapsed:t,_visibleItems:i,_openedPanelItems:r,_filterEnabled:o,_rootGroupUid:s,visibleElements:{closeButton:n,collapseButton:a,heading:l,flow:c},_dragEnabled:d,selectionMode:p,filterText:u,openedLayers:h,filterPlaceholder:_,messages:m}=this,g=[C.tsx("calcite-flow-item",{afterCreate:this._focusRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,closable:n,closed:!e,collapsed:t,collapsible:a,heading:l?m.widgetLabel:void 0,headingLevel:this.headingLevel,key:"root-flow-item",selected:!h.length&&!r.length,onCalciteFlowItemClose:()=>this.visible=!1},i?.length?null:this._renderNoItems(),C.tsx("calcite-list",{afterCreate:e=>{this._rootListEl=e,e.addEventListener("focusin",this._setActiveItem),e.addEventListener("focusout",this._clearActiveItem)},afterRemoved:e=>{this._rootListEl=null,e.removeEventListener("focusin",this._setActiveItem),e.removeEventListener("focusout",this._clearActiveItem)},canPull:e=>this._canMove(e,"pull"),canPut:e=>this._canMove(e,"put"),"data-layer-type":s,displayMode:A,dragEnabled:d,filterEnabled:o,filterPlaceholder:_,filterProps:f.calciteListFilterProps,filterText:o?u:"",group:s,key:"root-list",label:m.widgetLabel,onmouseleave:this._clearActiveItem,onmouseover:this._setActiveItem,selectionAppearance:"border",selectionMode:p,onCalciteListChange:e=>this._handleCalciteListChange(e),onCalciteListDragEnd:e=>this._handleCalciteListDragEnd(e.detail),onCalciteListFilter:e=>this.filterText=e.currentTarget?.filterText??"",onCalciteListOrderChange:e=>this._onCalciteListOrderChange(e.detail)},i.toArray().map(e=>this._renderItem(e)),o?C.tsx("div",{class:y.css.filterNoResults,slot:"filter-no-results"},C.tsx("calcite-notice",{kind:"info",open:!0,width:"full"},this._renderNoItemsMessage())):null)),this._renderPanelFlowItems(),this._renderedOpenLayerFlowItems];return e?c?C.tsx("calcite-flow",{key:"root-flow"},g):g:null}_renderItem(e,t,i){return C.tsx(u,{activeItem:this._activeItem,canMove:this._canMove,css:y.css,displayMode:A,dragEnabled:this.dragEnabled,item:e,key:`layerListItem-${e.layer?.uid}`,layerTablesEnabled:this.layerTablesEnabled,listModeDisabled:this.viewModel.listModeDisabled,messages:this.messages,messagesCommon:this.messagesCommon,parent:t,parentTitles:i,rootGroupUid:this._rootGroupUid,selectedDragItemLayerUid:this._selectedDragItemLayerUid,selectedItems:this.selectedItems,selectionMode:this.selectionMode,visibilityAppearance:this.visibilityAppearance,visibleElements:this.visibleElements,onAction:this._onTriggerAction,onCatalogOpen:this._onCatalogOpen,onPanelOpen:this._onPanelOpen,onSelectedDragItemLayerUidChange:this._onSelectedDragItemLayerUidChange,onTablesOpen:this._onTablesOpen,onTooltipReferenceChange:this._onTooltipReferenceChange})}_moveLayerFromChildList({toEl:e,fromEl:t,dragEl:i,newIndex:r}){const o=g.getItem(i),s=g.getItem(e),n=g.getItem(t);this.viewModel.moveListItem(o,n,s,r)}_handleCalciteListDragEnd(e){const{fromEl:t,dragEl:i,oldIndex:r}=e;t.insertBefore(i,t.children[r])}_sortLayers(e,t){if(e)if(e===this._rootListEl)g.sortLayersToIds(this.view?.map?.layers,t);else{const i=g.getItem(e);if(!i)return;g.sortChildLayersToIds(i,t)}}_handleCalciteListChange(e){const{selectionMode:t,selectedItems:i}=this;if("none"===t)return;const r=e.target.selectedItems.map(e=>g.getItem(e)).filter(Boolean);i.removeAll(),i.addMany(r)}};return t.__decorate([n.property()],x.prototype,"_rootListEl",void 0),t.__decorate([n.property()],x.prototype,"_activeItem",void 0),t.__decorate([n.property()],x.prototype,"_tooltipReferenceMap",void 0),t.__decorate([n.property()],x.prototype,"_focusRootFlowItem",void 0),t.__decorate([n.property()],x.prototype,"_focusPanelFlowItem",void 0),t.__decorate([n.property()],x.prototype,"_focusLayerFlowItem",void 0),t.__decorate([n.property()],x.prototype,"_layerListMap",void 0),t.__decorate([n.property()],x.prototype,"_totalItems",null),t.__decorate([n.property()],x.prototype,"_visibleItems",null),t.__decorate([n.property()],x.prototype,"_openedPanelItems",null),t.__decorate([n.property()],x.prototype,"_dragEnabled",null),t.__decorate([n.property()],x.prototype,"_filterEnabled",null),t.__decorate([n.property()],x.prototype,"_renderedOpenLayerFlowItems",null),t.__decorate([n.property({readOnly:!0})],x.prototype,"catalogLayerList",void 0),t.__decorate([n.property()],x.prototype,"catalogOptions",void 0),t.__decorate([n.property()],x.prototype,"collapsed",void 0),t.__decorate([n.property()],x.prototype,"dragEnabled",void 0),t.__decorate([n.property()],x.prototype,"filterPlaceholder",void 0),t.__decorate([n.property()],x.prototype,"filterPredicate",void 0),t.__decorate([n.property()],x.prototype,"filterText",void 0),t.__decorate([n.property()],x.prototype,"headingLevel",void 0),t.__decorate([n.property()],x.prototype,"icon",null),t.__decorate([n.property()],x.prototype,"knowledgeGraphOptions",void 0),t.__decorate([n.property()],x.prototype,"label",null),t.__decorate([n.property()],x.prototype,"layerTablesEnabled",void 0),t.__decorate([n.property()],x.prototype,"listItemCanGiveFunction",void 0),t.__decorate([n.property()],x.prototype,"listItemCanReceiveFunction",void 0),t.__decorate([n.property()],x.prototype,"listItemCreatedFunction",null),t.__decorate([n.property()],x.prototype,"mapImageOptions",void 0),t.__decorate([n.property(),I.messageBundle("esri/widgets/LayerList/t9n/LayerList")],x.prototype,"messages",void 0),t.__decorate([n.property(),I.messageBundle("esri/t9n/common")],x.prototype,"messagesCommon",void 0),t.__decorate([n.property()],x.prototype,"minDragEnabledItems",void 0),t.__decorate([n.property()],x.prototype,"minFilterItems",void 0),t.__decorate([n.property({readOnly:!0})],x.prototype,"openedLayers",void 0),t.__decorate([n.property({readOnly:!0})],x.prototype,"openedLayerLists",void 0),t.__decorate([n.property()],x.prototype,"operationalItems",null),t.__decorate([n.property()],x.prototype,"selectedItems",void 0),t.__decorate([n.property()],x.prototype,"selectionMode",void 0),t.__decorate([n.property({readOnly:!0})],x.prototype,"tableList",void 0),t.__decorate([n.property()],x.prototype,"tileOptions",void 0),t.__decorate([n.property()],x.prototype,"view",null),t.__decorate([w.vmEvent("trigger-action"),n.property({type:h})],x.prototype,"viewModel",void 0),t.__decorate([n.property()],x.prototype,"visibilityAppearance",void 0),t.__decorate([n.property({type:_,nonNullable:!0})],x.prototype,"visibleElements",void 0),x=t.__decorate([d.subclass("esri.widgets.LayerList")],x),x});