// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../../chunks/tslib.es6","../../core/accessorSupport/decorators/property","../../core/accessorSupport/decorators/cast","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../Widget","../../chunks/componentsUtils","./widgetUtils","./decorators/messageBundle","./jsxFactory","./FilterBuilder/FilterBuilderViewModel"],function(e,t,o,r,i,s,n,l,a,d,c,u,p,h){"use strict";const m={fab:!0,menu:!0},_="esri-filter-builder",w={base:_,conditionContainer:`${_}__condition-container`,operatorSelect:`${_}__operator-select`};return t.default=class extends a{constructor(e,t){super(e,t),this.messages=null,this.messagesCommon=null,this.viewModel=new h,this.visibleElements={...m}}loadDependencies(){return d.loadCalciteComponents({action:()=>new Promise((t,o)=>e(["../../chunks/index12"],t,o)),"action-menu":()=>new Promise((t,o)=>e(["../../chunks/index19"],t,o)).then(e=>e.index),block:()=>new Promise((t,o)=>e(["../../chunks/index13"],t,o)),fab:()=>new Promise((t,o)=>e(["../../chunks/index38"],t,o)),option:()=>new Promise((t,o)=>e(["../../chunks/index8"],t,o)),select:()=>new Promise((t,o)=>e(["../../chunks/index9"],t,o))})}get conditionOperator(){return this.viewModel.conditionOperator}set conditionOperator(e){this.viewModel.conditionOperator=e}get count(){return this.viewModel.count}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get operators(){return this.viewModel.operators}set operators(e){this.viewModel.operators=e}get state(){return this.viewModel.state}castVisibleElements(e){return{...m,...e}}get whereClause(){return this.viewModel.whereClause}get whereClauses(){return this.viewModel.whereClauses}render(){return p.tsx("div",{class:w.base},this._renderOperatorSelect(),this._renderConditions(),this._renderFAB())}reset(){this.viewModel.reset()}_renderOperatorSelect(){if(this.count<2)return;const{conditionOperator:e,messages:t}=this,o="AND"===e;return p.tsx("div",{class:w.operatorSelect},p.tsx("calcite-select",{label:t.condition,width:"full",onCalciteSelectChange:({currentTarget:e})=>{this.conditionOperator=e.value}},p.tsx("calcite-option",{label:t.allAreTrue,selected:o,value:"AND"}),p.tsx("calcite-option",{label:t.anyAreTrue,selected:!o,value:"OR"})))}_renderConditions(){return this.viewModel.conditionWidgets.toArray().map((e,t)=>this._renderConditionContainer(e,t))}_renderConditionContainer(e,t){return p.tsx("calcite-block",{class:w.conditionContainer,expanded:!0,heading:this.messages.condition},e.render(),this._renderConditionrMenu(t))}_renderFAB(){if(!this.visibleElements.fab)return;const e="loading"===this.state;return p.tsx("calcite-fab",{appearance:"outline-fill",disabled:e,icon:"plus",kind:"neutral",loading:e,onclick:()=>this.viewModel.addCondition(),text:this.messages.addNew,textEnabled:!0})}_renderConditionrMenu(e){if(!this.visibleElements.menu)return;const{messages:t}=this;return p.tsx("calcite-action-menu",{label:t.moreOptions,overlayPositioning:"fixed",placement:"bottom-end",slot:"control"},p.tsx("calcite-action",{onclick:()=>this.viewModel.removeCondition(e),text:t.delete,textEnabled:!0}),p.tsx("calcite-action",{onclick:()=>this.viewModel.duplicateCondition(e),text:t.duplicate,textEnabled:!0}))}},o.__decorate([r.property()],t.default.prototype,"conditionOperator",null),o.__decorate([r.property()],t.default.prototype,"count",null),o.__decorate([r.property()],t.default.prototype,"layer",null),o.__decorate([r.property(),u.messageBundle("esri/widgets/support/FilterBuilder/t9n/FilterBuilder")],t.default.prototype,"messages",void 0),o.__decorate([r.property(),u.messageBundle("esri/t9n/common")],t.default.prototype,"messagesCommon",void 0),o.__decorate([r.property()],t.default.prototype,"operators",null),o.__decorate([r.property()],t.default.prototype,"state",null),o.__decorate([r.property()],t.default.prototype,"viewModel",void 0),o.__decorate([r.property()],t.default.prototype,"visibleElements",void 0),o.__decorate([i.cast("visibleElements")],t.default.prototype,"castVisibleElements",null),o.__decorate([r.property()],t.default.prototype,"whereClause",null),o.__decorate([r.property()],t.default.prototype,"whereClauses",null),t.default=o.__decorate([l.subclass("esri.widgets.support.FilterBuilder")],t.default),t.default});