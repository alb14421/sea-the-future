// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../Graphic","../../../PopupTemplate","../../../layers/GraphicsLayer","../../../popup/FieldInfo","../../../symbols/SimpleFillSymbol","./GeometryHandler"],function(e,r,t,a,o,n,l){"use strict";const i=`utility-network-trace-result-area-${Date.now()}`;function s(e){return"graphics"===e.type}e.ResultAreaHandler=class{constructor(){this.traceInformation={},this._geometryHandler=new l.GeometryHandler}addResultAreaToMap(e,r){const t=this.createGraphicLayer(r);t&&s(t)&&t.add(e)}changeResultAreaColor(e,r,t){const a=new n({color:r.color,style:"solid",outline:{color:r.color,width:1}}),o=this._findGraphicsByTraceId(e,t);return o&&o.forEach(e=>{e.symbol=a}),a}createBuffer(e,r,t,a){return this._geometryHandler.createBuffer(e,r,t,a)}createConvexHull(e,r,t){const a=this._geometryHandler.createConvexHull(e);return r>0&&a?this.createBuffer(a,[r],t,!1):a}createResultAreaGraphic(e,a,l,i,s,c){const u=new n({color:c.color,style:"solid",outline:{color:c.color,width:1}}),d=[];for(const e in a)d.push(new o({fieldName:e,label:"areaStatistic"===e?i.attributeStrings[e]+" ("+s.units[l]?.abbr+")":i.attributeStrings[e]}));return new r({geometry:e,symbol:u,attributes:a,popupTemplate:new t({title:a.traceName,content:[{type:"fields",fieldInfos:d}]})})}removeResultArea(e,r){const t=r.findLayerById(i);if(t&&s(t)){const a=this._findGraphicsByTraceId(e,r);return a&&t.removeMany(a),a}return null}removeAllResultAreaGraphics(e){if(e){const r=e.findLayerById(i);r&&s(r)&&r.removeAll()}}createGraphicLayer(e,r){const t=e.findLayerById(i);if(t&&s(t))return t;const o=new a({title:r??i,listMode:"hide",id:i});return e.add(o),o}_findGraphicsByTraceId(e,r){const t=r.findLayerById(i);if(t&&s(t)){const r=t.graphics.filter(r=>r.attributes.traceId===e);return r.length>0?r.toArray():null}return null}},e.resultAreaGraphicLayer=i,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});