// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","../../chunks/tslib.es6","../../intl","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../Widget","./searchResultRendererCSS","./SearchViewModel","../../chunks/componentsUtils","../support/globalCss","../support/widgetUtils","../support/decorators/messageBundle","../support/jsxFactory","../../intl/substitute"],function(e,s,t,r,o,l,i,n,c,u,a,d,h,p,g,m,w){"use strict";let M=class extends c{constructor(e,s){super(e,s),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}loadDependencies(){return d.loadCalciteComponents({block:()=>new Promise((s,t)=>e(["../../chunks/index13"],s,t)),list:()=>new Promise((s,t)=>e(["../../chunks/index16"],s,t)),"list-item":()=>new Promise((s,t)=>e(["../../chunks/index20"],s,t)),"list-item-group":()=>new Promise((s,t)=>e(["../../chunks/index55"],s,t))})}destroy(){this.viewModel=null}render(){return m.tsx("div",{class:this.classes(u.css.base,h.globalCss.widget)},this.viewModel?.selectedResult?.name??"",this._renderMoreResults())}_renderMoreResults(){if(!this.viewModel)return null;const{resultCount:e,results:s}=this.viewModel;return!e||e<2||!s?null:m.tsx("calcite-block",{class:u.css.moreResults,collapsible:!0,expanded:this.showMoreResultsOpen,heading:w.substitute(this.messages.showMoreResults,{count:e-1}),onCalciteBlockClose:()=>this._toggleShowMoreResults(!1),onCalciteBlockOpen:()=>this._toggleShowMoreResults(!0)},s.map(e=>this._renderMoreResultsList(e,s?.length>1)))}_renderListItem(e){return m.tsx("calcite-list-item",{key:`result-${e.sourceIndex}-${e.key}`,label:e.name,onCalciteListItemSelect:()=>this._selectResult(e)})}_renderMoreResultsList(e,s){const{results:t}=e;if(!t?.length||!t)return null;const r=this.viewModel?.selectedResult,o=this._getSourceName(e.source,e.sourceIndex),l=t.filter(e=>e!==r).map(e=>this._renderListItem(e));return m.tsx("calcite-list",{label:o},s?m.tsx("calcite-list-item-group",{heading:o,key:`group-${e.sourceIndex}`},l):l)}_selectResult(e){this.showMoreResultsOpen=!1,this.viewModel?.select(e)}_toggleShowMoreResults(e){this.showMoreResultsOpen=e;const s=this.viewModel?.view?.popup;s&&"reposition"in s&&s.reposition()}_getSourceName(e,s){return s===a.ALL_INDEX?this.messages.all:e.name}};return s.__decorate([r.property(),g.messageBundle("esri/widgets/Search/t9n/Search")],M.prototype,"messages",void 0),s.__decorate([r.property()],M.prototype,"showMoreResultsOpen",void 0),s.__decorate([r.property()],M.prototype,"viewModel",void 0),M=s.__decorate([n.subclass("esri.widgets.Search.SearchResultRenderer")],M),M});