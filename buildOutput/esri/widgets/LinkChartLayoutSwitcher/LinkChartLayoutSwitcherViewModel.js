// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../chunks/tslib.es6","../../core/Error","../../core/Evented","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../layers/knowledgeGraph/supportUtils"],function(t,e,o,r,a,i,n,s,l){"use strict";let h=class extends o.EventedAccessor{constructor(t){super(t),this._goToExtentController=null,this._scaleExtent=(t,e)=>{const o=t,r=(t.xmax-t.xmin)/2*(e-1),a=(t.ymax-t.ymin)/2*(e-1);return o.xmin=t.xmin-r,o.ymin=t.ymin-a,o.xmax=t.xmax+r,o.ymax=t.ymax+a,o},this.switchLayout=this.switchLayout.bind(this)}destroy(){this._cancelGoToExtent(),this.view=null}set view(t){this._set("view",t),t&&t.when().then(()=>{if(this.view===t){if(!this.view.map.linkChartProperties)throw new e("linkChartLayoutSwitcher:error","Link chart layouts are only supported on WebLinkCharts.");this.layout=l.convertLayoutTypeToWebSupportedFormat(this.view.map.linkChartProperties.layoutType)}})}get state(){return this.view?this.view.map.linkChartProperties?"ready":"disabled":"loading"}get layout(){return this._get("layout")||"organic-standard"}set layout(t){this._set("layout",t)}get preventExtentUpdate(){return this._get("preventExtentUpdate")||!1}set preventExtentUpdate(t){this._set("preventExtentUpdate",t)}async switchLayout(t){if(!this.view||!this.view.map)throw new e("linkChartLayoutSwitcher:loading-state","Cannot change layout when link chart has not loaded.");if(this.layout=t,await this.view.map.applyLayout(t),!this.preventExtentUpdate&&this.view.map.diagramNodesExtent){const e="geographic-organic-standard"!==t?this._scaleExtent(this.view.map.diagramNodesExtent,1.4):this.view.map.diagramNodesExtent,o=new AbortController;this._goToExtentController=o;try{await this.view.when(),await this.view.goTo(e,{signal:o.signal})}catch(t){}this._goToExtentController=null}this.emit("switchLayout",{layout:t})}_cancelGoToExtent(){const{_goToExtentController:t}=this;t&&t.abort(),this._goToExtentController=null}};return t.__decorate([r.property()],h.prototype,"_goToExtentController",void 0),t.__decorate([r.property()],h.prototype,"view",null),t.__decorate([r.property({readOnly:!0})],h.prototype,"state",null),t.__decorate([r.property()],h.prototype,"layout",null),t.__decorate([r.property()],h.prototype,"preventExtentUpdate",null),h=t.__decorate([s.subclass("esri.widgets.LinkChartLayoutSwitcher.LinkChartLayoutSwitcherViewModel")],h),h});