// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
require({cache:{"esri/WebDocument2D":function(){define(["require","./chunks/tslib.es6","./kernel","./Map","./Viewpoint","./core/arrayUtils","./core/Collection","./core/Error","./core/Loadable","./core/loadAll","./core/Logger","./core/maybe","./core/MultiOriginJSONSupport","./core/Promise","./core/promiseUtils","./core/reactiveUtils","./core/urlUtils","./core/accessorSupport/decorators/property","./core/has","./core/accessorSupport/decorators/reader","./core/accessorSupport/decorators/subclass","./core/accessorSupport/decorators/writer","./core/accessorSupport/read","./geometry/SpatialReference","./portal/PortalItem","./portal/support/portalItemUtils","./support/MapFloorInfo","./chunks/TimeExtent","./webdoc/RangeInfo","./webdoc/Widgets","./webdoc/support/thumbnailUtils","./webdoc/support/webdocLoadUtils","./webdoc/support/writeUtils","./webmap/ApplicationProperties","./webmap/Bookmark","./webmap/InitialViewProperties","./webmap/Version","./webmap/background/ColorBackground"],function(e,t,r,o,s,i,n,a,c,p,l,u,d,y,m,h,g,b,f,w,_,S,v,I,T,N,j,k,O,L,x,E,R,C,P,A,U,F){"use strict";const V=n.ofType(P),J=new Map([["image/jpeg","jpeg"],["image/jpg","jpg"],["image/png","png"],["image/gif","gif"]]),M=N.typeKeyword.JSAPI;let G=class extends(d.MultiOriginJSONMixin(c.LoadableMixin(y.EsriPromiseMixin(o)))){constructor(t){super(t),this._isAuthoringAppSetByUser=!1,this._isAuthoringAppVersionSetByUser=!1,this._thumbnailFilename=null,this._updateFromPromise=null,this.resourceReferences={portalItem:null,paths:[]},this.applicationProperties=null,this.bookmarks=new V,this.floorInfo=null,this.initialViewProperties=new A,this.portalItem=null,this.sourceVersion=null,this.widgets=null,this._debouncedSaveOperations=m.debounce(async(t,r,o)=>{const{save:s,saveAs:i}=await new Promise((t,r)=>e(["./webdoc/support/webdocSaveUtils"],t,r));switch(t){case 0:return s(this.context,this,r);case 1:return i(this.context,this,o,r)}}),this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){this.portalItem=u.destroyMaybe(this.portalItem)}initialize(){if(this.when().catch(e=>{l.getLogger(this).error("#load()","Failed to load web map",e)}),this.resourceInfo){let e;try{e=this._validateJSON(this.resourceInfo)}catch(e){return void this.addResolvingPromise(Promise.reject(e))}this.read(e)}}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e)}writeAuthoringApp(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp=M}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e)}writeAuthoringAppVersion(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=r.version}readInitialViewProperties(e,t){const r=new A;t.background&&(r.background=F.fromJSON(t.background));const o=t.initialState?.timeExtent;o&&(r.timeExtent=k.TimeExtent.fromArray(o));const i=t.initialState?.viewpoint;return i&&(i.rotation&&U.Version.parse(t.version||"","webmap").lessThan(2,20)&&"ArcGIS Pro"===t.authoringApp&&(i.rotation*=-1),r.viewpoint=s.fromJSON(i)),t.mapRangeInfo&&(r.rangeInfo=O.fromJSON(t.mapRangeInfo)),t.spatialReference&&(r.spatialReference=I.fromJSON(t.spatialReference)),t.timeZone&&(r.timeZone=t.timeZone),r}writeInitialViewProperties(e,t,r,o){if(!e)return;e.background?.color&&(t.background=e.background.write({},o));const{timeExtent:s,viewpoint:i}=e;if(i||s){const e={};i&&(e.viewpoint=i.write({},o)),s&&(e.timeExtent=s.toArray()),t.initialState=e}e.rangeInfo&&(t.mapRangeInfo=e.rangeInfo.toJSON(o)),e.spatialReference&&(t.spatialReference=e.spatialReference.write({},o)),t.timeZone=e.timeZone}writeLayers(e,t,r,o){t[r]=this._writeLayers(e,o,"operational-layers")}get loaded(){return super.loaded}readSourceVersion(e,t){const[r,o]=t.version.split(".");return new U.Version(parseInt(r,10),parseInt(o,10))}writeSourceVersion(e,t,r){t[r]=`${this.context.currentVersion.major}.${this.context.currentVersion.minor}`}writeTables(e,t,r,o){const s=this._writeLayers(e,o,"tables");s.length&&(t[r]=s)}get thumbnailUrl(){return this.portalItem?.thumbnailUrl||null}set thumbnailUrl(e){e?(this._override("thumbnailUrl",e),this._thumbnailFilename=this._generateCustomThumbnailFilename(e)):this._clearThumbnailOverride()}get updatingFromView(){return!!this._updateFromPromise}load(e){return this.addResolvingPromise(E.loadFromSource(this.context,this)),Promise.resolve(this)}loadAll(){return p.loadAll(this,e=>{e(this.ground,this.basemap,this.layers,this.tables)})}read(e,t){t={...t,origin:this.context.origin};const r=this._getAuthoringPropsState();v.readLoadable(this,e,t=>super.read(e,t),t),this._restoreAuthoringPropsFromState(r)}write(e,t){if("loaded"!==this.loadStatus){const e=new a("webmap:not-loaded","Web map must be loaded before it can be serialized");throw l.getLogger(this).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),e}return this._removeDanglingLayerRefs(),t={...t,origin:this.context.origin,restrictedWebMapWriting:!0,webmap:this},super.write(e,t)}async save(e){return this._debouncedSaveOperations(0,e)}async saveAs(e,t){return this._debouncedSaveOperations(1,t,e)}async updateFrom(e,t){const r=this._updateFromInternal(e,t);this._updateFromPromise=r,await r,r===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(e){const t=this.resourceInfo;return this._collectAllLayersJSON([...t?.baseMap?.baseMapLayers||[],...t?.operationalLayers||[],...this.basemap?.resourceInfo?.data?.baseMapLayers||[]]).find(t=>t.id===e.id)}async updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await(this.portalItem?.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename})),this._clearThumbnailOverride())}getThumbnailState(){let e=this.thumbnailUrl;return e&&(e=this._isOverridden("thumbnailUrl")?e:g.addQueryParameter(e,"w","8192")),{thumbnailUrl:e,filename:this._thumbnailFilename}}restoreThumbnailFromState(e){this.thumbnailUrl=e.thumbnailUrl,this._thumbnailFilename=e.filename}_collectAllLayersJSON(e){return e.reduce((e,t)=>(e.push(t),"GroupLayer"===t.layerType&&(e=e.concat(this._collectAllLayersJSON(t.layers||[]))),e),[])}_writeLayers(e,t,r){return t={...t,layerContainerType:r},e.map(e=>R.getLayerJSON(e,"tables"===r?null:this.getLayerJSONFromResourceInfo(e),t)).filter(i.isSome).toArray()}_validateJSON(e){const t=U.Version.parse(e.version||"","webmap");return this.context.currentVersion.validate(t),e.version=`${t.major}.${t.minor}`,e}_removeDanglingLayerRefs(){const e=this.applicationProperties,t=e?.viewing?.search,r=e=>this.allLayers.some(t=>t.id===e);if(t?.layers&&(t.layers=t.layers.filter(e=>r(e.id))),t?.tables&&(t.tables=t.tables.filter(e=>this.tables.some(t=>t.id===e.id))),e){const t=e.editing?.locationTracking;t?.info&&!r(t.info.layerId)&&(e.editing=null)}const o="presentation"in this?this.presentation:null,s=o?.slides;s&&s.forEach(e=>{e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter(e=>r(e.id)))})}async _updateFromInternal(e,t){if(t??={},await h.whenOnce(()=>e.ready),this._updateInitialViewProperties(e,t),e.map===this)for(const t of e.allLayerViews)"visible"in t&&"visible"in t.layer&&t._isOverridden("visible")&&(t.layer.visible=t.visible),"featureEffect"in t&&"featureEffect"in t.layer&&t._isOverridden("featureEffect")&&(t.layer.featureEffect=t.featureEffect);await this._updateThumbnailUrl(e,t)}_updateInitialViewProperties(e,t){if(t.backgroundExcluded||(this.initialViewProperties.background=e.background?.clone()),this.initialViewProperties.spatialReference=e.spatialReference?.clone(),this.initialViewProperties.timeZone=e.timeZone,t.viewpointExcluded||(this.initialViewProperties.viewpoint=new s({rotation:e.rotation,scale:t.scalePreserved?e.scale:null,targetGeometry:this._getViewExtent(e)})),!t.widgetsExcluded)for(const t of e.persistableViewModels)t.updateWebDocument(this)}_getViewExtent(e){const t=e.center.clone().normalize(),r=e.extent.clone(),o=r.width/2;return r.xmin=t.x-o,r.xmax=t.x+o,r}async _updateThumbnailUrl(e,t){if(t.thumbnailExcluded)return;const r=x.getOptimalThumbnailSize(e,t.thumbnailSize),o=await e.takeScreenshot({format:"png",width:r.width,height:r.height});this._setAutoGeneratedThumbnail(o.dataUrl)}_setAutoGeneratedThumbnail(e){this.thumbnailUrl=e,this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null}_generateCustomThumbnailFilename(e){if(g.isDataProtocol(e)){const t=g.dataComponents(e),r=t?.mediaType,o=r&&J.get(r.toLowerCase())||null,s=`thumbnail${Date.now()}`;return o?`${s}.${o}`:s}return null}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(e){e.isAuthoringAppSetByUser?this.authoringApp=e.authoringApp:this._isAuthoringAppSetByUser=!1,e.isAuthoringAppVersionSetByUser?this.authoringAppVersion=e.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}};return t.__decorate([b.property()],G.prototype,"_updateFromPromise",void 0),t.__decorate([b.property({type:C,json:{write:!0}})],G.prototype,"applicationProperties",void 0),t.__decorate([b.property({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],G.prototype,"authoringApp",null),t.__decorate([S.writer("authoringApp")],G.prototype,"writeAuthoringApp",null),t.__decorate([b.property({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],G.prototype,"authoringAppVersion",null),t.__decorate([S.writer("authoringAppVersion")],G.prototype,"writeAuthoringAppVersion",null),t.__decorate([b.property({type:V,json:{write:{overridePolicy:e=>({enabled:!!(e&&e.length>0),ignoreOrigin:!0})}}})],G.prototype,"bookmarks",void 0),t.__decorate([b.property({type:j,json:{name:"mapFloorInfo",write:!0}})],G.prototype,"floorInfo",void 0),t.__decorate([b.property({type:A,nonNullable:!0,json:{read:{source:["background","initialState.timeExtent","initialState.viewpoint","mapRangeInfo","spatialReference","timeZone"]},write:{ignoreOrigin:!0,target:{background:{type:F},"initialState.timeExtent":{type:k.TimeExtent},"initialState.viewpoint":{type:s},mapRangeInfo:{type:O},spatialReference:{type:I},"timeZone:":{type:String}}}}})],G.prototype,"initialViewProperties",void 0),t.__decorate([w.reader("initialViewProperties")],G.prototype,"readInitialViewProperties",null),t.__decorate([S.writer("initialViewProperties")],G.prototype,"writeInitialViewProperties",null),t.__decorate([b.property({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],G.prototype,"layers",void 0),t.__decorate([S.writer("layers")],G.prototype,"writeLayers",null),t.__decorate([b.property({type:T})],G.prototype,"portalItem",void 0),t.__decorate([b.property()],G.prototype,"resourceInfo",void 0),t.__decorate([b.property({readOnly:!0,type:U.Version,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],G.prototype,"sourceVersion",void 0),t.__decorate([w.reader("sourceVersion")],G.prototype,"readSourceVersion",null),t.__decorate([S.writer("sourceVersion")],G.prototype,"writeSourceVersion",null),t.__decorate([b.property({json:{read:!1,write:{ignoreOrigin:!0}}})],G.prototype,"tables",void 0),t.__decorate([S.writer("tables")],G.prototype,"writeTables",null),t.__decorate([b.property()],G.prototype,"thumbnailUrl",null),t.__decorate([b.property()],G.prototype,"updatingFromView",null),t.__decorate([b.property({type:L,json:{write:!0}})],G.prototype,"widgets",void 0),G=t.__decorate([_.subclass("esri.WebDocument2D")],G),G})},"esri/support/MapFloorInfo":function(){define(["../chunks/tslib.es6","../core/JSONSupport","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../layers/support/FacilityLayerInfo","../layers/support/LevelLayerInfo","../layers/support/SiteLayerInfo"],function(e,t,r,o,s,i,n,a,c,p){"use strict";let l=class extends t.JSONSupport{constructor(e){super(e),this.levelLayer=null,this.facilityLayer=null,this.siteLayer=null}};return e.__decorate([r.property({type:c,json:{write:{isRequired:!0}}})],l.prototype,"levelLayer",void 0),e.__decorate([r.property({type:a,json:{write:{isRequired:!0}}})],l.prototype,"facilityLayer",void 0),e.__decorate([r.property({type:p,json:{write:!0}})],l.prototype,"siteLayer",void 0),l=e.__decorate([n.subclass("esri.support.MapFloorInfo")],l),l})},"esri/layers/support/FacilityLayerInfo":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n){"use strict";let a=class extends t.JSONSupport{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};return e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"facilityIdField",void 0),e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"layerId",void 0),e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"nameField",void 0),e.__decorate([r.property({type:String,json:{write:!0}})],a.prototype,"siteIdField",void 0),e.__decorate([r.property({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"sublayerId",void 0),a=e.__decorate([n.subclass("esri.layers.support.FacilityLayerInfo")],a),a})},"esri/layers/support/LevelLayerInfo":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n){"use strict";let a=class extends t.JSONSupport{constructor(e){super(e),this.facilityIdField=null,this.layerId=null,this.levelIdField=null,this.levelNumberField=null,this.longNameField=null,this.shortNameField=null,this.sublayerId=null,this.verticalOrderField=null}};return e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"facilityIdField",void 0),e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"layerId",void 0),e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"levelIdField",void 0),e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"levelNumberField",void 0),e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"longNameField",void 0),e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"shortNameField",void 0),e.__decorate([r.property({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"sublayerId",void 0),e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"verticalOrderField",void 0),a=e.__decorate([n.subclass("esri.layers.support.LevelLayerInfo")],a),a})},"esri/layers/support/SiteLayerInfo":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n){"use strict";let a=class extends t.JSONSupport{constructor(e){super(e),this.layerId=null,this.nameField=null,this.siteIdField=null,this.sublayerId=null}};return e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"layerId",void 0),e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"nameField",void 0),e.__decorate([r.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"siteIdField",void 0),e.__decorate([r.property({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"sublayerId",void 0),a=e.__decorate([n.subclass("esri.layers.support.SiteLayerInfo")],a),a})},"esri/webdoc/RangeInfo":function(){define(["../chunks/tslib.es6","../core/JSONSupport","../core/lang","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n){"use strict";var a;let c=a=class extends t.JSONSupport{constructor(e){super(e),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null}clone(){return new a(r.clone({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};return e.__decorate([o.property({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],c.prototype,"activeRange",void 0),e.__decorate([o.property({type:[Number],json:{write:!0}})],c.prototype,"currentRangeExtent",void 0),e.__decorate([o.property({type:[Number],json:{write:!0}})],c.prototype,"fullRangeExtent",void 0),c=a=e.__decorate([n.subclass("esri.webdoc.RangeInfo")],c),c})},"esri/webdoc/Widgets":function(){define(["../chunks/tslib.es6","../core/JSONSupport","../core/lang","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/accessorSupport/decorators/subclass","./widgets/FloorFilter","./widgets/Range","./widgets/TimeSlider"],function(e,t,r,o,s,i,n,a,c,p){"use strict";var l;let u=l=class extends t.JSONSupport{constructor(e){super(e),this.range=null,this.timeSlider=null,this.floorFilter=null}clone(){return new l(r.clone({range:this.range,timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};return e.__decorate([o.property({type:c,json:{write:!0}})],u.prototype,"range",void 0),e.__decorate([o.property({type:p,json:{write:!0}})],u.prototype,"timeSlider",void 0),e.__decorate([o.property({type:a,json:{write:!0}})],u.prototype,"floorFilter",void 0),u=l=e.__decorate([n.subclass("esri.webdoc.Widgets")],u),u})},"esri/webdoc/widgets/FloorFilter":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/lang","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n){"use strict";var a;let c=a=class extends t.JSONSupport{constructor(e){super(e),this.enabled=!1,this.longNames=!1,this.minimized=!1,this.pinnedLevels=!1,this.site=null,this.facility=null,this.level=null}clone(){return new a(r.clone({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};return e.__decorate([o.property({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],c.prototype,"enabled",void 0),e.__decorate([o.property({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],c.prototype,"longNames",void 0),e.__decorate([o.property({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],c.prototype,"minimized",void 0),e.__decorate([o.property({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],c.prototype,"pinnedLevels",void 0),e.__decorate([o.property({type:String,json:{read:{source:"site"},write:{target:"site"}}})],c.prototype,"site",void 0),e.__decorate([o.property({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],c.prototype,"facility",void 0),e.__decorate([o.property({type:String,json:{read:{source:"level"},write:{target:"level"}}})],c.prototype,"level",void 0),c=a=e.__decorate([n.subclass("esri.webdoc.widgets.FloorFilter")],c),c})},"esri/webdoc/widgets/Range":function(){define(["../../chunks/tslib.es6","../../core/jsonMap","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/has","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a){"use strict";var c;const p=new t.JSONMap({slider:"slider",picker:"picker"});let l=c=class extends r.JSONSupport{constructor(e){super(e),this.interactionMode=null,this.numStops=null,this.stopInterval=null}clone(){return new c({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};return e.__decorate([o.property({type:p.apiValues,nonNullable:!0,json:{type:p.jsonValues,default:null,read:{reader:p.read},write:{isRequired:!0,writer:p.write}}})],l.prototype,"interactionMode",void 0),e.__decorate([o.property({type:s.Integer,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const e=null!=this.stopInterval;return{enabled:!e,isRequired:!e}}}}})],l.prototype,"numStops",void 0),e.__decorate([o.property({type:Number,json:{write:{overridePolicy(){return{isRequired:null==this.numStops}}}}})],l.prototype,"stopInterval",void 0),l=c=e.__decorate([a.subclass("esri.webdoc.widgets.Range")],l),l})},"esri/webdoc/widgets/TimeSlider":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/lang","../../core/object","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/decorators/writer","../../portal/timeUnitKebabDictionary","../../chunks/TimeExtent","../../chunks/TimeInterval"],function(e,t,r,o,s,i,n,a,c,p,l,u){"use strict";var d;let y=d=class extends t.JSONSupport{constructor(e){super(e),this.currentTimeExtent=null,this.fullTimeExtent=null,this.loop=!1,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null,this.stops=null}readCurrentTimeExtent(e){return e?l.TimeExtent.fromArray(e):void 0}writeCurrentTimeExtent(e,t,r){e&&o.setDeepValue(r,e.toArray(),t)}readFullTimeExtent(e,t){const r=t.properties;if(!r)return;const o=null!=r.endTime?new Date(r.endTime):null,s=null!=r.startTime?new Date(r.startTime):null;return new l.TimeExtent({start:s,end:o})}writeFullTimeExtent(e,t){if(!e)return;const r=t.properties=t.properties||{},o=e.end,s=e.start;o&&(r.endTime=null!=o?o.getTime():null),s&&(r.startTime=null!=s?s.getTime():null)}readStopInterval(e,t,r){return e?u.TimeInterval.fromJSON({value:e.interval,unit:e.units},r):null}writeStopInterval(e,t,r,s){if(!e)return;const i=e.toJSON(s);o.setDeepValue("properties.timeStopInterval",{interval:i.value,units:i.unit},t)}readStops(e){return e?.length?e.map(e=>new Date(e)):null}writeStops(e,t,r){e?.length&&o.setDeepValue(r,e.map(e=>e.getTime()),t)}clone(){return new d(r.clone({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};return e.__decorate([s.property({type:l.TimeExtent,json:{type:[[i.Integer,i.Null]],read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],y.prototype,"currentTimeExtent",void 0),e.__decorate([n.reader("currentTimeExtent")],y.prototype,"readCurrentTimeExtent",null),e.__decorate([c.writer("currentTimeExtent")],y.prototype,"writeCurrentTimeExtent",null),e.__decorate([s.property({type:l.TimeExtent,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],y.prototype,"fullTimeExtent",void 0),e.__decorate([n.reader("fullTimeExtent")],y.prototype,"readFullTimeExtent",null),e.__decorate([c.writer("fullTimeExtent")],y.prototype,"writeFullTimeExtent",null),e.__decorate([s.property({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],y.prototype,"loop",void 0),e.__decorate([s.property({type:i.Integer,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){const e=!!this.stopInterval,t=!!this.stops?.length,r=!(e||t);return{enabled:r,isRequired:r}}}}})],y.prototype,"numStops",void 0),e.__decorate([s.property({type:[1,2],nonNullable:!0,json:{type:i.Integer,read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],y.prototype,"numThumbs",void 0),e.__decorate([s.property({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],y.prototype,"stopDelay",void 0),e.__decorate([s.property({type:u.TimeInterval,json:{read:{source:"properties.timeStopInterval"},write:{target:{"properties.timeStopInterval.interval":{type:Number},"properties.timeStopInterval.units":{type:p.timeUnitKebabDictionary.jsonValues.filter(e=>"esriTimeUnitsUnknown"!==e)}},overridePolicy(){const e=null!=this.numStops,t=!!this.stops?.length;return{enabled:!t,isRequired:!(e||t)}}}}})],y.prototype,"stopInterval",void 0),e.__decorate([n.reader("stopInterval")],y.prototype,"readStopInterval",null),e.__decorate([c.writer("stopInterval")],y.prototype,"writeStopInterval",null),e.__decorate([s.property({type:[Date],json:{type:[i.Integer],read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:null==this.numStops&&!this.stopInterval}}}}})],y.prototype,"stops",void 0),e.__decorate([n.reader("stops")],y.prototype,"readStops",null),e.__decorate([c.writer("stops")],y.prototype,"writeStops",null),y=d=e.__decorate([a.subclass("esri.webdoc.widgets.TimeSlider")],y),y})},"esri/webdoc/support/thumbnailUtils":function(){define(["exports"],function(e){"use strict";const t={width:600,height:400},r=1.5;e.getOptimalThumbnailSize=function(e,o){o=o||t;let{width:s,height:i}=o;const n=s/i;return n<r?i=s/r:n>r&&(s=i*r),s>e.width&&(i*=e.width/s,s=e.width),i>e.height&&(s*=e.height/i,i=e.height),{width:Math.round(s),height:Math.round(i)}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/webdoc/support/webdocLoadUtils":function(){define(["require","exports","../../Viewpoint","../../core/Error","../../core/Logger","../../geometry/support/webMercatorUtils","../../portal/Portal","../../portal/support/jsonContext","../../rest/geometryService/project","../../rest/support/ProjectParameters"],function(e,t,r,o,s,i,n,a,c,p){"use strict";function l(t,r,o){const s={context:{...o,layerContainerType:"operational-layers"}};return t.portalItem&&(s.context.portal=t.portalItem.portal||n.getDefault()),new Promise((t,r)=>e(["../../layers/support/layersCreator"],t,r)).then(({populateOperationalLayers:e})=>{const o=[],i=r.operationalLayers;i?.length&&o.push(e(t.layers,i,s));const n={...s,context:{...s.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},a=r.tables;return a?.length&&o.push(e(t.tables,a,n)),Promise.allSettled(o).then(()=>{})})}t.loadFromSource=function(t,n){return n.resourceInfo?l(n,n.resourceInfo,{origin:t.origin}):n.portalItem?.id?async function(t,n,u){if(await u.load().catch(e=>{throw new o(`${t.name}:load-portal-item`,"Failed to load portal item",{error:e})}),u.type!==t.itemType)throw new o(`${t.name}:invalid-portal-item`,`Invalid portal item type '${u.type}', expected '${t.itemType}'`,{type:u.type});const d=await u.fetchData();n.resourceInfo=d;const y=a.createForItemRead(u,t.origin);await function(e,t,r,o){const s=function(e,t){const r=e.parseVersion(t.version||"",e.name);return e.currentVersion.validate(r),t.version=`${r.major}.${r.minor}`,t}(e,r);return t.read(s,o),l(t,s,o)}(t,n,d,y),n.resourceReferences={portalItem:u,paths:y.readResourcePaths};const m=await async function(t,o,s){const n=t?.viewpoint?.targetGeometry;if(n)return null;const a=await async function(t,r,o){const s=t?.spatialReference,n=r?.extent;if(!s||!n)return null;if(s.isWGS84)return n.clone();if(s.isWebMercator)return i.geographicToWebMercator(n);const{getGeometryServiceURL:a}=await new Promise((t,r)=>e(["../../portal/support/geometryServiceUtils"],t,r));try{const e=await a(r),t=new p({geometries:[n],outSpatialReference:s});return(await c.project(e,t))[0]}catch(e){o.error("Error projecting item's extent:",e)}return null}(t,o,s);return a?new r({targetGeometry:a}):null}(n.initialViewProperties,u,s.getLogger(n));if(m){const e=n.initialViewProperties?.clone()??t.createInitialViewProperties();e.viewpoint=m,n.initialViewProperties=e}}(t,n,n.portalItem):Promise.resolve()},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/portal/support/jsonContext":function(){define(["exports","../../core/urlUtils","../Portal"],function(e,t,r){"use strict";function o(e,o){return{origin:o,url:t.urlToObject(e.itemUrl),portal:e.portal||r.getDefault(),portalItem:e}}e.createForItemRead=function(e,t){return{...o(e,t),readResourcePaths:[]}},e.createForItemWrite=function(e,r,s){const i=t.urlToObject(e.itemUrl);return{...o(e,r),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:i?{rootPath:i.path,writtenUrls:[]}:null,resources:s?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/project":function(){define(["exports","../../request","../../core/accessorSupport/ensureType","../../geometry/support/jsonUtils","../utils","./utils","../support/ProjectParameters"],function(e,t,r,o,s,i,n){"use strict";const a=r.ensureType(n);e.project=async function(e,r,n){r=a(r);const c=s.parseUrl(e),p={...c.query,f:"json",...r.toJSON()},l=r.outSpatialReference,u=o.getJsonType(r.geometries[0]),d=s.asValidOptions(p,n);return t(c.path+"/project",d).then(({data:{geometries:e}})=>i.decodeGeometries(e,u,l))},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ProjectParameters":function(){define(["exports","../../chunks/tslib.es6","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../geometry/SpatialReference","../../geometry/support/jsonUtils","../../geometry/support/spatialReferenceUtils"],function(e,t,r,o,s,i,n,a,c,p,l){"use strict";return e.default=class extends r.JSONSupport{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(e=>e.toJSON()),t=this.geometries[0],r={};return r.outSR=l.srToRESTValue(this.outSpatialReference),r.inSR=l.srToRESTValue(t.spatialReference),r.geometries=JSON.stringify({geometryType:p.getJsonType(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(r.transformForward=this.transformForward),r}},t.__decorate([o.property()],e.default.prototype,"geometries",void 0),t.__decorate([o.property({type:c,json:{read:{source:"outSR"}}})],e.default.prototype,"outSpatialReference",void 0),t.__decorate([o.property()],e.default.prototype,"transformation",void 0),t.__decorate([o.property()],e.default.prototype,"transformForward",void 0),e.default=t.__decorate([a.subclass("esri.rest.support.ProjectParameters")],e.default),e.default})},"esri/webmap/ApplicationProperties":function(){define(["../chunks/tslib.es6","../core/JSONSupport","../core/lang","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/accessorSupport/decorators/subclass","../webdoc/applicationProperties/Viewing"],function(e,t,r,o,s,i,n,a){"use strict";var c;let p=c=class extends t.JSONSupport{constructor(e){super(e),this.editing=null,this.offline=null,this.viewing=null}clone(){return new c(r.clone({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};return e.__decorate([o.property({json:{write:!0}})],p.prototype,"editing",void 0),e.__decorate([o.property({json:{write:!0}})],p.prototype,"offline",void 0),e.__decorate([o.property({type:a,json:{write:!0}})],p.prototype,"viewing",void 0),p=c=e.__decorate([n.subclass("esri.webmap.ApplicationProperties")],p),p})},"esri/webdoc/applicationProperties/Viewing":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/lang","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/accessorSupport/decorators/subclass","./Search"],function(e,t,r,o,s,i,n,a){"use strict";var c;let p=c=class extends t.JSONSupport{constructor(e){super(e),this.search=null}clone(){return new c(r.clone({search:this.search}))}};return e.__decorate([o.property({type:a,json:{write:!0}})],p.prototype,"search",void 0),p=c=e.__decorate([n.subclass("esri.webdoc.applicationProperties.Viewing")],p),p})},"esri/webdoc/applicationProperties/Search":function(){define(["../../chunks/tslib.es6","../../core/Collection","../../core/JSONSupport","../../core/lang","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/decorators/writer","../../core/accessorSupport/extensions/serializableProperty/writePolicyUtils","./SearchLayer","./SearchTable"],function(e,t,r,o,s,i,n,a,c,p,l,u,d){"use strict";var y;const m=t.ofType(u),h=t.ofType(d);let g=y=class extends r.JSONSupport{constructor(e){super(e),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new m,this.tables=new h}readAddressSearchEnabled(e){return!e}writeAddressSearchEnabled(e,t,r){t[r]=!e}clone(){return new y(o.clone({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};return e.__decorate([s.property({type:Boolean,nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],g.prototype,"addressSearchEnabled",void 0),e.__decorate([a.reader("addressSearchEnabled")],g.prototype,"readAddressSearchEnabled",null),e.__decorate([p.writer("addressSearchEnabled")],g.prototype,"writeAddressSearchEnabled",null),e.__decorate([s.property({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,write:!0}}}})],g.prototype,"enabled",void 0),e.__decorate([s.property({type:String,json:{write:!0}})],g.prototype,"hintText",void 0),e.__decorate([s.property({type:m,json:{write:{overridePolicy:l.writeNonEmptyCollectionPolicy},origins:{"web-scene":{write:{isRequired:!0}}}}})],g.prototype,"layers",void 0),e.__decorate([s.property({type:h,json:{read:!0,write:{overridePolicy:l.writeNonEmptyCollectionPolicy}}})],g.prototype,"tables",void 0),g=y=e.__decorate([c.subclass("esri.webdoc.applicationProperties.Search")],g),g})},"esri/core/accessorSupport/extensions/serializableProperty/writePolicyUtils":function(){define(["exports"],function(e){"use strict";e.writeNonEmptyCollectionPolicy=function(e){return{enabled:!!e?.length}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/webdoc/applicationProperties/SearchLayer":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/lang","../../core/accessorSupport/decorators/property","../../core/accessorSupport/ensureType","../../core/accessorSupport/decorators/subclass","./SearchLayerField"],function(e,t,r,o,s,i,n){"use strict";var a;let c=a=class extends t.JSONSupport{constructor(e){super(e),this.field=null,this.id=null,this.subLayer=null}clone(){return new a(r.clone({field:this.field,id:this.id,subLayer:this.subLayer}))}};return e.__decorate([o.property({type:n,json:{write:{isRequired:!0}}})],c.prototype,"field",void 0),e.__decorate([o.property({type:String,json:{write:{isRequired:!0}}})],c.prototype,"id",void 0),e.__decorate([o.property({type:s.Integer,json:{write:!0}})],c.prototype,"subLayer",void 0),c=a=e.__decorate([i.subclass("esri.webdoc.applicationProperties.SearchLayer")],c),c})},"esri/webdoc/applicationProperties/SearchLayerField":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/enumeration","../../core/accessorSupport/decorators/subclass","../../layers/support/fieldType"],function(e,t,r,o,s,i,n,a,c){"use strict";var p;let l=p=class extends t.JSONSupport{constructor(e){super(e),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new p({exactMatch:this.exactMatch,type:this.type,name:this.name})}};return e.__decorate([r.property({type:Boolean,json:{write:!0}})],l.prototype,"exactMatch",void 0),e.__decorate([r.property({type:String,json:{write:!0}})],l.prototype,"name",void 0),e.__decorate([n.enumeration(c.kebabDict)],l.prototype,"type",void 0),l=p=e.__decorate([a.subclass("esri.webdoc.applicationProperties.SearchLayerField")],l),l})},"esri/webdoc/applicationProperties/SearchTable":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/lang","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/accessorSupport/decorators/subclass","./SearchTableField"],function(e,t,r,o,s,i,n,a){"use strict";var c;let p=c=class extends t.JSONSupport{constructor(e){super(e),this.field=null,this.id=null}clone(){return new c(r.clone({field:this.field,id:this.id}))}};return e.__decorate([o.property({type:a,json:{write:{isRequired:!0}}})],p.prototype,"field",void 0),e.__decorate([o.property({type:String,json:{write:{isRequired:!0}}})],p.prototype,"id",void 0),p=c=e.__decorate([n.subclass("esri.webdoc.applicationProperties.SearchTable")],p),p})},"esri/webdoc/applicationProperties/SearchTableField":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/enumeration","../../core/accessorSupport/decorators/subclass","../../layers/support/fieldType"],function(e,t,r,o,s,i,n,a,c){"use strict";var p;let l=p=class extends t.JSONSupport{constructor(e){super(e),this.exactMatch=!1,this.name=null,this.type=null}clone(){return new p({exactMatch:this.exactMatch,type:this.type,name:this.name})}};return e.__decorate([r.property({type:Boolean,json:{write:!0}})],l.prototype,"exactMatch",void 0),e.__decorate([r.property({type:String,json:{write:!0}})],l.prototype,"name",void 0),e.__decorate([n.enumeration(c.kebabDict)],l.prototype,"type",void 0),l=p=e.__decorate([a.subclass("esri.webdoc.applicationProperties.SearchTableField")],l),l})},"esri/webmap/Bookmark":function(){define(["../chunks/tslib.es6","../Viewpoint","../core/Error","../core/Identifiable","../core/JSONSupport","../core/lang","../core/Logger","../core/accessorSupport/decorators/property","../core/accessorSupport/decorators/cast","../core/accessorSupport/decorators/reader","../core/accessorSupport/decorators/subclass","../core/accessorSupport/decorators/writer","../core/accessorSupport/ensureType","../webdoc/support/SlideThumbnail","../webdoc/support/timeProperties"],function(e,t,r,o,s,i,n,a,c,p,l,u,d,y,m){"use strict";var h;let g=h=class extends(o.IdentifiableMixin(s.JSONSupport)){constructor(e){super(e),this.name=null,this.thumbnail=new y.SlideThumbnail,this.timeExtent=null}castThumbnail(e){return"string"==typeof e?new y.SlideThumbnail({url:e}):d.ensureType(y.SlideThumbnail,e)}set viewpoint(e){const{targetGeometry:t,scale:r}=e;null!=t&&"point"===t.type&&null==r&&n.getLogger(this).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",e),this._set("viewpoint",e)}readViewpoint(e,r){const{extent:o,viewpoint:s}=r;return t.fromJSON(s||{targetGeometry:o})}writeViewpoint(e,t,o,s){if(!e)return;const{targetGeometry:i}=e;if(null!=i&&"extent"!==i.type){const e="Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.";return void(s?.messages?s.messages.push(new r("property:unsupported",e)):n.getLogger(this).error(e))}null!=i&&(t.extent=i.toJSON()),t[o]=e.toJSON()}clone(){return new h(i.clone({name:this.name,thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};return e.__decorate([a.property({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],g.prototype,"name",void 0),e.__decorate([a.property({type:y.SlideThumbnail,json:{write:{overridePolicy:e=>({enabled:!(!e||!e.url)})}}})],g.prototype,"thumbnail",void 0),e.__decorate([c.cast("thumbnail")],g.prototype,"castThumbnail",null),e.__decorate([a.property(m.timeExtent)],g.prototype,"timeExtent",void 0),e.__decorate([a.property({type:t,nonNullable:!0,json:{write:!0}})],g.prototype,"viewpoint",null),e.__decorate([p.reader("viewpoint",["extent","viewpoint"])],g.prototype,"readViewpoint",null),e.__decorate([u.writer("viewpoint")],g.prototype,"writeViewpoint",null),g=h=e.__decorate([l.subclass("esri.webmap.Bookmark")],g),g})},"esri/webdoc/support/SlideThumbnail":function(){define(["exports","../../chunks/tslib.es6","../../core/JSONSupport","../../core/urlUtils","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a,c){"use strict";var p;e.SlideThumbnail=p=class extends r.JSONSupport{constructor(){super(...arguments),this.url=""}destroy(){this.url=""}get isSecureUrl(){return o.isHTTPSProtocol(this.url)}get isDataURI(){return o.isDataProtocol(this.url)}clone(){return new p({url:this.url})}},t.__decorate([s.property({type:String,json:{write:{isRequired:!0}}})],e.SlideThumbnail.prototype,"url",void 0),t.__decorate([s.property()],e.SlideThumbnail.prototype,"isSecureUrl",null),t.__decorate([s.property()],e.SlideThumbnail.prototype,"isDataURI",null),e.SlideThumbnail=p=t.__decorate([c.subclass("esri.webdoc.support.SlideThumbnail")],e.SlideThumbnail),Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/webdoc/support/timeProperties":function(){define(["exports","../../core/Error","../../core/accessorSupport/ensureType","../../chunks/TimeExtent"],function(e,t,r,o){"use strict";const s={type:o.TimeExtent,json:{read:{source:"timeExtent",reader:e=>e?Array.isArray(e)?o.TimeExtent.fromArray(e):o.TimeExtent.fromJSON(e):null},write:{writer:(e,r,o,s)=>{e&&(e.isEmpty?s?.messages&&s.messages.push(new t("invalid-timeExtent","TimeExtent cannot be empty")):r[o]=e.toArray())},target:{timeExtent:{type:[[r.Integer,r.Null]]}}}}};e.timeExtent=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/webmap/InitialViewProperties":function(){define(["../chunks/tslib.es6","../Viewpoint","../core/Accessor","../core/Clonable","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../geometry/SpatialReference","../time/constants","../chunks/TimeExtent","../webdoc/RangeInfo","./background/ColorBackground"],function(e,t,r,o,s,i,n,a,c,p,l,u,d,y){"use strict";let m=class extends(o.ClonableMixin(r)){constructor(e){super(e),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.timeExtent=null,this.timeZone=l.system,this.viewpoint=null}};return e.__decorate([s.property({type:y})],m.prototype,"background",void 0),e.__decorate([s.property({type:d})],m.prototype,"rangeInfo",void 0),e.__decorate([s.property({type:p})],m.prototype,"spatialReference",void 0),e.__decorate([s.property({type:u.TimeExtent})],m.prototype,"timeExtent",void 0),e.__decorate([s.property({nonNullable:!0})],m.prototype,"timeZone",void 0),e.__decorate([s.property({type:t})],m.prototype,"viewpoint",void 0),m=e.__decorate([c.subclass("esri.webmap.InitialViewProperties")],m),m})},"esri/webmap/background/ColorBackground":function(){define(["../../chunks/tslib.es6","../../Color","../../core/JSONSupport","../../core/lang","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a){"use strict";var c;let p=c=class extends r.JSONSupport{constructor(e){super(e),this.color=new t([0,0,0,1])}clone(){return new c(o.clone({color:this.color}))}};return e.__decorate([s.property({type:t,json:{write:!0}})],p.prototype,"color",void 0),p=c=e.__decorate([a.subclass("esri.webmap.background.ColorBackground")],p),p})},"esri/webmap/Version":function(){define(["exports","../core/Version"],function(e,t){"use strict";class r extends t.Version{constructor(e,t){super(e,t,"webmap")}}e.Version=r,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/networks/UtilityNetwork":function(){define(["require","../chunks/tslib.es6","../Graphic","../core/MapUtils","../core/reactiveUtils","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../layers/FeatureLayer","../layers/support/featureQueryAll","./Network","./RulesTable","./support/NamedTraceConfiguration","./support/networkFieldUtils","./support/NetworkSystemLayers","./support/TerminalConfiguration","./support/TraceJobInfo","./support/typeUtils","./support/utils","../rest/support/Query"],function(e,t,r,o,s,i,n,a,c,p,l,u,d,y,m,h,g,b,f,w,_,S){"use strict";const v=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));let I=class extends d{constructor(e){super(e),this.sharedNamedTraceConfigurations=[],this.type="utility",this._circuitManagerMap=new Map,this._terminalById=new Map,this._unitIdentifierManager=null}initialize(){this.addHandles(s.watch(()=>[this.gdbVersion,this.historicMoment],()=>{this.networkSystemLayers.associationsTable&&(this.networkSystemLayers.associationsTable.gdbVersion!==this.gdbVersion&&(this.networkSystemLayers.associationsTable.gdbVersion=this.gdbVersion),this.networkSystemLayers.associationsTable.historicMoment!==this.historicMoment&&(this.networkSystemLayers.associationsTable.historicMoment=this.historicMoment))}))}get _rulesLayer(){const{gdbVersion:e,historicMoment:t}=this,r=this.networkSystemLayers.rulesTableUrl;return new l({url:r,gdbVersion:e,historicMoment:t})}get _utilityLayerList(){const e=new Set;return this.dataElement?.domainNetworks?.map(t=>{t?.edgeSources?.map(({layerId:t,sourceId:r})=>{this._layerIdBySourceId.set(r,t),this._sourceIdByLayerId.set(t,r),e.add(t)}),t?.junctionSources?.map(({layerId:t,sourceId:r})=>{this._layerIdBySourceId.set(r,t),this._sourceIdByLayerId.set(t,r),e.add(t)})}),e}get serviceTerritoryFeatureLayerId(){return this.dataElement?.serviceTerritoryFeatureLayerId??null}get networkSystemLayers(){return new g({rulesTableId:this.sourceJSON?.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.rulesTableId}`:null,subnetworksTableId:this.sourceJSON?.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:this.sourceJSON?.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.dirtyAreasLayerId}`:null,associationsTableId:this.sourceJSON?.systemLayers.associationsTableId,associationsTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.associationsTableId}`:null})}get terminalConfigurations(){return this.dataElement?.terminalConfigurations.map(e=>b.fromJSON(e))||[]}get domainNetworkNames(){return this.dataElement?.domainNetworks.map(e=>e.domainNetworkName)||[]}get hasTelecomNetwork(){return this.dataElement?.domainNetworks.some(e=>e.isTelecomNetwork)??!1}get associationsTable(){return this.networkSystemLayers.associationsTable}async load(e){return this.addResolvingPromise(this._load(e)),this}async _load(e){await super._load(e),await Promise.all([this._loadNamedTraceConfigurationsFromNetwork(e),this.networkSystemLayers.loadAssociationsTable(e)])}getTerminalConfiguration(e){let t=null,r=null;const o=e.sourceLayer;let s=null;if("feature"===o?.type){if(s=o.layerId,null===s)return null}else{if("subtype-sublayer"!==o?.type)return null;if(s=o?.parent?.layerId??null,null===s)return null}const i=e.attributes;if(null==i)return null;for(const o of Object.keys(i))"ASSETGROUP"===o.toUpperCase()&&(t=e.getAttribute(o)),"ASSETTYPE"===o.toUpperCase()&&(r=e.getAttribute(o));if(!this.dataElement)return null;let n=null;const a=this.dataElement.domainNetworks;for(const e of a){const o=e.junctionSources?.find(e=>e.layerId===s);if(o){const e=o.assetGroups?.find(e=>e.assetGroupCode===t);if(e){const t=e.assetTypes?.find(e=>e.assetTypeCode===r);if(t?.isTerminalConfigurationSupported){n=t.terminalConfigurationId;break}}}}if(null!=n){const e=this.dataElement.terminalConfigurations,t=e?.find(e=>e.terminalConfigurationId===n);return t?b.fromJSON(t):null}return null}getTierNames(e){const t=this.dataElement?.domainNetworks.find(t=>t.domainNetworkName===e);return t?.tiers?.map(e=>e.name)||[]}async getRulesTable(){const e=this._rulesLayer;e.loaded||await e.load();const t=this.dataElement?.domainNetworks;if(!t)return null;const r=t.flatMap(e=>[...e.edgeSources||[],...e.junctionSources||[]]),o=(await this._queryRulesTable(e)).map(t=>this._hydrateRuleInfo(e,r,t));return new y({rulesLayer:e,rules:o})}async getCircuitManager(t){if(!this.hasTelecomNetwork)return null;const r=this.dataElement?.domainNetworks.find(e=>e.domainNetworkName===t&&e.isTelecomNetwork);if(!r)return null;const{default:s}=await new Promise((t,r)=>e(["./CircuitManager"],e=>t(v(e)),r));return o.getOrCreateMapValue(this._circuitManagerMap,t,()=>new s({utilityNetwork:this,telecomDomainNetwork:r}))}async getUnitIdentifierManager(){if(!this.hasTelecomNetwork)return null;if(this._unitIdentifierManager)return this._unitIdentifierManager;const{default:t}=await new Promise((t,r)=>e(["./UnitIdentifierManager"],e=>t(v(e)),r));return this._unitIdentifierManager=new t({utilityNetwork:this}),this._unitIdentifierManager}getTerminalById(e){if(!this.dataElement||null==e)return null;const t=this._terminalById.get(e);return null!=t?t:(this.terminalConfigurations.forEach(e=>{e.terminals.forEach(e=>{this._terminalById.set(e.id,e)})}),this._terminalById.get(e))}isUtilityLayer(e){return"layerId"in e?null!=e.layerId&&this._utilityLayerList.has(e.layerId)&&(e.url?.startsWith(this.featureServiceUrl)??!1):!("subtype-sublayer"!==e.type||!e.parent)&&this._utilityLayerList.has(e.parent.layerId)&&(e.parent.url?.startsWith(this.featureServiceUrl)??!1)}async queryAssociations(t,r){const[{queryAssociations:o},{default:s}]=await Promise.all([new Promise((t,r)=>e(["../rest/networks/queryAssociations"],t,r)),new Promise((t,r)=>e(["../rest/networks/support/QueryAssociationsParameters"],e=>t(v(e)),r))]),i=s.from(t);return i.gdbVersion=this.gdbVersion,i.moment=this.historicMoment,(await o(this.networkServiceUrl,i,r)).associations}async synthesizeAssociationGeometries(t){const[{synthesizeAssociationGeometries:r},{default:o}]=await Promise.all([new Promise((t,r)=>e(["../rest/networks/synthesizeAssociationGeometries"],t,r)),new Promise((t,r)=>e(["../rest/networks/support/SynthesizeAssociationGeometriesParameters"],e=>t(v(e)),r))]),s=o.from(t);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,r(this.networkServiceUrl,s)}async trace(t){const[{trace:r},{default:o}]=await Promise.all([new Promise((t,r)=>e(["../rest/networks/trace"],t,r)),new Promise((t,r)=>e(["../rest/networks/support/TraceParameters"],e=>t(v(e)),r))]),s=o.from(t);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,r(this.networkServiceUrl,s)}async submitTraceJob(t){const[{submitTraceJob:r},{default:o}]=await Promise.all([new Promise((t,r)=>e(["../rest/networks/trace"],t,r)),new Promise((t,r)=>e(["../rest/networks/support/TraceParameters"],e=>t(v(e)),r))]),s=o.from(t);s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment;const i=await r(this.networkServiceUrl,s);return new f({statusUrl:i})}async canAddAssociation(e){const t=await this.getRulesTable();if(!t)return!1;const{fromNetworkElement:r,toNetworkElement:o}=e;if(!r||!o)return!1;await t.load();let s=null;switch(e.associationType){case"containment":s=t.rulesCategorized.containment;break;case"attachment":s=t.rulesCategorized.attachment;break;default:s=t.rulesCategorized.connectivity}return s.some(e=>_.doesRuleAllowAssociation(e,r,o))}generateAddAssociations(e){const{associationsTable:t}=this.networkSystemLayers,{fromNetworkSourceId:o,fromGlobalId:s,fromTerminalId:i,toNetworkSourceId:n,toGlobalId:a,toTerminalId:c,associationType:p,isContentVisible:l,percentAlong:u,globalId:d}=h.getAssociationsTableFields(t);return{addFeatures:e.map(e=>new r({attributes:{[o]:e.fromNetworkElement?.networkSourceId,[s]:e.fromNetworkElement?.globalId,[i]:e.fromNetworkElement?.terminalId,[n]:e.toNetworkElement?.networkSourceId,[a]:e.toNetworkElement?.globalId,[c]:e.toNetworkElement?.terminalId,[p]:w.AssociationTypeEnum[e.associationType],[l]:null==e.isContentVisible?void 0:e.isContentVisible?1:0,[u]:e.percentAlong,[d]:e.globalId}})),id:this.networkSystemLayers.associationsTableId,identifierFields:{globalIdField:t?.globalIdField??"globalid",objectIdField:t?.objectIdField??"objectid"}}}generateDeleteAssociations(e){const{associationsTable:t,associationsTableId:r}=this.networkSystemLayers;return{deleteFeatures:e.map(e=>({globalId:e.globalId})),id:r,identifierFields:{globalIdField:t?.globalIdField??"globalid",objectIdField:t?.objectIdField??"objectid"}}}async loadAssociationsTable(){return this.networkSystemLayers.loadAssociationsTable()}async _loadNamedTraceConfigurationsFromNetwork(e){if(0===this.sharedNamedTraceConfigurations?.length)return;const t=this.sharedNamedTraceConfigurations.map(e=>e.globalId),r=await this.queryNamedTraceConfigurations({globalIds:t},e);for(const e of this.sharedNamedTraceConfigurations){const t=r?.find(t=>t.globalId===e.globalId);if(t){const r=t.write({},{origin:"service"});e.read(r,{origin:"service"})}}}_hydrateRuleInfo(e,t,r){const o=e.fieldsIndex,s=o.get("RULETYPE"),i=o.get("CREATIONDATE"),n=o.get("FROMNETWORKSOURCEID"),a=o.get("FROMASSETGROUP"),c=o.get("FROMASSETTYPE"),p=o.get("FROMTERMINALID"),l=o.get("TONETWORKSOURCEID"),u=o.get("TOASSETGROUP"),d=o.get("TOASSETTYPE"),y=o.get("TOTERMINALID"),m=o.get("VIANETWORKSOURCEID"),h=o.get("VIAASSETGROUP"),g=o.get("VIAASSETTYPE"),b=o.get("VIATERMINALID"),f=r.attributes[s.name],w=new Date(r.attributes[i.name]),_=[{networkSourceId:r.attributes[n.name],assetGroupId:r.attributes[a.name],assetTypeId:r.attributes[c.name],terminalId:r.attributes[p.name]},{networkSourceId:r.attributes[l.name],assetGroupId:r.attributes[u.name],assetTypeId:r.attributes[d.name],terminalId:r.attributes[y.name]},{networkSourceId:r.attributes[m.name],assetGroupId:r.attributes[h.name],assetTypeId:r.attributes[g.name],terminalId:r.attributes[b.name]}],S={ruleType:f,creationDate:w};for(const e of[0,1,2]){if(5!==f&&2===e)continue;const r=_[e],o=t.find(e=>e.sourceId===r.networkSourceId),s=o?.assetGroups.find(e=>e.assetGroupCode===r.assetGroupId),i=s?.assetTypes.find(e=>e.assetTypeCode===r.assetTypeId),n=this._getTerminal(i,r);let a="";switch(e){case 0:a="from";break;case 1:a="to";break;case 2:a="via"}S[`${a}NetworkSource`]=o,S[`${a}AssetGroup`]=s,S[`${a}AssetType`]=i,S[`${a}Terminal`]=n?.toJSON()}return S}_getTerminal(e,t){const r=e?.terminalConfigurationId,o=this.terminalConfigurations?.find(e=>e.id===r);return o?.terminals?.find(e=>e.id===t.terminalId)??null}async _queryRulesTable(e){const{gdbVersion:t,historicMoment:r}=this,o=new S({where:"1=1",outFields:["*"],gdbVersion:t,historicMoment:r});return(await u.queryAllJSON(e,o)).features}};return t.__decorate([i.property({readOnly:!0})],I.prototype,"_rulesLayer",null),t.__decorate([i.property({type:[m],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],I.prototype,"sharedNamedTraceConfigurations",void 0),t.__decorate([i.property({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],I.prototype,"type",void 0),t.__decorate([i.property({readOnly:!0})],I.prototype,"serviceTerritoryFeatureLayerId",null),t.__decorate([i.property({readOnly:!0})],I.prototype,"networkSystemLayers",null),t.__decorate([i.property({readOnly:!0})],I.prototype,"terminalConfigurations",null),t.__decorate([i.property({readOnly:!0})],I.prototype,"domainNetworkNames",null),t.__decorate([i.property({readOnly:!0})],I.prototype,"hasTelecomNetwork",null),t.__decorate([i.property({readOnly:!0,json:{read:!1}})],I.prototype,"associationsTable",null),I=t.__decorate([p.subclass("esri.networks.UtilityNetwork")],I),I})},"esri/networks/Network":function(){define(["require","../chunks/tslib.es6","../Graphic","../request","../core/Error","../core/Loadable","../core/Logger","../core/MultiOriginJSONSupport","../core/promiseUtils","../core/urlUtils","../core/accessorSupport/decorators/property","../core/has","../core/RandomLCG","../core/accessorSupport/decorators/subclass","../geometry/Extent","../geometry/SpatialReference","../geometry/support/jsonUtils","../layers/mixins/EditBusLayer","../layers/support/arcgisLayerUrl","./support/TopologyValidationJobInfo","./support/utils","../versionManagement/support/versionManagementUtils"],function(e,t,r,o,s,i,n,a,c,p,l,u,d,y,m,h,g,b,f,w,_,S){"use strict";const v=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));let I=class extends(a.MultiOriginJSONMixin(i.Loadable)){static fromPortalItem(e){return _.networkFromPortalItem(e)}constructor(e){super(e),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this._historicMoment=null,this._gdbVersion=null,this._sourceIdByLayerId=new Map,this._layerIdBySourceId=new Map,this._applyEditsHandler=e=>{const{serviceUrl:t,gdbVersion:r,result:o}=e,s=t===this.featureServiceUrl,i=b.versionMatches(t,r,this.gdbVersion);s&&i&&o.then(e=>{S.isVersionInEditSession(t,r)&&(this.historicMoment=e.historicMoment)})},this._updateMomentHandler=e=>{const{serviceUrl:t,gdbVersion:r,moment:o}=e,s=t===this.featureServiceUrl,i=b.versionMatches(t,r,this.gdbVersion);s&&i&&(this.historicMoment=o)},this.when().then(()=>{this.addHandles([b.onApplyEditsEvent(this._applyEditsHandler),b.onUpdateMomentEvent(this._updateMomentHandler)])},()=>{})}initialize(){this.when().catch(e=>{c.isAbortError(e)||n.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}get loaded(){return super.loaded}get datasetName(){return this.dataElement?.name??null}get owner(){return this.dataElement?.userIdentity??null}get schemaGeneration(){return this.dataElement?.schemaGeneration??null}get parsedUrl(){return p.urlToObject(this.layerUrl)}get featureServiceUrl(){return f.parse(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return f.parse(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}get gdbVersion(){return this._gdbVersion}set gdbVersion(e){this._gdbVersion=e}get historicMoment(){return this._historicMoment}set historicMoment(e){this._historicMoment=e}async load(e){return this.addResolvingPromise(this._load(e)),this}async _load(e){await Promise.all([this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),e),this._fetchLayerMetaData(this.layerUrl,e)])}getLayerIdBySourceId(e){if(!this.dataElement)return null;const t=this._layerIdBySourceId.get(e);if(null!=t)return t;const r=this.dataElement.domainNetworks,o=this._traverseNetworkSources(r,this._layerIdBySourceId,"sourceId","layerId",e);return o>=0?o:null}getSourceIdByLayerId(e){if(!this.dataElement)return null;const t=this._sourceIdByLayerId.get(e);if(null!=t)return t;const r=this.dataElement.domainNetworks,o=this._traverseNetworkSources(r,this._sourceIdByLayerId,"layerId","sourceId",e);return o>=0?o:null}getObjectIdsFromElements(e){const t=[],r=new Map;for(const t of e){const e=this.getLayerIdBySourceId(t.networkSourceId);if(null==e)continue;let o=r.get(e);void 0===o&&(o=[]),o.push(t.objectId),r.set(e,o)}const o=this.featureServiceUrl;return r.forEach((e,r)=>t.push({layerUrl:`${o}/${r}`,objectIds:e})),t}async queryNamedTraceConfigurations(t,r){const[{queryNamedTraceConfigurations:o},{default:s}]=await Promise.all([new Promise((t,r)=>e(["../rest/networks/queryNamedTraceConfigurations"],t,r)),new Promise((t,r)=>e(["../rest/networks/support/QueryNamedTraceConfigurationsParameters"],e=>t(v(e)),r))]),i=this.networkServiceUrl,n=s.from(t);return(await o(i,n,{...r}))?.namedTraceConfigurations}async validateTopology(t,r){if(!t.validateArea)throw new s("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:o},{default:i}]=await Promise.all([new Promise((t,r)=>e(["../rest/networks/validateNetworkTopology"],t,r)),new Promise((t,r)=>e(["../rest/networks/support/ValidateNetworkTopologyParameters"],e=>t(v(e)),r))]),n=i.from(t);S.isVersionInEditSession(this.featureServiceUrl,this.gdbVersion||null)?(n.sessionID=S.currentSessionId,await S.isSafeToEditVersion(this.featureServiceUrl,this.gdbVersion,!0)):n.sessionID=null,n.gdbVersion=this.gdbVersion;const a=this.networkServiceUrl,c=this.featureServiceUrl,p=b.emitApplyEditsEvent(c,null,this.gdbVersion,!0),l=await o(a,n,{...r});if(l?.serviceEdits){const e=[];for(const t of l.serviceEdits){const{editedFeatures:r}=t,o=r?.spatialReference?new h(r.spatialReference):null;e.push({layerId:t.layerId,editedFeatures:{adds:r?.adds?.map(e=>T(e,o))||[],updates:r?.updates?.map(e=>({original:T(e[0],o),current:T(e[1],o)}))||[],deletes:r?.deletes?.map(e=>T(e,o))||[],spatialReference:o}})}p.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:e,exceededTransferLimit:!1,historicMoment:l.moment})}return l}async submitTopologyValidationJob(t,r){let i=null;if(!t.validateArea)throw new s("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion){const e=this.layerUrl.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");i=(await o(e,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}const[{submitValidateNetworkTopologyJob:n},{default:a}]=await Promise.all([new Promise((t,r)=>e(["../rest/networks/validateNetworkTopology"],t,r)),new Promise((t,r)=>e(["../rest/networks/support/ValidateNetworkTopologyParameters"],e=>t(v(e)),r))]),c=a.from(t);S.isVersionInEditSession(this.featureServiceUrl,this.gdbVersion||null)?(c.sessionID=S.currentSessionId,await S.isSafeToEditVersion(this.featureServiceUrl,this.gdbVersion,!0)):c.sessionID=null,c.gdbVersion=this.gdbVersion||i;const p=this.networkServiceUrl,l=this.featureServiceUrl?b.emitApplyEditsEvent(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,u=await n(p,c,{...r});return new w({statusUrl:u,editsResolver:l})}getSourceTypeById(e){if(!this.dataElement)return null;for(const t of this.dataElement.domainNetworks)for(const r of[t.edgeSources??[],t.junctionSources??[]])for(const o of r)if(o.sourceId===e)return r===t.edgeSources?"edge":"junction";return null}_traverseNetworkSources(e,t,r,o,s){for(const i of e)for(const e of[i.edgeSources??[],i.junctionSources??[]])for(const i of e)if(i[r]===s)return t.set(s,i[o]),i[o];return-1}async _fetchLayerMetaData(e,t){const r=await o(e,{responseType:"json",query:{f:"json"},...t});this.sourceJSON=r.data,this.read(r.data,{origin:"service"})}async _fetchDataElement(e,t,r){if(this.dataElement)return;const s=await o(`${e}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([t]),f:"json"},...r}).then(e=>e.data.layerDataElements?.[0]);s&&this.read(s,{origin:"service"})}};function T(e,t){return new r({attributes:e.attributes,geometry:g.fromJSON({...e.geometry,spatialReference:t})})}return t.__decorate([l.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],I.prototype,"id",void 0),t.__decorate([l.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],I.prototype,"title",void 0),t.__decorate([l.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],I.prototype,"layerUrl",void 0),t.__decorate([l.property({type:Object,json:{origins:{service:{read:!0}},read:!1}})],I.prototype,"dataElement",void 0),t.__decorate([l.property({type:m,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],I.prototype,"fullExtent",void 0),t.__decorate([l.property({type:h,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],I.prototype,"spatialReference",void 0),t.__decorate([l.property({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],I.prototype,"type",void 0),t.__decorate([l.property({readOnly:!0})],I.prototype,"datasetName",null),t.__decorate([l.property({readOnly:!0})],I.prototype,"owner",null),t.__decorate([l.property({readOnly:!0})],I.prototype,"schemaGeneration",null),t.__decorate([l.property({readOnly:!0})],I.prototype,"parsedUrl",null),t.__decorate([l.property({readOnly:!0})],I.prototype,"featureServiceUrl",null),t.__decorate([l.property({readOnly:!0})],I.prototype,"networkServiceUrl",null),t.__decorate([l.property({readOnly:!0})],I.prototype,"layerId",null),t.__decorate([l.property()],I.prototype,"sourceJSON",void 0),t.__decorate([l.property({readOnly:!0})],I.prototype,"networkSystemLayers",null),t.__decorate([l.property({type:String})],I.prototype,"gdbVersion",null),t.__decorate([l.property({type:Date})],I.prototype,"historicMoment",null),t.__decorate([l.property()],I.prototype,"_historicMoment",void 0),t.__decorate([l.property()],I.prototype,"_gdbVersion",void 0),I=t.__decorate([y.subclass("esri.networks.Network")],I),I})},"esri/networks/support/TopologyValidationJobInfo":function(){define(["../../chunks/tslib.es6","../../request","../../core/has","../../core/jsonMap","../../core/promiseUtils","../../core/accessorSupport/decorators/property","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/enumeration","../../core/accessorSupport/decorators/subclass","../../rest/networks/support/ValidateNetworkTopologyResult"],function(e,t,r,o,s,i,n,a,c,p,l){"use strict";const u=o.strict()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let d=class extends l{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const r={...e,query:{f:"json"}},{data:o}=await t(this.statusUrl,r);return this.read(o),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(e={}){const{interval:t=1e3,statusCallback:r}=e;return new Promise((e,o)=>{this._clearTimer();const i=setInterval(()=>{this._timer||o(s.createAbortError()),this.checkJobStatus().then(t=>{const{status:o}=t;switch(this.status=o,o){case"job-succeeded":this._clearTimer(),e(this);break;case"job-waiting":case"job-executing":r&&r(this)}},e=>{this._clearTimer(),o(e)})},t);this._timer=i})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};return e.__decorate([i.property()],d.prototype,"editsResolver",void 0),e.__decorate([i.property({type:String,json:{write:!0}})],d.prototype,"statusUrl",void 0),e.__decorate([c.enumeration(u)],d.prototype,"status",void 0),e.__decorate([i.property({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.submissionTime=e?e.getTime():null}}}})],d.prototype,"submissionTime",void 0),e.__decorate([i.property({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.lastUpdatedTime=e?e.getTime():null}}}})],d.prototype,"lastUpdatedTime",void 0),d=e.__decorate([p.subclass("esri.networks.support.TopologyValidationJobInfo")],d),d})},"esri/rest/networks/support/ValidateNetworkTopologyResult":function(){define(["../../../chunks/tslib.es6","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n){"use strict";let a=class extends t.JSONSupport{constructor(e){super(e),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};return e.__decorate([r.property({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.moment=e?e.getTime():null}}}})],a.prototype,"moment",void 0),e.__decorate([r.property({type:Boolean,json:{write:!0}})],a.prototype,"fullUpdate",void 0),e.__decorate([r.property({type:Boolean,json:{write:!0}})],a.prototype,"validateErrorsCreated",void 0),e.__decorate([r.property({type:Boolean,json:{write:!0}})],a.prototype,"exceededTransferLimit",void 0),e.__decorate([r.property({type:[Object],json:{write:!0}})],a.prototype,"serviceEdits",void 0),e.__decorate([r.property({type:[Object],json:{write:!0}})],a.prototype,"discoveredSubnetworks",void 0),a=e.__decorate([n.subclass("esri.rest.networks.support.ValidateNetworkTopologyResult")],a),a})},"esri/networks/support/utils":function(){define(["require","exports","../../request","../../core/Error","../../layers/support/featureQueryAll","../../layers/support/layerUtils","../../portal/PortalItem","../../rest/support/FeatureSet","../../support/guards"],function(e,t,r,o,s,i,n,a,c){"use strict";const p=e=>Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"}));function l(e,t,r,o,s,i){if(!r||!o)return!1;const n=d(e,r,i),a=d(t,o,i);if(s){const s=d(e,o,i),c=d(t,r,i);return n&&a||s&&c}return n&&a}function u(e,t){const r=e.terminal?.terminalId,o=t.terminalId;return null==r&&null==o||(1===r?null==o||1===o:r===o)}function d(e,t,r){const{assetGroupCode:o,assetTypeCode:s}=e;return("layerId"in e?e.layerId===t.networkSource?.layerId:e.networkSourceId===t.networkSource?.sourceId)&&(null==o||o===t.assetGroup?.assetGroupCode)&&(null==s||s===t.assetType?.assetTypeCode)&&(!r||!("terminalId"in e)||u(t,e))}function y(e){return{fromRuleElement:{networkSource:e.fromNetworkSource,assetGroup:e.fromAssetGroup,assetType:e.fromAssetType,terminal:e.fromTerminal},viaRuleElement:e.viaNetworkSource?{networkSource:e.viaNetworkSource,assetGroup:e.viaAssetGroup,assetType:e.viaAssetType,terminal:e.viaTerminal}:void 0,toRuleElement:{networkSource:e.toNetworkSource,assetGroup:e.toAssetGroup,assetType:e.toAssetType,terminal:e.toTerminal}}}function m(e){const{sourceLayer:t}=e;let r;return i.isFeatureLayer(t)?r=t.layerId:i.isSubtypeSublayer(t)&&(r=t.parent?.layerId),r??null}function h(e){const[t,r]=g(e.sourceLayer);return[t?e.attributes[t]:null,r?e.attributes[r]:null]}function g(e){return e&&"fieldsIndex"in e?[e.fieldsIndex.normalizeFieldName("assetGroup")??null,e.fieldsIndex.normalizeFieldName("assetType")??null]:[null,null]}async function b(t,r){if("Utility Network Layer"===t){const{default:t}=await new Promise((t,r)=>e(["../UtilityNetwork"],e=>t(p(e)),r));return new t({layerUrl:r})}return null}t.doElementsMatchRule=l,t.doesRuleAllowAssociation=function(e,t,r){const{fromRuleElement:o,viaRuleElement:s,toRuleElement:i}=y(e);switch(e.ruleType){case 2:case 3:return l(t,r,o,i,!1,!1);case 4:case 1:return l(t,r,o,i,!0,!0);case 5:return l(t,r,o,s,!0,!0)||l(t,r,i,s,!0,!0);default:return!1}},t.getAssetFieldNames=g,t.getCompatibleRuleElements=function(e,t,r="from"){const{fromRuleElement:o,viaRuleElement:s,toRuleElement:i}=y(e),n=[];switch(e.ruleType){case 2:case 3:"from"===r&&d(t,o,!1)?n.push(i):"to"===r&&d(t,i,!1)&&n.push(o);break;case 4:case 1:d(t,o,!0)?n.push(i):d(t,i,!0)&&n.push(o);break;case 5:s&&(d(t,s,!0)?(n.push(o),n.push(i)):(d(t,o,!0)||d(t,i,!0))&&n.push(s));break;default:return[]}return n},t.getElementsFromRule=y,t.getFeatureAssetCodes=h,t.getFeatureSourceLayerId=m,t.getFeaturesFromLayers=async function(e,t){const r=e.layers,o=e.layerInfos,i=e.returnGeometry||!1,n=e.outSpatialReference;return await Promise.all(r.map(async e=>{await e.load()})),(await Promise.all(r.map(async e=>{const r=o.find(t=>t.layerUrl===e.parsedUrl?.path);if(!r?.objectIds?.length)return{layer:e,featureSet:void 0};const c=e.createQuery();c.returnGeometry=i,c.outFields=r.outFields||["*"],c.outSpatialReference=n,c.gdbVersion=e.gdbVersion,c.objectIds=r.objectIds,t&&(c.where="1=1");const p=a.fromJSON(await s.queryAllJSON(e,c));return p.features.forEach(t=>{t.layer=t.sourceLayer=e}),{layer:e,featureSet:p}}))).filter(e=>void 0!==e.featureSet)},t.getRuleValues=function(e){let t=null,r=null,o=null;if(c.isGraphic(e))t=m(e),[r,o]=h(e);else if(i.isSubtypeSublayer(e)){t=e.parent?.layerId??null;const[o]=g(e);o===e.subtypeField&&(r=e.subtypeCode)}else t=e.layerId??null;return{layerId:t,assetGroupCode:r,assetTypeCode:o}},t.isRuleElementMatch=d,t.isTerminalMatch=u,t.networkFromPortalItem=async function(e){let t="portalItem"in e?e:{portalItem:e};!t.portalItem||t.portalItem instanceof n||(t={...t,portalItem:new n(t.portalItem)});const s=t.portalItem;if(await s.load(),"Feature Service"!==s.type)throw new o("portal:unknown-item-type","Unknown item type '${type}'",{type:s.type});const i=s.url,a=await r(i,{responseType:"json",query:{f:"json"}}),c="Network Layer";if(a.data.type?.includes(c))return b(a.data.type,i);if(a.data.layers){const e=a.data.layers.find(e=>e.type.includes(c));if(e){const t=`${i}/${e.id}`;return b(e.type,t)}}return null},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})},"esri/networks/RulesTable":function(){define(["exports","../chunks/tslib.es6","../request","../core/JSONSupport","../core/Loadable","../core/sql","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./support/utils","../support/guards"],function(e,t,r,o,s,i,n,a,c,p,l,u,d){"use strict";return e.default=class extends(o.JSONSupportMixin(s.Loadable)){constructor(e){super(e),this.rulesCategorized={attachment:[],containment:[],connectivity:[]},this.request=r}initialize(){}async load(e){const t=this.rulesLayer.load(e).then(()=>this._initializeRulesTable());return this.addResolvingPromise(t),this}getFeaturesCanAssociateWithClause(e,t,r){const o=new Map,[s,n]=u.getAssetFieldNames(e.sourceLayer);if(!s||!n)return"";const a=u.getRuleValues(e),c=u.getRuleValues(t);r.forEach(e=>{const{type:t,direction:r}=e;this._getRulesForAssociationType(t).forEach(e=>{u.getCompatibleRuleElements(e,a,r).filter(e=>e.networkSource?.layerId===c.layerId).forEach(e=>{const t=e.assetGroup?.assetGroupCode,r=e.assetType?.assetTypeCode;if(null!=t&&null!=r){const e=o.get(t)??new Set;e.add(r),o.set(t,e)}})})});let p=[];return this._mergeAssetCodes(o).forEach((e,t)=>{const r=`${s} IN (${t})`,o=i.sqlIn(n,[...e]);r&&o&&p.push(i.sqlAnd(r,o))}),p.length>1&&(p=p.map(e=>`(${e})`)),p.join(" OR ")}getFeaturesCanAssociateWith(e,t,r){return null==u.getFeatureSourceLayerId(e)?[]:t.filter(t=>this.canAssociateFeatures(e,t,r))}canAssociateFeatures(e,t,r){if(!this._canSupportAssociations([e,t]))return!1;const o=u.getRuleValues(e),s=u.getRuleValues(t);return r.some(e=>{const{type:t,direction:r}=e;return this._getRulesForAssociationType(t).some(e=>"to"===r?u.doesRuleAllowAssociation(e,s,o):u.doesRuleAllowAssociation(e,o,s))})}getLayersCanAssociateWith(e,t,r){return null==u.getFeatureSourceLayerId(e)?[]:t.filter(t=>this.canAssociateFeatureToLayer(e,t,r))}canAssociateFeatureToLayer(e,t,r){if(!this._canSupportAssociations([e,t]))return!1;const o=u.getRuleValues(e),s=u.getRuleValues(t);return r.some(e=>{const{type:t,direction:r}=e;return this._getRulesForAssociationType(t).some(e=>"to"===r?u.doesRuleAllowAssociation(e,s,o):u.doesRuleAllowAssociation(e,o,s))})}getFeatureSQL(e,t){const r=e.layerId.toString(),o=e.fieldsIndex?.normalizeFieldName("assetGroup"),s=e.fieldsIndex?.normalizeFieldName("assetType"),i=o?t.attributes[o]:null,n=s?t.attributes[s]:null,a=this.rulesHash[r];if(a){const e=a.assetGroupHash[i];if(e)return e.assetTypeHash[n]||null}return null}_initializeRulesTable(){const e={},t=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];this.rulesCategorized={attachment:[],containment:[],connectivity:[]};for(const r of this.rules){if(3===r.ruleType){this.rulesCategorized.attachment.push(r);continue}if(2===r.ruleType){this.rulesCategorized.containment.push(r);continue}if(1===r.ruleType){this.rulesCategorized.connectivity.push(r);continue}this.rulesCategorized.connectivity.push(r);let o=[[0,1],[1,0]];5===r.ruleType&&(o=[[0,2],[2,0],[1,2],[2,1]]);for(const s of o){const o=s.shift(),n=s.shift();let a=!1;switch(r.ruleType){case 5:a=0===o||1===o;break;case 4:a=1===o}const c=t[o],p=r[c.networkSourceId]?.layerId.toString()??"",l=r[c.assetGroupId]?.assetGroupCode?.toString(),u=r[c.assetTypeId],d=u?.assetTypeCode?.toString(),y=t[n],m=r[y.networkSourceId]?.layerId.toString()??"",h=r[y.assetGroupId]?.assetGroupCode?.toString(),g=r[y.assetTypeId],b=g?.assetTypeCode?.toString(),f=e[p]??{assetGroupHash:{}};if(!(l&&d&&h&&b))continue;const w=f.assetGroupHash[l]??{assetTypeHash:{}},_=w.assetTypeHash[d]??{};if(_[m]=_[m]??{},a){_[p]=_[p]??{};const e=i.sqlAnd(`assetgroup = ${l}`,`assettype = ${d}`);"esriNECPEndVertex"===g?.connectivityPolicy?_[p].endVertex=_[p]?.endVertex?`${_[p].endVertex}`:`(${e})`:_[p].anyVertex=_[p].anyVertex?`${_[p].anyVertex}`:`(${e})`}const S=i.sqlAnd(`assetgroup = ${h}`,`assettype = ${b}`);"esriNECPEndVertex"===g?.connectivityPolicy?_[m].endVertex=_[m]?.endVertex?i.sqlOr(_[m].endVertex,S):`(${S})`:_[m].anyVertex=_[m]?.anyVertex?i.sqlOr(_[m].anyVertex,S):`(${S})`,w.assetTypeHash[d]=_,f.assetGroupHash[l]=w,e[p]=f}}this._set("rulesHash",e)}_getRulesForAssociationType(e){const{rulesCategorized:t}=this;switch(e){case"attachment":return t.attachment;case"containment":return t.containment;case"connectivity":case"junction-junction-connectivity":return t.connectivity.filter(e=>1===e.ruleType);case"junction-edge-from-connectivity":case"junction-edge-midspan-connectivity":case"junction-edge-to-connectivity":return t.connectivity.filter(e=>4===e.ruleType||5===e.ruleType);default:return[]}}_areSetsEqual(e,t){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}_mergeAssetCodes(e){const t=new Map,r=new Set;for(const[o,s]of e){const i=new Set([o]);for(const[t,n]of e)o!==t&&!r.has(t)&&this._areSetsEqual(s,n)&&(i.add(t),r.add(t));const n=Array.from(i).sort().join(",");t.set(n,s)}return t}_canSupportAssociations(e){return e.every(e=>{const t=d.isGraphic(e)?e.sourceLayer:e,[r,o]=u.getAssetFieldNames(t);return null!=r&&null!=o})}},t.__decorate([n.property({constructOnly:!0})],e.default.prototype,"rulesLayer",void 0),t.__decorate([n.property({constructOnly:!0})],e.default.prototype,"rules",void 0),t.__decorate([n.property({readOnly:!0})],e.default.prototype,"rulesHash",void 0),t.__decorate([n.property()],e.default.prototype,"rulesCategorized",void 0),t.__decorate([n.property({constructOnly:!0})],e.default.prototype,"request",void 0),e.default=t.__decorate([l.subclass("esri.networks.RulesTable")],e.default),e.default})},"esri/networks/support/NamedTraceConfiguration":function(){define(["../../chunks/tslib.es6","../../core/MultiOriginJSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","./TraceConfiguration","./typeUtils","./UNTraceConfiguration"],function(e,t,r,o,s,i,n,a,c,p,l){"use strict";let u=class extends t.MultiOriginJSONSupport{constructor(e){super(e),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(e,t){return void 0!==e.tierName?l.fromJSON(e):c.fromJSON(e)}};return e.__decorate([r.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],u.prototype,"globalId",void 0),e.__decorate([r.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],u.prototype,"title",void 0),e.__decorate([r.property({type:c,json:{origins:{service:{read:!0,write:!0}},read:!1}})],u.prototype,"traceConfiguration",void 0),e.__decorate([n.reader("service","traceConfiguration")],u.prototype,"readTraceConfiguration",null),e.__decorate([r.property({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],u.prototype,"creationDate",void 0),e.__decorate([r.property({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],u.prototype,"creator",void 0),e.__decorate([r.property({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],u.prototype,"description",void 0),e.__decorate([r.property({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],u.prototype,"minStartingPoints",void 0),e.__decorate([r.property({json:{origins:{service:{read:!0,write:!0}},read:!1}})],u.prototype,"resultTypes",void 0),e.__decorate([r.property({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],u.prototype,"tags",void 0),e.__decorate([r.property({type:p.traceTypeKebabDict.apiValues,json:{type:p.traceTypeKebabDict.jsonValues,origins:{service:{read:p.traceTypeKebabDict.read,write:p.traceTypeKebabDict.write}},read:!1}})],u.prototype,"traceType",void 0),u=e.__decorate([a.subclass("esri.networks.support.NamedTraceConfiguration")],u),u})},"esri/networks/support/TraceConfiguration":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n){"use strict";let a=class extends t.JSONSupport{constructor(e){super(e),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};return e.__decorate([r.property({type:[Object],json:{write:!0}})],a.prototype,"conditionBarriers",void 0),e.__decorate([r.property({type:[Object],json:{write:!0}})],a.prototype,"outputConditions",void 0),e.__decorate([r.property({type:[Object],json:{write:!0}})],a.prototype,"functions",void 0),e.__decorate([r.property({type:[Object],json:{write:!0}})],a.prototype,"functionBarriers",void 0),e.__decorate([r.property({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],a.prototype,"traversabilityScope",void 0),e.__decorate([r.property({type:String,json:{write:!0}})],a.prototype,"shortestPathNetworkAttributeName",void 0),e.__decorate([r.property({type:Boolean,json:{write:!0}})],a.prototype,"includeBarriers",void 0),e.__decorate([r.property({type:Boolean,json:{write:!0}})],a.prototype,"validateConsistency",void 0),e.__decorate([r.property({type:Boolean,json:{write:!0}})],a.prototype,"ignoreBarriersAtStartingPoints",void 0),a=e.__decorate([n.subclass("esri.networks.support.TraceConfiguration")],a),a})},"esri/networks/support/typeUtils":function(){define(["exports","../../core/jsonMap"],function(e,t){"use strict";const r=new t.JSONMap({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation",path:"path",circuit:"circuit"}),o=new t.JSONMap({junctionJunctionConnectivity:"junction-junction-connectivity",connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionEdgeMidspanConnectivity:"junction-edge-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"}),s=new t.JSONMap({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});e.AssociationTypeEnum={connectivity:1,"junction-junction-connectivity":1,containment:2,attachment:3,"junction-edge-from-connectivity":4,"junction-edge-midspan-connectivity":5,"junction-edge-to-connectivity":6},e.associationTypeKebabDict=o,e.traceTypeKebabDict=r,e.validationTypeKebabDict=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/networks/support/UNTraceConfiguration":function(){define(["../../chunks/tslib.es6","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","./TraceConfiguration"],function(e,t,r,o,s,i,n){"use strict";let a=class extends n{constructor(e){super(e),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.circuitName=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.inferConnectivity=null,this.maxHops=null,this.nearestNeighbor=null,this.numPaths=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};return e.__decorate([t.property({type:[Object],json:{write:!0}})],a.prototype,"filterBarriers",void 0),e.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"arcadeExpressionBarrier",void 0),e.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"circuitName",void 0),e.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"domainNetworkName",void 0),e.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"filterBitsetNetworkAttributeName",void 0),e.__decorate([t.property({type:[Object],json:{write:!0}})],a.prototype,"filterFunctionBarriers",void 0),e.__decorate([t.property({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],a.prototype,"filterScope",void 0),e.__decorate([t.property({type:Boolean,json:{write:!0}})],a.prototype,"includeContainers",void 0),e.__decorate([t.property({type:Boolean,json:{write:!0}})],a.prototype,"includeContent",void 0),e.__decorate([t.property({type:Boolean,json:{write:!0}})],a.prototype,"includeIsolated",void 0),e.__decorate([t.property({type:Boolean,json:{write:!0}})],a.prototype,"includeStructures",void 0),e.__decorate([t.property({type:Boolean,json:{write:!0}})],a.prototype,"allowIndeterminateFlow",void 0),e.__decorate([t.property({type:Boolean,json:{write:!0}})],a.prototype,"includeUpToFirstSpatialContainer",void 0),e.__decorate([t.property({type:Boolean,json:{write:!0}})],a.prototype,"inferConnectivity",void 0),e.__decorate([t.property({type:Number,json:{write:!0}})],a.prototype,"maxHops",void 0),e.__decorate([t.property({type:Object,json:{write:!0}})],a.prototype,"nearestNeighbor",void 0),e.__decorate([t.property({type:Number,json:{write:!0}})],a.prototype,"numPaths",void 0),e.__decorate([t.property({type:[Object],json:{write:!0}})],a.prototype,"outputFilterCategories",void 0),e.__decorate([t.property({type:[Object],json:{write:!0}})],a.prototype,"outputFilters",void 0),e.__decorate([t.property({type:[Object],json:{write:!0}})],a.prototype,"propagators",void 0),e.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"subnetworkName",void 0),e.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"targetTierName",void 0),e.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"diagramTemplateName",void 0),e.__decorate([t.property({type:String,json:{write:!0}})],a.prototype,"tierName",void 0),e.__decorate([t.property({type:Boolean,json:{write:!0}})],a.prototype,"validateLocatability",void 0),a=e.__decorate([i.subclass("esri.networks.support.UNTraceConfiguration")],a),a})},"esri/networks/support/networkFieldUtils":function(){define(["exports"],function(e){"use strict";e.getAssociationsTableFields=function(e){const t=e?.fieldsIndex,r="fromnetworksourceid",o="fromglobalid",s="fromterminalid",i="tonetworksourceid",n="toglobalid",a="toterminalid",c="status",p="associationtype",l="iscontentvisible",u="percentalong",d="globalid";return{fromNetworkSourceId:t?.get(r)?.name??r,fromGlobalId:t?.get(o)?.name??o,fromTerminalId:t?.get(s)?.name??s,toNetworkSourceId:t?.get(i)?.name??i,toGlobalId:t?.get(n)?.name??n,toTerminalId:t?.get(a)?.name??a,status:t?.get(c)?.name??c,associationType:t?.get(p)?.name??p,isContentVisible:t?.get(l)?.name??l,percentAlong:t?.get(u)?.name??u,globalId:t?.get(e?.globalIdField??d)?.name??d}},e.getUtilityNetworkFields=function(e,t){if("feature"!==t.type&&"subtype-group"!==t.type)return[];if(!t.url)return[];const r="utilityNetworks"in e.map?e.map.utilityNetworks??[]:[];for(const e of r)if(e.isUtilityLayer(t)){const e=t.fieldsIndex.get("assetgroup"),r=t.fieldsIndex.get("assettype");return[e?.name,r?.name].filter(e=>null!=e)}return[]},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/networks/support/NetworkSystemLayers":function(){define(["exports","../../chunks/tslib.es6","../../core/Accessor","../../core/Error","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../layers/FeatureLayer"],function(e,t,r,o,s,i,n,a,c,p){"use strict";return e.default=class extends r{constructor(e){super(e),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null,this.associationsTable=null,this.associationsTableId=null,this.associationsTableUrl=null}destroy(){this.associationsTable?.destroy()}async loadAssociationsTable(e){if(!this.associationsTable){const{associationsTableUrl:e}=this;if(!e)throw new o("utility-network-system-layers:missing-associations-table-url","Unable to load the associations table, as the `associationsTableUrl` is not set.");this.associationsTable=new p({url:e})}return await this.associationsTable.load(e),this.associationsTable}},t.__decorate([s.property({constructOnly:!0})],e.default.prototype,"rulesTableId",void 0),t.__decorate([s.property({constructOnly:!0})],e.default.prototype,"rulesTableUrl",void 0),t.__decorate([s.property({constructOnly:!0})],e.default.prototype,"subnetworksTableId",void 0),t.__decorate([s.property({constructOnly:!0})],e.default.prototype,"subnetworksTableUrl",void 0),t.__decorate([s.property({constructOnly:!0})],e.default.prototype,"dirtyAreasLayerId",void 0),t.__decorate([s.property({constructOnly:!0})],e.default.prototype,"dirtyAreasLayerUrl",void 0),t.__decorate([s.property()],e.default.prototype,"associationsTable",void 0),t.__decorate([s.property({constructOnly:!0})],e.default.prototype,"associationsTableId",void 0),t.__decorate([s.property({constructOnly:!0})],e.default.prototype,"associationsTableUrl",void 0),e.default=t.__decorate([c.subclass("esri.networks.support.NetworkSystemLayers")],e.default),e.default})},"esri/networks/support/TerminalConfiguration":function(){define(["exports","../../chunks/tslib.es6","../../core/jsonMap","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","./Terminal"],function(e,t,r,o,s,i,n,a,c,p){"use strict";const l=new r.JSONMap({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});return e.default=class extends o.JSONSupport{constructor(e){super(e),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}},t.__decorate([s.property({type:String,json:{write:!0}})],e.default.prototype,"defaultConfiguration",void 0),t.__decorate([s.property({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],e.default.prototype,"id",void 0),t.__decorate([s.property({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],e.default.prototype,"name",void 0),t.__decorate([s.property({type:[p],json:{write:!0}})],e.default.prototype,"terminals",void 0),t.__decorate([s.property({type:l.apiValues,json:{type:l.jsonValues,read:l.read,write:l.write}})],e.default.prototype,"traversabilityModel",void 0),e.default=t.__decorate([c.subclass("esri.networks.support.TerminalConfiguration")],e.default),e.default})},"esri/networks/support/Terminal":function(){define(["../../chunks/tslib.es6","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n){"use strict";let a=class extends t.JSONSupport{constructor(e){super(e),this.id=null,this.name=null}};return e.__decorate([r.property({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],a.prototype,"id",void 0),e.__decorate([r.property({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],a.prototype,"name",void 0),e.__decorate([r.property({type:Boolean,json:{write:!0}})],a.prototype,"isUpstreamTerminal",void 0),a=e.__decorate([n.subclass("esri.networks.support.Terminal")],a),a})},"esri/networks/support/TraceJobInfo":function(){define(["exports","../../chunks/tslib.es6","../../request","../../core/has","../../core/jsonMap","../../core/promiseUtils","../../core/accessorSupport/decorators/property","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/enumeration","../../core/accessorSupport/decorators/subclass","../../rest/networks/support/TraceResult"],function(e,t,r,o,s,i,n,a,c,p,l,u){"use strict";const d=s.strict()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});return e.default=class extends u{constructor(e){super(e),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(e){const t={...e,query:{f:"json"}},{data:o}=await r(this.statusUrl,t),s=o.traceResults?{...o.traceResults,...o}:o;return this.read(s),this}async waitForJobCompletion(e={}){const{interval:t=1e3,statusCallback:r}=e;return new Promise((e,o)=>{this._clearTimer();const s=setInterval(()=>{this._timer||o(i.createAbortError()),this.checkJobStatus().then(t=>{const{status:o}=t;switch(this.status=o,o){case"job-succeeded":this._clearTimer(),e(this);break;case"job-waiting":case"job-executing":r&&r(this)}},e=>{this._clearTimer(),o(e)})},t);this._timer=s})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}},t.__decorate([n.property({type:String,json:{write:!0}})],e.default.prototype,"statusUrl",void 0),t.__decorate([p.enumeration(d)],e.default.prototype,"status",void 0),t.__decorate([n.property({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.submissionTime=e?e.getTime():null}}}})],e.default.prototype,"submissionTime",void 0),t.__decorate([n.property({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.lastUpdatedTime=e?e.getTime():null}}}})],e.default.prototype,"lastUpdatedTime",void 0),e.default=t.__decorate([l.subclass("esri.networks.support.TraceJobInfo")],e.default),e.default})},"esri/rest/networks/support/TraceResult":function(){define(["exports","../../../chunks/tslib.es6","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/reader","../../../core/accessorSupport/decorators/subclass","../../../core/accessorSupport/decorators/writer","./AggregatedGeometry","./CircuitPath","./CircuitTraceResult","./FunctionResult","./NetworkElement","./TelecomNetworkElement"],function(e,t,r,o,s,i,n,a,c,p,l,u,d,y,m,h){"use strict";return e.default=class extends r.JSONSupport{constructor(e){super(e),this.aggregatedGeometry=null,this.circuits=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.paths=null,this.startingPointsIgnored=!1,this.warnings=null}readNetworkElements(e,t){return null!=t.elements&&Array.isArray(t.elements)?t.elements.map(e=>"firstUnit"in e&&"numUnits"in e?new h({...e}):new m({...e})):[]}writeNetworkElements(e,t){t.elements=e.map(e=>e.toJSON())}},t.__decorate([o.property({type:l,json:{write:!0},readOnly:!0})],e.default.prototype,"aggregatedGeometry",void 0),t.__decorate([o.property({type:[d],json:{write:!0},readOnly:!0})],e.default.prototype,"circuits",void 0),t.__decorate([o.property({type:[m],json:{write:!0},readOnly:!0})],e.default.prototype,"elements",void 0),t.__decorate([a.reader("elements")],e.default.prototype,"readNetworkElements",null),t.__decorate([p.writer("elements")],e.default.prototype,"writeNetworkElements",null),t.__decorate([o.property({type:[y],json:{write:!0},readOnly:!0})],e.default.prototype,"globalFunctionResults",void 0),t.__decorate([o.property({type:Boolean,json:{write:!0},readOnly:!0})],e.default.prototype,"kFeaturesForKNNFound",void 0),t.__decorate([o.property({type:[u],json:{write:!0},readOnly:!0})],e.default.prototype,"paths",void 0),t.__decorate([o.property({type:Boolean,json:{write:!0},readOnly:!0})],e.default.prototype,"startingPointsIgnored",void 0),t.__decorate([o.property({type:[String],json:{write:!0},readOnly:!0})],e.default.prototype,"warnings",void 0),e.default=t.__decorate([c.subclass("esri.rest.networks.support.TraceResult")],e.default),e.default})},"esri/rest/networks/support/AggregatedGeometry":function(){define(["../../../chunks/tslib.es6","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../../geometry/Multipoint","../../../geometry/Polygon","../../../geometry/Polyline"],function(e,t,r,o,s,i,n,a,c,p){"use strict";let l=class extends t.JSONSupport{constructor(e){super(e),this.line=null,this.multipoint=null,this.polygon=null}};return e.__decorate([r.property({type:p,json:{write:!0},readOnly:!0})],l.prototype,"line",void 0),e.__decorate([r.property({type:a,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],l.prototype,"multipoint",void 0),e.__decorate([r.property({type:c,json:{write:!0},readOnly:!0})],l.prototype,"polygon",void 0),l=e.__decorate([n.subclass("esri.rest.networks.support.AggregatedGeometry")],l),l})},"esri/rest/networks/support/CircuitPath":function(){define(["../../../chunks/tslib.es6","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","../../../geometry/Polyline","./CircuitPathConnectivityElement","./TraceLocation"],function(e,t,r,o,s,i,n,a,c,p){"use strict";let l=class extends t.JSONSupport{constructor(e){super(e),this.pathId=null,this.order=null,this.startingPoint=null,this.stoppingPoint=null,this.pathConnectivity=[],this.geometry=null}};return e.__decorate([r.property({type:Number,json:{write:!0}})],l.prototype,"pathId",void 0),e.__decorate([r.property({type:Number,json:{write:!0}})],l.prototype,"order",void 0),e.__decorate([r.property({type:p,json:{write:!0}})],l.prototype,"startingPoint",void 0),e.__decorate([r.property({type:p,json:{write:!0}})],l.prototype,"stoppingPoint",void 0),e.__decorate([r.property({type:[c],json:{write:!0}})],l.prototype,"pathConnectivity",void 0),e.__decorate([r.property({type:a,json:{write:!0}})],l.prototype,"geometry",void 0),l=e.__decorate([n.subclass("esri.rest.networks.support.CircuitPath")],l),l})},"esri/rest/networks/support/CircuitPathConnectivityElement":function(){define(["../../../chunks/tslib.es6","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/reader","../../../core/accessorSupport/decorators/subclass","../../../core/accessorSupport/decorators/writer","./TelecomNetworkElement"],function(e,t,r,o,s,i,n,a,c,p){"use strict";let l=class extends t.JSONSupport{constructor(e){super(e),this.edgeElement=null,this.junctionElement=null}readEdgeElement(e,t){return new p({networkSourceId:t.edgeNetworkSourceId,globalId:t.edgeGlobalId,objectId:t.edgeObjectId,positionFrom:t.edgePositionFrom,positionTo:t.edgePositionTo,firstUnit:t.edgeFirstUnit,numUnits:t.edgeNumUnits})}writeEdgeElement(e,t){t.edgeNetworkSourceId=e.networkSourceId,t.edgeGlobalId=e.globalId,t.edgeObjectId=e.objectId,t.edgePositionFrom=e.positionFrom,t.edgePositionTo=e.positionTo,t.edgeFirstUnit=e.firstUnit,t.edgeNumUnits=e.numUnits}readJunctionElement(e,t){return new p({networkSourceId:t.junctionNetworkSourceId,globalId:t.junctionGlobalId,objectId:t.junctionObjectId,terminalId:t.junctionTerminalId,firstUnit:t.junctionFirstUnit,numUnits:t.junctionNumUnits})}writeJunctionElement(e,t){t.junctionNetworkSourceId=e.networkSourceId,t.junctionGlobalId=e.globalId,t.junctionObjectId=e.objectId,t.junctionTerminalId=e.terminalId,t.junctionFirstUnit=e.firstUnit,t.junctionNumUnits=e.numUnits}};return e.__decorate([r.property({type:p,json:{read:{source:["edgeNetworkSourceId","edgeGlobalId","edgeObjectId","edgePositionFrom","edgePositionTo","edgeFirstUnit","edgeNumUnits"]},write:!0}})],l.prototype,"edgeElement",void 0),e.__decorate([n.reader("edgeElement")],l.prototype,"readEdgeElement",null),e.__decorate([c.writer("edgeElement")],l.prototype,"writeEdgeElement",null),e.__decorate([r.property({type:p,json:{read:{source:["junctionNetworkSourceId","junctionGlobalId","junctionObjectId","junctionTerminalId","junctionFirstUnit","junctionNumUnits"]},write:!0}})],l.prototype,"junctionElement",void 0),e.__decorate([n.reader("junctionElement")],l.prototype,"readJunctionElement",null),e.__decorate([c.writer("junctionElement")],l.prototype,"writeJunctionElement",null),l=e.__decorate([a.subclass("esri.rest.networks.support.CircuitPathConnectivityElement")],l),l})},"esri/rest/networks/support/TelecomNetworkElement":function(){define(["exports","../../../chunks/tslib.es6","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass","./NetworkElement"],function(e,t,r,o,s,i,n,a){"use strict";return e.default=class extends a{constructor(e){super(e),this.type="telecomNetworkElement",this.firstUnit=null,this.numUnits=null}},t.__decorate([r.property({json:{write:!1}})],e.default.prototype,"type",void 0),t.__decorate([r.property({json:{write:!0}})],e.default.prototype,"firstUnit",void 0),t.__decorate([r.property({json:{write:!0}})],e.default.prototype,"numUnits",void 0),e.default=t.__decorate([n.subclass("esri.rest.networks.support.TelecomNetworkElement")],e.default),e.default})},"esri/rest/networks/support/NetworkElement":function(){define(["exports","../../../chunks/tslib.es6","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a){"use strict";return e.default=class extends r.JSONSupport{constructor(e){super(e),this.type="networkElement",this.assetGroupCode=null,this.assetTypeCode=null,this.globalId=null,this.networkSourceId=null,this.objectId=null,this.positionFrom=null,this.positionTo=null,this.terminalId=null}},t.__decorate([o.property({json:{write:!1}})],e.default.prototype,"type",void 0),t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"assetGroupCode",void 0),t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"assetTypeCode",void 0),t.__decorate([o.property({type:String,json:{write:!0}})],e.default.prototype,"globalId",void 0),t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"networkSourceId",void 0),t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"objectId",void 0),t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"positionFrom",void 0),t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"positionTo",void 0),t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"terminalId",void 0),e.default=t.__decorate([a.subclass("esri.rest.networks.support.NetworkElement")],e.default),e.default})},"esri/rest/networks/support/TraceLocation":function(){define(["../../../chunks/tslib.es6","../../../core/jsonMap","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a){"use strict";const c=new t.JSONMap({startingPoint:"starting-point",barrier:"barrier",stoppingPoint:"stopping-point"});let p=class extends r.JSONSupport{constructor(e){super(e),this.globalId=null,this.isFilterBarrier=!1,this.percentAlong=null,this.terminalId=null,this.type=null,this.firstUnit=null,this.numUnits=null}};return e.__decorate([o.property({type:String,json:{write:!0}})],p.prototype,"globalId",void 0),e.__decorate([o.property({type:Boolean,json:{write:!0}})],p.prototype,"isFilterBarrier",void 0),e.__decorate([o.property({type:Number,json:{write:!0}})],p.prototype,"percentAlong",void 0),e.__decorate([o.property({type:Number,json:{write:!0}})],p.prototype,"terminalId",void 0),e.__decorate([o.property({type:c.apiValues,json:{type:c.jsonValues,read:{reader:c.read,source:"traceLocationType"},write:{writer:c.write,target:"traceLocationType"}}})],p.prototype,"type",void 0),e.__decorate([o.property({type:Number,json:{write:!0}})],p.prototype,"firstUnit",void 0),e.__decorate([o.property({type:Number,json:{write:!0}})],p.prototype,"numUnits",void 0),p=e.__decorate([a.subclass("esri.rest.networks.support.TraceLocation")],p),p})},"esri/rest/networks/support/CircuitTraceResult":function(){define(["../../../chunks/tslib.es6","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/reader","../../../core/accessorSupport/decorators/subclass","../../../core/accessorSupport/decorators/writer","../../../geometry/Polyline","./CircuitPath"],function(e,t,r,o,s,i,n,a,c,p,l){"use strict";let u=class extends t.JSONSupport{constructor(e){super(e),this.circuit=null,this.geometry=null,this.path=null}readCircuit(e,t){const r=t.sections?.map(e=>({...e,path:l.fromJSON(e.path)}));return{name:t.name,globalId:t.globalId,isSectioned:t.isSectioned,sectionOrder:t.sectionOrder,startLocation:t.startLocation,stopLocation:t.stopLocation,sections:r,subcircuits:t.subcircuits,lastVerifiedTime:t.lastVerifiedTime?new Date(t.lastVerifiedTime):null,lastExportedTime:t.lastExportedTime?new Date(t.lastExportedTime):null,circuitType:t.circuitType,status:t.status}}writeCircuit(e,t){const r=e.sections?.map(e=>({...e,path:e.path?.toJSON()}));t.name=e.name,t.globalId=e.globalId,t.isSectioned=e.isSectioned,t.sectionOrder=e.sectionOrder,t.startLocation=e.startLocation,t.stopLocation=e.stopLocation,t.sections=r,t.subcircuits=e.subcircuits,t.lastVerifiedTime=e.lastVerifiedTime?.getTime(),t.lastExportedTime=e.lastExportedTime?.getTime(),t.circuitType=e.circuitType,t.status=e.status}};return e.__decorate([r.property({type:Object,json:{write:!0,read:{source:["name","globalId","isSectioned","sectionOrder","startLocation","stopLocation","sections","subcircuits","lastVerifiedTime","lastExportedTime","circuitType","status"]}}})],u.prototype,"circuit",void 0),e.__decorate([n.reader("circuit")],u.prototype,"readCircuit",null),e.__decorate([c.writer("circuit")],u.prototype,"writeCircuit",null),e.__decorate([r.property({type:p,json:{write:!0}})],u.prototype,"geometry",void 0),e.__decorate([r.property({type:l,json:{write:!0}})],u.prototype,"path",void 0),u=e.__decorate([a.subclass("esri.rest.networks.support.CircuitTraceResult")],u),u})},"esri/rest/networks/support/FunctionResult":function(){define(["../../../chunks/tslib.es6","../../../core/JSONSupport","../../../core/accessorSupport/decorators/property","../../../core/has","../../../core/Logger","../../../core/RandomLCG","../../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n){"use strict";let a=class extends t.JSONSupport{constructor(e){super(e),this.functionType=null,this.networkAttributeName=null,this.result=null}};return e.__decorate([r.property({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],a.prototype,"functionType",void 0),e.__decorate([r.property({type:String,json:{write:!0},readOnly:!0})],a.prototype,"networkAttributeName",void 0),e.__decorate([r.property({type:Number,json:{write:!0},readOnly:!0})],a.prototype,"result",void 0),a=e.__decorate([n.subclass("esri.rest.networks.support.FunctionResult")],a),a})},"esri/webdoc/GeotriggersInfo":function(){define(["../chunks/tslib.es6","../core/Clonable","../core/JSONSupport","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./geotriggersInfo/support/geotriggerTypes"],function(e,t,r,o,s,i,n,a,c){"use strict";let p=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.geotriggers=null}};return e.__decorate([o.property({types:[c.types],json:{write:{isRequired:!0}}})],p.prototype,"geotriggers",void 0),p=e.__decorate([a.subclass("esri.webdoc.GeotriggersInfo")],p),p})},"esri/webdoc/geotriggersInfo/support/geotriggerTypes":function(){define(["exports","../FenceGeotrigger","../Geotrigger"],function(e,t,r){"use strict";const o={base:r,key:"type",typeMap:{fence:t}};e.types=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/webdoc/geotriggersInfo/FenceGeotrigger":function(){define(["../../chunks/tslib.es6","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/enumeration","../../core/accessorSupport/decorators/subclass","./DeviceLocationFeed","./FeatureFenceParameters","./Geotrigger","./GeotriggerNotificationOptions","./support/typeUtils"],function(e,t,r,o,s,i,n,a,c,p,l,u){"use strict";let d=class extends p{constructor(e){super(e),this.enterExitRule="enter-contains-and-exit-does-not-intersect",this.feed=null,this.feedAccuracyMode="use-geometry",this.fenceNotificationRule=null,this.fenceParameters=null,this.name=null,this.notificationOptions=null,this.type="fence"}};return e.__decorate([i.enumeration(u.enterExitRuleKebabDict)],d.prototype,"enterExitRule",void 0),e.__decorate([t.property({type:a,json:{write:{isRequired:!0}}})],d.prototype,"feed",void 0),e.__decorate([i.enumeration(u.feedAccuracyModeKebabDict)],d.prototype,"feedAccuracyMode",void 0),e.__decorate([t.property({type:u.fenceNotificationRuleKebabDict.apiValues,json:{type:u.fenceNotificationRuleKebabDict.jsonValues,read:u.fenceNotificationRuleKebabDict.read,write:{writer:u.fenceNotificationRuleKebabDict.write,isRequired:!0}}})],d.prototype,"fenceNotificationRule",void 0),e.__decorate([t.property({type:c,json:{write:{isRequired:!0}}})],d.prototype,"fenceParameters",void 0),e.__decorate([t.property({type:String,json:{write:!0}})],d.prototype,"name",void 0),e.__decorate([t.property({type:l,json:{write:!0}})],d.prototype,"notificationOptions",void 0),e.__decorate([i.enumeration({fence:"fence"},{readOnly:!0})],d.prototype,"type",void 0),d=e.__decorate([n.subclass("esri.webdoc.geotriggersInfo.FenceGeotrigger")],d),d})},"esri/webdoc/geotriggersInfo/DeviceLocationFeed":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/jsonMap","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","./ExpressionInfo"],function(e,t,r,o,s,i,n,a,c,p){"use strict";const l=new r.JSONMap({deviceLocation:"device-location"});let u=class extends(t.ClonableMixin(o.JSONSupport)){constructor(e){super(e),this.filterExpression=null,this.type="device-location"}};return e.__decorate([s.property({type:p,json:{write:!0}})],u.prototype,"filterExpression",void 0),e.__decorate([s.property({type:l.apiValues,readOnly:!0,json:{type:l.jsonValues,read:l.read,write:l.write}})],u.prototype,"type",void 0),u=e.__decorate([c.subclass("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],u),u})},"esri/webdoc/geotriggersInfo/ExpressionInfo":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a){"use strict";let c=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.expression=null,this.returnType="string",this.title=null}};return e.__decorate([o.property({type:String,json:{write:{isRequired:!0}}})],c.prototype,"expression",void 0),e.__decorate([o.property({type:["number","string"],json:{write:!0}})],c.prototype,"returnType",void 0),e.__decorate([o.property({type:String,json:{write:!0}})],c.prototype,"title",void 0),c=e.__decorate([a.subclass("esri.webdoc.geotriggersInfo.ExpressionInfo")],c),c})},"esri/webdoc/geotriggersInfo/FeatureFenceParameters":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/enumeration","../../core/accessorSupport/decorators/subclass","./FeatureFilter","./FeatureLayerSource"],function(e,t,r,o,s,i,n,a,c,p,l){"use strict";let u=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.fenceSource=null,this.filter=null,this.bufferDistance=null,this.type="features"}};return e.__decorate([o.property({type:l,json:{write:{isRequired:!0}}})],u.prototype,"fenceSource",void 0),e.__decorate([o.property({type:p,json:{write:!0}})],u.prototype,"filter",void 0),e.__decorate([o.property({type:Number,json:{write:!0}})],u.prototype,"bufferDistance",void 0),e.__decorate([a.enumeration({features:"features"},{readOnly:!0})],u.prototype,"type",void 0),u=e.__decorate([c.subclass("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],u),u})},"esri/webdoc/geotriggersInfo/FeatureFilter":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","../../geometry/support/jsonUtils","../../geometry/support/typeUtils"],function(e,t,r,o,s,i,n,a,c,p){"use strict";let l=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.geometry=null,this.where=null}};return e.__decorate([o.property({types:p.geometryTypes,json:{read:c.fromJSON,write:!0}})],l.prototype,"geometry",void 0),e.__decorate([o.property({type:String,json:{write:!0}})],l.prototype,"where",void 0),l=e.__decorate([a.subclass("esri.webdoc.geotriggersInfo.FeatureFilter")],l),l})},"esri/webdoc/geotriggersInfo/FeatureLayerSource":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/enumeration","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a,c){"use strict";let p=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.layerId=null,this.layerUrl=null,this.type="feature-layer"}};return e.__decorate([o.property({type:String,json:{write:{overridePolicy(){return{isRequired:null===this.layerUrl}}}}})],p.prototype,"layerId",void 0),e.__decorate([o.property({type:String,json:{write:{overridePolicy(){return{isRequired:null===this.layerId}}}}})],p.prototype,"layerUrl",void 0),e.__decorate([a.enumeration({featureLayer:"feature-layer"},{readOnly:!0})],p.prototype,"type",void 0),p=e.__decorate([c.subclass("esri.webdoc.geotriggersInfo.FeatureLayerSource")],p),p})},"esri/webdoc/geotriggersInfo/Geotrigger":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/Logger","../../core/has","../../core/RandomLCG","../../core/Error","../../core/accessorSupport/decorators/enumeration","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a,c){"use strict";let p=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.type="fence"}};return e.__decorate([a.enumeration({fence:"fence"},{readOnly:!0})],p.prototype,"type",void 0),p=e.__decorate([c.subclass("esri.webdoc.geotriggersInfo.Geotrigger")],p),p})},"esri/webdoc/geotriggersInfo/GeotriggerNotificationOptions":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","./ExpressionInfo"],function(e,t,r,o,s,i,n,a,c){"use strict";let p=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.expressionInfo=null,this.requestedActions=null}};return e.__decorate([o.property({type:c,json:{write:!0}})],p.prototype,"expressionInfo",void 0),e.__decorate([o.property({type:[String],json:{write:!0}})],p.prototype,"requestedActions",void 0),p=e.__decorate([a.subclass("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],p),p})},"esri/webdoc/geotriggersInfo/support/typeUtils":function(){define(["exports","../../../core/jsonMap"],function(e,t){"use strict";const r=new t.JSONMap({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),o=new t.JSONMap({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"}),s=new t.JSONMap({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"});e.enterExitRuleKebabDict=r,e.feedAccuracyModeKebabDict=o,e.fenceNotificationRuleKebabDict=s,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"esri/webdoc/IPSInfo":function(){define(["../chunks/tslib.es6","../core/Clonable","../core/JSONSupport","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/RandomLCG","../core/accessorSupport/decorators/subclass","./ips/Configuration","./ips/PositioningService"],function(e,t,r,o,s,i,n,a,c,p){"use strict";let l=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.positioningService=null,this.configuration=null}};return e.__decorate([o.property({type:p,json:{write:{isRequired:!0}}})],l.prototype,"positioningService",void 0),e.__decorate([o.property({type:c,json:{write:!0}})],l.prototype,"configuration",void 0),l=e.__decorate([a.subclass("esri.webdoc.IPSInfo")],l),l})},"esri/webdoc/ips/Configuration":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass","./AppleIPSProperties","./GNSSProperties","./PathSnappingProperties","./SmoothingProperties"],function(e,t,r,o,s,i,n,a,c,p,l,u){"use strict";let d=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.appleIPS=null,this.gnss=null,this.smoothing=null,this.pathSnapping=null}};return e.__decorate([o.property({type:c,json:{name:"AppleIPS",write:!0}})],d.prototype,"appleIPS",void 0),e.__decorate([o.property({type:p,json:{name:"GNSS",write:!0}})],d.prototype,"gnss",void 0),e.__decorate([o.property({type:u,json:{write:!0}})],d.prototype,"smoothing",void 0),e.__decorate([o.property({type:l,json:{write:!0}})],d.prototype,"pathSnapping",void 0),d=e.__decorate([a.subclass("esri.webdoc.ips.Configuration")],d),d})},"esri/webdoc/ips/AppleIPSProperties":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a){"use strict";let c=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.enabled=!0}};return e.__decorate([o.property({type:Boolean,nonNullable:!0,json:{write:!0}})],c.prototype,"enabled",void 0),c=e.__decorate([a.subclass("esri.webdoc.ips.AppleIPSProperties")],c),c})},"esri/webdoc/ips/GNSSProperties":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a){"use strict";let c=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.enabled=!0}};return e.__decorate([o.property({type:Boolean,nonNullable:!0,json:{write:!0}})],c.prototype,"enabled",void 0),c=e.__decorate([a.subclass("esri.webdoc.ips.GNSSProperties")],c),c})},"esri/webdoc/ips/PathSnappingProperties":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a){"use strict";let c=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.enabled=!0,this.distance=5,this.units="meter"}};return e.__decorate([o.property({type:Boolean,nonNullable:!0,json:{write:!0}})],c.prototype,"enabled",void 0),e.__decorate([o.property({type:Number,nonNullable:!0,json:{write:!0}})],c.prototype,"distance",void 0),e.__decorate([o.property({type:["feet","meter"],nonNullable:!0,json:{write:!0}})],c.prototype,"units",void 0),c=e.__decorate([a.subclass("esri.webdoc.ips.PathSnappingProperties")],c),c})},"esri/webdoc/ips/SmoothingProperties":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/subclass"],function(e,t,r,o,s,i,n,a){"use strict";let c=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.enabled=!0}};return e.__decorate([o.property({type:Boolean,nonNullable:!0,json:{write:!0}})],c.prototype,"enabled",void 0),c=e.__decorate([a.subclass("esri.webdoc.ips.SmoothingProperties")],c),c})},"esri/webdoc/ips/PositioningService":function(){define(["../../chunks/tslib.es6","../../core/Clonable","../../core/JSONSupport","../../core/accessorSupport/decorators/property","../../core/has","../../core/Logger","../../core/RandomLCG","../../core/accessorSupport/decorators/reader","../../core/accessorSupport/decorators/subclass","../../core/accessorSupport/decorators/writer","../../portal/PortalItem"],function(e,t,r,o,s,i,n,a,c,p,l){"use strict";let u=class extends(t.ClonableMixin(r.JSONSupport)){constructor(e){super(e),this.portalItem=null}readPortalItem(e,t,r){const{itemId:o}=t;if(o)return new l({id:o,portal:r?.portal})}writePortalItem(e,t){e?.id&&(t.itemId=e.id)}};return e.__decorate([o.property({type:l,json:{write:{isRequired:!0}}})],u.prototype,"portalItem",void 0),e.__decorate([a.reader("portalItem",["itemId"])],u.prototype,"readPortalItem",null),e.__decorate([p.writer("portalItem",{itemId:{type:String}})],u.prototype,"writePortalItem",null),u=e.__decorate([c.subclass("esri.webdoc.ips.PositioningService")],u),u})},"esri/webmap/utils":function(){define(["exports","./Version"],function(e,t){"use strict";const r=new t.Version(2,34);e.currentVersion=r,e.isWebMap=function(e){return null!=e&&"object"==typeof e&&"declaredClass"in e&&"esri.WebMap"===e.declaredClass},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})})},"*noref":1}}),define(["./chunks/tslib.es6","./WebDocument2D","./core/Collection","./core/Error","./core/loadAll","./core/accessorSupport/decorators/property","./core/has","./core/Logger","./core/RandomLCG","./core/accessorSupport/decorators/subclass","./networks/UtilityNetwork","./webdoc/GeotriggersInfo","./webdoc/IPSInfo","./webmap/InitialViewProperties","./webmap/utils","./webmap/Version"],function(e,t,r,o,s,i,n,a,c,p,l,u,d,y,m,h){"use strict";const g={currentVersion:m.currentVersion,createInitialViewProperties:()=>new y,parseVersion:h.Version.parse,itemType:"Web Map",name:"webmap",origin:"web-map"},b=r.ofType(l);let f=class extends t{constructor(e){super(e),this.geotriggersInfo=null,this.ipsInfo=null,this.presentation=null,this.utilityNetworks=null}destroy(){if(this.utilityNetworks){const e=this.utilityNetworks.removeAll();for(const t of e)t.destroy();this.utilityNetworks.destroy()}}get context(){return g}loadAll(){return s.loadAll(this,e=>{e(this.ground,this.basemap,this.layers,this.tables,this.ipsInfo?.positioningService?.portalItem)})}static fromJSON(e){if(e)return new this({resourceInfo:e});throw new o("webmap:empty-resource","Expected a JSON resource but got nothing")}static{this.VERSION=m.currentVersion}};return e.__decorate([i.property({type:u,json:{write:!0}})],f.prototype,"geotriggersInfo",void 0),e.__decorate([i.property({type:d,json:{write:!0,name:"mapIPSInfo"}})],f.prototype,"ipsInfo",void 0),e.__decorate([i.property({json:{write:!0}})],f.prototype,"presentation",void 0),e.__decorate([i.property({type:b,json:{read:!0,write:!0}})],f.prototype,"utilityNetworks",void 0),f=e.__decorate([p.subclass("esri.WebMap")],f),f});