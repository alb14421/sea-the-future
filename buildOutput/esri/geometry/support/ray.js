// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../core/arrayUtils","../../core/ObjectStack","../../core/libs/gl-matrix-2/math/mat3","../../core/libs/gl-matrix-2/factories/mat3f64","../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64","./vectorStacks"],function(t,r,i,e,n,o,c,s){"use strict";function a(t){return t?u(c.clone(t.origin),c.clone(t.direction)):u(c.create(),c.create())}function u(t,r){return{origin:t,direction:r}}function d(t,r,i=a()){return o.copy(i.origin,t),o.copy(i.direction,r),i}const l=new i.ObjectStack(()=>a()),g=c.create(),f=c.create(),b=c.create(),m=n.create();t.closestPoint=function(t,r,i){const e=o.dot(t.direction,o.subtract(i,r,t.origin));return o.add(i,t.origin,o.scale(i,t.direction,e)),i},t.closestPoints=function(t,r,i,n){const c=t.origin,s=r.origin,a=t.direction,u=r.direction,d=o.dot(o.normalize(f,a),o.normalize(b,u));if(Math.abs(d)>=1)return null;const l=o.cross(f,a,u),v=o.sub(g,s,c),p=e.set(m,a[0],a[1],a[2],-u[0],-u[1],-u[2],l[0],l[1],l[2]),y=e.invert(m,p);if(null==y)return[i,n];const S=o.dot(o.set(f,y[0],y[3],y[6]),v),k=o.dot(o.set(b,y[1],y[4],y[7]),v);return o.add(i,c,o.scale(g,a,S)),o.add(n,s,o.scale(g,u,k)),[i,n]},t.copy=function(t,r=a()){return d(t.origin,t.direction,r)},t.create=a,t.distance2=function(t,r){const i=o.cross(s.sv3d.get(),o.normalize(s.sv3d.get(),t.direction),o.subtract(s.sv3d.get(),r,t.origin));return o.dot(i,i)},t.equals=function(t,i){return r.equals(t.origin,i.origin)&&r.equals(t.direction,i.direction)},t.fromPoints=function(t,r,i=a()){return o.copy(i.origin,t),o.subtract(i.direction,r,t),i},t.fromValues=d,t.wrap=function(t,r){const i=l.get();return i.origin=t,i.direction=r,i},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});