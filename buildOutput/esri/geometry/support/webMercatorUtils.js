// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../core/lang","../asserts","../SpatialReference","./Ellipsoid","./spatialReferenceUtils"],function(e,t,n,r,i,a){"use strict";function s(e){return 57.29577951308232*e}function o(e){return.017453292519943*e}function l(e){return null!=e.wkid||null!=e.wkt}const c=[0,0];function u(e,t,n,r,i){const a=e,s=i;if(s.spatialReference=n,"x"in a&&"x"in s)[s.x,s.y]=t(a.x,a.y,c,r);else if("xmin"in a&&"xmin"in s)[s.xmin,s.ymin]=t(a.xmin,a.ymin,c,r),[s.xmax,s.ymax]=t(a.xmax,a.ymax,c,r);else if("paths"in a&&"paths"in s||"rings"in a&&"rings"in s){const e="paths"in a?a.paths:a.rings,n=[];let i;for(let a=0;a<e.length;a++){const s=e[a];i=[],n.push(i);for(let e=0;e<s.length;e++)i.push(t(s[e][0],s[e][1],[0,0],r)),s[e].length>2&&i[e].push(s[e][2]),s[e].length>3&&i[e].push(s[e][3])}"paths"in s?s.paths=n:s.rings=n}else if("points"in a&&"points"in s){const e=a.points,n=[];for(let i=0;i<e.length;i++)n[i]=t(e[i][0],e[i][1],[0,0],r),e[i].length>2&&n[i].push(e[i][2]),e[i].length>3&&n[i].push(e[i][3]);s.points=n}return i}function h(e,t){const n=e&&(l(e)?e:e.spatialReference),r=t&&(l(t)?t:t.spatialReference);return!(e&&"type"in e&&"mesh"===e.type||t&&"type"in t&&"mesh"===t.type||!n||!r)&&(!!a.equals(r,n)||a.isWebMercator(r)&&a.isWGS84(n)||a.isWebMercator(n)&&a.isWGS84(r))}function p(e,t,n=[0,0]){t>89.99999?t=89.99999:t<-89.99999&&(t=-89.99999);const r=o(t);return n[0]=o(e)*i.earth.radius,n[1]=i.earth.halfSemiMajorAxis*Math.log((1+Math.sin(r))/(1-Math.sin(r))),n}function f(e,t,n=[0,0],r=!1){if(e===a.webMercatorValid[0])n[0]=-180;else if(e===a.webMercatorValid[1])n[0]=180;else{const t=s(e/i.earth.radius);n[0]=r?t:t-360*Math.floor((t+180)/360)}return n[1]=s(Math.PI/2-2*Math.atan(Math.exp(-t/i.earth.radius))),n}e.canProject=h,e.geographicToWebMercator=function(e,i=!1,a=t.clone(e)){return n.assertNotMesh(e),n.assertNotMesh(a),u(e,p,r.WebMercator,i,a)},e.lngLatToXY=p,e.project=function(e,n){if(null==e)return null;const i=e.spatialReference,s=n&&(l(n)?n:n.spatialReference);return h(i,s)?a.equals(i,s)?t.clone(e):a.isWebMercator(s)?u(e,p,r.WebMercator,!1,t.clone(e)):a.isWGS84(s)?u(e,f,r.WGS84,!1,t.clone(e)):null:null},e.webMercatorToGeographic=function(e,i=!1,a=t.clone(e)){return n.assertNotMesh(e),n.assertNotMesh(a),u(e,f,r.WGS84,i,a)},e.x2lon=function(e){return e/i.earth.radius},e.xyToLngLat=f,e.y2lat=function(e){return Math.PI/2-2*Math.atan(Math.exp(-e/i.earth.radius))},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});