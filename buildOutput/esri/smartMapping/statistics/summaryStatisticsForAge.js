// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../core/Error","./summaryStatistics","./support/ageUtils","../support/adapters/support/layerUtils"],function(e,t,a,s){"use strict";return async function(i){const{layerAdapter:r,...n}=await async function(t){if(!(t&&t.layer&&t.startTime&&t.endTime&&t.unit))throw new e("summary-statistics-for-age:missing-parameters","'layer', 'startTime', 'endTime' and 'unit' parameters are required");const{layer:i,...r}=t,n=s.createLayerAdapter(i,s.featureCapableLayerTypes);if(!n)throw new e("summary-statistics-for-age:invalid-parameters","'layer' must be one of these types: "+s.getLayerTypeLabels(s.featureCapableLayerTypes).join(", "));const u={layerAdapter:n,...r},l=u.view,o=null!=u.signal?{signal:u.signal}:null;await Promise.all([l?.when(),n.load(o)]);const m=a.verifyDates(n,u.startTime,u.endTime,"summary-statistics-for-age:invalid-parameters");if(m)throw m;if(!u.unit||!a.supportedAgeUnits.includes(u.unit))throw new e("summary-statistics-for-age:invalid-parameters",`Supported units are: ${a.supportedAgeUnits.join(", ")}`);return u}(i),{view:u,startTime:l,endTime:o,unit:m,minValue:p,maxValue:y,signal:c,filter:d,outStatisticTypes:f}=n,{valueExpression:g,statisticsQuery:T}=a.getAgeExpressions({layer:r,startTime:l,endTime:o,unit:m}),w={layer:r,valueExpression:g,...T,minValue:p,maxValue:y,outStatisticTypes:f,view:u,filter:d,signal:c};return t(w)}});