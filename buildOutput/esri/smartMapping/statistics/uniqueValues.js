// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["../../core/Error","./support/utils","../support/binningUtils","../support/utils","../support/adapters/support/layerUtils"],function(e,i,s,r,a){"use strict";return async function(n){const{layerAdapter:t,...l}=await async function(n){if(!n?.layer||!n.field&&!n.valueExpression)throw new e("unique-values:missing-parameters","'layer' and 'field' or 'valueExpression' parameters are required");const t=n.valueExpression||n.sqlExpression,l=t&&!n.sqlExpression;if(t)if(l){if(!n.view)throw new e("unique-values:missing-parameters","View is required when 'valueExpression' is specified")}else if(!n.valueExpression)throw new e("unique-values:missing-parameters","'valueExpression' parameters are required");n.forBinning&&s.verifyBinningParams(n,"unique-values");const{layer:u,...p}=n,o=[...a.defaultSupportedLayerTypes,5],f=n.forBinning?a.binningCapableLayerTypes:o,d=a.createLayerAdapter(u,f,n.forBinning);if(!d)throw new e("unique-values:invalid-parameters","'layer' must be one of these types: "+a.getLayerTypeLabels(f).join(", "));const y={layerAdapter:d,...p},v=null!=y.signal?{signal:y.signal}:null;await d.load(v);const c=await r.getFieldsList({field:y.field,field2:y.field2,field3:y.field3,valueExpression:y.valueExpression}),w=i.verifyBasicFieldValidity(d,c,"unique-values:invalid-parameters");if(w)throw w;y.filter&&!y.filter.spatialRelationship&&(y.filter.spatialRelationship="intersects");const m=i.verifyFilterValidity(y.filter,"summary-statistics:invalid-parameters");if(m)throw m;return y}(n);return t.uniqueValues(l)}});