// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../core/Error","../../../renderers/support/rasterRendererHelper","./adapters/ImageryLayerAdapter","./adapters/ImageryTileLayerAdapter"],function(e,r,a,t,n){"use strict";const s={imagery:{adapter:t,label:"ImageryLayer"},"imagery-tile":{adapter:n,label:"ImageryTileLayer"},wcs:{adapter:n,label:"WCSLayer"}},i={"raster-stretch":"raster-stretch","unique-value":"raster-unique-value","raster-rgb":"raster-rgb","class-breaks":"raster-class-breaks","raster-colormap":"raster-colormap","raster-shaded-relief":"raster-shaded-relief","vector-field":"raster-vector-field",flow:"raster-flow"},o=Object.keys(s).map(e=>s[e].label);function l(e){if("raster-layer-adapter"===e.type)return e;const r=s[e.type]?.adapter;return null==r?null:new r({layer:e})}async function d(e){const{layer:a}=e;if(!a)throw new r("raster-renderer-creator:missing-parameters","'layer' parameter is required");const t=l(a);if(null==t)throw new r("raster-renderer-creator:invalid-parameters","'layer' must be one of these types: "+o.join(", "));await t.load();const n=e.rasterFunction??e.renderingRule??a.rasterFunction;return await t.updateRasterInfo({rasterFunction:n,signal:e.signal}),{...e,layer:t,rasterFunction:n}}e.createRasterLayerAdapter=l,e.getDefaultBandCombination=async function(e){const r=l((e=await d(e)).layer),t=await r.generateRasterInfo(e),{layer:n}=r;if("wcs"!==n.type&&n.presetRenderers?.length){const r=a.matchPresetRenderer({variableName:e.variableName,rasterFunctionName:e.rasterFunction?.functionName,presetRenderers:n.presetRenderers});if(r?.bandIds?.length)return r.bandIds}return a.getDefaultBandCombination(t)},e.getSupportedRendererInfo=async function(e){const r=l((e=await d(e)).layer),t=await r.generateRasterInfo(e),n=a.getSupportedRendererTypes(t,!0).map(e=>i[e]),s=r.layer,o="imagery-tile"===s.type?a.getFunctionColorRamp(s.raster):void 0,c="wcs"!==s.type?s.presetRenderers:void 0,u=a.matchPresetRenderer({variableName:e.variableName,rasterFunctionName:e.rasterFunction?.functionName,presetRenderers:c}),p=u?.renderer??a.createDefaultRenderer(t,{rasterFunctionColorRamp:o,variableName:e.variableName}),{bandCount:y}=t;return y>1&&n.push("raster-rgb"),!n.includes("raster-class-breaks")&&1===y&&+r.layer?.version>=10.3&&n.push("raster-class-breaks"),{supportedTypes:n,defaultRenderer:p}},e.processRasterRendererParameters=d,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});