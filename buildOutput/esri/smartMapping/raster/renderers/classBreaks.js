// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../core/Error","../../../intl/number","../../../renderers/support/rasterRendererHelper","../support/utils"],function(e,r,a,t,s){"use strict";function n(e){const{rasterInfo:r,layer:a}=e,s=r.multidimensionalInfo?"imagery"===a.type?a.mosaicRule?.multidimensionalDefinition?.[0]?.variableName:a.multidimensionalDefinition?.[0]?.variableName:"";return t.getVariableRasterInfo(r,s)}e.createRenderer=async function(e){e=await async function(e){const a=n((e=await s.processRasterRendererParameters(e)).layer);if(a.bandCount>1)throw new r("raster-class-breaks-renderer:not-supported","Multiband raster is not supported");const{attributeTable:o}=a;e.field||(e.field=t.getField(o,"value")?.name??"value");const{colors:i,numClasses:l}=e;if(i&&l&&i.length!==l)throw new r("raster-class-breaks-renderer:not-supported","The size of the `colors` parameter does not match 'numClasses'");return e.classificationMethod||(e.classificationMethod="natural-breaks"),e}(e);const o=n(e.layer).clone(),i=o.attributeTable?.fields.find(r=>r.name.toLowerCase()===e.field?.toLowerCase());if(!i&&!o.histograms?.length&&(await e.layer.updateRasterInfoWithEstimatedStats(o,{rasterFunction:e.rasterFunction,signal:e.signal}),!o.histograms?.length))throw new r("raster-class-breaks-renderer:not-supported","Histograms or raster attribute table is required on the source raster. Unable to estimate histograms");const l=t.createClassBreaksRenderer(o,e);if(null==l)throw new r("raster-class-breaks-renderer:not-supported","Class breaks renderer is not supported on this data");const u={minValue:l.minValue,maxValue:l.classBreakInfos[l.classBreakInfos.length-1].maxValue,normalizationTotal:null,classBreakInfos:l.classBreakInfos.map(e=>{const r=(t=e.minValue,s=e.maxValue,a.formatNumber(t,{maximumFractionDigits:3})+" - "+a.formatNumber(s,{maximumFractionDigits:3}));var t,s;return e.label=r,{minValue:e.minValue,maxValue:e.maxValue,label:r}})};return{renderer:l,classBreaksResult:u}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});