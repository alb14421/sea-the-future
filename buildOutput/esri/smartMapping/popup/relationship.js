// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../PopupTemplate","../../core/Error","../../intl/messages","./support/utils"],function(e,n,r,i,t){"use strict";async function o(e){const{layer:n,renderer:i}=e;await n.load();const t=i??("renderer"in n?n.renderer:void 0);if("unique-value"!==t?.type)throw new r("relationship-popup:invalid-parameters","renderer.type must be 'unique-value'");const o=t.authoringInfo;if(!o||"relationship"!==o.type)throw new r("relationship-popup:invalid-parameters","renderer.authoringInfo.type must be 'relationship'");if(!o.field1?.field||!o.field2?.field)throw new r("relationship-popup:invalid-parameters","'field1' and/or 'field2' properties are missing in renderer.authoringInfo");return{layer:n,renderer:t}}async function a(e,r,i="divide"){const{fieldInfos:o,expressionInfos:a}=await t.getFieldAndExpressionInfos({renderer:e,layer:r,normFieldExpressionTemplate:i});return new n({content:await t.getContentFromFieldInfos(r,{fieldInfos:o,expressionInfos:a}),fieldInfos:o,expressionInfos:a})}e.getTemplates=async function(e){const[{renderer:n,layer:r},t]=await Promise.all([o(e),i.fetchMessageBundle("esri/smartMapping/t9n/smartMapping")]),s={name:"relationship",title:t.relationshipPopupTitle,value:await a(n,r)},l=[];return function(e){const n=e.authoringInfo;return!(!n?.field1?.normalizationField&&!n?.field2?.normalizationField)}(n)&&l.push({name:"relationship-percent",title:t.relationshipNormFieldAsPercent,value:await a(n,r,"percentage")}),{primaryTemplate:s,secondaryTemplates:l}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});