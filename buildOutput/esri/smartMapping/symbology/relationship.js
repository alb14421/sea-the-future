// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../Color","../../core/arrayUtils","../../core/lang","./support/colors","./support/symbologyUtils","./support/utils"],function(e,o,r,a,l,n,s){"use strict";const t={light:{color:[153,153,153,.25],width:"1px"},dark:{color:[153,153,153,.25],width:"1px"},darker:{color:[26,26,26,.25],width:"1px"}},i={lightBasemaps:{primary:"relationship-blue-orange-brown",secondary:["relationship-brewer-yellow-blue-black","relationship-brewer-pink-blue-purple","relationship-purple-green-blue","relationship-blue-green-purple","relationship-blue-orange-green","relationship-mustard-blue-wine","relationship-pink-blue-purple","relationship-olive-blue-green","relationship-yellow-cyan-blue","relationship-blue-pink-purple","relationship-purple-green-wine","relationship-blue-peach-purple","relationship-mint-mustard-green","relationship-purple-mustard-darkpurple","relationship-blue-orange-purple","relationship-pink-periwinkle-violet","relationship-blue-tan-green","relationship-blue-red-pink","relationship-blue-green-brightgreen","relationship-blue-orange-lavender","relationship-pink-purple-peach","relationship-purple-mustard-eggshell","relationship-blue-brick-green","relationship-orange-purple-lavender","relationship-brown-purple-lilac","relationship-teal-yellow-lightteal"]},darkBasemaps:{primary:"relationship-blue-green-brightgreen",secondary:["relationship-blue-red-pink","relationship-blue-orange-lavender","relationship-pink-purple-peach","relationship-purple-mustard-eggshell","relationship-blue-brick-green","relationship-orange-purple-lavender","relationship-brown-purple-lilac","relationship-teal-yellow-lightteal","relationship-blue-orange-brown","relationship-brewer-yellow-blue-black","relationship-brewer-pink-blue-purple","relationship-purple-green-blue","relationship-blue-green-purple","relationship-blue-orange-green","relationship-mustard-blue-wine","relationship-pink-blue-purple","relationship-olive-blue-green","relationship-yellow-cyan-blue","relationship-blue-pink-purple","relationship-purple-green-wine","relationship-blue-peach-purple","relationship-mint-mustard-green","relationship-purple-mustard-darkpurple","relationship-blue-orange-purple","relationship-pink-periwinkle-violet","relationship-blue-tan-green"]}},p="#aaaaaa",c={default:{name:"default",label:"Default",description:"Default theme for visualizing features based on relationship between two attributes.",schemes:{point:{light:{common:{noDataColor:p,outline:t.light,size:"8px"},primary:i.lightBasemaps.primary,secondary:i.lightBasemaps.secondary},dark:{common:{noDataColor:p,outline:t.darker,size:"8px"},primary:i.darkBasemaps.primary,secondary:i.darkBasemaps.secondary}},polyline:{light:{common:{noDataColor:p,width:"2px"},primary:i.lightBasemaps.primary,secondary:i.lightBasemaps.secondary},dark:{common:{noDataColor:p,width:"2px"},primary:i.darkBasemaps.primary,secondary:i.darkBasemaps.secondary}},polygon:{light:{common:{noDataColor:p,outline:t.light,fillOpacity:.8},primary:i.lightBasemaps.primary,secondary:i.lightBasemaps.secondary},dark:{common:{noDataColor:p,outline:t.dark,fillOpacity:.8},primary:i.darkBasemaps.primary,secondary:i.darkBasemaps.secondary}}}}},u=n.createThemes({themeDictionary:c});function m(e){const o=n.getRawSchemes({basemap:e.basemap,geometryType:e.geometryType,basemapTheme:e.basemapTheme,theme:u.get("default")});if(!o)return;const{schemesInfo:a,basemapId:l,basemapTheme:s}=o,t={...e,basemap:l};return{primaryScheme:C(t,a.primary,a.common),secondarySchemes:a.secondary.map(e=>C(t,e,a.common)).filter(r.isSome),basemapId:l,basemapTheme:s}}function h(e){if(!e)return;const r={...e};return r.colorsForClassBreaks=r.colorsForClassBreaks.map(e=>({numClasses:e.numClasses,colors:e.colors.map(e=>e.map(e=>new o(e)))})),r.tags=[...r.tags],r.noDataColor&&(r.noDataColor=new o(r.noDataColor)),"outline"in r&&r.outline&&(r.outline={color:r.outline.color&&new o(r.outline.color),width:r.outline.width}),r}function g(e,o){e=a.clone(e);let r=[];const l=(o||"HH").split(""),n=l[0],s=l[1];"L"===n&&e.reverse();const t="H"===s;return e.forEach(e=>{t&&e.reverse(),r=r.concat(e)}),r}function d(e,r,a){let l;return e.colorsForClassBreaks.some(e=>(e.numClasses===r&&(l=e.colors),!!l)),l=l?.map(e=>e.map(e=>new o(e))),l?g(l,a):null}function y(e,o){const r=o?e:h(e);return r.colorsForClassBreaks.forEach(e=>{const o=e.colors.reverse(),r=[];for(let a=0;a<e.numClasses;a++){const e=[];o.forEach(o=>{e.push(o[a])}),r.push(e)}e.colors=r}),r}function b(e,o,r,a){let l;const n=d(e,r,a);return n&&1===s.hasIdenticalColors(o,n)&&(l=e),l}function w(e,o,r,a){let l,n=1;do{l=b(e,o,r,a),l||(e=y(e),n++)}while(!l&&n<=4);return l}function f(e,o,r){return w(e,o,r,"HH")||w(e,o,r,"HL")||w(e,o,r,"LH")||w(e,o,r,"LL")}function C(e,r,a){const n="mesh"!==e.geometryType&&e.worldScale?e.view:null,t=l[r],i=e.theme||"default";if(!t)return;const p=i+"/"+e.basemap+"/"+r,c=[];for(const e in t)if("stops"!==e&&"name"!==e&&"tags"!==e){const o=+e,r=t[e];c.push({numClasses:o,colors:r})}switch(e.geometryType){case"point":case"multipoint":{const e=a;return function(e,r){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:k(e.colorsForClassBreaks),noDataColor:new o(e.noDataColor),outline:{color:new o(e.outline.color),width:e.outline.width},size:r?s.toWorldScale(e.size,r):e.size,opacity:e.opacity}}({id:p,name:t.name,tags:t.tags,colorsForClassBreaks:c,noDataColor:e.noDataColor,opacity:1,outline:e.outline,size:e.size},n)}case"polyline":{const e=a;return function(e,r){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:k(e.colorsForClassBreaks),noDataColor:new o(e.noDataColor),opacity:e.opacity,width:r?s.toWorldScale(e.width,r):e.width}}({id:p,name:t.name,tags:t.tags,colorsForClassBreaks:c,noDataColor:e.noDataColor,opacity:1,width:e.width},n)}case"polygon":{const e=a;return{id:(u={id:p,name:t.name,tags:t.tags,colorsForClassBreaks:c,noDataColor:e.noDataColor,opacity:e.fillOpacity,outline:e.outline}).id,name:u.name,tags:[...u.tags],colorsForClassBreaks:k(u.colorsForClassBreaks),noDataColor:new o(u.noDataColor),outline:{color:new o(u.outline.color),width:u.outline.width},opacity:u.opacity}}case"mesh":{const e=a;return function(e){return{id:e.id,name:e.name,tags:[...e.tags],colorsForClassBreaks:k(e.colorsForClassBreaks),noDataColor:new o(e.noDataColor),opacity:e.opacity}}({id:p,name:t.name,tags:t.tags,colorsForClassBreaks:c,noDataColor:e.noDataColor,opacity:e.fillOpacity})}}var u}function k(e){return e.map(e=>({numClasses:e.numClasses,colors:e.colors.map(e=>e.map(e=>new o(e)))}))}e.cloneScheme=h,e.flatten2DArray=g,e.flipColors=y,e.getColors=d,e.getMatchingSchemes=function(e){const o=e.theme||"default",r=e.geometryType,a=e.colors,l=e.numClasses,n=u.get(o);if(!n)return[];const s=n.supportedBasemaps,t=[];return s.forEach(e=>{const n=m({theme:o,basemap:e,geometryType:r});if(n){let e=f(n.primaryScheme,a,l);e&&t.push(e),n.secondarySchemes.forEach(o=>{e=f(o,a,l),e&&t.push(e)})}}),t},e.getSchemeByName=function(e){return n.filterSchemesByName(e.name,m(e))},e.getSchemes=m,e.getSchemesByTag=function(e){return n.filterSchemesByTag(e.includedTags,e.excludedTags,m(e))},e.getThemes=function(e){return n.getThemesforBasemap(u,e)},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});