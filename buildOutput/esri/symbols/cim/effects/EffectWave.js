// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../geometry/GeometryCursor","../GeometryWalker"],function(t,e,i){"use strict";class s{static{this.instance=null}static local(){return null===s.instance&&(s.instance=new s),s.instance}execute(t,e,i){return new h(t,e,i)}}class h{constructor(t,e,s){this._inputGeometries=t,this._height=(void 0!==e.amplitude?e.amplitude:2)*s,this._period=(void 0!==e.period?e.period:3)*s,this._style=e.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new i.DashPattern,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new i.GeometryWalker,this._walker.updateTolerance(s)}next(){let t=this._inputGeometries.next();for(;t;){if(0===this._height||0===this._period)return t;const e=this._processGeom(t);if(e)return e;t=this._inputGeometries.next()}return null}_processGeom(t){const i=e.GeometryCursor.createEmptyOptimizedCIM(t.geometryType);for(;t.nextPath();){i.startPath();const e=t.pathLength();if(this._walker.init(t,this._pattern))switch(this._style){case"Sinus":default:this._constructCurve(i,e,!1);break;case"Square":this._constructSquare(i,e);break;case"Triangle":this._constructTriangle(i,e);break;case"Random":this._constructCurve(i,e,!0)}else for(;t.nextPoint();)i.pushXY(t.x,t.y)}return i}_constructCurve(t,e,s){let h=Math.round(e/this._period);0===h&&(h=1);const n=16*h+1,r=e/h,a=this._period/16,o=1/n,p=2*Math.PI*e/r,_=2*Math.PI*Math.random(),u=2*Math.PI*Math.random(),c=2*Math.PI*Math.random(),l=.75-Math.random()/2,d=.75-Math.random()/2,g=new i.Pos;this._walker.curPointAndAngle(g),t.pushPoint(g.pt);let P=0;for(;;){if(!this._walker.nextPointAndAngle(a,g)){t.pushPoint(this._walker.getPathEnd());break}{const e=P;let i;if(P+=o,s){const t=this._height/2*(1+.3*Math.sin(l*p*e+_));i=t*Math.sin(p*e+u),i+=t*Math.sin(d*p*e+c),i/=2}else i=.5*this._height*Math.sin(.5*p*e);t.pushXY(g.pt[0]-i*g.sa,g.pt[1]+i*g.ca)}}}_constructSquare(t,e){Math.round(e/this._period);let s=!0;for(;;){let e=!1;if(this._walker.curPositionIsValid()){const h=new i.Pos;this._walker.curPointAndAngle(h);const n=new i.Pos;if(this._walker.nextPointAndAngle(this._period,n)){const r=new i.Pos;this._walker.nextPointAndAngle(this._period,r)&&(s?(t.pushPoint(h.pt),s=!1):t.pushPoint(h.pt),t.pushXY(h.pt[0]-this._height/2*h.sa,h.pt[1]+this._height/2*h.ca),t.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),t.pushXY(n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca),t.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca),e=!0)}}if(!e){t.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(t,e){Math.round(e/this._period);let s=!0;for(;;){let e=!1;if(this._walker.curPositionIsValid()){const h=new i.Pos;this._walker.curPointAndAngle(h);const n=new i.Pos;if(this._walker.nextPointAndAngle(this._period/2,n)){const r=new i.Pos;this._walker.nextPointAndAngle(this._period,r)&&(this._walker.nextPosition(this._period/2)&&(s?(t.pushPoint(h.pt),s=!1):t.pushPoint(h.pt),t.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),t.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca)),e=!0)}}if(!e){t.pushPoint(this._walker.getPathEnd());break}}}}t.EffectWave=s,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});