// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../../geometry/GeometryCursor","../../../geometry/SpatialReference","../CIMEffects"],function(t,i,e,n){"use strict";class s{static{this.instance=null}static local(){return null===s.instance&&(s.instance=new s),s.instance}execute(t,i,e,n,s,o){return new r(t,i,e,n,s,o)}}class r{constructor(t,i,e,n,s,r){this._preventClipping=r,this._inputGeometries=t,this._tileKey=n,this._maxInflateSize=s*e,this._width=(void 0!==i.width?i.width:2)*e,i.method,this._option=i.option}next(){let t;for(;t=this._inputGeometries.next();){if("esriGeometryEnvelope"===t.geometryType&&this._width>0){const e=t.asJSON();return Math.min(e.xmax-e.xmin,e.ymax-e.ymin)-2*this._width<0?t:i.GeometryCursor.fromJSONCIM({paths:[[[e.xmin+this._width,e.ymin+this._width],[e.xmax-this._width,e.ymin+this._width],[e.xmax-this._width,e.ymax-this._width],[e.xmin+this._width,e.ymax-this._width],[e.xmin+this._width,e.ymin+this._width]],[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]})}if("esriGeometryPolygon"===t.geometryType){if(0===this._width)return t.clone();const i=n.lazyBufferOperator.module,s=!this._preventClipping&&this._tileKey?n.clipCursorToTileExtent(t,this._maxInflateSize,!0):t.clone();if(!s)continue;const r={...s.asJSON(),spatialReference:{wkid:e.WebMercator.wkid}},o=i.execute(r,-this._width);if(o)for(const t of o.rings)if(t){s.startPath();for(const i of t.reverse())s.pushXY(i[0],s.yFactor*i[1])}return s}}return null}}t.EffectDonut=s,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});