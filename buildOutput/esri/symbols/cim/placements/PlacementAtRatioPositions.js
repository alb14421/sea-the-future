// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../CIMCursor","../GeometryWalker"],function(t,i,e){"use strict";class s{static{this.instance=null}static local(){return null===s.instance&&(s.instance=new s),s.instance}execute(t,i,e){return new n(t,i,e)}}class n extends i.PathTransformationCursor{constructor(t,i,s){super(t),this._walker=new e.GeometryWalker,this._walker.updateTolerance(s),this._angleToLine=void 0===i.angleToLine||i.angleToLine,this._offset=void 0!==i.offset?i.offset*s:0,this._beginGap=void 0!==i.beginPosition?i.beginPosition*s:0,this._endGap=void 0!==i.endPosition?i.endPosition*s:0,this._flipFirst=void 0===i.flipFirst||i.flipFirst,this._pattern=new e.DashPattern,this._pattern.init(i.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(t){if(this._pattern.isEmpty())return null;let i;if(this.iteratePath){const t=this._pattern.nextValue()*this._subPathLen,e=this._beginGap+t;i=e-this._prevPos,this._prevPos=e}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=t.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(t,this._pattern,!1))return null;this._pattern.reset();const e=this._pattern.nextValue()*this._subPathLen,s=this._beginGap+e;i=s-this._prevPos,this._prevPos=s,this.iteratePath=!0}const s=new e.Pos;if(!this._walker.nextPointAndAngle(i,s,1))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(s.pt[0]-this._offset*s.sa,s.pt[1]+this._offset*s.ca);const n=this._isFirst&&this._flipFirst;let a,r;return this._angleToLine?(a=s.ca,r=s.sa):(a=1,r=0),n&&(a=-a,r=-r),this.internalPlacement.setRotateCS(a,r),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}t.PlacementAtRatioPositions=s,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});