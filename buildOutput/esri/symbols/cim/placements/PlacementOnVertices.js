// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../CIMCursor","../CurveHelper"],function(t,e,s){"use strict";class i{static{this.instance=null}static local(){return null===i.instance&&(i.instance=new i),i.instance}execute(t,e,s){return new n(t,e,s)}}class n extends e.PathTransformationCursor{constructor(t,e,i){super(t),this._curveHelper=new s.CurveHelper,this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*i:0,this._endPoints=void 0===e.placeOnEndPoints||e.placeOnEndPoints,this._controlPoints=void 0===e.placeOnControlPoints||e.placeOnControlPoints,this._regularVertices=void 0===e.placeOnRegularVertices||e.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(t){if(this.iteratePath||(this._preparePath(t),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const e=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(e[2]);let s=e[0],i=e[1];if(0!==this._offset){const t=Math.cos(e[2]),n=Math.sin(e[2]);s-=this._offset*n,i+=this._offset*t}return this.internalPlacement.setTranslate(s,i),this._tagIterator++,this.internalPlacement}_preparePath(t){this._tags.length=0,this._tagIterator=0,t.seekPathStart();const e=t.isClosed();let s=0,i=!1,n=0,a=0;if(t.seekPathStart(),t.nextPoint()){let o=t.x,h=t.y,l=t.getControlPoint(),c=!0,_=t.nextPoint();for(;_;){const g=t.x,u=t.y,P=t.getControlPoint();(this._angleToLine||0!==this._offset)&&(n=this._curveHelper.getAngle(o,h,g,u,0)),c?(c=!1,e?(s=n,i=l):(this._endPoints||this._controlPoints&&l)&&this._tags.push([o,h,n])):l?this._controlPoints&&this._tags.push([o,h,r(a,n)]):this._regularVertices&&this._tags.push([o,h,r(a,n)]),(this._angleToLine||0!==this._offset)&&(a=this._curveHelper.getAngle(o,h,g,u,1)),_=t.nextPoint(),_||(e?P||i?this._controlPoints&&this._tags.push([g,u,r(a,s)]):this._regularVertices&&this._tags.push([g,u,r(a,s)]):(this._endPoints||this._controlPoints&&P)&&this._tags.push([g,u,a])),o=g,h=u,l=P}}this._tagIterator=0}}function r(t,e){const s=Math.PI;for(;Math.abs(e-t)>s+2e-15;)e-t>s?e-=2*s:e+=2*s;return(t+e)/2}t.PlacementOnVertices=i,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});