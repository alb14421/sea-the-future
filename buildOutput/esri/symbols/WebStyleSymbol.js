// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["require","exports","../chunks/tslib.es6","../core/deprecate","../core/Error","../core/Logger","../core/promiseUtils","../core/accessorSupport/decorators/property","../core/has","../core/RandomLCG","../core/accessorSupport/decorators/enumeration","../core/accessorSupport/decorators/subclass","../portal/Portal","../chunks/persistableUrlUtils","./Symbol","./support/Thumbnail"],function(e,t,o,r,l,s,a,c,n,y,i,p,u,h,m,d){"use strict";var b;return t.default=b=class extends m{constructor(e){super(e),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const e=null!=this.portal?this.portal:u.getDefault(),t=e.user?e.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${t}:${e.url}`}read(e,t){this.portal=t?.portal,super.read(e,t)}clone(){return new b({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(e){return this._fetchSymbol(e)}async fetchCIMSymbol(e){r.deprecatedFunction(s.getLogger(this),"WebStyleSymbol.fetchCIMSymbol is deprecated in favour of WebStyleSymbol.fetchSymbol which now supports both web and cim symbology",{version:"4.33",replacement:"WebStyleSymbol.fetchSymbol",see:"https://arcg.is/0CXPTr#fetchSymbol",warnOnce:!0});const t=await this._fetchSymbol({...e,acceptedFormats:["cim"]});if("cim"!==t?.type)throw new l("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return t}async _fetchSymbol(t){const o=null!=t?t.cache:null,r=o?this._fetchCacheKey:null;if(null!=o){const e=r&&o.get(r);if(e)return e.clone()}const{resolveWebStyleSymbol:l}=await new Promise((t,o)=>e(["./support/webStyleSymbolUtils"],t,o));a.throwIfAborted(t);const c=l(this,{portal:this.portal},t);c.catch(e=>{s.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",e)});const n=await c;return null!=o&&o.set(r,n.clone()),n}},o.__decorate([c.property({json:{write:!1}})],t.default.prototype,"color",void 0),o.__decorate([c.property({type:String,json:{write:!0}})],t.default.prototype,"styleName",void 0),o.__decorate([c.property({type:u,json:{write:!1}})],t.default.prototype,"portal",void 0),o.__decorate([c.property({type:String,json:{read:h.read,write:h.write}})],t.default.prototype,"styleUrl",void 0),o.__decorate([c.property({type:d.Thumbnail,json:{read:!1}})],t.default.prototype,"thumbnail",void 0),o.__decorate([c.property({type:String,json:{write:!0}})],t.default.prototype,"name",void 0),o.__decorate([i.enumeration({styleSymbolReference:"web-style"},{readOnly:!0})],t.default.prototype,"type",void 0),o.__decorate([c.property()],t.default.prototype,"_fetchCacheKey",null),t.default=b=o.__decorate([p.subclass("esri.symbols.WebStyleSymbol")],t.default),t.default});