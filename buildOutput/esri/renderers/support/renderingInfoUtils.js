// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../../Color","./RenderingInfo","../visualVariables/support/visualVariableUtils"],function(e,t,i,n){"use strict";async function o(e,t){return null!=e.symbol?e.symbol:t?.renderer?.getSymbolAsync(e,t)??null}e.getDriverAxisSizeValue=function(e,t=0){const i=e[t];return"number"==typeof i&&isFinite(i)?i:null},e.getDriverAxisSizeValueAny=function(e){for(let t=0;t<3;t++){const i=e[t];if("number"==typeof i)return isFinite(i)?i:0}return 0},e.getRenderingInfo=function(e,t){const o=function(e,t){if(null!=e.symbol)return e.symbol;const i=t?.renderer;return null!=i&&"dot-density"!==i.type?i.getSymbol(e,t):null}(e,t);if(null==o)return null;const r=t?.renderer,l=new i.RenderingInfo(r,o);if(null==r||!("visualVariables"in r)||!r.visualVariables)return l;const a=n.getVisualVariableValues(r,e,t)??[],s=["proportional","proportional","proportional"];for(const{variable:e,value:t}of a)if(null!=t||"size"===e.type&&e.useSymbolValue)switch(e.type){case"color":l.color=t?.toRgba();break;case"size":if("outline"===e.target)l.outlineSize=t;else{const i=e.axis,n=e.useSymbolValue?"symbol-value":t??"proportional";switch(i){case"width":s[0]=n;break;case"depth":s[1]=n;break;case"height":s[2]=n;break;case"width-and-depth":s[0]=s[1]=n;break;default:s[0]=s[1]=s[2]=n}}break;case"opacity":l.opacity=t;break;case"rotation":switch(e.axis){case"tilt":l.tilt=t;break;case"roll":l.roll=t;break;default:l.heading=t}}return"proportional"===s[0]&&"proportional"===s[1]&&"proportional"===s[2]||(l.size=s),l},e.getRenderingInfoAsync=async function(e,r){const l=await o(e,r);if(!l)return null;const a=r?.renderer,s=new i.RenderingInfo(a,l);if(!a||!("visualVariables"in a)||!a.visualVariables)return s;const u=n.getVisualVariableValues(a,e,r)??[],c=["proportional","proportional","proportional"];for(const{variable:e,value:i}of u)if("color"===e.type)s.color=t.toUnitRGBA(i);else if("size"===e.type)if("outline"===e.target)s.outlineSize=i;else{const t=e.axis,n=e.useSymbolValue?"symbol-value":i;"width"===t?c[0]=n:"depth"===t?c[1]=n:"height"===t?c[2]=n:c[0]=c[1]="width-and-depth"===t?n:c[2]=n}else"opacity"===e.type?s.opacity=i:"rotation"===e.type&&"tilt"===e.axis?s.tilt=i:"rotation"===e.type&&"roll"===e.axis?s.roll=i:"rotation"===e.type&&(s.heading=i);return(isFinite(c[0])||isFinite(c[1])||isFinite(c[2]))&&(s.size=c),s},e.getSymbolAsync=o,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});