// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../chunks/tslib.es6","../Color","../core/lang","../core/screenUtils","../core/accessorSupport/decorators/property","../core/has","../core/Logger","../core/accessorSupport/decorators/enumeration","../core/accessorSupport/decorators/subclass","../layers/support/fieldUtils","./Renderer","./support/AuthoringInfo","./support/HeatmapColorStop","./support/HeatmapLegendOptions","./support/heatmapUtils","../symbols/SimpleMarkerSymbol"],function(e,t,i,r,s,o,n,a,l,p,u,y,d,c,m,h,f){"use strict";var _;function g(e){if(null!=e){const{maxDensity:t,minDensity:i,radius:r}=e;if(null!=t||null!=i||null!=r){const{blurRadius:t,maxPixelIntensity:i,minPixelIntensity:r,...s}=e;return s}}return e}return e.default=_=class extends y{constructor(e){super(e),this.authoringInfo=null,this.colorStops=[new c({ratio:0,color:new i("rgba(255, 140, 0, 0)")}),new c({ratio:.75,color:new i("rgba(255, 140, 0, 1)")}),new c({ratio:.9,color:new i("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(e){return g(e)}get blurRadius(){return h.kernelDensityRadiusPtToGaussianBlurRadiusPx(this.radius)}set blurRadius(e){const t=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",h.gaussianBlurRadiusPxToKernelDensityRadiusPt(e)),this._set("maxDensity",t*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(e){this._set("maxDensity",e*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(e){this._set("minDensity",e*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(h.magicKernelDensityRadiusInflationFactor**2*this.blurRadius**4)}read(e,t){e=g(e),super.read(e,t)}getSymbol(){return new f}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}async collectRequiredFields(e,t){const i=this.field,r=this.valueExpression;i&&"string"==typeof i&&u.collectField(e,t,i),r&&"string"==typeof r&&await u.collectArcadeFieldNames(e,t,r)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new _({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:r.clone(this.colorStops),field:this.field,legendOptions:r.clone(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}},t.__decorate([o.property({type:d,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],e.default.prototype,"authoringInfo",void 0),t.__decorate([o.property({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],e.default.prototype,"blurRadius",null),t.__decorate([o.property({type:[c],json:{write:{isRequired:!0}}})],e.default.prototype,"colorStops",void 0),t.__decorate([o.property({type:String,json:{write:!0}})],e.default.prototype,"field",void 0),t.__decorate([o.property({type:m.HeatmapLegendOptions,json:{write:!0}})],e.default.prototype,"legendOptions",void 0),t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"maxDensity",void 0),t.__decorate([o.property({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],e.default.prototype,"maxPixelIntensity",null),t.__decorate([o.property({type:Number,json:{write:!0}})],e.default.prototype,"minDensity",void 0),t.__decorate([o.property({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],e.default.prototype,"minPixelIntensity",null),t.__decorate([o.property({type:Number,cast:s.toPt,json:{write:!0}})],e.default.prototype,"radius",void 0),t.__decorate([o.property({type:Number,range:{min:0},json:{default:0,write:!0}})],e.default.prototype,"referenceScale",void 0),t.__decorate([l.enumeration({heatmap:"heatmap"})],e.default.prototype,"type",void 0),t.__decorate([o.property({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],e.default.prototype,"valueExpression",void 0),t.__decorate([o.property({type:String})],e.default.prototype,"valueExpressionTitle",void 0),t.__decorate([o.property({readOnly:!0})],e.default.prototype,"_pixelIntensityToDensity",null),e.default=_=t.__decorate([p.subclass("esri.renderers.HeatmapRenderer")],e.default),e.default});