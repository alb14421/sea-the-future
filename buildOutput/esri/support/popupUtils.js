// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../PopupTemplate","../layers/support/fieldUtils","../popup/content/AttachmentsContent","../popup/content/Content","../popup/content/CustomContent","../popup/content/ExpressionContent","../popup/content/FieldsContent","../popup/content/MediaContent","../popup/content/RelationshipContent","../popup/content/TextContent","../popup/content/UtilityNetworkAssociationsContent","../popup/FieldInfo","../popup/support/FieldInfoFormat"],function(e,t,n,i,o,l,s,a,r,p,d,u,c,f){"use strict";const m=(e,t)=>t.visibleFieldNames?t.visibleFieldNames.has(e.name):n.isFieldVisibleByDefault(e,t);function F(e,t){return"oid"===e.type?-1:"oid"===t.type?1:y(e)?-1:y(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function b(e,t){const i=t?.visibleFieldNames;return function({fields:e,ignoreFieldTypes:t,sortDisabled:n}){const i=e;return t&&(e=e.filter(e=>!t.includes(e.type))),e===i&&(e=e.slice()),!0!==n&&e.sort(F),e}({fields:e.fields??[],ignoreFieldTypes:t?.ignoreFieldTypes||C,sortDisabled:t?.sortDisabled}).map(t=>new c({fieldName:t.name,isEditable:n.isFieldEditable(t,e),label:t.alias,format:w(t),visible:m(t,{...e,visibleFieldNames:i})}))}function g(e,t){const{onStatisticField:n,onStatisticExpression:i,statisticType:o}=e;if(n){const e=t.find(e=>n===e.name);if(e)return w(e)}return"number"===i?.returnType?new f({digitSeparator:!0,places:2}):"count"===o?new f({digitSeparator:!0,places:0}):void 0}function w(e){switch(e.type){case"small-integer":case"integer":case"single":return new f({digitSeparator:!0,places:0});case"double":return new f({digitSeparator:!0,places:2});case"string":return n.isRasterPixelValueField(e.name)?new f({digitSeparator:!0,places:0}):void 0;default:return}}function y(e){if("name"===(e.name&&e.name.toLowerCase()))return!0;const t=e.alias?.toLowerCase();return"name"===t}const C=["geometry","blob","raster","guid","xml"];e.createFieldInfos=b,e.createFieldsContent=function(e,t){return new a({fieldInfos:b(e,t).filter(e=>e.visible)})},e.createPopupTemplate=function({displayField:e,editFieldsInfo:o,fields:l,objectIdField:s,title:r},p){if(!l)return null;const d=b({editFieldsInfo:o,fields:l,objectIdField:s},p);if(!d.length)return null;const u=function(e){const t=n.getDisplayFieldName(e),{titleBase:i}=e;return t?`${i}: {${t.trim()}}`:i??""}({titleBase:r,fields:l,displayField:e}),c=[new a,new i];return new t({title:u,content:c,fieldInfos:d})},e.createPopupTemplateForFeatureReduction=function(e){const{fields:n,featureReduction:i,title:o}=e,l=i.fields;if(!l)return null;const s=function(e,t){return e.map(e=>new c({fieldName:e.name,isEditable:!1,label:e.alias,format:g(e,t),visible:!0}))}(l,n??[]);if(!s.length)return null;const r=[new a];return new t({title:o,content:r,fieldInfos:s})},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});