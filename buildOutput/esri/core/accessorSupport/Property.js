// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","./ObservableBase","./tracking","./tracking/Flags","./tracking/TrackingTarget"],function(t,s,e,a,i){"use strict";class r extends s.ObservableBase{constructor(t,s){super(),this.propertyName=t,this.metadata=s,this.trackingTarget=new i.TrackingTarget(this),this.flags=0,this.flags=a.Flags.Dirty|(s.nonNullable?a.Flags.NonNullable:0)|(s.hasOwnProperty("value")?a.Flags.HasDefaultValue:0)|(void 0===s.get?a.Flags.DepTrackingInitialized:0)|(void 0===s.dependsOn?a.Flags.AutoTracked:0)}destroy(){this.flags&a.Flags.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(t){t.mutable&&e.trackAccess(this);const s=t.store,i=this.propertyName,r=this.flags,n=s.get(i);if(r&a.Flags.Computing)return n;if(~r&a.Flags.Dirty&&s.has(i))return n;this.flags|=a.Flags.Computing;const l=t.host;let o;r&a.Flags.AutoTracked?o=e.runTracked(this.trackingTarget,this.metadata.get,l):(e.trackExplicitDependencies(l,this),o=this.metadata.get.call(l)),this.flags|=a.Flags.DepTrackingInitialized,s.set(i,o,1);const g=s.get(i);return g===n?this.flags&=~a.Flags.Dirty:e.runUntracked(this.commit,this),this.flags&=~a.Flags.Computing,g}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=~a.Flags.Dirty,this.onCommitted()}onInvalidated(){~this.flags&a.Flags.Overridden&&(this.flags|=a.Flags.Dirty);const t=this._observers;if(t&&t.length>0)for(const s of t)s.onInvalidated()}onCommitted(){const t=this._observers;if(t&&t.length>0){const s=t.slice();for(const t of s)t.onCommitted()}}}t.Property=r,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});