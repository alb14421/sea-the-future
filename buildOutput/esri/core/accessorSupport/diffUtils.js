// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../Accessor","../Collection","./utils"],function(e,t,n,o){"use strict";const r=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function f(e){return e instanceof t}function i(e){return e instanceof n?Object.keys(e.items):f(e)?o.getProperties(e).keys():e?Object.keys(e):[]}function l(e,t){return e instanceof n?e.items[t]:e[t]}function u(e){return e?e.declaredClass:null}function c(e,t){const n=e.diff;if(n&&"function"==typeof n)return n(e,t);const o=i(e),s=i(t);if(0===o.length&&0===s.length)return;if(!o.length||!s.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};const a=s.filter(e=>!o.includes(e)),p=o.filter(e=>!s.includes(e)),y=o.filter(n=>s.includes(n)&&l(e,n)!==l(t,n)).concat(a,p).sort(),d=u(e);if(d&&r.has(d)&&y.length)return{type:"complete",oldValue:e,newValue:t};let m;const h=f(e)&&f(t);for(const o of y){const r=l(e,o),f=l(t,o);let i;if((h||"function"!=typeof r&&"function"!=typeof f)&&r!==f&&(null!=r||null!=f)){if(n&&n[o]&&"function"==typeof n[o])i=n[o]?.(r,f);else if(r instanceof Date&&f instanceof Date){if(r.getTime()===f.getTime())continue;i={type:"complete",oldValue:r,newValue:f}}else i="object"==typeof r&&"object"==typeof f&&u(r)===u(f)?c(r,f):{type:"complete",oldValue:r,newValue:f};null!=i&&(null!=m?m.diff[o]=i:m={type:"partial",diff:{[o]:i}})}}return m}function s(e,t){if(null==e)return!1;const n=t.split(".");let o=e;for(const e of n){if("complete"===o.type)return!0;if("partial"!==o.type)return!1;{const t=o.diff[e];if(!t)return!1;o=t}}return!0}e.diff=function(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&u(e)!==u(t)?{type:"complete",oldValue:e,newValue:t}:c(e,t)},e.hasDiff=s,e.hasRootDiff=function(e,t){return s(e,t)},e.hasRootDiffOnly=function(e,t){if(!e)return!1;if("partial"===e.type){const n=Object.keys(e.diff);return 1===n.length&&n[0]===t}return!1},e.isEmpty=function e(t){if(null==t)return!0;switch(t.type){case"complete":return!1;case"collection":{const n=t;for(const t of n.added)if(!e(t))return!1;for(const t of n.removed)if(!e(t))return!1;for(const t of n.changed)if(!e(t))return!1;return!0}case"partial":for(const n in t.diff)if(!e(t.diff[n]))return!1;return!0}},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});