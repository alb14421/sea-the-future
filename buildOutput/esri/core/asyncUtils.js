// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","../chunks/tslib.es6","./Accessor","./maybe","./promiseUtils","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass"],function(r,t,e,o,s,n,l){"use strict";function a(r){return{ok:!0,value:r}}function u(r){return{ok:!1,error:r}}function i(r){return null!=r&&!0===r.ok?r.value:null}function c(r){return null!=r&&!1===r.ok?r.error:null}let p=class extends e{get value(){return i(this._result)}get error(){return c(this._result)}get finished(){return null!=this._result}constructor(r,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=o.abortMaybe(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:e}=this._abortController;this.promise=r(e),this.promise.then(r=>{this._result=a(r),this._cleanup()},r=>{this._result=u(r),this._cleanup()}),this._abortHandle=s.onAbort(t,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=o.removeMaybe(this._abortHandle),this._abortController=null}};t.__decorate([n.property()],p.prototype,"value",null),t.__decorate([n.property()],p.prototype,"error",null),t.__decorate([n.property()],p.prototype,"finished",null),t.__decorate([n.property()],p.prototype,"promise",void 0),t.__decorate([n.property()],p.prototype,"_result",void 0),p=t.__decorate([l.subclass("esri.core.asyncUtils.ReactiveTask")],p),r.assertResult=function(r){if(!0===r.ok)return r.value;throw r.error},r.createTask=function(r,t){return new p(r,t)},r.forEach=function(r,t,e){return s.eachAlways(r.map((r,o)=>t.apply(e,[r,o])))},r.makeResultError=u,r.makeResultOk=a,r.map=async function(r,t,e){return(await s.eachAlways(r.map((r,o)=>t.apply(e,[r,o])))).map(r=>r.value)},r.result=async function(r){if(null==r)return{ok:!1,error:new Error("no promise provided")};try{return a(await r)}catch(r){return u(r)}},r.resultError=c,r.resultOrAbort=async function(r){try{return a(await r)}catch(r){return s.throwIfAbortError(r),u(r)}},r.resultValue=i,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});