// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["exports","./events","./handleUtils","./maybe","./promiseUtils","./accessorSupport/watch","./accessorSupport/trackingUtils"],function(n,e,t,r,o,i,u){"use strict";function c(n,e,t={}){return l(n,e,t,a)}function l(n,e,t={},o){let u=null;const c=t.once?(n,t)=>{o(n)&&(r.removeMaybe(u),e(n,t))}:(n,t)=>{o(n)&&e(n,t)};if(u=i.watchTracked(n,c,t.sync,t.equals),t.initial){const e=n();c(e,e)}return u}function s(n,e,i){if(o.isAborted(i))return Promise.reject(o.createAbortError());const u=n();if(e?.(u))return Promise.resolve(u);let c=null;function s(){c=r.removeMaybe(c)}return new Promise((r,u)=>{c=t.handlesGroup([o.onAbort(i,()=>{s(),u(o.createAbortError())}),l(n,n=>{s(),r(n)},{sync:!1,once:!0},e??a)])})}function a(n){return!0}function f(n){return!!n}n.autorun=u.autorun,n.initial={initial:!0},n.on=function(n,o,i,u={}){let l=null,s=null,a=null;function f(){l&&s&&(s.remove(),u.onListenerRemove?.(l),l=null,s=null)}function m(n){u.once&&u.once&&r.removeMaybe(a),i(n)}const y=c(n,(n,t)=>{f(),e.isEventedOrEventTarget(n)&&(l=n,s=e.on(n,o,m),u.onListenerAdd?.(n))},{sync:u.sync,initial:!0});return a=t.makeHandle(()=>{y.remove(),f()}),a},n.once=function(n,e){return s(n,null,e)},n.pausable=function(n,e,t={}){let r=!1;const o=c(n,(n,t)=>{r||e(n,t)},t);return{remove(){o.remove()},pause(){r=!0},resume(){r=!1}}},n.sync={sync:!0},n.syncAndInitial={sync:!0,initial:!0},n.watch=c,n.when=function(n,e,t={}){return l(n,e,t,f)},n.whenOnce=function(n,e){return s(n,f,e)},Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});