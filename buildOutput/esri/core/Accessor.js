// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.34/esri/copyright.txt for details.
//>>built
define(["./deprecate","./Handles","./Logger","./maybe","./accessorSupport/beforeDestroy","./accessorSupport/get","./accessorSupport/Lifecycle","./accessorSupport/metadata","./accessorSupport/Properties","./accessorSupport/set","./accessorSupport/testSupport","./accessorSupport/watch","./accessorSupport/decorators/property","./accessorSupport/decorators/subclass"],function(e,t,r,s,c,o,i,a,n,_,l,h,u,p){"use strict";var d,y;function f(e){if(null==e)return{value:e};if(Array.isArray(e))return{type:[e[0]],value:null};switch(typeof e){case"object":return e.constructor?.__accessorMetadata__||e instanceof Date?{type:e.constructor,value:e}:e;case"boolean":return{type:Boolean,value:e};case"string":return{type:String,value:e};case"number":return{type:Number,value:e};case"function":return{type:e,value:null};default:return}}const v=Symbol("Accessor-Handles"),g=Symbol("Accessor-Initialized");class b{static{d=v,y=g}static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:t,declaredClass:r,constructor:s}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const c=this;class o extends c{constructor(...e){super(...e),this.inherited=null,s&&s.apply(this,e)}}a.getPropertiesMetadata(o.prototype);for(const t in e){const r=e[t];o.prototype[t]="function"==typeof r?function(...e){const s=this.inherited;let o;this.inherited=function(...e){if(c.prototype[t])return c.prototype[t].apply(this,e)};try{o=r.apply(this,e)}catch(e){throw this.inherited=s,e}return this.inherited=s,o}:e[t]}for(const e in t){const r=f(t[e]);u.property(r)(o.prototype,e)}return p.subclass(r)(o)}static freeze(e){return e instanceof b?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof b?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){if(this[d]=null,this[y]=!1,this.constructor===b)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const t=new n(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:t}),e.length>0&&(t.ctorArgs=this.normalizeCtorArgs?.apply(this,e)??e[0]),l.getAccessorInterceptor()?.onInstanceConstruct(this)}postscript(){const e=this.__accessor__,t=e.ctorArgs;e.initialize(),t&&(this.set(t),e.ctorArgs=null),e.constructed(),this.initialize(),this[g]=!0}initialize(){}[c.beforeDestroySymbol](){this[v]=s.destroyMaybe(this[v])}destroy(){this.destroyed||(h.removeTarget(this),this.__accessor__.destroy(),l.getAccessorInterceptor()?.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[g]}get destroyed(){return this.__accessor__?.lifecycle===i.Lifecycle.DESTROYED||!1}get destroying(){return this.__accessor__?.lifecycle===i.Lifecycle.DESTROYING||!1}commitProperty(e){o.get(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,t){return _.set(this,e,t),this}watch(t,s,c){return e.deprecatedFunction(r.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://arcg.is/1vaqf42#watch",warnOnce:!0}),h.watch(this,t,s,c)}addHandles(e,r){if(this.destroyed){const t=Array.isArray(e)?e:[e];for(const e of t)e.remove();return}(this[v]??=new t).add(e,r)}removeHandles(e){this[v]?.remove(e)}removeAllHandles(){this[v]?.removeAll()}removeHandlesReference(e){this[v]?.removeReference(e)}hasHandles(e){return!0===this[v]?.has(e)}_override(e,t){void 0===t?this.__accessor__.clearOverride(e):this.__accessor__.override(e,t)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,t){null==t?this.__accessor__.clearOverride(e):this.__accessor__.override(e,t)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,t){return this.__accessor__.internalSet(e,t),this}}return b});