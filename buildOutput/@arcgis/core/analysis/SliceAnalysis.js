/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import s from"./Analysis.js";import r from"./SlicePlane.js";import{JSONSupport as t}from"../core/JSONSupport.js";import{property as o}from"../core/accessorSupport/decorators/property.js";import{equalsShallow as i}from"../core/lang.js";import"../chunks/Logger.js";import{subclass as l}from"../core/accessorSupport/decorators/subclass.js";import a from"../core/Collection.js";import{c as p,r as n}from"../chunks/collectionUtils.js";import{e as c}from"../chunks/maybe.js";import{r as u}from"../chunks/reader.js";import{w as d}from"../chunks/writer.js";import"./support/AnalysisOriginWebScene.js";import"../core/Clonable.js";import"../core/Accessor.js";import"../core/Handles.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/Lifecycle.js";import"../chunks/metadata.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/promiseUtils.js";import"../core/Error.js";import"../chunks/object.js";import"../config.js";import"../chunks/string.js";import"../chunks/events.js";import"../chunks/SetUtils.js";import"../chunks/SimpleTrackingTarget.js";import"../chunks/ensureType.js";import"../chunks/MapUtils.js";import"../chunks/Warning.js";import"../core/Identifiable.js";import"../chunks/Cyclical.js";import"../chunks/mathUtils.js";import"../core/accessorSupport/decorators/cast.js";import"../geometry/Point.js";import"../geometry/Geometry.js";import"../geometry/SpatialReference.js";import"../chunks/unitUtils.js";import"../chunks/jsonMap.js";import"../chunks/pe.js";import"../chunks/assets.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/jsonUtils.js";import"../chunks/persistableUrlUtils.js";import"../geometry/support/webMercatorUtils.js";import"../core/Evented.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";let m=class extends t{constructor(e){super(e),this.layerId=""}static fromLayer(e){return new this({layerId:"building-component"===e.type?e.layer.id:e.id,sublayerId:"building-component"===e.type?e.id:void 0})}};e([o({type:String,json:{write:{isRequired:!0}}})],m.prototype,"layerId",void 0),e([o({type:Number,json:{write:!0}})],m.prototype,"sublayerId",void 0),m=e([l("esri.analysis.support.SliceAnalysisExcludedLayer")],m);let y=class extends s{constructor(e){super(e),this.type="slice",this.tiltEnabled=!1,this.shape=null,this.excludeGroundSurface=!1}get excludedLayers(){return this._get("excludedLayers")||new a}set excludedLayers(e){this._set("excludedLayers",n(e,this._get("excludedLayers")))}writeExcludedLayers(e,s,r,t){0!==e.length&&(s[r]=e.toArray().map(e=>m.fromLayer(e).toJSON(t)))}readExcludedLayers(e,s,r){const t=r?.initiator;t&&r?.hooks?.onAfterLoad(async()=>{for(const s of e){const{layerId:e,sublayerId:o}=m.fromJSON(s,r),i=t.allLayers.find(({id:s})=>s===e);if(i)if(null!=o&&"allSublayers"in i){await i.load();const e=i.allSublayers.find(({id:e})=>e===o);e&&"type"in e&&"building-component"===e.type&&this.excludedLayers.add(e)}else this.excludedLayers.add(i)}})}get valid(){return null!=this.shape?.position}equals(e){return this===e||super.equals(e)&&c(this.shape,e.shape)&&this.tiltEnabled===e.tiltEnabled&&i(this.excludedLayers.toArray(),e.excludedLayers.toArray())&&this.excludeGroundSurface===e.excludeGroundSurface}clear(){this.shape=null}};e([o({type:["slice"],json:{read:!1,write:{isRequired:!0}}})],y.prototype,"type",void 0),e([o({type:Boolean,nonNullable:!0,json:{write:!0,default:!1}})],y.prototype,"tiltEnabled",void 0),e([o({types:{key:"type",base:null,typeMap:{plane:r},defaultKeyValue:"plane"},json:{write:{isRequired:!0}}})],y.prototype,"shape",void 0),e([o({cast:p,clonable:e=>e.slice(),json:{type:[m],write:!0}})],y.prototype,"excludedLayers",null),e([d("excludedLayers")],y.prototype,"writeExcludedLayers",null),e([u("excludedLayers")],y.prototype,"readExcludedLayers",null),e([o({type:Boolean,nonNullable:!0,json:{write:!0}})],y.prototype,"excludeGroundSurface",void 0),e([o({readOnly:!0})],y.prototype,"valid",null),y=e([l("esri.analysis.SliceAnalysis")],y);const j=y;export{j as default};
