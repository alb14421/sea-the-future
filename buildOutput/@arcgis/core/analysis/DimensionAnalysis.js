/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as s}from"../chunks/tslib.es6.js";import t from"./Analysis.js";import e from"./DimensionSimpleStyle.js";import o from"./LengthDimension.js";import{e as r}from"../core/lang.js";import i from"../core/Collection.js";import{r as n,c as p}from"../chunks/collectionUtils.js";import{watch as l,syncAndInitial as m}from"../core/reactiveUtils.js";import{property as c}from"../core/accessorSupport/decorators/property.js";import"../chunks/Logger.js";import{subclass as u}from"../core/accessorSupport/decorators/subclass.js";import a from"../geometry/Extent.js";import{projectOrLoadMany as j}from"../chunks/projectionUtils.js";import"./support/AnalysisOriginWebScene.js";import"../core/Clonable.js";import"../core/Accessor.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/Lifecycle.js";import"../chunks/metadata.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/promiseUtils.js";import"../core/Error.js";import"../chunks/object.js";import"../chunks/events.js";import"../chunks/SetUtils.js";import"../chunks/SimpleTrackingTarget.js";import"../chunks/ensureType.js";import"../chunks/MapUtils.js";import"../config.js";import"../chunks/string.js";import"../chunks/Warning.js";import"../core/Identifiable.js";import"../core/JSONSupport.js";import"../Color.js";import"../chunks/colorUtils.js";import"../chunks/mathUtils.js";import"../chunks/screenUtils.js";import"../chunks/Cyclical.js";import"../core/accessorSupport/decorators/cast.js";import"../geometry/Point.js";import"../chunks/reader.js";import"../chunks/writer.js";import"../geometry/Geometry.js";import"../geometry/SpatialReference.js";import"../chunks/unitUtils.js";import"../chunks/jsonMap.js";import"../chunks/pe.js";import"../chunks/assets.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/jsonUtils.js";import"../chunks/persistableUrlUtils.js";import"../geometry/support/webMercatorUtils.js";import"../core/Evented.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../chunks/vec3f64.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/coordsUtils.js";import"../chunks/extentUtils.js";import"../chunks/boundsUtils.js";import"../chunks/aaBoundingRect.js";import"../geometry/Polyline.js";import"../chunks/projectBuffer.js";import"../chunks/geodesicConstants.js";import"../chunks/projectXYZToVector.js";import"../geometry/support/GeographicTransformation.js";import"../geometry/support/GeographicTransformationStep.js";import"../chunks/zscale.js";const h=i.ofType(o);let d=class extends t{constructor(s){super(s),this.type="dimension",this.style=new e,this.extent=null}initialize(){this.addHandles(l(()=>this._computeExtent(),s=>{null==s?.pending&&this._set("extent",null!=s?s.extent:null)},m))}get dimensions(){return this._get("dimensions")||new h}set dimensions(s){this._set("dimensions",n(s,this.dimensions,h))}get spatialReference(){for(const s of this.dimensions){if(null!=s.startPoint)return s.startPoint.spatialReference;if(null!=s.endPoint)return s.endPoint.spatialReference}return null}get valid(){return this.dimensions.every(s=>s.valid)}async waitComputeExtent(){const s=this._computeExtent();return null!=s?s.pending:Promise.resolve()}_computeExtent(){const s=this.spatialReference;if(null==s)return{pending:null,extent:null};const t=[];for(const s of this.dimensions)null!=s.startPoint&&t.push(s.startPoint),null!=s.endPoint&&t.push(s.endPoint);const e=j(t,s);if(null!=e.pending)return{pending:e.pending,extent:null};let o=null;return null!=e.geometries&&(o=e.geometries.reduce((s,t)=>null==s?null!=t?a.fromPoint(t):null:null!=t?s.union(a.fromPoint(t)):s,null)),{pending:null,extent:o}}clear(){this.dimensions.removeAll()}equals(s){return this===s||super.equals(s)&&this.style.equals(s.style)&&r(this.dimensions.toArray(),s.dimensions.toArray(),(s,t)=>s.equals(t))}};s([c({type:["dimension"]})],d.prototype,"type",void 0),s([c({cast:p,type:h,nonNullable:!0})],d.prototype,"dimensions",null),s([c({readOnly:!0})],d.prototype,"spatialReference",null),s([c({types:{key:"type",base:null,typeMap:{simple:e}},nonNullable:!0})],d.prototype,"style",void 0),s([c({value:null,readOnly:!0})],d.prototype,"extent",void 0),s([c({readOnly:!0})],d.prototype,"valid",null),d=s([u("esri.analysis.DimensionAnalysis")],d);export{d as default};
