/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import"./index.js";import"./index35.js";import"./index28.js";import"./index6.js";import"./index50.js";import{L as e,c as t,s as i,E as s,x as o,B as l,i as a,a as n}from"./componentsUtils.js";import{e as r,n as c}from"./ref.js";import{n as d}from"./locale2.js";import{u as h}from"./useT9n.js";import{i as p}from"./component.js";import"./dom.js";import"./guid.js";import"./observers.js";import"./logger2.js";import"./interactive.js";import"./key.js";import"./static.js";import"./form.js";import"./label.js";import"./keyed.js";import"./directive-helpers.js";import"./responsive.js";import"./global.js";import"./assets.js";import"../config.js";import"../core/lang.js";import"./object.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/Error.js";import"./Logger.js";import"./string.js";import"./jsonUtils.js";import"./MapUtils.js";import"../core/promiseUtils.js";import"./handleUtils.js";import"./events.js";import"./maybe.js";import"./persistableUrlUtils.js";
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.2.1 */const m="bordered",b="striped",u="table-container",g="table--fixed",f=a`@charset "UTF-8";:host([scale=s]){--calcite-internal-table-cell-padding: .25rem;--calcite-internal-table-cell-font-size: var(--calcite-font-size--2);--calcite-internal-table-cell-font-size-secondary: var(--calcite-font-size--3)}:host([scale=m]){--calcite-internal-table-cell-padding: .5rem;--calcite-internal-table-cell-font-size: var(--calcite-font-size--1);--calcite-internal-table-cell-font-size-secondary: var(--calcite-font-size--2)}:host([scale=l]){--calcite-internal-table-cell-padding: 1rem;--calcite-internal-table-cell-font-size: var(--calcite-font-size-0);--calcite-internal-table-cell-font-size-secondary: var(--calcite-font-size--1)}:host{display:flex}.container{display:flex;block-size:100%;inline-size:100%;flex-direction:column}.table-container{overflow:auto;white-space:nowrap;border:1px solid var(--calcite-color-border-3)}.assistive-text{position:absolute;inline-size:1px;block-size:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}table{inline-size:100%;border-collapse:collapse;overflow-x:scroll}@-moz-document url-prefix(){table{border-collapse:separate;border-spacing:0}}.table--fixed{table-layout:fixed}.bordered ::slotted(calcite-table-row){--calcite-table-row-border-color: var(--calcite-color-border-3)}.striped ::slotted(calcite-table-row:nth-child(2n+1)){--calcite-table-row-background: var(--calcite-color-foreground-2)}.selection-actions{display:flex;flex-direction:row;margin-inline-start:auto}.selection-area{display:flex;flex-direction:row;align-items:center;padding-block:var(--calcite-internal-table-cell-padding)}.selection-area calcite-chip:last-of-type{margin-inline-end:.5rem}.selection-area calcite-chip:last-of-type:not(:first-of-type){margin-inline-start:.5rem}.selection-area calcite-button{margin-inline-end:1rem}.pagination-area{display:flex;inline-size:100%;flex-direction:row;justify-content:center;padding-block:var(--calcite-internal-table-cell-padding)}calcite-pagination{flex:1;justify-content:center}:host([hidden]){display:none}[hidden]{display:none}`;class w extends e{constructor(){super(),this.paginationEl=r(),this.tableBodySlotEl=r(),this.tableFootSlotEl=r(),this.tableHeadSlotEl=r(),this.messages=h({blocking:!0}),this.colCount=0,this.pageStartRow=1,this.selectedCount=0,this._selectedItems=[],this.bordered=!1,this.groupSeparator=!1,this.interactionMode="interactive",this.layout="auto",this.numbered=!1,this.pageSize=0,this.scale="m",this.selectionDisplay="top",this.selectionMode="none",this.striped=!1,this.calciteInternalTableRowFocusChange=t({cancelable:!1}),this.calciteTablePageChange=t({cancelable:!1}),this.calciteTableSelect=t({cancelable:!1}),this.listen("calciteTableRowSelect",this.calciteTableRowSelectListener),this.listen("calciteInternalTableRowSelect",this.calciteInternalTableRowSelectListener),this.listen("calciteInternalTableRowFocusRequest",this.calciteInternalTableRowFocusEvent)}static{this.properties={colCount:[16,{},{state:!0}],pageStartRow:[16,{},{state:!0}],readCellContentsToAT:[16,{},{state:!0}],selectedCount:[16,{},{state:!0}],_selectedItems:[16,{},{state:!0}],bordered:[7,{},{reflect:!0,type:Boolean}],caption:1,groupSeparator:[7,{},{reflect:!0,type:Boolean}],interactionMode:[3,{},{reflect:!0}],layout:[3,{},{reflect:!0}],messageOverrides:[0,{},{attribute:!1}],numbered:[7,{},{reflect:!0,type:Boolean}],numberingSystem:[3,{},{reflect:!0}],pageSize:[11,{},{reflect:!0,type:Number}],scale:[3,{},{reflect:!0}],selectedItems:[32,{},{attribute:!1,readOnly:!0}],selectionDisplay:[3,{},{reflect:!0}],selectionMode:[3,{},{reflect:!0}],striped:[7,{},{reflect:!0,type:Boolean}]}}static{this.styles=f}get selectedItems(){return this._selectedItems}async load(){this.readCellContentsToAT=/safari/i.test(function(){const e=navigator.userAgentData;return e?.brands?e.brands.map(({brand:e,version:t})=>`${e}/${t}`).join(" "):navigator.userAgent}()),this.listenOn(this.el.shadowRoot,"slotchange",this.handleSlotChange)}willUpdate(e){(e.has("groupSeparator")&&(this.hasUpdated||!1!==this.groupSeparator)||e.has("interactionMode")&&(this.hasUpdated||"interactive"!==this.interactionMode)||e.has("numbered")&&(this.hasUpdated||!1!==this.numbered)||e.has("numberingSystem")||e.has("pageSize")&&(this.hasUpdated||0!==this.pageSize)||e.has("scale")&&(this.hasUpdated||"m"!==this.scale)||e.has("selectionMode")&&(this.hasUpdated||"none"!==this.selectionMode))&&this.updateRows()}handleSlotChange(){this.updateRows()}calciteTableRowSelectListener(e){e.composedPath().includes(this.el)&&this.setSelectedItems(e.target)}calciteInternalTableRowSelectListener(e){e.composedPath().includes(this.el)&&(this.updateSelectedItems(!1),e.stopPropagation())}calciteInternalTableRowFocusEvent(e){const t=e.detail.cellPosition,i=e.detail.rowPosition,s=e.detail.destination,o=e.detail.lastCell,l=this.bodyRows?.filter(e=>!p(e)),a=this.allRows?.filter(e=>!p(e)),n=this.headRows[this.headRows.length-1]?.positionAll,r=l[0]?.positionAll,c=l[l.length-1]?.positionAll,d=this.footRows[0]?.positionAll,h=a[a.length-1]?.positionAll,m="next"===s&&i===n,b="previous"===s&&i===d,u="previous"===s&&i===r,g="next"===s&&i===c;let f;switch(s){case"first":f=0;break;case"last":f=h;break;case"next":f=m?r:g?d:i+1;break;case"previous":f=b?c:u?n:i-1}const w=this.allRows?.find(e=>e.positionAll===f)?.cellCount,S=t>w?w:t;void 0!==f&&this.calciteInternalTableRowFocusChange.emit({cellPosition:S,rowPosition:f,destination:s,lastCell:o})}getSlottedRows(e){return e?.assignedElements({flatten:!0})?.filter(e=>e?.matches("calcite-table-row"))}updateRows(){const e=this.getSlottedRows(this.tableHeadSlotEl.value)||[],t=this.getSlottedRows(this.tableBodySlotEl.value)||[],i=this.getSlottedRows(this.tableFootSlotEl.value)||[],s=[...e,...t,...i];e?.forEach(t=>{const i=e?.indexOf(t);t.rowType="head",t.positionSection=i,t.positionSectionLocalized=this.localizeNumber((i+1).toString())}),t?.forEach(e=>{const i=t?.indexOf(e);e.rowType="body",e.positionSection=i,e.positionSectionLocalized=this.localizeNumber((i+1).toString())}),i?.forEach(e=>{const t=i?.indexOf(e);e.rowType="foot",e.positionSection=t,e.positionSectionLocalized=this.localizeNumber((t+1).toString())}),s?.forEach(e=>{e.interactionMode=this.interactionMode,e.selectionMode=this.selectionMode,e.bodyRowCount=t?.length,e.positionAll=s?.indexOf(e),e.numbered=this.numbered,e.scale=this.scale,e.readCellContentsToAT=this.readCellContentsToAT,e.lastVisibleRow=s?.indexOf(e)===s.length-1});const o=e[0]?.cellCount||e[0]?.querySelectorAll("calcite-table-header")?.length;this.colCount=o,this.headRows=e,this.bodyRows=t,this.footRows=i,this.allRows=s,this.updateSelectedItems(),this.paginateRows()}handlePaginationChange(){const e=this.paginationEl.value?.startItem;this.pageStartRow=e||1,this.calciteTablePageChange.emit(),this.updateRows()}paginateRows(){this.bodyRows?.forEach(e=>{const t=e.positionSection+1,i=t>=this.pageStartRow&&t<this.pageStartRow+this.pageSize;e.itemHidden=this.pageSize>0&&!i&&!this.footRows.includes(e),e.lastVisibleRow=t===this.pageStartRow+this.pageSize-1||t===this.bodyRows.length})}async updateSelectedItems(e){const t=this.bodyRows?.filter(e=>e.selected);this._selectedItems=t,this.selectedCount=t?.length,this.allRows?.forEach(e=>{e.selectedRowCount=this.selectedCount,e.selectedRowCountLocalized=this.localizeNumber(this.selectedCount)}),e&&this.calciteTableSelect.emit()}handleDeselectAllRows(){this.bodyRows?.forEach(e=>{e.selected=!1}),this.updateSelectedItems(!0)}setSelectedItems(e){this.bodyRows?.forEach(t=>{t.selected="head"===e?.rowType?this.selectedCount!==this.bodyRows?.length:("multiple"===this.selectionMode||e===t)&&t.selected}),this.updateSelectedItems(!0)}localizeNumber(e){return d.numberFormatOptions={locale:this.messages._lang,numberingSystem:this.numberingSystem,useGrouping:this.groupSeparator},d.localize(e.toString())}renderSelectionArea(){const e=this._selectedItems?.filter(e=>p(e))?.length,t=this.localizeNumber(e?.toString()),l=`${this.localizeNumber(this.selectedCount?.toString())} ${this.messages.selected}`,a=`${t} ${this.messages.hiddenSelected}`;return o`<div class=${i("selection-area")}><calcite-chip .kind=${this.selectedCount>0?"brand":"neutral"} .label=${l} .scale=${this.scale} .value=${l}>${l}</calcite-chip>${e>0&&o`<calcite-chip icon=hide-empty .label=${a} .scale=${this.scale} title=${a??s} .value=${a}>${t}</calcite-chip>`||""}${this.selectedCount>0&&o`<calcite-button icon-start=x kind=neutral @click=${this.handleDeselectAllRows} round .scale=${this.scale} .title=${`${this.messages.clear} ${l} ${this.messages.row}`}>${this.messages.clear}</calcite-button>`||""}<div class=${i("selection-actions")}><slot name=${"selection-actions"}></slot></div></div>`}renderPaginationArea(){return o`<div class=${i("pagination-area")}><calcite-pagination .groupSeparator=${this.groupSeparator} .numberingSystem=${this.numberingSystem} @calcitePaginationChange=${this.handlePaginationChange} .pageSize=${this.pageSize} .scale=${this.scale} start-item=1 .totalItems=${this.bodyRows?.length} ${c(this.paginationEl)}></calcite-pagination></div>`}renderTHead(){return o`<thead><slot name=${"table-header"} ${c(this.tableHeadSlotEl)}></slot></thead>`}renderTBody(){return o`<tbody><slot ${c(this.tableBodySlotEl)}></slot></tbody>`}renderTFoot(){return o`<tfoot><slot name=${"table-footer"} ${c(this.tableFootSlotEl)}></slot></tfoot>`}render(){return o`<div class=${i("container")}>${"none"!==this.selectionMode&&"none"!==this.selectionDisplay&&this.renderSelectionArea()||""}<div class=${i({[m]:this.bordered,[b]:this.striped,[u]:!0})}><table .ariaColCount=${this.colCount} .ariaMultiSelectable=${"multiple"===this.selectionMode?"true":null} .ariaRowCount=${this.allRows?.length} class=${i({[g]:"fixed"===this.layout})} .role=${"interactive"===this.interactionMode?"grid":"table"} ${c(e=>{e&&l(o`<caption class=${i("assistive-text")}>${this.caption}</caption>${this.renderTHead()}${this.renderTBody()}${this.renderTFoot()}`,e)})}></table></div>${this.pageSize>0&&this.renderPaginationArea()||""}</div>`}}n("calcite-table",w);export{w as Table};
