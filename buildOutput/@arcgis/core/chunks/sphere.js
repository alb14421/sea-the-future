/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import"../core/lang.js";import"./Logger.js";import{h as t,g as n}from"./mathUtils.js";import{a as r}from"./mat4.js";import{l as s,k as o,u as e,j as i,i as a,x as c,c as u,t as f,h as m,w as l,n as h,m as g,a as p}from"./vec3.js";import{c as M}from"./vec3f64.js";import{e as d,c as j}from"./vec4.js";import{c as v,f as S}from"./vec4f64.js";import{g as b}from"./common.js";import{f as y,e as q}from"./ray.js";import{s as x,e as P,f as R}from"./vector.js";function A(n,r){const e=s(n),i=t(n[2]/e),a=Math.atan2(n[1]/e,n[0]/e);return o(r,e,i,a),r}const w=C();function C(){return v()}const _=d,E=d;function O(t,n){return j(n,t)}function T(t,n){return S(t[0],t[1],t[2],n)}function k(t){return t}function L(t,n){return t[0]=t[1]=t[2]=0,t[3]=n,t}function N(t){return t[3]}function z(t){return t}function F(t,n,r,s){return S(t,n,r,s)}function I(t,n,r){if(null==n)return!1;if(!B(t,n,V))return!1;let{t0:s,t1:o}=V;if((s<0||o<s&&o>0)&&(s=o),s<0)return!1;if(r){const{origin:t,direction:o}=n;r[0]=t[0]+o[0]*s,r[1]=t[1]+o[1]*s,r[2]=t[2]+o[2]*s}return!0}function U(t,n,r){const s=y(n,r);if(!B(t,s,V))return[];const{origin:o,direction:e}=s,{t0:i,t1:a}=V,c=n=>{const r=M();return p(r,o,e,n),K(t,r,r)};return Math.abs(i-a)<b()?[c(i)]:[c(i),c(a)]}const V={t0:0,t1:0};function B(t,n,r){const{origin:s,direction:o}=n,e=D;e[0]=s[0]-t[0],e[1]=s[1]-t[1],e[2]=s[2]-t[2];const i=o[0]*o[0]+o[1]*o[1]+o[2]*o[2];if(0===i)return!1;const a=2*(o[0]*e[0]+o[1]*e[1]+o[2]*e[2]),c=a*a-4*i*(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]-t[3]*t[3]);if(c<0)return!1;const u=Math.sqrt(c);return r.t0=(-a-u)/(2*i),r.t1=(-a+u)/(2*i),!0}const D=M();function G(t,n){return I(t,n,null)}function H(t,n,o){const e=x.get(),i=P.get();u(e,n.origin,n.direction);const c=N(t);u(o,e,n.origin),a(o,o,1/s(o)*c);const m=W(t,n.origin),l=R(n.origin,o);return r(i,l+m,e),f(o,o,i),o}function J(t,n,r,s){const o=N(t),e=o*o,i=n+.5*Math.PI,a=r*r+e-2*Math.cos(i)*r*o,c=Math.sqrt(a),u=a-e;if(u<=0)return.5;const f=Math.sqrt(u),m=Math.acos(f/c)-Math.asin(o/(c/Math.sin(i)));return Math.min(1,(m+.5*s)/s)}function K(t,n,r){const o=m(x.get(),n,t),e=a(x.get(),o,t[3]/s(o));return i(r,e,t)}function Q(t,n){const r=m(x.get(),n,t),s=l(r),o=t[3]*t[3];return Math.sqrt(Math.abs(s-o))}function W(t,r){const o=m(x.get(),r,t),e=s(o),i=N(t),a=i+Math.abs(i-e);return n(i/a)}const X=M();function Y(t,n,r,s){const e=m(X,n,t);switch(r){case 0:{const t=A(e,X)[2];return o(s,-Math.sin(t),Math.cos(t),0)}case 1:{const t=A(e,X),n=t[1],r=t[2],i=Math.sin(n);return o(s,-i*Math.cos(r),-i*Math.sin(r),Math.cos(n))}case 2:return h(s,e);default:return}}function Z(t,n){const r=m(nt,n,t);return s(r)-t[3]}function $(t,n){const r=e(t,n),s=N(t);return r<=s*s}function tt(t,n,r=v()){const s=c(t,n),o=t[3],e=n[3];return s+e<o?(j(r,t),r):s+o<e?(j(r,n),r):(g(r,t,n,(s+e-o)/(2*s)),r[3]=(s+o+e)/2,r)}const nt=M(),rt=C(),st=Object.freeze(Object.defineProperty({__proto__:null,NullSphere:w,altitudeAt:Z,angleToSilhouette:W,axisAt:Y,cameraFrustumCoverage:J,clear:function(t){t[0]=t[1]=t[2]=t[3]=0},closestPoint:function(t,n,r){return I(t,n,r)?r:(q(n,t,r),K(t,r,r))},closestPointOnSilhouette:H,containsPoint:$,copy:O,create:C,distanceToSilhouette:Q,elevate:function(t,n,r){return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2]),r[3]=t[3]+n,r},equals:E,exactEquals:_,fromCenterAndRadius:T,fromRadius:L,fromValues:F,getCenter:z,getExtent:function(t,n){return n},getRadius:N,intersectLine:U,intersectRay:I,intersectRayClosestSilhouette:function(t,n,r){if(I(t,n,r))return r;const o=H(t,n,x.get());return i(r,n.origin,a(x.get(),n.direction,c(n.origin,o)/s(n.direction))),r},intersectsRay:G,projectPoint:K,setAltitudeAt:function(t,n,r,s){const o=Z(t,n),e=Y(t,n,2,nt),c=a(nt,e,r-o);return i(s,n,c)},setExtent:function(t,n,r){return t!==r&&O(t,r),r},tmpSphere:rt,union:tt,wrap:k},Symbol.toStringTag,{value:"Module"}));export{w as N,N as a,C as b,O as c,$ as d,U as e,F as f,z as g,T as h,G as i,_ as j,L as k,I as l,J as m,H as n,Q as o,K as p,st as s,rt as t,tt as u,k as w};
