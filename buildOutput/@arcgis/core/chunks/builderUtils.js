/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import e from"../core/Error.js";import{E as t,m as s}from"./unitUtils.js";import{c as o,e as r,d as n}from"./templateUtils2.js";import{c as a}from"./createTemplateExecutor.js";import{createPresetServiceEdit as i}from"./createPresetServiceEdit.js";import l from"../geometry/Polygon.js";import{isPoint as u,isPolygon as c}from"../geometry/support/jsonUtils.js";function f({edits:t,mode:s,relationships:l,shape:c,templatePart:f},p=""){if(null===f)return;const{template:m}=f;if(!o(m))throw new e("shared-template:template-not-loaded","A template part's template must be loaded before use");if(r(m)){if(!u(c))throw new e("shared-template:invalid-geometry","Preset templates must have a point geometry");i({geometry:c,template:m,edits:t,relationships:l,rotation:0,mode:s,tag:p})}else n(m)&&a({geometry:c,template:m,edits:t,relationships:l,tag:p})}function p(e,t){if(!e||!c(e))return null;if(!t.hasZ&&!t.hasM)return e;let s=null,o=null;const r=t.hasZ&&t.hasM?3:2;switch(t.type){case"point":s=t.hasZ?t.z:null,o=t.hasM?t.m:null;break;case"polygon":case"polyline":{const e="polygon"===t.type?t.rings:t.paths;for(const n of e)for(const e of n)t.hasZ&&(null===s||e[2]>s)&&(s=e[2]),t.hasM&&(null===o||e[r]>o)&&(o=e[r])}break;case"multipoint":for(const e of t.points)t.hasZ&&(null===s||e[2]>s)&&(s=e[2]),t.hasM&&(null===o||e[r]>o)&&(o=e[r]);break;default:return e}const n=function(e,t,s,o,r){const n=[];for(const a of e)n.push(M(a,t,s,o,r));return n}(e.rings,t.hasZ,t.hasM,s,o);return new l({rings:n,spatialReference:e.spatialReference,hasZ:t.hasZ,hasM:t.hasM})}function m(e){let o=1;return(e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(o=t(e.spatialReference)/s(e.spatialReference)),o}function h(e){let t=!1;return void 0!==e.byNumber&&(t=!0===e.byNumber),t}function d(e){let t=0;return void 0!==e.count&&(t=e.count),t}function g(e,t){let s=0;return t?void 0!==e.proportional&&(s=e.proportional):void 0!==e.distanceValue&&(s=e.distanceValue),t&&(s/=100),s}function y(e){return!0===e.isProportional}function v(e){return!1!==e.createUnique}function b(e){let t=0;return void 0!==e.offsetDistance&&(t=e.offsetDistance),void 0!==e.side&&1===e.side&&(t*=-1),t}function j(e){return!0===e.vertexBeforeOffset}function M(e,t,s,o,r){const n=[];for(const a of e){const e=[a[0],a[1]];t&&(e[2]=o),s&&(e[t?3:2]=r),n.push(e)}return n}export{j as a,h as b,p as c,g as d,d as e,y as f,m as g,v as h,f as m,b as r};
