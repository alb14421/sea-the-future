/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../geometry/Multipoint.js";import"../geometry/Point.js";import"../geometry/Polygon.js";import"../geometry/Polyline.js";function t(t){return t?{originPosition:"upper-left"===t.originPosition?"upperLeft":"lower-left"===t.originPosition?"lowerLeft":t.originPosition,scale:t.tolerance?[t.tolerance,t.tolerance,1,1]:[1,1,1,1],translate:null!=t.extent?[t.extent.xmin,t.extent.ymax,t.extent.zmin??0,t.extent.mmin??0]:[0,0,0,0]}:null}function n(t){if(function(t){return"lowerLeft"===t.originPosition&&4===t.scale.length&&4===t.translate.length}(t))return t;const{originPosition:n,scale:e,translate:r}=t,o=e[0]??1,s=e[1]??1;return{originPosition:"lowerLeft",scale:[o,"lowerLeft"===n?s:-s,e[2]??1,e[3]??1],translate:[r[0]??0,r[1]??0,r[2]??0,r[3]??0]}}function e({scale:t,translate:n},e){return Math.round((e-n[0])/t[0])}function r({scale:t,translate:n},e){return Math.round((e-n[1])/t[1])}function o({scale:t,translate:n},e){return Math.round(((e??0)-n[2])/t[2])}function s({scale:t,translate:n},e){return e?Math.round((e-n[3])/t[3]):0}function l(t,n){return t&&n?c:t&&!n?i:!t&&n?a:u}const u=(t,n)=>{const o=[];if(!n.length)return null;const s=n[0];let l=e(t,s[0]),u=r(t,s[1]);o.push([l,u]);for(let s=1;s<n.length;s++){const[i,a]=n[s],c=e(t,i),h=r(t,a);c===l&&h===u||o.push([c-l,h-u]),l=c,u=h}return o},i=(t,n)=>{const s=[];if(!n.length)return null;const l=n[0];let u=e(t,l[0]),i=r(t,l[1]),a=o(t,l[2]);s.push([u,i,a]);for(let l=1;l<n.length;l++){const[c,h,f]=n[l],g=e(t,c),p=r(t,h),m=o(t,f);g===u&&p===i&&m===a||s.push([g-u,p-i,m]),u=g,i=p,a=m}return s},a=(t,n)=>{const o=[];if(!n.length)return null;const l=n[0];let u=e(t,l[0]),i=r(t,l[1]),a=s(t,l[2]);o.push([u,i,a]);for(let l=1;l<n.length;l++){const[c,h,f]=n[l],g=e(t,c),p=r(t,h),m=s(t,f);g===u&&p===i&&m===a||o.push([g-u,p-i,m]),u=g,i=p,a=m}return o},c=(t,n)=>{const l=[];if(!n.length)return null;const u=n[0];let i=e(t,u[0]),a=r(t,u[1]),c=o(t,u[2]),h=s(t,u[3]);l.push([i,a,c,h]);for(let u=1;u<n.length;u++){const[f,g,p,m]=n[u],y=e(t,f),M=r(t,g),w=o(t,p),P=s(t,m);y===i&&M===a&&w===c&&P===h||l.push([y-i,M-a,w,P]),i=y,a=M,c=w,h=P}return l};function h({scale:t,translate:n},e){return e*t[0]+n[0]}function f({scale:t,translate:n},e){return e*t[1]+n[1]}function g({scale:t,translate:n},e){return(e??0)*t[2]+n[2]}function p({scale:t,translate:n},e){return e?e*t[3]+n[3]:0}function m(t,n){return t&&n?P:t&&!n?M:!t&&n?w:y}const y=(t,n)=>{const e=new Array(n.length);if(!n.length)return e;const r=n[0];let o=h(t,r[0]),s=f(t,r[1]);e[0]=[o,s];const{scale:l,originPosition:u}=t,i=l[0],a="lowerLeft"===u?l[1]:-l[1];for(let t=1;t<n.length;t++){const[r,l]=n[t];o+=i*r,s+=a*l,e[t]=[o,s]}return e},M=(t,n)=>{const e=new Array(n.length);if(!n.length)return e;const r=n[0];let o=h(t,r[0]),s=f(t,r[1]);e[0]=[o,s,g(t,r[2])];const{scale:l,originPosition:u}=t,i=l[0],a="lowerLeft"===u?l[1]:-l[1];for(let r=1;r<n.length;r++){const[l,u,c]=n[r];o+=i*l,s+=a*u,e[r]=[o,s,g(t,c)]}return e},w=(t,n)=>{const e=new Array(n.length);if(!n.length)return e;const r=n[0];let o=h(t,r[0]),s=f(t,r[1]);e[0]=[o,s,p(t,r[2])];const{scale:l,originPosition:u}=t,i=l[0],a="lowerLeft"===u?l[1]:-l[1];for(let r=1;r<n.length;r++){const[l,u,c]=n[r];o+=i*l,s+=a*u,e[r]=[o,s,p(t,c)]}return e},P=(t,n)=>{const e=new Array(n.length);if(!n.length)return e;const r=n[0];let o=h(t,r[0]),s=f(t,r[1]);e[0]=[o,s,g(t,r[2]),p(t,r[3])];const{scale:l,originPosition:u}=t,i=l[0],a="lowerLeft"===u?l[1]:-l[1];for(let r=1;r<n.length;r++){const[l,u,c,h]=n[r];o+=i*l,s+=a*u,e[r]=[o,s,g(t,c),p(t,h)]}return e};function x(t,n,e){const r=new Array(e.length);for(let o=0;o<e.length;o++)r[o]=n(t,e[o]);return r}function Z(t,l,u){const i=n(t);return l.x=e(i,u.x),l.y=r(i,u.y),null!=u.z&&(l.z=o(i,u.z)),null!=u.m&&(l.m=s(i,u.m)),l}function L(t,e,r){const o=function(t,n,e,r){const o=[],s=l(e,r);for(let e=0;e<n.length;e++){const r=s(t,n[e]);r&&r.length>=3&&o.push(r)}return o.length?o:null}(n(t),r.rings,r.hasZ,r.hasM);return o?(e.rings=o,e.hasZ=r.hasZ??!1,e.hasM=r.hasM??!1,e):null}function z(t,e,r){const o=function(t,n,e,r){const o=[],s=l(e,r);for(let e=0;e<n.length;e++){const r=s(t,n[e]);r&&r.length>=2&&o.push(r)}return o.length?o:null}(n(t),r.paths,r.hasZ,r.hasM);return o?(e.paths=o,e.hasZ=r.hasZ??!1,e.hasM=r.hasM??!1,e):null}function j(t,e,r,o=r?.hasZ??!1,s=r?.hasM??!1){if(null!=r){const l=n(t);e.points=m(o,s)(l,r.points),e.hasZ=o,e.hasM=s}return e}function d(t,e,r,o=null!=r?.z,s=null!=r?.m){if(null==r)return e;const l=n(t);return e.x=h(l,r.x),e.y=f(l,r.y),o&&(e.z=g(l,r.z)),s&&(e.m=p(l,r.m)),e}function A(t,e,r,o=r?.hasZ??!1,s=r?.hasM??!1){if(null!=r){const l=n(t);e.rings=x(l,m(o,s),r.rings),e.hasZ=o,e.hasM=s}return e}function b(t,e,r,o=r?.hasZ??!1,s=r?.hasM??!1){if(null!=r){const l=n(t);e.paths=x(l,m(o,s),r.paths),e.hasZ=o,e.hasM=s}return e}export{z as a,Z as b,b as c,A as d,d as e,e as f,r as g,n,L as q,t,j as u};
