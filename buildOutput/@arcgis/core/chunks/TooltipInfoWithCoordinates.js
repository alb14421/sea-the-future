/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as t}from"./tslib.es6.js";import{z as e,t as i,d as a,a as o,e as s,f as n,g as r,b as l}from"./quantityUtils.js";import{property as u}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import"./Logger.js";import{subclass as c}from"../core/accessorSupport/decorators/subclass.js";import{g as p}from"../geometry/Point.js";import{m,s as h,f,b as d,c as g,d as v,e as y}from"../views/interactive/Tooltip.js";import k from"../core/Accessor.js";import{g as b}from"./uuid.js";import{d as I}from"./quantityFormatUtils.js";import{b as x,c as A}from"./angularMeasurementUtils.js";import{s as w}from"./geodesicMeasurementUtils.js";let L=class extends k{constructor(t){super(t),this.actual=null,this.lockable=!0,this.id=b(),this.inputValue=null,this.readOnly=!1,this.suffix=null,this.visible=!0,this.invalid=!1,this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(t){this.lockable&&this._set("committed",t)}get dirty(){return null!=this.inputValue}get locked(){return this.lockable&&null!=this.committed}onInput(t){this.inputValue=t,this.invalid=!1}onCommit(t,e,i){this.lockable?this._onCommitLockable(t,i):this._onCommitNonLockable(i),this.invalid&&"commit-and-exit"===t||i.onCommit(e,t)}_onCommitLockable(t,e){const{inputValue:i,locked:a}=this;a&&V(i)?this.unlock():("commit-and-exit"===t&&!a||null!=i)&&this._parseInputAndLock(e)}_onCommitNonLockable(t){const{inputValue:e}=this;V(e)?this.lockable?this.setActual(null):this.clearInputValue():null!=e&&this._parseInputAndSetActual(t)}applyValue(t){this.lockable?this.lock(t):this.setActual(t)}clearInputValue(){this.inputValue=null,this.invalid=!1}setActual(t){this.actual=t,this.clearInputValue()}lock(t){this.lockable&&(this.committed=t??this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(t){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(t))}getSuffix(t){const{suffix:e}=this;return"function"==typeof e?e(t):e}getFormattedValue(t){const{actual:e,committed:i,format:a}=this;return null!=i?a(i,t):null!=e?a(e,t):null}getRawDisplayValue(t){const{actual:e,committed:i,inputValue:a}=this;return null!=a?a:this.lockable&&null!=i?this.formatForInputMode(i,t):null!=e?this.formatForInputMode(e,t):null}_parseInputAndSetActual(t){const{inputValue:e}=this;if(null==e||V(e))return this.setActual(null);const i=this.parse(e,t);null!=i?this.setActual(i):this.invalid=!0}_parseInputAndLock(t){const{inputValue:e,actual:i}=this;if(V(e))return this.unlock();if(null==e)return this.lock(i);const a=this.parse(e,t);null!=a?this.lock(a):this.invalid=!0}};function V(t){return null!=t&&""===t.trim()}t([u()],L.prototype,"actual",void 0),t([u()],L.prototype,"committed",null),t([u()],L.prototype,"dirty",null),t([u()],L.prototype,"format",void 0),t([u()],L.prototype,"formatForInputMode",void 0),t([u()],L.prototype,"lockable",void 0),t([u()],L.prototype,"locked",null),t([u()],L.prototype,"id",void 0),t([u()],L.prototype,"inputValue",void 0),t([u()],L.prototype,"name",void 0),t([u()],L.prototype,"parse",void 0),t([u()],L.prototype,"readOnly",void 0),t([u()],L.prototype,"suffix",void 0),t([u()],L.prototype,"title",void 0),t([u()],L.prototype,"visible",void 0),t([u()],L.prototype,"invalid",void 0),t([u()],L.prototype,"unlockOnVertexPlacement",void 0),L=t([c("esri.views.interactive.tooltip.fields.TooltipField")],L);let F=class extends L{constructor(t){super(t),this.showAsZ=!1}normalizeCtorArgs(t){const o=t=>t.inputUnitInfos.verticalLength.unit;return{name:"elevation",actual:e,parse:m({createQuantity:(t,e)=>a(t,o(e))}),format:(t,e)=>e.formatters.verticalLength(t),formatForInputMode:(t,e)=>e.formatters.scalar(i(t,o(e))),suffix:t=>t.inputUnitInfos.verticalLength.abbreviation,title:t=>t.messages.sketch[this.showAsZ?"z":"elevation"],unlockOnVertexPlacement:!1,...t}}};t([u()],F.prototype,"showAsZ",void 0),F=t([c("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],F);let U=class extends L{constructor(t){super(t),this.precision=1}normalizeCtorArgs(t){return{name:"orientation",actual:null,parse:m({createQuantity:(t,e)=>o(t,(t=>t.inputUnitInfos.angle.unit)(e),"geographic"),sanitize:h}),format:t=>{const e=x(t);return I(e,"geographic",this.precision)},formatForInputMode:(t,e)=>{const i=x(t);return e.formatters.scalar(i)},suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.orientation,...t}}};t([u()],U.prototype,"precision",void 0),U=t([c("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],U);let _=class extends L{constructor(t){super(t),this.precision=null}normalizeCtorArgs(t){const e=t=>t.inputUnitInfos.length.unit;return{name:"size",actual:null,parse:m({createQuantity:(t,i)=>a(t,e(i))}),format:(t,e)=>e.formatters.length(t),formatForInputMode:(t,a)=>a.formatters.scalar(i(t,e(a))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.size,...t}}};function M(t){const e=t=>t.inputUnitInfos.angle.unit,a=t=>t.sketchOptions.values.effectiveDirectionMode;return new L({name:"direction",actual:r,parse:m({createQuantity:(t,i)=>o(t,e(i),"geographic"),sanitize:h}),format:(t,e)=>{const i=a(e),o=A(t,i);switch(i){case"absolute":return e.formatters.direction(o);case"relative":return e.formatters.directionRelative(o);case"relative-bilateral":return e.formatters.directionRelativeBilateral(o)}},formatForInputMode:(t,o)=>{const s=A(t,a(o));return o.formatters.scalar(i(s,e(o)))},suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>{const e=a(t),{absolute:i,relative:o}=t.messages.sketch.direction;switch(e){case"absolute":return i;case"relative":case"relative-bilateral":return o}},...t})}function j(t){const o=t=>t.inputUnitInfos.length.unit;return new L({name:"distance",actual:e,parse:m({createQuantity:(t,e)=>a(Math.max(t,0),o(e))}),format:(t,e)=>e.formatters.length(t),formatForInputMode:(t,e)=>e.formatters.scalar(i(t,o(e))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.distance,...t})}function z(t){return j({format:(t,e)=>e.formatters.totalLength(t),title:t=>t.messages.sketch.totalLength,readOnly:!0,...t})}function C(t){return j({...t})}function O(t){return j({...t,parse:m({createQuantity:(t,e)=>a(t,(t=>t.inputUnitInfos.length.unit)(e))}),format:(t,e)=>e.formatters.lengthRelative(t)})}function Q(t){return new U(t)}function T(t){return new _(t)}function D(t){return P("scale",{name:"scale",actual:null,parse:m({createQuantity:t=>s(Math.abs(t))}),...t})}function S(t){const e=t=>t.inputUnitInfos.area.unit;return new L({name:"area",actual:n,parse:m({createQuantity:(t,i)=>l(t,e(i))}),format:(t,e)=>e.formatters.area(t),formatForInputMode:(t,a)=>a.formatters.scalar(i(t,e(a))),suffix:t=>t.inputUnitInfos.area.abbreviation,title:t=>t.messages.sketch.area,readOnly:!0,...t})}function P(t,e){return new L({actual:s(0),parse:m({createQuantity:t=>s(t)}),format:(t,e)=>e.formatters.scalar(t),formatForInputMode:(t,e)=>e.formatters.scalar(t),title:e=>e.messages.sketch[t],...e})}t([u()],_.prototype,"precision",void 0),_=t([c("esri.views.interactive.tooltip.fields.TooltipFieldSize")],_);const R=e=>{const i=e;let a=class extends i{constructor(){super(...arguments),this.longitude=new L({name:"x",actual:r,parse:d,format:(t,e)=>e.formatters.longitudeDecimalDegrees(t),formatForInputMode:t=>f(t),suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.longitude}),this.latitude=new L({name:"y",actual:r,parse:v,format:(t,e)=>e.formatters.latitudeDecimalDegrees(t),formatForInputMode:t=>g(t),suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.latitude}),this.x=P("x",{name:"x"}),this.y=P("y",{name:"y"}),this.elevation=new F(void 0),this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(t,e=t?.spatialReference){if(this.geographic=!!e&&w(e),null==t)return this._setActualLonLat(null,null),void this._setActualXY(null,null);if(this.geographic){const e=p(t,X);this._setActualLonLat(y(e?.[0]),y(e?.[1]))}else this._setActualXY(s(t.x),s(t.y))}_setActualLonLat(t,e){this.longitude.actual=t,this.latitude.actual=e}_setActualXY(t,e){this.x.actual=t,this.y.actual=e}};return t([u()],a.prototype,"geographic",void 0),t([u()],a.prototype,"effectiveX",null),t([u()],a.prototype,"effectiveY",null),t([u()],a.prototype,"key",null),a=t([c("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],a),a},X=[0,0];export{R as T,z as a,Q as b,D as c,M as d,C as e,O as f,T as g,S as m};
