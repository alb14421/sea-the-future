/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import"./index28.js";import"./index22.js";import"./index.js";import{L as e,c as i,h as t,s as n,C as s,x as a,r as o,j as r,i as l,a as c}from"./componentsUtils.js";import{n as h}from"./ref.js";import{i as d}from"./keyed.js";import{u as p,i as m}from"./usePreventDocumentScroll.js";import{f as b,g as u,h as z,o as v}from"./dom.js";import{c as x}from"./component.js";import{c as f}from"./observers.js";import{o as g}from"./openCloseComponent.js";import{g as k}from"./dynamicClasses.js";import{c as w}from"./math.js";import{u as y}from"./useT9n.js";import{u as S}from"./useFocusTrap.js";import"./guid.js";import"./logger2.js";import"./assets.js";import"../config.js";import"../core/lang.js";import"./object.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/Error.js";import"./Logger.js";import"./string.js";import"./jsonUtils.js";import"./MapUtils.js";import"../core/promiseUtils.js";import"./handleUtils.js";import"./events.js";import"./maybe.js";import"./persistableUrlUtils.js";import"./directive-helpers.js";
/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.2.1 */const j="container",C="container--open",D="container--embedded",B=l`:host{position:absolute;inset:0;z-index:var(--calcite-z-index-overlay);display:flex;visibility:hidden!important;--calcite-sheet-scrim-background-internal: rgba(0, 0, 0, .85);--calcite-scrim-shadow-block-start-internal: 0 4px 8px -1px rgba(0, 0, 0, .08), 0 2px 4px -1px rgba(0, 0, 0, .04);--calcite-scrim-shadow-block-end-internal: 0 -4px 8px -1px rgba(0, 0, 0, .08), 0 -2px 4px -1px rgba(0, 0, 0, .04);--calcite-scrim-shadow-inline-start-internal: 4px 0 8px -1px rgba(0, 0, 0, .08), 2px 0 4px -1px rgba(0, 0, 0, .04);--calcite-scrim-shadow-inline-end-internal: -4px 0 8px -1px rgba(0, 0, 0, .08), -2px 0 4px -1px rgba(0, 0, 0, .04)}.calcite--rtl{--calcite-scrim-shadow-inline-start-internal: -4px 0 8px -1px rgba(0, 0, 0, .08), -2px 0 4px -1px rgba(0, 0, 0, .04);--calcite-scrim-shadow-inline-end-internal: 4px 0 8px -1px rgba(0, 0, 0, .08), 2px 0 4px -1px rgba(0, 0, 0, .04)}.assistive-text{position:absolute;inline-size:1px;block-size:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.container{visibility:hidden;position:fixed;z-index:var(--calcite-z-index-overlay);box-sizing:border-box;display:flex;opacity:0;color:var(--calcite-sheet-text-color, var(--calcite-color-text-2));transition:visibility 0ms linear var(--calcite-internal-animation-timing-medium),opacity var(--calcite-internal-animation-timing-medium) cubic-bezier(.215,.44,.42,.88)}:host([position=inline-start]) .container{justify-content:flex-start;inset-block:0;inset-inline:0 auto;--calcite-sheet-hidden-position-internal: translate3d(-1rem, 0, 0)}:host([position=inline-end]) .container{justify-content:flex-end;inset-block:0;inset-inline:auto 0;--calcite-sheet-hidden-position-internal: translate3d(1rem, 0, 0)}:host([position=block-start]) .container{align-items:flex-start;inset-block:0 auto;inset-inline:0;--calcite-sheet-hidden-position-internal: translate3d(0, -1rem, 0)}:host([position=block-end]) .container{align-items:flex-end;inset-block:auto 0;inset-inline:0;--calcite-sheet-hidden-position-internal: translate3d(0, 1rem, 0)}:host([display-mode=float]) .content{--tw-shadow: 0 2px 12px -4px rgba(0, 0, 0, .2), 0 2px 4px -2px rgba(0, 0, 0, .16);--tw-shadow-colored: 0 2px 12px -4px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--calcite-sheet-shadow, var(--tw-ring-offset-shadow, 0 0 rgba(0, 0, 0, 0)), var(--tw-ring-shadow, 0 0 rgba(0, 0, 0, 0)), var(--tw-shadow))}:host([display-mode=overlay][position=inline-start]) .container{box-shadow:var(--calcite-scrim-shadow-inline-start-internal)}:host([display-mode=overlay][position=inline-end]) .container{box-shadow:var(--calcite-scrim-shadow-inline-end-internal)}:host([display-mode=overlay][position=block-start]) .container{box-shadow:var(--calcite-scrim-shadow-block-start-internal)}:host([display-mode=overlay][position=block-end]) .container{box-shadow:var(--calcite-scrim-shadow-block-end-internal)}:host([position^=inline]) .content{inline-size:var(--calcite-sheet-width-internal);max-inline-size:var(--calcite-sheet-max-width-internal);min-inline-size:var(--calcite-sheet-min-width-internal)}:host([position^=block]) .content{block-size:var(--calcite-sheet-height-internal);max-block-size:var(--calcite-sheet-max-height-internal);min-block-size:var(--calcite-sheet-min-height-internal)}:host([position^=inline]) .width-s{--calcite-sheet-width-internal: var(--calcite-sheet-width, 15vw);--calcite-sheet-max-width-internal: var(--calcite-sheet-max-width, 360px);--calcite-sheet-min-width-internal: var(--calcite-sheet-min-width, 260px)}:host([position^=inline]) .width-m{--calcite-sheet-width-internal: var(--calcite-sheet-width, 25vw);--calcite-sheet-max-width-internal: var(--calcite-sheet-max-width, 420px);--calcite-sheet-min-width-internal: var(--calcite-sheet-min-width, 300px)}:host([position^=inline]) .width-l{--calcite-sheet-width-internal: var(--calcite-sheet-width, 45vw);--calcite-sheet-max-width-internal: var(--calcite-sheet-max-width, 680px);--calcite-sheet-min-width-internal: var(--calcite-sheet-min-width, 340px)}:host([position^=block]) .height-s{--calcite-sheet-min-height-internal: var(--calcite-sheet-min-height, 160px);--calcite-sheet-height-internal: var(--calcite-sheet-height, 30vh);--calcite-sheet-max-height-internal: var(--calcite-sheet-max-height, 30vh)}:host([position^=block]) .height-m{--calcite-sheet-min-height-internal: var(--calcite-sheet-min-height, 200px);--calcite-sheet-height-internal: var(--calcite-sheet-height, 45vh);--calcite-sheet-max-height-internal: var(--calcite-sheet-max-height, 50vh)}:host([position^=block]) .height-l{--calcite-sheet-min-height-internal: var(--calcite-sheet-min-height, 240px);--calcite-sheet-height-internal: var(--calcite-sheet-height, 60vh);--calcite-sheet-max-height-internal: var(--calcite-sheet-max-height, 70vh)}.scrim{--calcite-scrim-background: var(--calcite-sheet-scrim-background, var(--calcite-sheet-scrim-background-internal));position:fixed;inset:0;display:flex;overflow:hidden}:host([opened]){visibility:visible!important}.content{position:relative;z-index:var(--calcite-z-index-modal);box-sizing:border-box;display:flex;max-inline-size:100%;padding:0;background-color:var(--calcite-sheet-background-color, var(--calcite-color-foreground-1));max-block-size:100%;visibility:hidden;transition:transform var(--calcite-internal-animation-timing-medium) cubic-bezier(.215,.44,.42,.88),visibility 0ms linear var(--calcite-internal-animation-timing-medium),opacity var(--calcite-internal-animation-timing-medium) cubic-bezier(.215,.44,.42,.88);transform:var(--calcite-sheet-hidden-position-internal)}.content-container{position:relative;display:flex;max-block-size:100%;max-inline-size:100%;flex:1 1 0%;overflow:hidden}.container--open .content{transform:translateZ(0)}:host([display-mode=float]) .content,:host([display-mode=float]) .container,:host([display-mode=float]) .content-container{border-radius:var(--calcite-sheet-corner-radius, var(--calcite-corner-radius-round))}:host([display-mode=float]) .container{padding:var(--calcite-spacing-md)}.container--open{visibility:visible;opacity:1;transition-delay:0ms}.container--open .content{pointer-events:auto;visibility:visible;opacity:1;transition:transform var(--calcite-internal-animation-timing-medium) cubic-bezier(.215,.44,.42,.88),visibility 0ms linear,opacity var(--calcite-internal-animation-timing-medium) cubic-bezier(.215,.44,.42,.88),max-inline-size var(--calcite-internal-animation-timing-medium) cubic-bezier(.215,.44,.42,.88),max-block-size var(--calcite-internal-animation-timing-medium) cubic-bezier(.215,.44,.42,.88);transition-delay:0ms}:host([position=inline-start]) .content,:host([position=inline-end]) .content{block-size:100%}:host([position=inline-start]) .content{flex-direction:row}:host([position=inline-end]) .content{flex-direction:row-reverse}:host([position=block-start]) .content,:host([position=block-end]) .content{inline-size:100%}:host([position=block-start]) .content{flex-direction:column}:host([position=block-end]) .content{flex-direction:column-reverse}:host([resizable][position=inline-start]) .content{padding-inline-end:var(--calcite-size-fixed-sm-plus)}:host([resizable][position=inline-end]) .content{padding-inline-start:var(--calcite-size-fixed-sm-plus)}:host([resizable][position=block-start]) .content{padding-block-end:var(--calcite-size-fixed-sm-plus)}:host([resizable][position=block-end]) .content{padding-block-start:var(--calcite-size-fixed-sm-plus)}.resize-handle{position:absolute;box-sizing:border-box;display:flex;-webkit-user-select:none;user-select:none;align-items:center;justify-content:center;outline:2px solid transparent;outline-offset:2px;--calcite-internal-sheet-resize-handle-offset: calc( (var(--calcite-size-fixed-xxl) - var(--calcite-size-fixed-sm-plus)) / 2 * -1 );z-index:var(--calcite-z-index-header)}.resize-handle:active .resize-handle-bar,.resize-handle:hover .resize-handle-bar{color:var(--calcite-sheet-resize-icon-color, var(--calcite-color-text-1));background-color:var(--calcite-sheet-resize-background-color, var(--calcite-color-foreground-3))}.resize-handle-bar{pointer-events:none;display:flex;align-items:center;justify-content:center;color:var(--calcite-sheet-resize-icon-color, var(--calcite-color-border-input));background-color:var(--calcite-sheet-resize-background-color, var(--calcite-color-background))}.resize-handle:focus .resize-handle-bar{outline-color:transparent;outline:2px solid var(--calcite-color-focus, var(--calcite-ui-focus-color, var(--calcite-color-brand)))}:host([position=inline-start]) .resize-handle{inline-size:var(--calcite-size-fixed-xxl);inset-inline-end:var(--calcite-internal-sheet-resize-handle-offset);block-size:100%}:host([position=inline-start]) .resize-handle-bar{block-size:100%;inline-size:var(--calcite-size-fixed-sm-plus);border-inline-start:var(--calcite-border-width-sm) solid var(--calcite-sheet-border-color, var(--calcite-color-border-3))}:host([position=inline-start]):host([display-mode=float]) .resize-handle-bar{border-start-end-radius:var(--calcite-sheet-corner-radius, var(--calcite-corner-radius-round));border-end-end-radius:var(--calcite-sheet-corner-radius, var(--calcite-corner-radius-round))}:host([position=inline-end]) .resize-handle{inline-size:var(--calcite-size-fixed-xxl);inset-inline-start:var(--calcite-internal-sheet-resize-handle-offset);block-size:100%}:host([position=inline-end]) .resize-handle-bar{block-size:100%;inline-size:var(--calcite-size-fixed-sm-plus);border-inline-end:var(--calcite-border-width-sm) solid var(--calcite-sheet-border-color, var(--calcite-color-border-3))}:host([position=inline-end]):host([display-mode=float]) .resize-handle-bar{border-start-start-radius:.25rem;border-end-start-radius:.25rem}:host([position=block-start]) .resize-handle{block-size:var(--calcite-size-fixed-xxl);inline-size:100%;inset-block-end:var(--calcite-internal-sheet-resize-handle-offset)}:host([position=block-start]) .resize-handle-bar{inline-size:100%;block-size:var(--calcite-size-fixed-sm-plus);border-block-start:var(--calcite-border-width-sm) solid var(--calcite-sheet-border-color, var(--calcite-color-border-3))}:host([position=block-start]):host([display-mode=float]) .resize-handle-bar{border-end-end-radius:.25rem;border-end-start-radius:.25rem}:host([position=block-end]) .resize-handle{block-size:var(--calcite-size-fixed-xxl);inline-size:100%;inset-block-start:var(--calcite-internal-sheet-resize-handle-offset)}:host([position=block-end]) .resize-handle-bar{inline-size:100%;block-size:var(--calcite-size-fixed-sm-plus);border-block-end:var(--calcite-border-width-sm) solid var(--calcite-sheet-border-color, var(--calcite-color-border-3))}:host([position=block-end]):host([display-mode=float]) .resize-handle-bar{border-start-start-radius:var(--calcite-sheet-corner-radius, var(--calcite-corner-radius-round));border-start-end-radius:var(--calcite-sheet-corner-radius, var(--calcite-corner-radius-round))}:host([position]) .container--embedded{pointer-events:auto;position:absolute;inline-size:100%;max-inline-size:100%;min-inline-size:100%;block-size:100%;max-block-size:100%;min-block-size:100%}:host([position]) .container--embedded calcite-scrim{position:absolute}:host([hidden]){display:none}[hidden]{display:none}`;class O extends e{constructor(){super(),this.focusTrap=S({triggerProp:"open",focusTrapOptions:{clickOutsideDeactivates:()=>this.embedded,escapeDeactivates:e=>(e.defaultPrevented||this.escapeDisabled||(this.open=!1,e.preventDefault()),!1)}})(this),this.usePreventDocumentScroll=p()(this),this.ignoreOpenChange=!1,this.messages=y(),this.mutationObserver=f("mutation",()=>this.handleMutationObserver()),this._open=!1,this.openProp="opened",this.transitionProp="opacity",this.keyDownHandler=e=>{const{defaultPrevented:i,key:t}=e;!i&&!this.escapeDisabled&&this.focusTrapDisabled&&this.open&&"Escape"===t&&(e.preventDefault(),this.open=!1)},this.resizeValues={inlineSize:null,blockSize:null,minInlineSize:null,minBlockSize:null,maxInlineSize:null,maxBlockSize:null},this.displayMode="overlay",this.embedded=!1,this.escapeDisabled=!1,this.focusTrapDisabled=!1,this.heightScale="m",this.opened=!1,this.outsideCloseDisabled=!1,this.position="inline-start",this.resizable=!1,this.widthScale="m",this.calciteSheetBeforeClose=i({cancelable:!1}),this.calciteSheetBeforeOpen=i({cancelable:!1}),this.calciteSheetClose=i({cancelable:!1}),this.calciteSheetOpen=i({cancelable:!1}),this.listen("keydown",this.keyDownHandler)}static{this.properties={resizeValues:[16,{},{state:!0}],preventDocumentScroll:[16,{},{state:!0}],beforeClose:[0,{},{attribute:!1}],displayMode:[3,{},{reflect:!0}],embedded:[5,{},{type:Boolean}],escapeDisabled:[7,{},{reflect:!0,type:Boolean}],focusTrapDisabled:[7,{},{reflect:!0,type:Boolean}],focusTrapOptions:[0,{},{attribute:!1}],heightScale:[3,{},{reflect:!0}],height:[3,{},{reflect:!0}],label:1,messageOverrides:[0,{},{attribute:!1}],open:[7,{},{reflect:!0,type:Boolean}],opened:[7,{},{reflect:!0,type:Boolean}],outsideCloseDisabled:[7,{},{reflect:!0,type:Boolean}],position:[3,{},{reflect:!0}],resizable:[7,{},{reflect:!0,type:Boolean}],widthScale:[3,{},{reflect:!0}],width:[3,{},{reflect:!0}]}}static{this.styles=B}get preventDocumentScroll(){return!this.embedded}get open(){return this._open}set open(e){e!==this._open&&(this._open=e,this.toggleSheet(e))}async setFocus(){await x(this),b(this.el)}async updateFocusTrapElements(e){this.focusTrap.setExtraContainers(e),this.focusTrap.updateContainerElements()}connectedCallback(){super.connectedCallback(),this.mutationObserver?.observe(this.el,{childList:!0,subtree:!0}),this.setupInteractions()}load(){this.open&&this.openSheet()}willUpdate(e){e.has("opened")&&(this.hasUpdated||!1!==this.opened)&&g(this),(e.has("open")&&(this.hasUpdated||!1!==this.open)||e.has("position")&&(this.hasUpdated||"inline-start"!==this.position)||e.has("resizable")&&(this.hasUpdated||!1!==this.resizable))&&this.setupInteractions()}disconnectedCallback(){super.disconnectedCallback(),this.mutationObserver?.disconnect(),this.embedded=!1,this.cleanupInteractions()}toggleSheet(e){this.ignoreOpenChange||(e?this.openSheet():this.closeSheet())}getResizeIcon(){const{position:e}=this;return"block-start"===e||"block-end"===e?"drag-resize-vertical":"drag-resize-horizontal"}getContentElDOMRect(){return this.contentEl.getBoundingClientRect()}handleKeyDown(e){const{key:i,defaultPrevented:t,shiftKey:n}=e,{position:s,resizable:a,contentEl:l,el:c,resizeValues:{maxBlockSize:h,maxInlineSize:d,minBlockSize:p,minInlineSize:m}}=this,b=[..."block-end"===s||"block-start"===s?["ArrowUp","ArrowDown"]:["ArrowLeft","ArrowRight"],"Home","End"];if(!a||!l||t||!b.includes(i))return;const z=this.getContentElDOMRect(),v="rtl"===u(c)?-1:1,x=n?o:r;switch(i){case"ArrowUp":this.updateSize({size:z.height+("block-end"===s?x:-x),type:"blockSize"}),e.preventDefault();break;case"ArrowDown":this.updateSize({size:z.height+("block-end"===s?-x:x),type:"blockSize"}),e.preventDefault();break;case"ArrowLeft":this.updateSize({size:z.width+("inline-end"===s?x:-x)*v,type:"inlineSize"}),e.preventDefault();break;case"ArrowRight":this.updateSize({size:z.width+("inline-end"===s?-x:x)*v,type:"inlineSize"}),e.preventDefault();break;case"Home":this.updateSize({size:"block-start"===s||"block-end"===s?p:m,type:"block-start"===s||"block-end"===s?"blockSize":"inlineSize"}),e.preventDefault();break;case"End":this.updateSize({size:"block-start"===s||"block-end"===s?h:d,type:"block-start"===s||"block-end"===s?"blockSize":"inlineSize"}),e.preventDefault()}}updateSize({type:e,size:i}){const{contentEl:t,resizeValues:n}=this;if(!t)return;const s="blockSize"===e?"minBlockSize":"minInlineSize",a="blockSize"===e?"maxBlockSize":"maxInlineSize",o=n[s]&&n[a]?w(i,n[s],n[a]):i,r=Math.round(o);this.resizeValues={...n,[e]:r},t.style[e]=null!==i?`${r}px`:null}cleanupInteractions(){this.interaction?.unset(),this.updateSize({size:null,type:"inlineSize"}),this.updateSize({size:null,type:"blockSize"})}async setupInteractions(){this.cleanupInteractions();const{el:e,contentEl:i,resizable:t,position:n,open:s,resizeHandleEl:a}=this;if(!(i&&s&&t&&a))return;await this.el.componentOnReady();const{inlineSize:o,minInlineSize:r,blockSize:l,minBlockSize:c,maxInlineSize:h,maxBlockSize:d}=window.getComputedStyle(i),p={inlineSize:z(o),blockSize:z(l),minInlineSize:z(r),minBlockSize:z(c),maxInlineSize:z(h)||window.innerWidth,maxBlockSize:z(d)||window.innerHeight};this.resizeValues=p;const b="rtl"===u(e);this.interaction=m(i,{context:e.ownerDocument}).resizable({edges:{top:"block-end"===n&&a,right:n===(b?"inline-end":"inline-start")&&a,bottom:"block-start"===n&&a,left:n===(b?"inline-start":"inline-end")&&a},modifiers:[m.modifiers.restrictSize({min:{width:p.minInlineSize,height:p.minBlockSize},max:{width:p.maxInlineSize,height:p.maxBlockSize}})],listeners:{move:({rect:e})=>{const i="block-start"===n||"block-end"===n;this.updateSize({size:i?e.height:e.width,type:i?"blockSize":"inlineSize"})}}})}onBeforeOpen(){this.calciteSheetBeforeOpen.emit()}onOpen(){this.focusTrapDisabled&&this.setFocus(),this.focusTrap.activate(),this.calciteSheetOpen.emit()}onBeforeClose(){this.calciteSheetBeforeClose.emit()}onClose(){this.calciteSheetClose.emit(),this.focusTrap.deactivate()}setResizeHandleEl(e){this.resizeHandleEl=e,this.setupInteractions()}setContentEl(e){this.contentEl=e,this.contentId=v(e)}setTransitionEl(e){e&&(this.transitionEl=e)}async openSheet(){await this.componentOnReady(),this.opened=!0}handleOutsideClose(){this.outsideCloseDisabled||(this.open=!1)}async closeSheet(){if(this.beforeClose)try{await this.beforeClose(this.el)}catch{return void requestAnimationFrame(()=>{this.ignoreOpenChange=!0,this.open=!0,this.ignoreOpenChange=!1})}this.opened=!1}handleMutationObserver(){this.focusTrap.updateContainerElements()}render(){const{resizable:e,position:i,resizeValues:o}=this,r=u(this.el),l="block-start"===i||"block-end"===i;return t(this.el,"aria-describedby",this.contentId),this.el.ariaLabel=this.label,this.el.ariaModal="true",this.el.role="dialog",a`<div class=${n({[j]:!0,[C]:this.opened,[D]:this.embedded,[s.rtl]:"rtl"===r,[k("width",this.width,this.widthScale)]:!(!this.width&&!this.widthScale),[k("height",this.height,this.heightScale)]:!(!this.height&&!this.heightScale)})} ${h(this.setTransitionEl)}><calcite-scrim class=${n("scrim")} @click=${this.handleOutsideClose}></calcite-scrim><div class=${n("content")} id=sheet-content ${h(this.setContentEl)}><div class=${n("content-container")}><slot></slot></div>${e?d("resize-handle",a`<div .ariaLabel=${this.messages.resizeEnabled} .ariaOrientation=${l?"vertical":"horizontal"} .ariaValueMax=${l?o.maxBlockSize:o.maxInlineSize} .ariaValueMin=${l?o.minBlockSize:o.minInlineSize} .ariaValueNow=${l?o.blockSize:o.inlineSize} class=${n("resize-handle")} @keydown=${this.handleKeyDown} role=separator tabindex=0 touch-action=none ${h(this.setResizeHandleEl)}><div class=${n("resize-handle-bar")}><calcite-icon .icon=${this.getResizeIcon()} scale=s></calcite-icon></div></div>`):null}</div></div>`}}c("calcite-sheet",O);export{O as Sheet};
