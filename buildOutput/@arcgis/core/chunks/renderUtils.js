/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import a from"../Color.js";import{id as e}from"../kernel.js";import t from"../request.js";import{a as m,t as c}from"./colorUtils2.js";import n from"../core/Error.js";import{h as s}from"../core/lang.js";import{c as o}from"./projector.js";import{r as l}from"./svgUtils.js";import{f as u}from"./utils8.js";const p={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}]};function d(a,e,t){let m=22,c=22;a<1?m*=.75:a>1&&(c*=1.25);let n=22,s=22;return e&&t&&(m=c=n=s=0),[{type:"path",path:[{command:"M",values:[n,0]},{command:"L",values:[t?n:.875*n,0]},{command:"L",values:[t?m-.5*n:0,c-.5*s]},{command:"L",values:[m-.5*n,c-.5*s]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[n,0]},{command:"L",values:[n,e?0:.125*s]},{command:"L",values:[m-.5*n,e?c-.5*s:s]},{command:"L",values:[m-.5*n,c-.5*s]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[m-.5*n,c-.5*s]},{command:"L",values:[t?m-.5*n:0,c-.5*s]},{command:"L",values:[t?m-.5*n:0,e?c-.5*s:s]},{command:"L",values:[m-.5*n,e?c-.5*s:s]},{command:"Z",values:[]}]}]}function r(a){const e=.5*a,t=22;return[{type:"path",path:[{command:"M",values:[0,.7*t*.5]},{command:"L",values:[6.6,.7*t]},{command:"L",values:[6.6,.7*t+e]},{command:"L",values:[0,.7*t+e-.7*t*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,.7*t]},{command:"L",values:[6.6,.7*t+e]},{command:"L",values:[22,e]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,.7*t]},{command:"L",values:[0,.7*t*.5]},{command:"Z",values:[]}]}]}function h(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function v(a,e){let t=e?20:a;const m=e?4:6;t-=t<=22?.5*m:m;const c=e?.35*t:.5*t;return[{type:"path",path:[{command:"M",values:[.5*t,0]},{command:"L",values:[t,.5*c]},{command:"L",values:[.5*t,c]},{command:"L",values:[0,.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[.5*t,c]},{command:"L",values:[.5*t,a]},{command:"L",values:[0,a-.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*t,c]},{command:"L",values:[.5*t,a]},{command:"L",values:[t,a-.5*c]},{command:"L",values:[t,.5*c]},{command:"Z",values:[]}]}]}function i(a,e){let t=e?20:a;const m=e?4:6;t-=t<=22?.5*m:m;const c=.5*t,n=.15*t,s=a-n;return[{type:"ellipse",cx:.5*t,cy:s,rx:c,ry:n},{type:"path",path:[{command:"M",values:[0,n]},{command:"L",values:[0,s]},{command:"L",values:[t,s]},{command:"L",values:[t,n]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*t,cy:n,rx:c,ry:n}]}function L(a,e){let t=e?20:a;const m=e?4:6;t-=t<=22?.5*m:m;const c=.15*t,n=a-c;return[{type:"ellipse",cx:.5*t,cy:n,rx:.5*t,ry:c},{type:"path",path:[{command:"M",values:[.5*t,0]},{command:"L",values:[t,n]},{command:"L",values:[0,n]},{command:"Z",values:[]}]}]}function y(a){let e=a;e-=e<22?3:6;const t=.15*e;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[e,0]},{command:"L",values:[.5*e,a-t]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:0,rx:.5*e,ry:t}]}function f(a){let e=a;const t=a;e-=e<22?2:4;const m=e,c=t,n=Math.floor(a/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*m,0]},{command:"L",values:[m,.5*c-n]},{command:"L",values:[.45*m-n,.5*c+n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*m,0]},{command:"L",values:[.45*m-n,.5*c+n]},{command:"L",values:[0,.5*c-n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*c-n]},{command:"L",values:[.45*m-n,.5*c+n]},{command:"L",values:[.45*m,t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*m,t]},{command:"L",values:[m,.5*c-n]},{command:"L",values:[.45*m-n,.5*c+n]},{command:"Z",values:[]}]}]}function M(a){let e=a;return e-=e<22?1:2,[{type:"path",path:[{command:"M",values:[.45*a,0]},{command:"L",values:[a,e]},{command:"L",values:[.45*a,.6*e]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*a,0]},{command:"L",values:[.45*a,.6*e]},{command:"L",values:[0,e]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,e]},{command:"L",values:[.45*a,.6*e]},{command:"L",values:[a,e]},{command:"Z",values:[]}]}]}function g(a,e){return Math.round(Math.min(Math.max(a+255*e*.75,0),255))}function Z(e,t){if(null==e)return new a;if("type"in e&&("linear"===e.type||"pattern"===e.type))return e;const m=new a(e);return new a([g(m.r,t),g(m.g,t),g(m.b,t),m.a])}const w=o();function x(a,e){w.append(a,e),w.detach(e)}function j(a,e,t){const m=Math.ceil(e[0]),c=Math.ceil(e[1]);if(!a.some(a=>!!a.length))return null;const n=t?.node||document.createElement("div");return null!=t.opacity&&(n.style.opacity=t.opacity.toString()),null!=t.effectView&&(n.style.filter=u(t.effectView)),x(n,()=>l(a,m,c,t)),n}function b(a,e,t,n,s){switch(s){case"multiply":a[e]*=t[0],a[e+1]*=t[1],a[e+2]*=t[2],a[e+3]*=t[3];break;default:{const s=m({r:a[e],g:a[e+1],b:a[e+2]});s.h=n.h,s.s=n.s,s.v=s.v/100*n.v;const o=c(s);a[e]=o.r,a[e+1]=o.g,a[e+2]=o.b,a[e+3]*=t[3];break}}}function k(a,c,o,l,u){return function(a,e,m){return a?t(a,{responseType:"image"}).then(a=>{const t=a.data,c=t.width,n=t.height,s=c/n;let o=e;if(m){const a=Math.max(c,n);o=Math.min(o,a)}return{image:t,width:s<=1?Math.ceil(o*s):o,height:s<=1?o:Math.ceil(o/s)}}):Promise.reject(new n("renderUtils: imageDataSize","href not provided."))}(a,c,u).then(t=>{const n=t.width??c,u=t.height??c;if(t.image&&function(a,e){return!(!a||"ignore"===e||"multiply"===e&&255===a.r&&255===a.g&&255===a.b&&1===a.a)}(o,l)){let e=t.image.width,c=t.image.height;s("edge")&&/\.svg$/i.test(a)&&(e-=1,c-=1);const p=function(a,e){a=Math.ceil(a),e=Math.ceil(e);const t=document.createElement("canvas");t.width=a,t.height=e,t.style.width=a+"px",t.style.height=e+"px";const m=t.getContext("2d");return m.clearRect(0,0,a,e),m}(n,u);p.drawImage(t.image,0,0,e,c,0,0,n,u);const d=p.getImageData(0,0,n,u),r=[o.r/255,o.g/255,o.b/255,o.a],h=m(o);for(let a=0;a<d.data.length;a+=4)b(d.data,a,r,h,l);p.putImageData(d,0,0),a=p.canvas.toDataURL("image/png")}else{const t=e?.findCredential(a);if(t?.token){const e=a.includes("?")?"&":"?";a=`${a}${e}token=${t.token}`}}return{url:a,width:n,height:u}}).catch(()=>({url:a,width:c,height:c}))}export{Z as a,g as b,f as c,i as d,v as e,y as f,M as g,L as h,d as i,h as j,r as k,x as l,j as r,p as s,k as t};
