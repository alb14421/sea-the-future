/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{r as t}from"./mathUtils.js";import{U as e,m as s,P as i}from"./unitUtils.js";import{s as o}from"./mat4.js";import{e as r}from"./vec3.js";import{g as n}from"./spatialReferenceEllipsoidUtils.js";import{p as a}from"./projectPointToVector.js";import{p as m}from"./projectVectorToPoint.js";import{p as c}from"./projectVectorToVector.js";import{c as d}from"./aaBoundingRect.js";import{c as l,s as h,g as p,a as u,b as f,d as S,n as y,e as _,f as j,i as g,h as P,j as w,k as A}from"./coordinateSystem.js";import{i as C}from"./plane.js";import{s as R,d as M}from"./vector.js";import{i as U}from"./dehydratedFeatureUtils.js";class B{constructor(t,s,i,o){this.viewingMode=t,this.spatialReference=s,this.unitInMeters=i,this._coordinateSystem=o,this._tmpCoordinateSystem=l(o),this.referenceEllipsoid=e(s),this.sphericalPCPF=n(s)}set extent(t){t&&h(this._coordinateSystem,t,this._coordinateSystem)}get extent(){return p(this._coordinateSystem,d())}getAltitude(t){return u(this._coordinateSystem,t)}setAltitude(t,e,s=t){return f(this._coordinateSystem,s,e,t)}setAltitudeOfTransformation(t,e){S(this._coordinateSystem,e,t,e)}worldUpAtPosition(t,e){return y(this._coordinateSystem,t,e)}worldBasisAtPosition(t,e,s){return _(this._coordinateSystem,t,e,s)}basisMatrixAtPosition(t,e){const s=this.worldBasisAtPosition(t,0,R.get()),i=this.worldBasisAtPosition(t,1,R.get()),r=this.worldBasisAtPosition(t,2,R.get());return o(e,s[0],s[1],s[2],0,i[0],i[1],i[2],0,r[0],r[1],r[2],0,0,0,0,1),e}headingAtPosition(e,s){const i=this.worldUpAtPosition(e,R.get()),o=this.worldBasisAtPosition(e,1,R.get()),r=M(s,o,i);return t(r)}intersectManifoldClosestSilhouette(t,e,s){return j(this._coordinateSystem,e,this._tmpCoordinateSystem),g(this._tmpCoordinateSystem,t,s),s}intersectManifold(t,e,s){j(this._coordinateSystem,e,this._tmpCoordinateSystem);const i=R.get();return P(this._tmpCoordinateSystem,t,i)?r(s,i):null}intersectInfiniteManifold(t,e,s){if(1===this.viewingMode)return this.intersectManifold(t,e,s);j(this._coordinateSystem,e,this._tmpCoordinateSystem);const i=this._tmpCoordinateSystem.value,o=R.get();return C(i.plane,t,o)?r(s,o):null}toRenderCoords(t,e,s){return U(t)?a(t,e,this.spatialReference):c(t,e,s,this.spatialReference)}fromRenderCoords(t,e,s=null){return U(e)?(null!=s&&(e.spatialReference=s),m(t,this.spatialReference,e)?e:null):c(t,this.spatialReference,e,s)?e:null}static create(t,e){switch(t){case 2:return new B(2,e,s(e),A());case 1:return new B(1,e,1,w(e))}}static renderUnitScaleFactor(t,e){return i(t)/i(e)}}export{B as R};
