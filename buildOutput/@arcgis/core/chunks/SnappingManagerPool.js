/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{d as e,m as n}from"./handleUtils.js";import{n as t}from"./nextTick.js";import i from"../core/Collection.js";import{m as r}from"./mapCollectionUtils.js";import o from"../views/interactive/snapping/FeatureSnappingLayerSource.js";import{d as s}from"./Settings.js";import a from"../views/interactive/snapping/SnappingOptions.js";import{S as p}from"./SnappingManager.js";const c=i.ofType(o),l=new Map;function m(i){if(!l.has(i)){const n=function(n,t){const i=r(()=>n.map?.allLayers,e=>new o({layer:e}),{recycleItems:!0,createCollection:()=>new c}),p=new a({enabled:!0,selfEnabled:!1,featureEnabled:!0,featureSources:i,distance:t?.distance,touchSensitivityMultiplier:t?.touchSensitivityMultiplier??s.touchSensitivityMultiplier});return{...e(i),options:p}}(i,{distance:10}),t=function(e,n){return new p({view:e,options:n})}(i,n.options);l.set(i,{referenceCount:0,snappingManager:t,remove:()=>{n.remove(),t.destroy()}})}const m=l.get(i);m.referenceCount++;const u=n(()=>function(e,n){n.referenceCount--,n.referenceCount>0||t(()=>{0===n.referenceCount&&(n.remove(),l.delete(e))})}(i,m));return{snappingManager:m.snappingManager,...u}}export{m as a};
