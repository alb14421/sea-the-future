/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{g as e}from"./assets.js";import{h as t}from"../core/lang.js";let o,r=null;function _(){return!!r}function n(){return!!t("esri-wasm")}function P(){return o||(o=import("./pe-wasm.js").then(({default:t})=>t({locateFile:t=>e(`esri/geometry/support/${t}`)})).then(e=>{m(e)}),o)}const s={geogToProj(e,t,o){r.ensureCache.prepare();const _=U(o),n=o===_,P=r.ensureFloat64(_),s=r._pe_geog_to_proj(r.getPointer(e),t,P);return s&&F(o,t,P,n),s},projGeog(e,t,o,r){switch(r){case p.PE_TRANSFORM_P_TO_G:return s.projToGeog(e,t,o);case p.PE_TRANSFORM_G_TO_P:return s.geogToProj(e,t,o)}return 0},projToGeog:(e,t,o)=>s.projToGeogCenter(e,t,o,0),projToGeogCenter(e,t,o,_){r.ensureCache.prepare();const n=U(o),P=o===n,s=r.ensureFloat64(n),p=r._pe_proj_to_geog_center(r.getPointer(e),t,s,_);return p&&F(o,t,s,P),p}};class p{static init(){p.PE_BUFFER_MAX=r.PeDefs.prototype.PE_BUFFER_MAX,p.PE_NAME_MAX=r.PeDefs.prototype.PE_NAME_MAX,p.PE_MGRS_MAX=r.PeDefs.prototype.PE_MGRS_MAX,p.PE_USNG_MAX=r.PeDefs.prototype.PE_USNG_MAX,p.PE_DD_MAX=r.PeDefs.prototype.PE_DD_MAX,p.PE_DDM_MAX=r.PeDefs.prototype.PE_DDM_MAX,p.PE_DMS_MAX=r.PeDefs.prototype.PE_DMS_MAX,p.PE_UTM_MAX=r.PeDefs.prototype.PE_UTM_MAX,p.PE_PARM_MAX=r.PeDefs.prototype.PE_PARM_MAX,p.PE_TYPE_NONE=r.PeDefs.prototype.PE_TYPE_NONE,p.PE_TYPE_GEOGCS=r.PeDefs.prototype.PE_TYPE_GEOGCS,p.PE_TYPE_PROJCS=r.PeDefs.prototype.PE_TYPE_PROJCS,p.PE_TYPE_GEOGTRAN=r.PeDefs.prototype.PE_TYPE_GEOGTRAN,p.PE_TYPE_COORDSYS=r.PeDefs.prototype.PE_TYPE_COORDSYS,p.PE_TYPE_UNIT=r.PeDefs.prototype.PE_TYPE_UNIT,p.PE_TYPE_LINUNIT=r.PeDefs.prototype.PE_TYPE_LINUNIT,p.PE_STR_OPTS_NONE=r.PeDefs.prototype.PE_STR_OPTS_NONE,p.PE_STR_AUTH_NONE=r.PeDefs.prototype.PE_STR_AUTH_NONE,p.PE_STR_AUTH_TOP=r.PeDefs.prototype.PE_STR_AUTH_TOP,p.PE_STR_NAME_CANON=r.PeDefs.prototype.PE_STR_NAME_CANON,p.PE_STR_FMT_WKT=r.PeDefs.prototype.PE_STR_FMT_WKT,p.PE_STR_FMT_WKT2=r.PeDefs.prototype.PE_STR_FMT_WKT2,p.PE_PARM_X0=r.PeDefs.prototype.PE_PARM_X0,p.PE_PARM_ND=r.PeDefs.prototype.PE_PARM_ND,p.PE_TRANSFORM_1_TO_2=r.PeDefs.prototype.PE_TRANSFORM_1_TO_2,p.PE_TRANSFORM_2_TO_1=r.PeDefs.prototype.PE_TRANSFORM_2_TO_1,p.PE_TRANSFORM_P_TO_G=r.PeDefs.prototype.PE_TRANSFORM_P_TO_G,p.PE_TRANSFORM_G_TO_P=r.PeDefs.prototype.PE_TRANSFORM_G_TO_P,p.PE_HORIZON_RECT=r.PeDefs.prototype.PE_HORIZON_RECT,p.PE_HORIZON_POLY=r.PeDefs.prototype.PE_HORIZON_POLY,p.PE_HORIZON_LINE=r.PeDefs.prototype.PE_HORIZON_LINE,p.PE_HORIZON_DELTA=r.PeDefs.prototype.PE_HORIZON_DELTA}}let i=null;const E={},a={},c=e=>{const t=e.getType();switch(t){case p.PE_TYPE_GEOGCS:e=r.castObject(e,r.PeGeogcs);break;case p.PE_TYPE_PROJCS:e=r.castObject(e,r.PeProjcs);break;case p.PE_TYPE_GEOGTRAN:e=r.castObject(e,r.PeGeogtran);break;default:t&p.PE_TYPE_UNIT&&(e=r.castObject(e,r.PeUnit))}return e},T={initialize(){r.PeFactory.prototype.initialize(null)},coordsys:e=>T.factoryByType(p.PE_TYPE_COORDSYS,e),factoryByType(e,t){let o=null,_=E[e];if(_||(_={},E[e]=_),_.hasOwnProperty(String(t))&&(o=_[t],r.compare(o,r.NULL)&&(o=null)),!o){const n=r.PeFactory.prototype.factoryByType(e,t);r.compare(n,r.NULL)||(o=c(n),_[t]=o)}return o},fromString(e,t){let o=null,_=a[e];if(_||(_={},a[e]=_),_.hasOwnProperty(t)&&(o=_[t],r.compare(o,r.NULL)&&(o=null)),!o){const n=r.PeFactory.prototype.fromString(e,t);r.compare(n,r.NULL)||(o=c(n),_[t]=o)}return o},geogcs:e=>T.factoryByType(p.PE_TYPE_GEOGCS,e),geogtran:e=>T.factoryByType(p.PE_TYPE_GEOGTRAN,e),getCode:e=>r.PeFactory.prototype.getCode(e),projcs:e=>T.factoryByType(p.PE_TYPE_PROJCS,e),unit:e=>T.factoryByType(p.PE_TYPE_UNIT,e)};let g,l=null;const y={PE_GTLIST_OPTS_COMMON:0,init(){y.PE_GTLIST_OPTS_COMMON=r.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,g=r._pe_getPeGTlistExtendedEntrySize()},getGTlist(e,t,o,_,n,P){let s=null;const p=new r.PeInteger(P);try{const i=r.PeGTlistExtended.prototype.getGTlist(e,t,o,_,n,p);if((P=p.val)&&(s=[i],P>1)){const e=r.getPointer(i);for(let t=1;t<P;t++)s.push(r.wrapPointer(e+g*t,r.PeGTlistExtendedEntry))}}finally{r.destroy(p)}return s}},u={destroy(e){if(e?.length){for(const t of e)C(t),t.getEntries().forEach(e=>{C(e);const t=e.getGeogtran();C(t),t.getParameters().forEach(C),[t.getGeogcs1(),t.getGeogcs2()].forEach(e=>{C(e);const t=e.getDatum();C(t),C(t.getSpheroid()),C(e.getPrimem()),C(e.getUnit())})});r.PeGTlistExtendedEntry.prototype.Delete(e[0])}}},S={geogToGeog(e,t,o,_,n){r.ensureCache.prepare();const P=U(o),s=o===P,p=r.ensureFloat64(P);let i=0;_&&(i=r.ensureFloat64(_));const E=r._pe_geog_to_geog(r.getPointer(e),t,p,i,n);return E&&F(o,t,p,s),E}},O={geodesicCoordinate(e,t,o,_,n,P,s,p){r.PeLineType.prototype.geodesic_coordinate(e,t,o,_,n,P,s,p)},geodeticCoordinate(e,t,o,_,n,P,s,p,i){r.PeLineType.prototype.geodetic_coordinate(e,t,o,_,n,P,s,p,i)},geodeticDistance(e,t,o,_,n,P,s,p,i,E){r.PeLineType.prototype.geodetic_distance(e,t,o,_,n,P,s,p,i,E)},greatEllipticDistance(e,t,o,_,n,P,s,p,i){r.PeLineType.prototype.great_elliptic_distance(e,t,o,_,n,P,s,p,i)}},N={phiToEta:(e,t)=>r.PeMath.prototype.phi_to_eta(e,t),etaToPhi:(e,t)=>r.PeMath.prototype.eta_to_phi(e,t),phiToPhig:(e,t)=>r.PeMath.prototype.phi_to_phig(e,t),q:(e,t,o)=>r.PeMath.prototype.q(e,t,o),q90:(e,t)=>r.PeMath.prototype.q90(e,t)},f=(e,t,o,_,n,P)=>{let s,i;switch(r.ensureCache.prepare(),e){case"dd":s=r._pe_geog_to_dd,i=p.PE_DD_MAX;break;case"ddm":s=r._pe_geog_to_ddm,i=p.PE_DDM_MAX;break;case"dms":s=r._pe_geog_to_dms,i=p.PE_DMS_MAX}let E=0;t&&(E=r.getPointer(t));const a=U(_),c=r.ensureFloat64(a),T=I(o,i),g=s(E,o,c,n,r.ensureInt32(T));if(g)for(let e=0;e<o;e++)P[e]=r.UTF8ToString(T[e]);return g},d=(e,t,o,_,n)=>{let P;switch(r.ensureCache.prepare(),e){case"dd":P=r._pe_dd_to_geog;break;case"ddm":P=r._pe_ddm_to_geog;break;case"dms":P=r._pe_dms_to_geog}let s=0;t&&(s=r.getPointer(t));const p=_.map(e=>r.ensureString(e)),i=r.ensureInt32(p),E=r.ensureFloat64(new Array(2*o)),a=P(s,o,i,E);return a&&F(n,o,E),a},M={geogToDms:(e,t,o,r,_)=>f("dms",e,t,o,r,_),dmsToGeog:(e,t,o,r)=>d("dms",e,t,o,r),geogToDdm:(e,t,o,r,_)=>f("ddm",e,t,o,r,_),ddmToGeog:(e,t,o,r)=>d("ddm",e,t,o,r),geogToDd:(e,t,o,r,_)=>f("dd",e,t,o,r,_),ddToGeog:(e,t,o,r)=>d("dd",e,t,o,r)};class A{static init(){A.PE_MGRS_STYLE_NEW=r.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,A.PE_MGRS_STYLE_OLD=r.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,A.PE_MGRS_STYLE_AUTO=r.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,A.PE_MGRS_180_ZONE_1_PLUS=r.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,A.PE_MGRS_ADD_SPACES=r.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}static geogToMgrsExtended(e,t,o,_,n,P,s){r.ensureCache.prepare();let i=0;e&&(i=r.getPointer(e));const E=U(o),a=r.ensureFloat64(E),c=I(t,p.PE_MGRS_MAX),T=r.ensureInt32(c),g=r._pe_geog_to_mgrs_extended(i,t,a,_,n,P,T);if(g)for(let e=0;e<t;e++)s[e]=r.UTF8ToString(c[e]);return g}static mgrsToGeogExtended(e,t,o,_,n){r.ensureCache.prepare();let P=0;e&&(P=r.getPointer(e));const s=o.map(e=>r.ensureString(e)),p=r.ensureInt32(s),i=r.ensureFloat64(new Array(2*t)),E=r._pe_mgrs_to_geog_extended(P,t,p,_,i);return E&&F(n,t,i),E}}const D={geogToUsng(e,t,o,_,n,P,s){r.ensureCache.prepare();let i=0;e&&(i=r.getPointer(e));const E=U(o),a=r.ensureFloat64(E),c=I(t,p.PE_MGRS_MAX),T=r.ensureInt32(c),g=r._pe_geog_to_usng(i,t,a,_,n,P,T);if(g)for(let e=0;e<t;e++)s[e]=r.UTF8ToString(c[e]);return g},usngToGeog(e,t,o,_){r.ensureCache.prepare();let n=0;e&&(n=r.getPointer(e));const P=o.map(e=>r.ensureString(e)),s=r.ensureInt32(P),p=r.ensureFloat64(new Array(2*t)),i=r._pe_usng_to_geog(n,t,s,p);return i&&F(_,t,p),i}};class R{static init(){R.PE_UTM_OPTS_NONE=r.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,R.PE_UTM_OPTS_ADD_SPACES=r.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,R.PE_UTM_OPTS_NS=r.PeNotationUtm.prototype.PE_UTM_OPTS_NS}static geogToUtm(e,t,o,_,n){r.ensureCache.prepare();let P=0;e&&(P=r.getPointer(e));const s=U(o),i=r.ensureFloat64(s),E=I(t,p.PE_UTM_MAX),a=r.ensureInt32(E),c=r._pe_geog_to_utm(P,t,i,_,a);if(c)for(let e=0;e<t;e++)n[e]=r.UTF8ToString(E[e]);return c}static utmToGeog(e,t,o,_,n){r.ensureCache.prepare();let P=0;e&&(P=r.getPointer(e));const s=o.map(e=>r.ensureString(e)),p=r.ensureInt32(s),i=r.ensureFloat64(new Array(2*t)),E=r._pe_utm_to_geog(P,t,p,_,i);return E&&F(n,t,i),E}}class G{static{this.cache=new Map}static init(){G.PE_PCSINFO_OPTION_NONE=r.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,G.PE_PCSINFO_OPTION_DOMAIN=r.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,G.PE_POLE_OUTSIDE_BOUNDARY=r.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,G.PE_POLE_POINT=r.PePCSInfo.prototype.PE_POLE_POINT}static generate(e,t=G.PE_PCSINFO_OPTION_DOMAIN){let o=null,_=null;return G.cache.has(e)&&(_=G.cache.get(e),_[t]&&(o=_[t])),o||(o=r.PePCSInfo.prototype.generate(e,t),_||(_=[],G.cache.set(e,_)),_[t]=o),o}}const h={versionString:()=>r.PeVersion.prototype.version_string()};function m(e){function t(e,t,o){e[t]=o(e[t])}r=e,p.init(),y.init(),A.init(),R.init(),G.init(),i=class extends r.PeDouble{constructor(e=NaN){super(e)}destroy(){r.destroy(this)}[Symbol.dispose](){this.destroy()}},l=class extends r.PeGCSExtent{destroy(){r.destroy(this)}[Symbol.dispose](){this.destroy()}};const o=[r.PeAngunit,r.PeDatum,r.PeGeogcs,r.PeGeogtran,r.PeObject,r.PeParameter,r.PePrimem,r.PeProjcs,r.PeSpheroid,r.PeUnit];for(const e of o)t(e.prototype,"getName",e=>function(){return e.call(this,new Array(p.PE_NAME_MAX))});for(const e of[r.PeGeogtran,r.PeProjcs])t(e.prototype,"getParameters",e=>function(){const t=new Array(p.PE_PARM_MAX);let o=e.call(this);for(let e=0;e<t.length;e++){const _=r.getValue(o,"*");t[e]=_?r.wrapPointer(_,r.PeParameter):null,o+=Int32Array.BYTES_PER_ELEMENT}return t});t(r.PeHorizon.prototype,"getCoord",e=>function(t=!1){const o=this.getSize();if(!o)return null;const r=[];return F(r,o,e.call(this),t),r}),t(r.PeGTlistExtendedEntry.prototype,"getEntries",e=>{const t=r._pe_getPeGTlistExtendedGTsSize();return function(){let o=null;const _=e.call(this);if(!r.compare(_,r.NULL)){o=[_];const e=this.getSteps();if(e>1){const n=r.getPointer(_);for(let _=1;_<e;_++)o.push(r.wrapPointer(n+t*_,r.PeGTlistExtendedGTs))}}return o}});const _=r._pe_getPeHorizonSize(),n=e=>function(){let t=this._cache;if(t||(t=new Map,this._cache=t),t.has(e))return t.get(e);let o=null;const n=e.call(this);if(!r.compare(n,r.NULL)){o=[n];const e=n.getNump();if(e>1){const t=r.getPointer(n);for(let n=1;n<e;n++)o.push(r.wrapPointer(t+_*n,r.PeHorizon))}}return t.set(e,o),o};t(r.PeProjcs.prototype,"horizonGcsGenerate",n),t(r.PeProjcs.prototype,"horizonPcsGenerate",n),r.PeObject.prototype.toString=function(e=p.PE_STR_OPTS_NONE){r.ensureCache.prepare();const t=r.getPointer(this),o=r.ensureInt8(new Array(p.PE_BUFFER_MAX));return r.UTF8ToString(r._pe_object_to_string_ext(t,e,o))},r.PeGeogcs.prototype.destroy=function(){this.Delete(),C(this),this.ptr=0},r.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},r.PeProjcs.prototype.destroy=function(){this.Delete(),C(this),this.ptr=0},r.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function C(e){if(!e)return;const t=r.getClass(e);if(!t)return;const o=r.getCache(t);if(!o)return;const _=r.getPointer(e);_&&delete o[_]}function I(e,t){const o=[],_=new Array(t);for(let t=0;t<e;t++)o.push(r.ensureInt8(_));return o}function U(e){return ArrayBuffer.isView(e)?e:Array.isArray(e[0])?e.flat():e}function F(e,t,o,_=!1){if(_)for(let _=0;_<2*t;_++)e[_]=r.getValue(o+_*Float64Array.BYTES_PER_ELEMENT,"double");else{const _=0===e.length;for(let n=0;n<t;n++)_&&(e[n]=new Array(2)),e[n][0]=r.getValue(o,"double"),e[n][1]=r.getValue(o+Float64Array.BYTES_PER_ELEMENT,"double"),o+=2*Float64Array.BYTES_PER_ELEMENT}}const L=Object.freeze(Object.defineProperty({__proto__:null,PeCSTransformations:s,PeDefs:p,get PeDouble(){return i},PeFactory:T,get PeGCSExtent(){return l},PeGTTransformations:S,PeGTlistExtended:y,PeGTlistExtendedEntry:u,PeLineType:O,PeMath:N,PeNotationDms:M,PeNotationMgrs:A,PeNotationUsng:D,PeNotationUtm:R,PePCSInfo:G,PeVersion:h,_init:m,get _pe(){return r},isLoaded:_,isSupported:n,load:P},Symbol.toStringTag,{value:"Module"}));export{T as P,p as a,G as b,s as c,S as d,M as e,D as f,R as g,A as h,_ as i,n as j,P as l,L as p};
