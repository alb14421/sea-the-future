/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{r as e}from"../core/lang.js";import{m as t,h as i}from"./handleUtils.js";import{g as o}from"./MapUtils.js";import{p as r,V as n}from"./InputManager.js";const s={cancel:"Escape",complete:"Enter"},a={...s,redo:"r",undo:"z",center:"Alt",constraint:"Shift",delete:["Backspace","Delete"],vertexAdd:"f",pan:" "},p={toggle:"Control"},c={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},f={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:r,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},editSourcePoints:{key:"Alt",continuePropagation:!0},undo:"z",redo:"r"},d={invertType:["Control","Meta"]};class h{constructor(){this._bindings=new Map}add(e,t){return this.addToggle(e,e=>{"key-down"===e.type&&t(e)})}addToggle(i,r){const n=g.fromDefinition(i,r),s=o(this._bindings,n.key,()=>[]);return s.push(n),t(()=>e(s,n))}register(e,t=n.WIDGET){return i([e.on("key-down",t=>this.dispatch(e.inputManager,t),t),e.on("key-up",t=>this.dispatch(e.inputManager,t),t)])}dispatch(e,t){const i=t.key,o=this._bindings.get(i);if(o)for(const i of o)i.process(e,t)}}class g{constructor(e,t,i,o,r){this.key=e,this.modifiers=t,this.repeats=i,this.continuePropagation=o,this.callback=r}process(e,t){if(!(t.key!==this.key||"repeat"in t&&t.repeat&&!this.repeats)){for(const t of this.modifiers)if(!e.isModifierKeyDown(t))return;this.continuePropagation||t.stopPropagation(),this.callback(t)}}static fromDefinition(e,t){if("string"==typeof e)return new g(e,[],!1,!1,t);const{key:i,modifier:o,repeats:r,continuePropagation:n}=e;return new g(i,o?Array.isArray(o)?o:[o]:[],!!r,!!n,t)}}export{h as K,d as a,p as b,s as i,f as m,a as s,c as t};
