/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{D as t}from"./Dictionary.js";import{A as r}from"./enum.js";import{s as o,d as e,Q as i,w as s,f as n,T as a,U as m,L as p,V as c,W as d,X as u,Y as j,K as l,Z as y,_ as f}from"./languageUtils.js";import{l as g}from"./shared2.js";import"./TimeOnly.js";import"./string.js";import"./object.js";import"../core/lang.js";import"./UnknownTimeZone.js";import"./datetime.js";import"./locale.js";import"./handleUtils.js";import"../geometry/Extent.js";import"./tslib.es6.js";import"../core/accessorSupport/decorators/property.js";import"./Logger.js";import"../config.js";import"./ensureType.js";import"./MapUtils.js";import"./get.js";import"./utils.js";import"./metadata.js";import"../core/Error.js";import"../core/accessorSupport/decorators/subclass.js";import"./Lifecycle.js";import"./tracking.js";import"./Warning.js";import"../geometry/Geometry.js";import"../core/JSONSupport.js";import"../core/Accessor.js";import"../core/Handles.js";import"./maybe.js";import"./ObjectPool.js";import"./ObservableBase.js";import"./watch.js";import"../core/scheduling.js";import"./nextTick.js";import"./PooledArray.js";import"../core/promiseUtils.js";import"./events.js";import"./SetUtils.js";import"./SimpleTrackingTarget.js";import"./reader.js";import"../geometry/SpatialReference.js";import"./unitUtils.js";import"./jsonMap.js";import"./pe.js";import"./assets.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"./jsonUtils.js";import"./persistableUrlUtils.js";import"./writer.js";import"../geometry/Point.js";import"../core/accessorSupport/decorators/cast.js";import"../geometry/support/webMercatorUtils.js";import"./deepClone.js";import"./guards.js";import"./ImmutableArray.js";import"./number2.js";import"../geometry/Multipoint.js";import"./zmUtils.js";import"../geometry/Polygon.js";import"./coordsUtils.js";import"./extentUtils.js";import"./boundsUtils.js";import"./aaBoundingRect.js";import"./mathUtils.js";import"../geometry/Polyline.js";import"../geometry/support/jsonUtils.js";import"../layers/support/Field.js";import"./enumeration.js";import"./domains.js";import"../layers/support/CodedValueDomain.js";import"../layers/support/Domain.js";import"../layers/support/InheritedDomain.js";import"../layers/support/RangeDomain.js";import"./fieldType.js";function v(r,o){return r&&r.domain?"coded-value"===r.domain.type||"codedValue"===r.domain.type?t.convertObjectToArcadeDictionary({type:"codedValue",name:r.domain.name,dataType:g[r.field.type],codedValues:r.domain.codedValues.map(t=>({name:t.name,code:t.code}))},p(o)):t.convertObjectToArcadeDictionary({type:"range",name:r.domain.name,dataType:g[r.field.type],min:r.domain.minValue,max:r.domain.maxValue},p(o)):null}function w(g){"async"===g.mode&&(g.functions.domain=function(t,m){return g.standardFunctionAsync(t,m,async(p,c,d)=>{if(o(d,2,3,t,m),e(d[0]))return v(i(d[0],s(d[1]),void 0===d[2]?void 0:d[2]),t);if(n(d[0]))return await d[0]._ensureLoaded(),v(a(s(d[1]),d[0],null,void 0===d[2]?void 0:d[2]),t);throw new r(t,"InvalidParameter",m)})},g.functions.subtypes=function(i,s){return g.standardFunctionAsync(i,s,async(a,c,d)=>{if(o(d,1,1,i,s),e(d[0])){const r=m(d[0]);return r?t.convertObjectToArcadeDictionary(r,p(i)):null}if(n(d[0])){await d[0]._ensureLoaded();const r=d[0].subtypeMetaData();return r?t.convertObjectToArcadeDictionary(r,p(i)):null}throw new r(i,"InvalidParameter",s)})},g.functions.domainname=function(t,i){return g.standardFunctionAsync(t,i,async(m,p,u)=>{if(o(u,2,4,t,i),e(u[0]))return c(u[0],s(u[1]),u[2],void 0===u[3]?void 0:u[3]);if(n(u[0])){await u[0]._ensureLoaded();const t=a(s(u[1]),u[0],null,void 0===u[3]?void 0:u[3]);return d(t,u[2])}throw new r(t,"InvalidParameter",i)})},g.signatures.push({name:"domainname",min:2,max:4}),g.functions.domaincode=function(t,i){return g.standardFunctionAsync(t,i,async(m,p,c)=>{if(o(c,2,4,t,i),e(c[0]))return u(c[0],s(c[1]),c[2],void 0===c[3]?void 0:c[3]);if(n(c[0])){await c[0]._ensureLoaded();const t=a(s(c[1]),c[0],null,void 0===c[3]?void 0:c[3]);return j(t,c[2])}throw new r(t,"InvalidParameter",i)})},g.signatures.push({name:"domaincode",min:2,max:4}),g.functions.text=function(t,e){return g.standardFunctionAsync(t,e,async(i,s,a)=>{if(o(a,1,2,t,e),n(a[0])){const o=l(a[1],"");if(""===o)return a[0].castToText();if("schema"===o.toLowerCase())return a[0].convertToText("schema",i.abortSignal);if("featureset"===o.toLowerCase())return a[0].convertToText("featureset",i.abortSignal);throw new r(t,"InvalidParameter",e)}return y(a[0],a[1])})},g.functions.gdbversion=function(t,i){return g.standardFunctionAsync(t,i,async(s,a,m)=>{if(o(m,1,1,t,i),e(m[0]))return m[0].gdbVersion();if(n(m[0]))return(await m[0].load()).gdbVersion;throw new r(t,"InvalidParameter",i)})},g.functions.schema=function(i,s){return g.standardFunctionAsync(i,s,async(a,m,c)=>{if(o(c,1,1,i,s),n(c[0]))return await c[0].load(),t.convertObjectToArcadeDictionary(c[0].schema(),p(i));if(e(c[0])){const r=f(c[0]);return r?t.convertObjectToArcadeDictionary(r,p(i)):null}throw new r(i,"InvalidParameter",s)})})}export{w as registerFunctions};
