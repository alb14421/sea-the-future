/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{c as t}from"./mathUtils.js";import{O as r}from"./ray.js";import{e as n,h as o,d as i,w as e,i as s,j as c,u as a}from"./vec3.js";import{c as u,b as g}from"./vec3f64.js";import{s as f}from"./vector.js";function v(t){return t?{origin:g(t.origin),vector:g(t.vector)}:{origin:u(),vector:u()}}function p(t,r){const n=y.get();return n.origin=t,n.vector=r,n}function m(t,r=v()){return h(t.origin,t.vector,r)}function h(t,r,o=v()){return n(o.origin,t),n(o.vector,r),o}function b(t,r,i=v()){return n(i.origin,t),o(i.vector,r,t),i}function M(r,n){const e=o(f.get(),n,r.origin),c=i(r.vector,e),a=i(r.vector,r.vector),u=t(c/a,0,1),g=o(f.get(),s(f.get(),r.vector,u),e);return i(g,g)}function d(t,r,n){return A(t,r,0,1,n)}function j(t,r,n){return c(n,t.origin,s(n,t.vector,r))}function A(r,n,a,u,g){const{vector:v,origin:p}=r,m=o(f.get(),n,p),h=i(v,m)/e(v);return s(g,v,t(h,a,u)),c(g,g,r.origin)}function B(t,r){if(w(t,p(r.origin,r.direction),!1,x)){const{tA:r,pB:n,distance2:o}=x;if(r>=0&&r<=1)return o;if(r<0)return a(t.origin,n);if(r>1)return a(c(f.get(),t.origin,t.vector),n)}return null}function l(t,r,o){return!!w(t,r,!0,x)&&(n(o,x.pA),!0)}function w(r,n,o,i){const e=1e-6,s=r.origin,u=c(f.get(),s,r.vector),g=n.origin,v=c(f.get(),g,n.vector),p=f.get(),m=f.get();if(p[0]=s[0]-g[0],p[1]=s[1]-g[1],p[2]=s[2]-g[2],m[0]=v[0]-g[0],m[1]=v[1]-g[1],m[2]=v[2]-g[2],Math.abs(m[0])<e&&Math.abs(m[1])<e&&Math.abs(m[2])<e)return!1;const h=f.get();if(h[0]=u[0]-s[0],h[1]=u[1]-s[1],h[2]=u[2]-s[2],Math.abs(h[0])<e&&Math.abs(h[1])<e&&Math.abs(h[2])<e)return!1;const b=p[0]*m[0]+p[1]*m[1]+p[2]*m[2],M=m[0]*h[0]+m[1]*h[1]+m[2]*h[2],d=p[0]*h[0]+p[1]*h[1]+p[2]*h[2],j=m[0]*m[0]+m[1]*m[1]+m[2]*m[2],A=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*j-M*M;if(Math.abs(A)<e)return!1;let B=(b*M-d*j)/A,l=(b+M*B)/j;o&&(B=t(B,0,1),l=t(l,0,1));const w=f.get(),x=f.get();return w[0]=s[0]+B*h[0],w[1]=s[1]+B*h[1],w[2]=s[2]+B*h[2],x[0]=g[0]+l*m[0],x[1]=g[1]+l*m[1],x[2]=g[2]+l*m[2],i.tA=B,i.tB=l,i.pA=w,i.pB=x,i.distance2=a(w,x),!0}const x={tA:0,tB:0,pA:u(),pB:u(),distance2:0},y=new r(()=>v());export{A as a,d as b,v as c,M as d,B as e,b as f,m as g,h,l as i,j as p,p as w};
