/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
var n=Math.PI,t=Math.sin,r=Math.cos,e=Math.tan,u=Math.asin,a=Math.atan2,o=Math.acos,i=n/180,c=864e5,f=2440588,d=2451545,s={dec:0,ra:0};function M(n){return new Date((n+.5-f)*c)}function h(n){return function(n){return n.valueOf()/c-.5+f}(n)-d}var l=23.4397*i;function v(n,u){return a(t(n)*r(l)-e(u)*t(l),r(n))}function p(n,e){return u(t(e)*r(l)+r(e)*t(l)*t(n))}function N(n,u,o){return a(t(n),r(n)*t(u)-e(o)*r(u))}function P(n,e,a){return u(t(e)*t(a)+r(e)*r(a)*r(n))}function x(n,t){return i*(280.16+360.9856235*n)-t}function E(n){return i*(357.5291+.98560028*n)}function I(n){return i*(1.9148*t(n)+.02*t(2*n)+3e-4*t(3*n))}function O(t,r){return t+r+102.9372*i+n}function T(n,t){var r=E(n),e=O(r,I(r));return t||(t={dec:0,ra:0}),t.dec=p(e,0),t.ra=v(e,0),t}var g={PolarException:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(n,t,r,e){var u=i*-r,a=i*t,o=h(n),c=T(o,s),f=x(o,u)-c.ra;return e||(e={azimuth:0,altitude:0}),e.azimuth=N(f,a,c.dec),e.altitude=P(f,a,c.dec),e}},m=[[-.83,"sunrise","sunset"]];g.addTime=function(n,t,r){m.push([n,t,r])};var A=9e-4;function L(t,r,e){return A+(t+r)/(2*n)+e}function R(n,r,e){return d+n+.0053*t(r)-.0069*t(2*e)}function G(n){var e=i*(134.963+13.064993*n),u=i*(93.272+13.22935*n),a=i*(218.316+13.176396*n)+6.289*i*t(e),o=5.128*i*t(u),c=385001-20905*r(e);return{ra:v(a,o),dec:p(a,o),dist:c}}g.getTimes=function(e,u,a){var c=i*-a,f=i*u,d=function(t,r){return Math.round(t-A-r/(2*n))}(h(e),c),s=L(0,c,d),l=E(s),v=I(l),N=O(l,v),P=p(N,0),x=R(s,l,N);function T(n){var e=function(n,e,u){return o((t(n)-t(e)*t(u))/(r(e)*r(u)))}(n,f,P);return R(L(e,c,d),l,N)}var G,H,_,z,D,S,U,w={solarNoon:M(x),nadir:M(x-.5),polarException:g.PolarException.NORMAL};for(G=0,H=m.length;G<H;G+=1)D=x-((z=T((_=m[G])[0]*i))-x),w[_[1]]=M(D),w[_[2]]=M(z);return w.polarException=(S=m[0][0]*i,(U=(t(S)-t(f)*t(P))/(r(f)*r(P)))<-1?g.PolarException.MIDNIGHT_SUN:U>1?g.PolarException.POLAR_NIGHT:g.PolarException.NORMAL),w},g.getMoonPosition=function(n,t,r){var u=i*-r,a=i*t,o=h(n),c=G(o),f=x(o,u)-c.ra,d=P(f,a,c.dec);return d+=.017*i/e(d+10.26*i/(d+5.1*i)),{azimuth:N(f,a,c.dec),altitude:d,distance:c.dist}},g.getMoonFraction=function(n){var e=h(n),u=T(e),i=G(e),c=149598e3,f=o(t(u.dec)*t(i.dec)+r(u.dec)*r(i.dec)*r(u.ra-i.ra)),d=a(c*t(f),i.dist-c*r(f));return(1+r(d))/2};export{g as S};
