/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{l as s}from"./Lyr3DModule.js";import"./assets.js";import"../config.js";import"../core/lang.js";import"./object.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/Error.js";import"./Logger.js";import"./string.js";import"./jsonUtils.js";import"./MapUtils.js";import"../core/promiseUtils.js";import"./handleUtils.js";import"./events.js";import"./maybe.js";import"./persistableUrlUtils.js";let t,r;async function e(s){await o();const t={status:1,error:"",jobDescJson:"",data:new Uint8Array(0),missingInputUrls:[]};if(s.inputs.length<1)return{result:t,transferList:[]};const e={ptrs:[],sizes:[]};for(const t of s.inputs){const s=r._malloc(t.byteLength);new Uint8Array(r.HEAPU8.buffer,s,t.byteLength).set(new Uint8Array(t)),e.ptrs.push(s),e.sizes.push(t.byteLength)}const i=r.process(s.jobDescJson,s.id,e,s.isMissingResourceCase);t.status=i.status,t.missingInputUrls=i.missingInputUrls.slice();const n=0===i.status&&i.data,l=2===t.status&&t.missingInputUrls.length>0;t.jobDescJson=i.jobDescJson.slice(),t.error=i.error.slice(),n?t.data=i.data.slice():l&&(t.originalInputs=s.inputs.slice());for(let s=0;s<e.ptrs.length;++s)r._free(e.ptrs[s]);const p=[];if(n)p.push(t.data.buffer);else if(l)for(const t of s.inputs)p.push(t);return{result:t,transferList:p}}function i(){r&&(r.uninitialize_lyr3d_worker_wasm(),r=null)}function o(){return r?Promise.resolve():(t||(t=s().then(s=>{r=s,r.initialize_lyr3d_worker_wasm(),t=null})),t)}export{i as destroyWasm,o as initialize,e as process};
