/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{c as t}from"./memoryEstimations.js";import{O as e}from"./OptimizedGeometry.js";function n(t,e){return t?e?4:3:e?3:2}function r(t,e,r,l){if(!e?.lengths.length)return null;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const c=t.coords,h=[],N=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:m,coords:d}=e,f=n(r,l);let g=0;for(const t of m){const e=o(N,d,g,t,r,l);e&&h.push(e),g+=t*f}if(h.sort((t,e)=>{let n=t[2]-e[2];return 0===n&&r&&(n=t[4]-e[4]),n}),h.length){let t=6*h[0][2];c[0]=h[0][0]/t,c[1]=h[0][1]/t,r&&(t=6*h[0][4],c[2]=0!==t?h[0][3]/t:0),(c[0]<N[0]||c[0]>N[1]||c[1]<N[2]||c[1]>N[3]||r&&(c[2]<N[4]||c[2]>N[5]))&&(c.length=0)}if(!c.length){const t=e.lengths[0]?function(t,e,r,o,l){const c=n(o,l);let h=0,N=0+c,m=0,d=0,f=0,g=0;for(let e=0,n=r-1;e<n;e++,h+=c,N+=c){const e=t[h],n=t[h+1],r=t[h+2],l=t[N],c=t[N+1],a=t[N+2],T=o?i(e,n,r,l,c,a):s(e,n,l,c);if(T)if(m+=T,o){const t=I(e,n,r,l,c,a);d+=T*t[0],f+=T*t[1],g+=T*t[2]}else{const t=u(e,n,l,c);d+=T*t[0],f+=T*t[1]}}return m>0?o?[d/m,f/m,g/m]:[d/m,f/m]:r>0?o?[t[0],t[1],t[2]]:[t[0],t[1]]:null}(d,0,m[0],r,l):null;if(!t)return null;c[0]=t[0],c[1]=t[1],r&&t.length>2&&(c[2]=t[2])}return t}function o(t,e,r,o,s,i){const u=n(s,i);let I=r,l=r+u,c=0,h=0,N=0,m=0,d=0;for(let n=0,r=o-1;n<r;n++,I+=u,l+=u){const n=e[I],r=e[I+1],o=e[I+2],i=e[l],u=e[l+1],f=e[l+2];let g=n*u-i*r;m+=g,c+=(n+i)*g,h+=(r+u)*g,s&&(g=n*f-i*o,N+=(o+f)*g,d+=g),n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),r<t[2]&&(t[2]=r),r>t[3]&&(t[3]=r),s&&(o<t[4]&&(t[4]=o),o>t[5]&&(t[5]=o))}if(m>0&&(m*=-1),d>0&&(d*=-1),!m)return null;const f=[c,h,.5*m];return s&&(f[3]=N,f[4]=.5*d),f}function s(t,e,n,r){const o=n-t,s=r-e;return Math.sqrt(o*o+s*s)}function i(t,e,n,r,o,s){const i=r-t,u=o-e,I=s-n;return Math.sqrt(i*i+u*u+I*I)}function u(t,e,n,r){return[t+.5*(n-t),e+.5*(r-e)]}function I(t,e,n,r,o,s){return[t+.5*(r-t),e+.5*(o-e),n+.5*(s-n)]}class l{constructor(t=null,e={},n,r,o=0){this.geometry=t,this.attributes=e,this.centroid=n,this.objectId=r,this.displayId=o}static fromJSON(t){const n=t.geometry?e.fromJSON(t.geometry):null,r=t.centroid?e.fromJSON(t.centroid):null,o=t.objectId;return new l(n,t.attributes,r,o)}weakClone(){const t=new l(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t}clone(){const t=this.geometry?.clone(),e=new l(t,{...this.attributes},this.centroid?.clone(),this.objectId);return e.displayId=this.displayId,e}ensureCentroid(t){return this.centroid??=r(new e,this.geometry,t.hasZ,t.hasM),this.centroid}get usedMemory(){return 128+t(this.attributes)+(this.geometry?.usedMemory??0)}}function c(t){return!!t.geometry?.coords?.length}export{l as O,r as g,c as h};
