/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import"../core/lang.js";import{g as t}from"./watch.js";import{h as i}from"./vec3.js";import{f as s,c as r}from"./vec3f64.js";import{f as o}from"./vec4f64.js";import{p as a}from"./projectBuffer.js";import{A as n}from"./orientedBoundingBox.js";import{G as e}from"./Matrix4PassUniform.js";import{R as h,W as c,O as g}from"./RibbonLineMaterial.js";class m{constructor(t,i){this.vec3=t,this.id=i}}function d(t,i,r,o){return new m(s(t,i,r),o)}class f{constructor(i){this._originSR=i,this._rootOriginId="root/"+t(),this._origins=new Map,this._objects=new Map,this._gridSize=5e5}getOrigin(t){const s=this._origins.get(this._rootOriginId);if(null==s){const i=d(t[0]+Math.random()-.5,t[1]+Math.random()-.5,t[2]+Math.random()-.5,this._rootOriginId);return this._origins.set(this._rootOriginId,i),i}const r=this._gridSize,o=Math.round(t[0]/r),a=Math.round(t[1]/r),n=Math.round(t[2]/r),e=`${o}/${a}/${n}`;let h=this._origins.get(e);const c=.5*r;if(i(_,t,s.vec3),_[0]=Math.abs(_[0]),_[1]=Math.abs(_[1]),_[2]=Math.abs(_[2]),_[0]<c&&_[1]<c&&_[2]<c){if(h){const s=Math.max(..._);if(i(_,t,h.vec3),_[0]=Math.abs(_[0]),_[1]=Math.abs(_[1]),_[2]=Math.abs(_[2]),Math.max(..._)<s)return h}return s}return h||(h=d(o*r,a*r,n*r,e),this._origins.set(e,h)),h}_drawOriginBox(t,i=o(1,1,0,1)){const s=window.view,r=s.stage,m=i.toString();if(!this._objects.has(m)){this._material=new h({width:2,color:i});const t=new c(r,{pickable:!1}),s=new g({castShadow:!1});t.add(s),this._objects.set(m,s)}const d=this._objects.get(m),f=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],_=f.length,p=new Array(3*_),M=new Array,w=.5*this._gridSize;for(let i=0;i<_;i++)p[3*i]=t[0]+(1&f[i]?w:-w),p[3*i+1]=t[1]+(2&f[i]?w:-w),p[3*i+2]=t[2]+(4&f[i]?w:-w),i>0&&M.push(i-1,i);a(p,this._originSR,0,p,s.renderSpatialReference,0,_);const l=new e(this._material,[["position",new n(p,M,3,!0)]],null,2);d.addGeometry(l)}get test(){}}const _=r();export{f as G,d as f};
