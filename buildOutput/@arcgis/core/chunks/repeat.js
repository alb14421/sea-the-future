/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{e,d as t,t as s,T as r}from"./componentsUtils.js";import{p as l,v as n,s as o,M as i,m as u}from"./directive-helpers.js";const f=(e,t,s)=>{const r=new Map;for(let l=t;l<=s;l++)r.set(e[l],l);return r},c=e(class extends t{constructor(e){if(super(e),e.type!==s.CHILD)throw Error("repeat() can only be used in text expressions")}dt(e,t,s){let r;void 0===s?s=t:void 0!==t&&(r=t);const l=[],n=[];let o=0;for(const t of e)l[o]=r?r(t,o):o,n[o]=s(t,o),o++;return{values:n,keys:l}}render(e,t,s){return this.dt(e,t,s).values}update(e,[t,s,c]){const a=l(e),{values:d,keys:h}=this.dt(t,s,c);if(!Array.isArray(a))return this.ut=h,d;const p=this.ut??=[],v=[];let y,m,x=0,g=a.length-1,j=0,k=d.length-1;for(;x<=g&&j<=k;)if(null===a[x])x++;else if(null===a[g])g--;else if(p[x]===h[j])v[j]=n(a[x],d[j]),x++,j++;else if(p[g]===h[k])v[k]=n(a[g],d[k]),g--,k--;else if(p[x]===h[k])v[k]=n(a[x],d[k]),o(e,v[k+1],a[x]),x++,k--;else if(p[g]===h[j])v[j]=n(a[g],d[j]),o(e,a[x],a[g]),g--,j++;else if(void 0===y&&(y=f(h,j,k),m=f(p,x,g)),y.has(p[x]))if(y.has(p[g])){const t=m.get(h[j]),s=void 0!==t?a[t]:null;if(null===s){const t=o(e,a[x]);n(t,d[j]),v[j]=t}else v[j]=n(s,d[j]),o(e,a[x],s),a[t]=null;j++}else i(a[g]),g--;else i(a[x]),x++;for(;j<=k;){const t=o(e,v[k+1]);n(t,d[j]),v[j++]=t}for(;x<=g;){const e=a[x++];null!==e&&i(e)}return this.ut=h,u(e,v),r}});export{c};
