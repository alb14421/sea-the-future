/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import e from"../Color.js";import{R as t}from"./TextureCompressionTracker.js";import{b as o}from"./visualVariableUtils.js";function i(e,i){const r=function(e,t){if(null!=e.symbol)return e.symbol;const o=t?.renderer;return null!=o&&"dot-density"!==o.type?o.getSymbol(e,t):null}(e,i);if(null==r)return null;const l=i?.renderer,n=new t(l,r);if(null==l||!("visualVariables"in l)||!l.visualVariables)return n;const a=o(l,e,i)??[],s=["proportional","proportional","proportional"];for(const{variable:e,value:t}of a)if(null!=t||"size"===e.type&&e.useSymbolValue)switch(e.type){case"color":n.color=t?.toRgba();break;case"size":if("outline"===e.target)n.outlineSize=t;else{const o=e.axis,i=e.useSymbolValue?"symbol-value":t??"proportional";switch(o){case"width":s[0]=i;break;case"depth":s[1]=i;break;case"height":s[2]=i;break;case"width-and-depth":s[0]=s[1]=i;break;default:s[0]=s[1]=s[2]=i}}break;case"opacity":n.opacity=t;break;case"rotation":switch(e.axis){case"tilt":n.tilt=t;break;case"roll":n.roll=t;break;default:n.heading=t}}return"proportional"===s[0]&&"proportional"===s[1]&&"proportional"===s[2]||(n.size=s),n}async function r(i,r){const l=await async function(e,t){return null!=e.symbol?e.symbol:t?.renderer?.getSymbolAsync(e,t)??null}(i,r);if(!l)return null;const n=r?.renderer,a=new t(n,l);if(!n||!("visualVariables"in n)||!n.visualVariables)return a;const s=o(n,i,r)??[],u=["proportional","proportional","proportional"];for(const{variable:t,value:o}of s)if("color"===t.type)a.color=e.toUnitRGBA(o);else if("size"===t.type)if("outline"===t.target)a.outlineSize=o;else{const e=t.axis,i=t.useSymbolValue?"symbol-value":o;"width"===e?u[0]=i:"depth"===e?u[1]=i:"height"===e?u[2]=i:u[0]=u[1]="width-and-depth"===e?i:u[2]=i}else"opacity"===t.type?a.opacity=o:"rotation"===t.type&&"tilt"===t.axis?a.tilt=o:"rotation"===t.type&&"roll"===t.axis?a.roll=o:"rotation"===t.type&&(a.heading=o);return(isFinite(u[0])||isFinite(u[1])||isFinite(u[2]))&&(a.size=u),a}function l(e,t=0){const o=e[t];return"number"==typeof o&&isFinite(o)?o:null}function n(e){for(let t=0;t<3;t++){const o=e[t];if("number"==typeof o)return isFinite(o)?o:0}return 0}export{r as a,l as b,n as c,i as g};
