/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import n from"../Color.js";import{s as t,clone as r,g as o}from"../core/lang.js";import{c as e}from"./mathUtils.js";import{e as u}from"./vec4.js";import{f as a}from"./vec4f64.js";function c(n){return"r"in n&&"g"in n&&"b"in n}function s(n){return"h"in n&&"s"in n&&"v"in n}function i(n){return"l"in n&&"a"in n&&"b"in n}function f(n){return"l"in n&&"c"in n&&"h"in n}const h=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],l=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function g(n,t){const r=[];let o,e;if(n[0].length!==t.length)throw new Error("dimensions do not match");const u=n.length,a=n[0].length;let c=0;for(o=0;o<u;o++){for(c=0,e=0;e<a;e++)c+=n[o][e]*t[e];r.push(c)}return r}function b(n){const t=[n.r/255,n.g/255,n.b/255].map(n=>n<=.04045?n/12.92:((n+.055)/1.055)**2.4),r=g(h,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function M(n){const t=g(l,[n.x/100,n.y/100,n.z/100]).map(n=>{const t=n<=.0031308?12.92*n:1.055*n**(1/2.4)-.055;return Math.min(1,Math.max(t,0))});return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function m(n){const t=[n.x/95.047,n.y/100,n.z/108.883].map(n=>n>(6/29)**3?n**(1/3):1/3*(29/6)**2*n+4/29);return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function d(n){const t=n.l,r=[(t+16)/116+n.a/500,(t+16)/116,(t+16)/116-n.b/200].map(n=>n>6/29?n**3:3*(6/29)**2*(n-4/29));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function p(n){return c(n)?n:f(n)?function(n){return M(d(function(n){const t=n.l,r=n.c,o=n.h;return{l:t,a:r*Math.cos(o),b:r*Math.sin(o)}}(n)))}(n):i(n)?function(n){return M(d(n))}(n):function(n){return"x"in n&&"y"in n&&"z"in n}(n)?M(n):s(n)?function(n){const t=(n.h+360)%360/60,r=n.s/100,o=n.v/100*255,e=o*r,u=e*(1-Math.abs(t%2-1));let a;switch(Math.floor(t)){case 0:a={r:e,g:u,b:0};break;case 1:a={r:u,g:e,b:0};break;case 2:a={r:0,g:e,b:u};break;case 3:a={r:0,g:u,b:e};break;case 4:a={r:u,g:0,b:e};break;case 5:case 6:a={r:e,g:0,b:u};break;default:a={r:0,g:0,b:0}}return a.r=Math.round(a.r+o-e),a.g=Math.round(a.g+o-e),a.b=Math.round(a.b+o-e),a}(n):n}function k(n){return s(n)?n:function(n){const t=n.r,r=n.g,o=n.b,e=Math.max(t,r,o),u=e-Math.min(t,r,o);let a=e,c=0===u?0:e===t?(r-o)/u%6:e===r?(o-t)/u+2:(t-r)/u+4,s=0===u?0:u/a;return c<0&&(c+=6),c*=60,s*=100,a*=100/255,{h:c,s,v:a}}(p(n))}function w(n){return i(n)?n:function(n){return m(b(n))}(p(n))}function x(n){return f(n)?n:function(n){return function(n){const t=n.l,r=n.a,o=n.b,e=Math.sqrt(r*r+o*o);let u=Math.atan2(o,r);return u=u>0?u:u+2*Math.PI,{l:t,c:e,h:u}}(m(b(n)))}(p(n))}function j(n){return v(n).isBright?"light":"dark"}function v(t){let{r,g:o,b:e,a:u}=t;return u<1&&(r=Math.round(u*r+255*(1-u)),o=Math.round(u*o+255*(1-u)),e=Math.round(u*e+255*(1-u))),new n({r,g:o,b:e})}function y(n,t){const{r,g:o,b:e}=t?.ignoreAlpha?n:v(n);return.2126*r+.7152*o+.0722*e}function z(t,r=225){return y(t,{ignoreAlpha:!0})>r?new n([0,0,0,t.a]):new n([255,255,255,t.a])}function A(n,t){const r=w(n);r.l*=1-t;const o=p(r),e=n.clone();return e.setColor(o),e.a=n.a,e}function B(n,t){const r=n.clone();return r.a*=t,r}function C(n,t){const r=k(n);r.s*=t;const o=p(r),e=n.clone();return e.setColor(o),e.a=n.a,e}function U(t){return n.toUnitRGBA(t)}function q(n,t){return n===t||null!=n&&n.equals(t)}function G(n,t){return n===t||null!=n&&null!=t&&u(n,t)}function R(n){return a(n[0],n[1],n[2],n.length>3?n[3]:1)}function E(n){return n[0]??=0,n[1]??=0,n[2]??=0,n}function I(n){return n.length=4,E(n),n[3]??=1,e(n[3],0,1),n}function P(t,r){const o=n.toUnitRGBA(t);return o[3]*=r,o}function D(o,e,u={}){if(0===o.length||e<=0)return[];if(1===(o=o.map(t=>"string"==typeof t?new n(t):t)).length||1===e){const n=[],t=o[0];for(let r=0;r<e;r++)n.push(t.clone());return n}if(u.shuffle&&(o=t(r(o),u.seed)),o.length>=e){const n=[],t=(o.length-1)/(e-1);for(let r=0;r<e;r++){const e=Math.round(r*t);n.push(o[e].clone())}return n}return function(n,r,o={}){const e=[],u=n.length-1,a=Math.ceil((r-n.length)/u);n:for(let t=0;t<u;t++){const u=n[t],c=n[t+1];for(let t=1;t<=a;t++){const s=t/(a+1);if(e.push(H(u,c,s,o)),e.length+n.length===r)break n}}return[...n.map(n=>n.clone()),...t(e,o.seed??1)]}(o,e,u)}const F=(n,t)=>{const r=Math.floor(10*t())-5;return Math.min(255,Math.max(0,n+r))};function H(t,r,e,u={}){const a=t.r,c=t.g,s=t.b,i=r.r,f=r.g,h=r.b,l=Math.round(a+(i-a)*e),g=Math.round(c+(f-c)*e),b=Math.round(s+(h-s)*e);if(!u.offset)return new n([l,g,b]);const M=o(u.seed);return new n([F(l,M),F(g,M),F(b,M)])}export{k as a,w as b,x as c,D as d,j as e,z as f,y as g,C as h,c as i,R as j,P as k,A as l,B as m,G as n,E as o,q as p,p as t,U as u,I as v};
