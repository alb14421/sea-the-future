/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{c as t}from"./mathUtils.js";import{d as n,h as r,i as o,j as s,c,g as e,n as u,k as a,e as i}from"./vec3.js";import{c as f}from"./vec3f64.js";import{s as g,a as h,p as m}from"./vector.js";import{t as l}from"./mathUtils2.js";function M(t=V){return[t[0],t[1],t[2],t[3]]}function p(t=V[0],n=V[1],r=V[2],o=V[3]){return b(t,n,r,o,h.get())}function j(t,n){return b(n[0],n[1],n[2],n[3],t)}function v(t){return t}function b(t,n,r,o,s=M()){return s[0]=t,s[1]=n,s[2]=r,s[3]=o,s}function d(t,n,r){return i(r,t),r[3]=n,r}function y(t,n,r){const o=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],s=Math.abs(o-1)>1e-5&&o>1e-12?1/Math.sqrt(o):1;return r[0]=n[0]*s,r[1]=n[1]*s,r[2]=n[2]*s,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function q(t,n,r,o=M()){const s=r[0]-n[0],c=r[1]-n[1],e=r[2]-n[2],u=t[0]-n[0],a=t[1]-n[1],i=t[2]-n[2],f=c*i-e*a,g=e*u-s*i,h=s*a-c*u,m=f*f+g*g+h*h,l=Math.abs(m-1)>1e-5&&m>1e-12?1/Math.sqrt(m):1;return o[0]=f*l,o[1]=g*l,o[2]=h*l,o[3]=-(o[0]*t[0]+o[1]*t[1]+o[2]*t[2]),o}function x(t,o,s,c=0,a=Math.floor(s*(1/3)),i=Math.floor(s*(2/3))){if(s<3)return!1;o(w,c);let f=a,g=!1;for(;f<s-1&&!g;)o(z,f),f++,g=!e(w,z);if(!g)return!1;for(f=Math.max(f,i),g=!1;f<s&&!g;)o(A,f),f++,r(B,w,z),u(B,B),r(C,z,A),u(C,C),g=!e(w,A)&&!e(z,A)&&Math.abs(n(B,C))<U;return g?(q(w,z,A,t),!0):(0!==c||1!==a||2!==i)&&x(t,o,s,0,1,2)}function k(t,n,r=!0){const o=n.length/3;return x(t,(t,r)=>a(t,n[3*r+0],n[3*r+1],n[3*r+2]),r?o-1:o)}const U=.99619469809,w=f(),z=f(),A=f(),B=f(),C=f();function D(t,r,o){return r!==t&&j(t,r),t[3]=-n(t,o),t}function E(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function F(t,n,r,o){return c(A,n,t),y(r,A,o)}function G(t,n,o,s){return S(T(t,n,r(g.get(),o,n),W,s))}function H(t,n,r){return null!=n&&S(T(t,n.origin,n.direction,X,r))}function I(t,n,r){return S(T(t,n.origin,n.vector,0,r))}function J(t,n,r){return S(T(t,n.origin,n.vector,1,r))}function K(t,n){return R(t,n)>=0}function L(t,r){const o=n(t,r.ray.direction),s=-R(t,r.ray.origin);if(s<0&&o>=0)return!1;if(o>-1e-6&&o<1e-6)return s>0;if((s<0||o<0)&&!(s<0&&o<0))return!0;const c=s/o;return o>0?c<r.c1&&(r.c1=c):c>r.c0&&(r.c0=c),r.c0<=r.c1}function N(t,r){const o=n(t,r.ray.direction),s=-R(t,r.ray.origin);if(o>-1e-6&&o<1e-6)return s>0;const c=s/o;return o>0?c<r.c1&&(r.c1=c):c>r.c0&&(r.c0=c),r.c0<=r.c1}function O(t,c,e){const u=o(g.get(),t,-t[3]),a=function(t,s,c){const e=o(g.get(),t,n(t,s));return r(c,s,e),c}(t,r(g.get(),c,u),g.get());return s(e,a,u),e}function P(t,n,o,s){const c=t,e=g.get(),u=g.get();l(c,e,u);const i=r(g.get(),o,n),f=m(e,i),h=m(u,i),M=m(c,i);return a(s,f,h,M)}function Q(t,n){return Math.abs(R(t,n))}function R(t,r){return n(t,r)+t[3]}function S(t){return 0===t||1===t}function T(r,c,e,u,a){const i=n(r,e),f=R(r,c);if(0===i)return f>=0?2:3;let g=-f/i;return 1&u&&(g=t(g,0,1)),!(4&u)&&g<0||!(8&u)&&g>1?f>=0?2:3:(s(a,c,o(a,e,g)),f>=0?0:1)}const V=[0,0,1,0],W=12,X=8;export{j as a,F as b,M as c,b as d,I as e,y as f,v as g,J as h,H as i,K as j,x as k,q as l,P as m,N as n,R as o,O as p,L as q,k as r,D as s,G as t,Q as u,E as v,p as w,T as x,d as y};
