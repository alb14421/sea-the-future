/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{g as t}from"../core/Accessor.js";import{L as i}from"../chunks/Logger.js";import{property as r}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import{subclass as s}from"../core/accessorSupport/decorators/subclass.js";import o from"./Widget.js";import{g as n}from"../chunks/globalCss.js";import{l as a}from"../chunks/legacyIcon.js";import"../chunks/widgetUtils.js";import{m as l}from"../chunks/messageBundle.js";import{t as c}from"../chunks/jsxFactory.js";import p from"./Swipe/SwipeViewModel.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/Lifecycle.js";import"../chunks/metadata.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/promiseUtils.js";import"../core/Error.js";import"../chunks/object.js";import"../chunks/events.js";import"../chunks/SetUtils.js";import"../chunks/SimpleTrackingTarget.js";import"../config.js";import"../chunks/string.js";import"../chunks/ensureType.js";import"../chunks/MapUtils.js";import"../chunks/Warning.js";import"../intl.js";import"../chunks/date.js";import"../chunks/jsonMap.js";import"../chunks/locale.js";import"../chunks/constants.js";import"../chunks/datetime.js";import"../chunks/number.js";import"../chunks/substitute.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/jsonUtils.js";import"../chunks/persistableUrlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Promise.js";import"../core/reactiveUtils.js";import"../chunks/uuid.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/projector.js";import"../chunks/sanitizerUtils.js";import"../chunks/componentsUtils.js";import"../chunks/jsxWidgetSupport.js";import"../core/Collection.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../chunks/ClipRect.js";import"../core/JSONSupport.js";const d="esri-swipe",h={base:d,baseDisabled:`${d}--disabled`,vertical:`${d}--vertical`,horizontal:`${d}--horizontal`,container:`${d}__container`,divider:`${d}__divider`,handle:`${d}__handle`,handleHidden:`${d}__handle--hidden`,handleIcon:`${d}__handle-icon`},m={handle:!0,divider:!0};let u=class extends o{constructor(e,r){super(e,r),this.disabled=!1,this.messages=null,this.viewModel=new p,this._pointerOffset=0,this._container=null,t(i.getLogger(this),"Swipe","arcgis-swipe",{version:"4.32"}),this._onContainerPointerDown=this._onContainerPointerDown.bind(this),this._onContainerPointerMove=this._onContainerPointerMove.bind(this),this._onContainerPointerUp=this._onContainerPointerUp.bind(this)}get direction(){return this.viewModel.direction}set direction(e){this.viewModel.direction=e}get dragLabel(){return this.messages?.dragLabel??""}set dragLabel(e){this._overrideIfSome("dragLabel",e)}get icon(){return"compare"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get leadingLayers(){return this.viewModel.leadingLayers}set leadingLayers(e){this.viewModel.leadingLayers=e}get position(){return this.viewModel.position}set position(e){this.viewModel.position=e}get trailingLayers(){return this.viewModel.trailingLayers}set trailingLayers(e){this.viewModel.trailingLayers=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set visibleElements(e){this._set("visibleElements",{...m,...e})}get visibleElements(){return this._get("visibleElements")||m}render(){const{state:e,direction:t}=this.viewModel,i="disabled"===e||this.disabled,r={[n.disabled]:i,[h.baseDisabled]:i,[h.vertical]:"vertical"===t,[h.horizontal]:"horizontal"===t};return c("div",{class:this.classes(h.base,n.widget,r)},"disabled"===e?null:this._renderContainer())}_renderHandle(){const{direction:e}=this.viewModel,{visibleElements:t}=this,i={[a.dragHorizontal]:"vertical"===e,[a.dragVertical]:"horizontal"===e},r=this.classes(h.handle,!t.handle&&h.handleHidden);return c("div",{class:r,key:"handle",role:"presentation"},c("span",{"aria-hidden":"true",class:this.classes(h.handleIcon,i)}))}_renderDivider(){const{visibleElements:e}=this;return e&&e.divider?c("div",{class:h.divider,key:"divider",role:"presentation"}):null}_renderContent(){return[this._renderDivider(),this._renderHandle()]}_renderContainer(){const{disabled:e,dragLabel:t,viewModel:i}=this,{max:r,min:s,direction:o,position:n}=i,a=`${n}%`,l={top:"vertical"===o?a:void 0,left:"vertical"===o?void 0:a},p=this._renderContent();return c("div",e?{class:h.container,key:"container",role:"presentation",styles:l}:{afterCreate:this._afterContainerCreate,"aria-label":t,"aria-orientation":o,"aria-valuemax":`${r}`,"aria-valuemin":`${s}`,"aria-valuenow":`${n}`,"aria-valuetext":a,bind:this,class:h.container,key:"container",onkeydown:this._onContainerKeyDown,role:"slider",styles:l,tabIndex:0,title:t,"touch-action":"none"},p)}_afterContainerCreate(e){this._container=e,e.addEventListener("pointerdown",this._onContainerPointerDown)}_calculatePointerOffset(e){const{direction:t}=this,i=e.target,r=("vertical"===t?i.clientHeight:i.clientWidth)/2,s=i.getBoundingClientRect(),o=e.clientX-s.left,n=e.clientY-s.top;this._pointerOffset="vertical"===t?n-r:o-r}_onContainerPointerDown(e){e.preventDefault(),this._container&&document.activeElement!==this.container&&this._container.focus(),this._calculatePointerOffset(e),document.addEventListener("pointerup",this._onContainerPointerUp),document.addEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerUp(e){e.preventDefault(),document.removeEventListener("pointerup",this._onContainerPointerUp),document.removeEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerMove(e){e.preventDefault();const{_pointerOffset:t,container:i,direction:r}=this,{clientX:s,clientY:o}=e,{top:n,left:a,width:l,height:c}=i.getBoundingClientRect(),p=("vertical"===r?o-n-t:s-a-t)/("vertical"===r?c:l)*100;this.position=p}_getKeyPosition(e){const{key:t}=e,{position:i}=this,{max:r,min:s,step:o,stepMultiplier:n,direction:a}=this.viewModel,l=o*n;return["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].includes(t)&&(e.preventDefault(),e.stopPropagation()),("vertical"===a?"ArrowDown"===t||"ArrowRight"===t:"ArrowUp"===t||"ArrowRight"===t)?i+(e.shiftKey?l:o):("vertical"===a?"ArrowUp"===t||"ArrowLeft"===t:"ArrowDown"===t||"ArrowLeft"===t)?i-(e.shiftKey?l:o):"Home"===t?s:"End"===t?r:("vertical"===a?"PageDown"===t:"PageUp"===t)?i+l:("vertical"===a?"PageUp"===t:"PageDown"===t)?i-l:null}_onContainerKeyDown(e){const t=this._getKeyPosition(e);"number"==typeof t&&(this.position=t)}};e([r()],u.prototype,"direction",null),e([r()],u.prototype,"disabled",void 0),e([r()],u.prototype,"dragLabel",null),e([r()],u.prototype,"icon",null),e([r()],u.prototype,"label",null),e([r()],u.prototype,"leadingLayers",null),e([r(),l("esri/widgets/Swipe/t9n/Swipe")],u.prototype,"messages",void 0),e([r()],u.prototype,"position",null),e([r()],u.prototype,"trailingLayers",null),e([r()],u.prototype,"view",null),e([r({type:p})],u.prototype,"viewModel",void 0),e([r()],u.prototype,"visibleElements",null),u=e([s("esri.widgets.Swipe")],u);const v=u;export{v as default};
