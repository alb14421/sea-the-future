/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import{g as t}from"../../chunks/assets.js";import s from"../../Graphic.js";import o from"../../PopupTemplate.js";import{i as r}from"../../core/lang.js";import i from"../../core/Collection.js";import l from"../../core/Error.js";import{EventedAccessor as n}from"../../core/Evented.js";import{L as a}from"../../chunks/Logger.js";import{m as u}from"../../chunks/maybe.js";import{eachAlways as p,after as c}from"../../core/promiseUtils.js";import{watch as m,initial as h,whenOnce as g}from"../../core/reactiveUtils.js";import{property as d}from"../../core/accessorSupport/decorators/property.js";import{subclass as y}from"../../core/accessorSupport/decorators/subclass.js";import j from"../../geometry/Point.js";import f from"../../geometry/SpatialReference.js";import{g as S,a as b}from"../../chunks/geometryUtils2.js";import{o as _}from"../../chunks/locale.js";import{f as v}from"../../chunks/messages.js";import w from"../../portal/Portal.js";import{f as k}from"../../request.js";import L from"../../symbols/PictureMarkerSymbol.js";import x from"../../symbols/SimpleFillSymbol.js";import I from"../../symbols/SimpleLineSymbol.js";import T from"../../symbols/TextSymbol.js";import{h as P}from"../../chunks/layerViewUtils.js";import F from"./LayerSearchSource.js";import E,{i as R,m as C,a as D,b as M}from"./LocatorSearchSource.js";import U from"./SearchSource.js";import{s as O,g as A,p as G}from"../../chunks/geolocationUtils.js";import{GoTo as N}from"../support/GoTo.js";import"../../config.js";import"../../chunks/object.js";import"../../core/urlUtils.js";import"../../chunks/jsonUtils.js";import"../../core/Clonable.js";import"../../core/Accessor.js";import"../../core/Handles.js";import"../../chunks/get.js";import"../../chunks/utils.js";import"../../chunks/handleUtils.js";import"../../chunks/Lifecycle.js";import"../../chunks/metadata.js";import"../../chunks/ObjectPool.js";import"../../chunks/ObservableBase.js";import"../../chunks/tracking.js";import"../../chunks/watch.js";import"../../core/scheduling.js";import"../../chunks/nextTick.js";import"../../chunks/PooledArray.js";import"../../chunks/SetUtils.js";import"../../chunks/SimpleTrackingTarget.js";import"../../chunks/ensureType.js";import"../../chunks/MapUtils.js";import"../../chunks/events.js";import"../../chunks/string.js";import"../../chunks/Warning.js";import"../../core/JSONSupport.js";import"../../geometry/support/jsonUtils.js";import"../../geometry/Extent.js";import"../../geometry/Geometry.js";import"../../chunks/reader.js";import"../../chunks/unitUtils.js";import"../../chunks/jsonMap.js";import"../../chunks/pe.js";import"../../kernel.js";import"../../chunks/persistableUrlUtils.js";import"../../chunks/writer.js";import"../../geometry/support/webMercatorUtils.js";import"../../geometry/Multipoint.js";import"../../chunks/zmUtils.js";import"../../core/accessorSupport/decorators/cast.js";import"../../geometry/Polygon.js";import"../../chunks/coordsUtils.js";import"../../chunks/extentUtils.js";import"../../chunks/boundsUtils.js";import"../../chunks/aaBoundingRect.js";import"../../chunks/mathUtils.js";import"../../geometry/Polyline.js";import"../../chunks/typeUtils.js";import"../../chunks/createFeatureId.js";import"../../chunks/typeUtils2.js";import"../../symbols/CIMSymbol.js";import"../../chunks/enumeration.js";import"../../layers/support/fieldUtils.js";import"../../core/sql.js";import"../../chunks/guards.js";import"../../chunks/datetime.js";import"../../symbols/Symbol.js";import"../../Color.js";import"../../chunks/colorUtils.js";import"../../symbols/LabelSymbol3D.js";import"../../symbols/Symbol3D.js";import"../../chunks/collectionUtils.js";import"../../symbols/ExtrudeSymbol3DLayer.js";import"../../symbols/Symbol3DLayer.js";import"../../chunks/utils3.js";import"../../symbols/edges/Edges3D.js";import"../../chunks/screenUtils.js";import"../../chunks/materialUtils.js";import"../../chunks/opacityUtils.js";import"../../symbols/edges/SketchEdges3D.js";import"../../symbols/edges/SolidEdges3D.js";import"../../chunks/Symbol3DMaterial.js";import"../../symbols/FillSymbol3DLayer.js";import"../../symbols/patterns/LineStylePattern3D.js";import"../../symbols/patterns/StylePattern3D.js";import"../../chunks/utils4.js";import"../../chunks/colors.js";import"../../chunks/symbolLayerUtils3D.js";import"../../chunks/vec3f64.js";import"../../chunks/aaBoundingBox.js";import"../../chunks/DoubleArray.js";import"../../symbols/IconSymbol3DLayer.js";import"../../symbols/LineSymbol3DLayer.js";import"../../symbols/LineStyleMarker3D.js";import"../../chunks/lineMarkers.js";import"../../symbols/ObjectSymbol3DLayer.js";import"../../symbols/PathSymbol3DLayer.js";import"../../symbols/TextSymbol3DLayer.js";import"../../symbols/Font.js";import"../../symbols/WaterSymbol3DLayer.js";import"../../symbols/support/StyleOrigin.js";import"../../core/Loadable.js";import"../../core/Promise.js";import"../../portal/PortalGroup.js";import"../../portal/PortalQueryParams.js";import"../../portal/PortalQueryResult.js";import"../../portal/PortalUser.js";import"../../portal/PortalFolder.js";import"../../chunks/Thumbnail.js";import"../../chunks/shared.js";import"../../chunks/SimpleObservable.js";import"../../chunks/calloutUtils.js";import"../../symbols/callouts/Callout3D.js";import"../../symbols/callouts/LineCallout3D.js";import"../../symbols/support/Symbol3DVerticalOffset.js";import"../../symbols/LineSymbol3D.js";import"../../symbols/MeshSymbol3D.js";import"../../symbols/PictureFillSymbol.js";import"../../symbols/FillSymbol.js";import"../../symbols/LineSymbol.js";import"../../symbols/LineSymbolMarker.js";import"../../chunks/urlUtils.js";import"../../symbols/PointSymbol3D.js";import"../../symbols/PolygonSymbol3D.js";import"../../symbols/SimpleMarkerSymbol.js";import"../../symbols/MarkerSymbol.js";import"../../symbols/WebStyleSymbol.js";import"../../popup/content.js";import"../../popup/content/AttachmentsContent.js";import"../../popup/content/Content.js";import"../../popup/support/AttachmentsOrderByInfo.js";import"../../popup/content/CustomContent.js";import"../../popup/content/ExpressionContent.js";import"../../popup/ElementExpressionInfo.js";import"../../popup/content/FieldsContent.js";import"../../popup/FieldInfo.js";import"../../popup/support/FieldInfoFormat.js";import"../../chunks/date.js";import"../../chunks/constants.js";import"../../popup/content/MediaContent.js";import"../../popup/content/BarChartMediaInfo.js";import"../../popup/content/mixins/ChartMediaInfo.js";import"../../popup/content/mixins/MediaInfo.js";import"../../popup/content/support/ChartMediaInfoValue.js";import"../../popup/content/support/ChartMediaInfoValueSeries.js";import"../../chunks/chartMediaInfoUtils.js";import"../../popup/content/ColumnChartMediaInfo.js";import"../../popup/content/ImageMediaInfo.js";import"../../popup/content/support/ImageMediaInfoValue.js";import"../../popup/content/LineChartMediaInfo.js";import"../../popup/content/PieChartMediaInfo.js";import"../../popup/content/RelationshipContent.js";import"../../popup/support/RelatedRecordsInfoFieldOrder.js";import"../../popup/content/TextContent.js";import"../../popup/content/UtilityNetworkAssociationsContent.js";import"../../popup/support/UtilityNetworkAssociationType.js";import"../../popup/ExpressionInfo.js";import"../../popup/LayerOptions.js";import"../../popup/RelatedRecordsInfo.js";import"../../support/actions/ActionBase.js";import"../../core/Identifiable.js";import"../../support/actions/ActionButton.js";import"../../support/actions/ActionToggle.js";import"../../chunks/scaleUtils.js";import"../../intl.js";import"../../chunks/number.js";import"../../chunks/substitute.js";import"../../chunks/FullTextSearch.js";import"../../chunks/suggestLocations.js";import"../../chunks/utils9.js";import"../../rest/support/AddressCandidate.js";import"../../chunks/commonProperties3.js";import"../../chunks/project.js";import"../../chunks/utils10.js";import"../../rest/support/ProjectParameters.js";import"../../chunks/goToUtils.js";function B(e,t){return e.hasOwnProperty(t)&&null!=e[t]&&""!==e[t]}const V="highlight",J=i.ofType({key:e=>e.layer?"layer":"locator",base:U,typeMap:{layer:F,locator:E}}),H=f.WGS84,Q=/<[\s\S]*?>/g,q=-1;let W=class extends(N(n)){constructor(e){super(e),this._gotoController=null,this._searching=null,this._updatingPromise=null,this._createdFeatureLayers=[],this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new J,this.defaultSymbols={point:new L({url:t("esri/images/search/search-symbol-32.png"),size:24,width:24,height:24}),polyline:new I({color:[130,130,130,1],width:2}),polygon:new x({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=w.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new J,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){const e=async()=>{const e=await v("esri/widgets/Search/t9n/Search");this.messages=e,this.defaultPopupTemplate=new o({title:e.searchResult,content:"{Match_addr}"})};e(),this.addHandles([m(()=>[this.includeDefaultSources,this.view,this.portal],()=>this._update(),h),_(e)])}destroy(){this._destroyFeatureLayers(),this._abortGoTo(),this.clearGraphics()}static{this.ALL_INDEX=q}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return 1!==this.allSources.length&&this.searchAllEnabled?q:0}set activeSourceIndex(e){this._overrideIfSome("activeSourceIndex",e)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(e){this._overrideIfSome("allPlaceholder",e)}get allSources(){const{sources:e,defaultSources:t,includeDefaultSources:s}=this,o="function"==typeof s?s.call(null,{sources:e,defaultSources:t}):s?t.concat(e):e,r=this._get("allSources")||new J;return r.removeAll(),r.addMany(o.filter(Boolean)),r}get locationEnabled(){return this._get("locationEnabled")||O()}set locationEnabled(e){if(void 0===e)return void this._clearOverride("locationEnabled");const t=O();if(e&&!t){const e=new l("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});a.getLogger(this).error(e)}this._override("locationEnabled",!!e&&t)}get placeholder(){const{allSources:e,activeSourceIndex:t,allPlaceholder:s}=this;if(t===q)return s??"";const o=e.at(t);return o?.placeholder??""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),""===e&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup();const{view:e,resultGraphic:t}=this;e&&t&&e.graphics.remove(t),this._set("resultGraphic",null)}search(e,t){this.emit("search-start"),this.clearGraphics();const s=this._createSuggestionForSearch(e),o=(async()=>{try{await this.when();const e=await this._getResultsFromSources(s,t);if(t?.signal?.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:s.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(o,e,s);const r=this._getFirstResult(o.results),i=s.location&&r?r.name:s.text,l=i?.replace(Q,"");return this._set("searchTerm",l),(s.key&&"number"==typeof s.sourceIndex||s.location)&&this._set("selectedSuggestion",s),this._set("results",o.results),this._set("resultCount",o.results.reduce((e,t)=>e+(t.results?.length??0),0)),this.emit("search-complete",o),await this._selectFirstResult(r),o}finally{this._clearSearching()}})();return this._searching=o,o}async searchNearby(e){if(!this.locationEnabled){const e=new l("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});throw a.getLogger(this).error(e),e}const t=(async()=>{try{const t=await A(),s=await G({position:t,view:this.view},e);return await this.search(s,e)}finally{this._clearSearching()}})();return this._searching=t,t}async select(e){if(this.clearGraphics(),!e){const t=new l("select:missing-parameter","Cannot select without a searchResult.",{searchResult:e});throw a.getLogger(this).error(t),t}const{view:t}=this,o=B(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),r=null!=o?this.allSources.at(o):null;if(!r){const e=new l("select:missing-source","Cannot select without a source.",{source:r});throw a.getLogger(this).error(e),e}const i=r instanceof F?this._getLayerSourcePopupTemplate(r):r.popupTemplate,n=r.resultSymbol||this._getDefaultSymbol(e),u=B(r,"resultGraphicEnabled")?r.resultGraphicEnabled:this.resultGraphicEnabled,c=B(r,"autoNavigate")?r.autoNavigate:this.autoNavigate,m=B(r,"popupEnabled")?r.popupEnabled:this.popupEnabled,h=m?i||this.popupTemplate||this.defaultPopupTemplate:null,{feature:g}=e;if(!g){const e=new l("select:missing-feature","Cannot select without a feature.",{feature:g});throw a.getLogger(this).error(e),e}const{attributes:d,geometry:y,layer:j,sourceLayer:f}=g,_=y?S(y):null,v={layerViewQuery:this._getLayerView(g),elevationQuery:t&&null!=_?b(_,t):Promise.resolve(_)},w=await p(v),k=w.layerViewQuery.value,L=w.elevationQuery.value;n instanceof T&&(n.text=e.name);const x=t&&c?e.target||e.extent:null,I=null!=x?this._goToSearchResult(x):Promise.resolve();await I;const E=k?g:new s({geometry:y,symbol:n,attributes:d,layer:j,sourceLayer:f,popupTemplate:h}),R=t?.popup,C=R&&m&&E.getEffectivePopupTemplate(R.defaultPopupTemplateEnabled);return C&&await t.openPopup({features:[E],location:L}),k&&P(k)&&!C&&this._highlightFeature({graphic:E,layerView:k}),!k&&u&&t&&t.graphics.push(E),this._setResultFloor(e),this._set("selectedResult",e),this._set("resultGraphic",E),this.emit("select-result",{result:e,source:r,sourceIndex:o}),e}async suggest(e,t,s){const o=e||this.searchTerm;this.emit("suggest-start",{searchTerm:o}),await this._suggestTimer(t,s);const r=await this._suggestImmediate(o,s);return this._set("suggestions",r?.results),this._set("suggestionCount",r?.results.reduce((e,t)=>e+(t.results?.length??0),0)??null),this.emit("suggest-complete",r),r}async when(){await g(()=>!this.updating)}async _update(){const{portal:e,view:t}=this;if(this.includeDefaultSources){const s=this._updatingPromise=p([e?.load(),t?.when()]);if(this.destroyed)return;if(await s,s!==this._updatingPromise)return}await g(()=>this.messages),this.destroyed||this._updateDefaultSources(),this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const e=this.portal?.helperServices?.geocode;return e?e.map(e=>{if(!1===e.placefinding)return;const t=R(e.url)&&k(e.url)?{url:C}:null,s=E.fromJSON({...e,...t}),o=s.url;if(R(o)||D(o)||M(o)){const e=s.outFields??["Addr_type","Match_addr","StAddr","City"],t=(s.placeholder||this.messages?.placeholder)??"",o="number"==typeof s.defaultZoomScale?s.defaultZoomScale:2500;s.singleLineFieldName="SingleLine",s.outFields=e,s.placeholder=t,s.defaultZoomScale=o}return s.singleLineFieldName?s:void 0}).filter(r):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(e=>e?.destroy()),this._createdFeatureLayers=[]}_getLayerSources(e,t){const s=this.view?.map;return e.map(e=>{const o=s.findLayerById(e.id);if(!o)return;const r=this._getLayerJSON(e),i=F.fromJSON(r);return i.placeholder=t,this._getLayer(o,r).then(e=>{i.layer=e}),i}).filter(r).toArray()}_getTableSources(e,t){const s=this.view?.map;return e.map(e=>{if(!e.id)return;const o=s.findTableById(e.id);if(!o)return;const r=this._getLayerJSON(e),i=F.fromJSON(r);return i.placeholder=t,this._getLayer(o,r).then(e=>{i.layer=e}),i}).filter(r).toArray()}_convertApplicationProperties(){const e=this.view?.map,t=e?.applicationProperties?.viewing?.search;if(!t)return[];const{enabled:s,hintText:o,layers:r,tables:i}=t;return s?[...this._getLayerSources(r,o),...this._getTableSources(i,o)]:[]}async _getSubLayer(e,t){if(await e.load(),!e.allSublayers)throw new Error;const s=e.allSublayers.find(e=>e.id===t.subLayer);if(!s)throw new Error;const o=await(s.createFeatureLayer?.());if(!o)throw new Error;return this._createdFeatureLayers.push(o),o}async _getBuildingSubLayer(e,t){await e.load();const s=e.allSublayers.find(e=>e.id===t.subLayer);if("building-component"!==s?.type)throw new Error;if(await s.load(),null==s.associatedLayer)throw new Error;return await s.associatedLayer.load(),s}async _getLayer(e,t){if("feature"===e.type||"scene"===e.type||"csv"===e.type||"geojson"===e.type||"ogc-feature"===e.type)return e;if("map-image"===e.type)try{return await this._getSubLayer(e,t)}catch(t){const s=new l("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return a.getLogger(this).error(s),null}return"building-scene"===e.type?this._getBuildingSubLayer(e,t):null}_getLayerJSON(e){return"function"==typeof e.toJSON?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:t}=this;this._destroyFeatureLayers(),e.removeAll(),t&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){const e=this.view?.popup,{resultGraphic:t}=this;if(!e||!t)return;const s="selectedFeature"in e,o=s?e.selectedFeature:null;s&&o&&o===t&&e.close()}_suggestTimer(e,t){const s=null!=e?e:this.suggestionDelay;return c(s,null,t?.signal)}_createLocationForSearch(e){return e instanceof s&&e.geometry?S(e.geometry):e instanceof j?e:Array.isArray(e)&&2===e.length?new j({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&B(e,"key")&&B(e,"text")&&B(e,"sourceIndex"))return e;const t=this._createLocationForSearch(e),s="string"==typeof e?e:this.searchTerm,{selectedSuggestion:o,selectedResult:r}=this,i=!e&&o&&r,l=i&&o.key===r.key&&o.sourceIndex===r.sourceIndex,n=i&&o.location;return l||n?o:{location:t,text:t?"":s,sourceIndex:null,key:null}}_getFirstResult(e){return u(e,({results:e})=>e?.[0])??null}async _selectFirstResult(e){return this.autoSelect&&e?this.select(e):null}async _suggestImmediate(e,t){await this.when();const s=await this._getSuggestionsFromSources(e,t);if(t?.signal?.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:e??"",numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(o,s),o}_formatSourceResponse(e,t,s){const o=t?.value||[],r=t?.error,i=this.allSources.at(s);if(r){const t={sourceIndex:s,source:i,error:r};e.errors.push(t),a.getLogger(this).error(r),e.numErrors++}else{const t={sourceIndex:s,source:i,results:o};e.results.push(t),e.numResults+=o.length}}_formatResponse(e,t,s){if(t)if(e.activeSourceIndex===q){const o=s&&B(s,"sourceIndex")&&-1!==s.sourceIndex?s.sourceIndex:void 0;t.forEach((t,s)=>{const r=void 0!==o?o:s;this._formatSourceResponse(e,t,r)})}else this._formatSourceResponse(e,t[0],e.activeSourceIndex)}async _getResultsFromSources(e,t){const{allSources:s}=this,o=!e.location&&B(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,r=[];if(!s.length){const e=new l("search:no-sources-defined","At least one source is required.",{allSources:s});throw a.getLogger(this).error(e),e}return o===q?s.forEach((s,o)=>{r.push(this._getResultsFromSource(e,o,t))}):r.push(this._getResultsFromSource(e,o,t)),p(r)}async _getSuggestionsFromSources(e,t){const{allSources:s,activeSourceIndex:o}=this,r=[];if(!s.length){const e=new l("suggest:no-sources-defined","At least one source is required.",{allSources:s});throw a.getLogger(this).error(e),e}return o===q?s.forEach((s,o)=>{r.push(this._getSuggestionsFromSource(e,o,t))}):r.push(this._getSuggestionsFromSource(e,o,t)),p(r)}async _getResultsFromSource(e,t,s){const o=null!=t?this.allSources.at(t):null;if(!o)return null;const{location:r=null}=e,i=this.view?.spatialReference??H,l=B(o,"maxResults")?o.maxResults:this.maxResults,n=!!(o instanceof F&&B(o,"exactMatch"))&&o.exactMatch,{view:a}=this;return o.getResults?.({exactMatch:n,location:r,maxResults:l,sourceIndex:t,spatialReference:i,suggestResult:e,view:a},s)}async _getSuggestionsFromSource(e,t,s){const o=this.allSources.at(t);if(!o)return null;e??="";const r=B(o,"suggestionsEnabled")?o.suggestionsEnabled:this.suggestionsEnabled,i=e?.length,l=B(o,"minSuggestCharacters")?o.minSuggestCharacters:this.minSuggestCharacters;if(r&&e.trim()&&i>=l){const r=this.view?.spatialReference||H,i=B(o,"maxSuggestions")?o.maxSuggestions:this.maxSuggestions,{view:l}=this,n=!!(o instanceof F&&B(o,"exactMatch"))&&o.exactMatch;return o.getSuggestions?.({view:l,sourceIndex:t,suggestTerm:e,spatialReference:r,maxSuggestions:i,exactMatch:n},s)}return null}_getLayerSourcePopupTemplate(e){const{layer:t}=e;if(t)return B(e,"popupTemplate")?e.popupTemplate:t.popupTemplate}_getSourceIndexOfResult(e){return u(this.results??[],({results:t,sourceIndex:s})=>{const o=t?.includes(e);return o?s:null})??null}async _goToSearchResult(e){this._abortGoTo();const t=new AbortController;this._gotoController=t;const s={target:{target:e},options:{signal:t.signal}};e||(s.options.animate=!1),await this.callGoTo(s),this._gotoController=null}_getDefaultSymbol(e){const{defaultSymbols:t}=this,s=e.feature?.geometry;if(null==s)return null;switch(s.type){case"point":case"multipoint":return t.point;case"polyline":return t.polyline;case"extent":case"polygon":return t.polygon;default:return null}}_removeHighlight(){this.removeHandles(V)}async _getLayerView(e){const{view:t}=this;if(!e||!t)return null;const{layer:s,sourceLayer:o}=e,r=s??o;return r&&"building-component"!==r.type&&"subtype-sublayer"!==r.type?(await t.when(),t.whenLayerView(r)):null}_highlightFeature(e){const{graphic:t,layerView:s}=e,{attributes:o,layer:r,sourceLayer:i}=t,l=r??i,{objectIdField:n}=l,a=(n&&o?.[n])??null,u=s.highlight(a??t);this.addHandles(u,V)}_setResultFloor(e){const{view:t}=this,s=e.feature?.attributes,o=e.feature?.sourceLayer;if(o&&"floorInfo"in o&&o?.floorInfo?.floorField&&s){const e=s[o.floorInfo.floorField];t?.emit("select-result-floor",e)}}};e([d()],W.prototype,"_searching",void 0),e([d()],W.prototype,"_updatingPromise",void 0),e([d({readOnly:!0,value:null})],W.prototype,"activeSource",null),e([d()],W.prototype,"activeSourceIndex",null),e([d()],W.prototype,"allPlaceholder",null),e([d({readOnly:!0})],W.prototype,"allSources",null),e([d()],W.prototype,"autoNavigate",void 0),e([d()],W.prototype,"autoSelect",void 0),e([d({type:o})],W.prototype,"defaultPopupTemplate",void 0),e([d({readOnly:!0})],W.prototype,"defaultSources",void 0),e([d()],W.prototype,"defaultSymbols",void 0),e([d()],W.prototype,"includeDefaultSources",void 0),e([d()],W.prototype,"locationEnabled",null),e([d()],W.prototype,"maxInputLength",void 0),e([d()],W.prototype,"maxResults",void 0),e([d()],W.prototype,"maxSuggestions",void 0),e([d()],W.prototype,"messages",void 0),e([d()],W.prototype,"minSuggestCharacters",void 0),e([d({readOnly:!0})],W.prototype,"placeholder",null),e([d()],W.prototype,"popupEnabled",void 0),e([d({type:o})],W.prototype,"popupTemplate",void 0),e([d({type:w})],W.prototype,"portal",void 0),e([d()],W.prototype,"resultCount",void 0),e([d()],W.prototype,"resultGraphicEnabled",void 0),e([d({readOnly:!0})],W.prototype,"resultGraphic",void 0),e([d({readOnly:!0})],W.prototype,"results",void 0),e([d({readOnly:!0})],W.prototype,"selectedSuggestion",void 0),e([d()],W.prototype,"searchAllEnabled",void 0),e([d({readOnly:!0})],W.prototype,"selectedResult",void 0),e([d()],W.prototype,"searchTerm",null),e([d({type:J})],W.prototype,"sources",void 0),e([d({readOnly:!0})],W.prototype,"state",null),e([d()],W.prototype,"suggestionDelay",void 0),e([d()],W.prototype,"suggestionCount",void 0),e([d({readOnly:!0})],W.prototype,"suggestions",void 0),e([d()],W.prototype,"suggestionsEnabled",void 0),e([d({readOnly:!0})],W.prototype,"updating",null),e([d()],W.prototype,"view",void 0),e([d()],W.prototype,"clear",null),W=e([y("esri.widgets.Search.SearchViewModel")],W);const z=W;export{z as default};
