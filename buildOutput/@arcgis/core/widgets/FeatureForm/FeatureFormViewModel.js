/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import t from"../../Graphic.js";import{q as s}from"../../core/lang.js";import{EventedAccessor as i}from"../../core/Evented.js";import{L as o}from"../../chunks/Logger.js";import{d as r}from"../../chunks/maybe.js";import{EsriPromiseMixin as n}from"../../core/Promise.js";import{isAbortError as a,createResolver as l,debounce as p}from"../../core/promiseUtils.js";import{watch as u,syncAndInitial as m,whenOnce as c,on as h}from"../../core/reactiveUtils.js";import{t as d}from"../../chunks/string.js";import{property as y}from"../../core/accessorSupport/decorators/property.js";import{subclass as f}from"../../core/accessorSupport/decorators/subclass.js";import{U as j}from"../../chunks/UpdatingHandles.js";import g from"../../form/FormTemplate.js";import{g as b,a as _,c as k,h as x,i as I}from"../../chunks/formUtils.js";import{L as v,C as E}from"../../chunks/LayerContingentValuesCache.js";import{i as C}from"../../chunks/editableLayers.js";import{a as F,u as V,s as A}from"../../chunks/constants.js";import{q as S,r as U,d as w,t as T,p as L,e as M,b as R,f as P,u as D,w as O}from"../../chunks/featureFormUtils.js";import N from"./FieldInput.js";import Z from"../../core/Accessor.js";import{g as G}from"../../chunks/MapUtils.js";import H from"./GroupInput.js";import B from"./RelationshipInput.js";import W from"./TextElementInput.js";import{createArcadeProfile as $,createArcadeExecutor as z}from"../../arcade.js";import{fixFields as J}from"../../layers/support/fieldUtils.js";import"../../PopupTemplate.js";import"../../core/Clonable.js";import"../../chunks/utils.js";import"../../chunks/handleUtils.js";import"../../core/Handles.js";import"../../chunks/get.js";import"../../chunks/Lifecycle.js";import"../../chunks/metadata.js";import"../../chunks/ObjectPool.js";import"../../chunks/ObservableBase.js";import"../../chunks/tracking.js";import"../../chunks/ensureType.js";import"../../core/Error.js";import"../../chunks/object.js";import"../../config.js";import"../../chunks/watch.js";import"../../core/scheduling.js";import"../../chunks/nextTick.js";import"../../chunks/PooledArray.js";import"../../chunks/events.js";import"../../chunks/SetUtils.js";import"../../chunks/SimpleTrackingTarget.js";import"../../chunks/Warning.js";import"../../core/Collection.js";import"../../chunks/shared.js";import"../../chunks/SimpleObservable.js";import"../../chunks/jsonUtils.js";import"../../core/JSONSupport.js";import"../../core/accessorSupport/decorators/cast.js";import"../../chunks/reader.js";import"../../chunks/writer.js";import"../../popup/content.js";import"../../popup/content/AttachmentsContent.js";import"../../popup/content/Content.js";import"../../popup/support/AttachmentsOrderByInfo.js";import"../../chunks/jsonMap.js";import"../../popup/content/CustomContent.js";import"../../popup/content/ExpressionContent.js";import"../../popup/ElementExpressionInfo.js";import"../../popup/content/FieldsContent.js";import"../../popup/FieldInfo.js";import"../../chunks/enumeration.js";import"../../popup/support/FieldInfoFormat.js";import"../../chunks/date.js";import"../../chunks/locale.js";import"../../chunks/datetime.js";import"../../popup/content/MediaContent.js";import"../../popup/content/BarChartMediaInfo.js";import"../../popup/content/mixins/ChartMediaInfo.js";import"../../popup/content/mixins/MediaInfo.js";import"../../popup/content/support/ChartMediaInfoValue.js";import"../../Color.js";import"../../chunks/colorUtils.js";import"../../chunks/mathUtils.js";import"../../popup/content/support/ChartMediaInfoValueSeries.js";import"../../chunks/chartMediaInfoUtils.js";import"../../popup/content/ColumnChartMediaInfo.js";import"../../popup/content/ImageMediaInfo.js";import"../../popup/content/support/ImageMediaInfoValue.js";import"../../popup/content/LineChartMediaInfo.js";import"../../popup/content/PieChartMediaInfo.js";import"../../popup/content/RelationshipContent.js";import"../../popup/support/RelatedRecordsInfoFieldOrder.js";import"../../popup/content/TextContent.js";import"../../popup/content/UtilityNetworkAssociationsContent.js";import"../../popup/support/UtilityNetworkAssociationType.js";import"../../popup/ExpressionInfo.js";import"../../popup/LayerOptions.js";import"../../popup/RelatedRecordsInfo.js";import"../../support/actions/ActionBase.js";import"../../core/Identifiable.js";import"../../support/actions/ActionButton.js";import"../../support/actions/ActionToggle.js";import"../../core/sql.js";import"../../chunks/guards.js";import"../../geometry/support/jsonUtils.js";import"../../geometry/Extent.js";import"../../geometry/Geometry.js";import"../../geometry/SpatialReference.js";import"../../chunks/unitUtils.js";import"../../chunks/pe.js";import"../../chunks/assets.js";import"../../request.js";import"../../kernel.js";import"../../core/urlUtils.js";import"../../chunks/persistableUrlUtils.js";import"../../geometry/Point.js";import"../../geometry/support/webMercatorUtils.js";import"../../geometry/Multipoint.js";import"../../chunks/zmUtils.js";import"../../geometry/Polygon.js";import"../../chunks/coordsUtils.js";import"../../chunks/extentUtils.js";import"../../chunks/boundsUtils.js";import"../../chunks/aaBoundingRect.js";import"../../geometry/Polyline.js";import"../../chunks/typeUtils.js";import"../../chunks/createFeatureId.js";import"../../chunks/typeUtils2.js";import"../../symbols/CIMSymbol.js";import"../../symbols/Symbol.js";import"../../symbols/LabelSymbol3D.js";import"../../symbols/Symbol3D.js";import"../../chunks/collectionUtils.js";import"../../portal/Portal.js";import"../../core/Loadable.js";import"../../portal/PortalGroup.js";import"../../portal/PortalQueryParams.js";import"../../portal/PortalQueryResult.js";import"../../portal/PortalUser.js";import"../../portal/PortalFolder.js";import"../../symbols/ExtrudeSymbol3DLayer.js";import"../../symbols/Symbol3DLayer.js";import"../../chunks/utils3.js";import"../../symbols/edges/Edges3D.js";import"../../chunks/screenUtils.js";import"../../chunks/materialUtils.js";import"../../chunks/opacityUtils.js";import"../../symbols/edges/SketchEdges3D.js";import"../../symbols/edges/SolidEdges3D.js";import"../../chunks/Symbol3DMaterial.js";import"../../symbols/FillSymbol3DLayer.js";import"../../symbols/patterns/LineStylePattern3D.js";import"../../symbols/patterns/StylePattern3D.js";import"../../chunks/utils4.js";import"../../chunks/colors.js";import"../../chunks/symbolLayerUtils3D.js";import"../../chunks/vec3f64.js";import"../../chunks/aaBoundingBox.js";import"../../chunks/DoubleArray.js";import"../../symbols/IconSymbol3DLayer.js";import"../../symbols/LineSymbol3DLayer.js";import"../../symbols/LineStyleMarker3D.js";import"../../chunks/lineMarkers.js";import"../../symbols/ObjectSymbol3DLayer.js";import"../../symbols/PathSymbol3DLayer.js";import"../../symbols/TextSymbol3DLayer.js";import"../../symbols/Font.js";import"../../symbols/WaterSymbol3DLayer.js";import"../../symbols/support/StyleOrigin.js";import"../../chunks/Thumbnail.js";import"../../chunks/calloutUtils.js";import"../../symbols/callouts/Callout3D.js";import"../../symbols/callouts/LineCallout3D.js";import"../../symbols/support/Symbol3DVerticalOffset.js";import"../../symbols/LineSymbol3D.js";import"../../symbols/MeshSymbol3D.js";import"../../symbols/PictureFillSymbol.js";import"../../symbols/FillSymbol.js";import"../../symbols/SimpleLineSymbol.js";import"../../symbols/LineSymbol.js";import"../../symbols/LineSymbolMarker.js";import"../../chunks/urlUtils.js";import"../../symbols/PictureMarkerSymbol.js";import"../../symbols/MarkerSymbol.js";import"../../symbols/PointSymbol3D.js";import"../../symbols/PolygonSymbol3D.js";import"../../symbols/SimpleFillSymbol.js";import"../../symbols/SimpleMarkerSymbol.js";import"../../symbols/TextSymbol.js";import"../../symbols/WebStyleSymbol.js";import"../../form/ExpressionInfo.js";import"../../form/elements/GroupElement.js";import"../../form/elements/Element.js";import"../../form/elements/AttachmentElement.js";import"../../form/elements/inputs/attachments/AttachmentInput.js";import"../../chunks/Input.js";import"../../form/elements/inputs/attachments/AudioInput.js";import"../../chunks/utils2.js";import"../../form/elements/inputs/attachments/DocumentInput.js";import"../../form/elements/inputs/attachments/ImageInput.js";import"../../form/elements/inputs/attachments/SignatureInput.js";import"../../form/elements/inputs/attachments/VideoInput.js";import"../../form/elements/FieldElement.js";import"../../form/elements/inputs.js";import"../../form/elements/inputs/BarcodeScannerInput.js";import"../../form/elements/inputs/TextInput.js";import"../../form/elements/inputs/Input.js";import"../../form/elements/inputs/ComboBoxInput.js";import"../../form/elements/inputs/DatePickerInput.js";import"../../form/elements/inputs/DateTimeOffsetPickerInput.js";import"../../form/elements/inputs/DateTimePickerInput.js";import"../../form/elements/inputs/RadioButtonsInput.js";import"../../form/elements/inputs/SwitchInput.js";import"../../form/elements/inputs/TextAreaInput.js";import"../../form/elements/inputs/TextBoxInput.js";import"../../form/elements/inputs/TimePickerInput.js";import"../../chunks/domains.js";import"../../layers/support/CodedValueDomain.js";import"../../layers/support/Domain.js";import"../../layers/support/InheritedDomain.js";import"../../layers/support/RangeDomain.js";import"../../form/elements/RelationshipElement.js";import"../../form/elements/TextElement.js";import"../../form/elements/UtilityNetworkAssociationsElement.js";import"../../layers/support/Subtype.js";import"../../layers/catalog/catalogUtils.js";import"../../chunks/layerUtils.js";import"../../intl.js";import"../../chunks/number.js";import"../../chunks/substitute.js";import"../../chunks/messages.js";import"../../chunks/utils7.js";import"../../chunks/basemapUtils.js";import"../../chunks/utils5.js";import"../../chunks/mat4.js";import"../../chunks/common.js";import"../../chunks/basemapDefinitions.js";import"../../chunks/timeZoneUtils.js";import"../../chunks/dateUtils.js";import"../../chunks/formUtils2.js";import"../../chunks/featureUtils.js";import"./EditableInput.js";import"./InputBase.js";import"../../chunks/FeatureRelationshipViewModel.js";import"../../rest/support/RelationshipQuery.js";import"../../chunks/DataLayerSource.js";import"../../layers/support/Field.js";import"../../chunks/fieldType.js";import"../../chunks/ReactiveMap.js";import"../../chunks/ReactiveSet.js";import"../../chunks/sanitizerUtils.js";import"../../chunks/TimeOnly.js";import"../../chunks/enum.js";import"../../chunks/UnknownTimeZone.js";import"../../chunks/arcadeEnvironment.js";import"../../chunks/ImmutableArray.js";import"../../layers/FeatureLayer.js";import"../../chunks/MultiOriginJSONSupport.js";import"../../chunks/layerContainerType.js";import"../../graphic/FeatureGraphicOrigin.js";import"../../graphic/GraphicOrigin.js";import"../../chunks/isFeatureGraphicOrigin.js";import"../../layers/Layer.js";import"../../time/TimeExtent.js";import"../../chunks/timeUtils.js";import"../../core/workers/workers.js";import"../../core/workers/Connection.js";import"../../chunks/Queue.js";import"../../core/workers/RemoteClient.js";import"../../chunks/editsZScale.js";import"../../chunks/queryZScale.js";import"../../chunks/zscale.js";import"../../rest/support/FeatureSet.js";import"../../layers/mixins/APIKeyMixin.js";import"../../chunks/ArcGISService.js";import"../../layers/mixins/BlendLayer.js";import"../../chunks/jsonUtils2.js";import"../../chunks/parser.js";import"../../layers/mixins/CustomParametersMixin.js";import"../../layers/mixins/DisplayFilteredLayer.js";import"../../layers/support/DisplayFilterInfo.js";import"../../chunks/scaleUtils.js";import"../../layers/support/DisplayFilter.js";import"../../chunks/uuid.js";import"../../chunks/displayFilterUtils.js";import"../../chunks/EditBusLayer.js";import"../../layers/mixins/FeatureEffectLayer.js";import"../../layers/support/FeatureEffect.js";import"../../layers/support/FeatureFilter.js";import"../../rest/support/Query.js";import"../../chunks/FullTextSearch.js";import"../../chunks/spatialRelationships.js";import"../../rest/support/StatisticDefinition.js";import"../../layers/mixins/FeatureLayerBase.js";import"../../geometry/HeightModelInfo.js";import"../../chunks/commonProperties.js";import"../../symbols/support/ElevationInfo.js";import"../../symbols/support/FeatureExpressionInfo.js";import"../../chunks/unitConversionUtils.js";import"../../chunks/lengthUtils.js";import"../../tables/AttributeTableTemplate.js";import"../../tables/elements/AttributeTableGroupElement.js";import"../../tables/elements/AttributeTableAttachmentElement.js";import"../../tables/elements/AttributeTableElement.js";import"../../tables/elements/AttributeTableFieldElement.js";import"../../tables/elements/AttributeTableRelationshipElement.js";import"../../chunks/featureLayerUtils.js";import"../../chunks/asyncUtils.js";import"../../chunks/featureQueryAll.js";import"../../renderers/SimpleRenderer.js";import"../../renderers/Renderer.js";import"../../renderers/support/AuthoringInfo.js";import"../../renderers/support/AuthoringInfoVisualVariable.js";import"../../chunks/colorRamps.js";import"../../rest/support/AlgorithmicColorRamp.js";import"../../rest/support/ColorRamp.js";import"../../rest/support/MultipartColorRamp.js";import"../../renderers/mixins/VisualVariablesMixin.js";import"../../renderers/visualVariables/ColorVariable.js";import"../../renderers/visualVariables/VisualVariable.js";import"../../renderers/visualVariables/support/ColorStop.js";import"../../renderers/visualVariables/OpacityVariable.js";import"../../renderers/visualVariables/support/OpacityStop.js";import"../../renderers/visualVariables/RotationVariable.js";import"../../renderers/visualVariables/SizeVariable.js";import"../../renderers/visualVariables/support/SizeStop.js";import"../../chunks/visualVariableUtils.js";import"../../chunks/commonProperties2.js";import"../../symbols/support/jsonUtils.js";import"../../chunks/defaults.js";import"../../chunks/defaultsJSON.js";import"../../renderers/UniqueValueRenderer.js";import"../../chunks/diffUtils.js";import"../../chunks/RendererLegendOptions.js";import"../../renderers/support/UniqueValue.js";import"../../renderers/support/UniqueValueClass.js";import"../../renderers/support/UniqueValueGroup.js";import"../../renderers/support/UniqueValueInfo.js";import"../../chunks/styleUtils.js";import"../../rest/support/AttachmentQuery.js";import"../../rest/support/NormalizationBinParametersMixin.js";import"../../layers/support/GeometryFieldsInfo.js";import"../../layers/support/LayerFloorInfo.js";import"../../chunks/multiLayerServiceUtils.js";import"../../layers/support/Relationship.js";import"../../chunks/serviceCapabilitiesUtils.js";import"../../chunks/infoFor3D.js";import"../../chunks/portalItemUtils.js";import"../../chunks/projectionUtils.js";import"../../chunks/projectBuffer.js";import"../../chunks/geodesicConstants.js";import"../../chunks/projectXYZToVector.js";import"../../geometry/support/GeographicTransformation.js";import"../../geometry/support/GeographicTransformationStep.js";import"../../layers/mixins/FeatureReductionLayer.js";import"../../layers/support/AggregateField.js";import"../../layers/support/ExpressionInfo.js";import"../../chunks/FeatureReduction.js";import"../../layers/support/FeatureReductionBinning.js";import"../../layers/support/LabelClass.js";import"../../chunks/labelUtils.js";import"../../renderers/support/jsonUtils.js";import"../../chunks/typeUtils3.js";import"../../renderers/ClassBreaksRenderer.js";import"../../renderers/support/ClassBreakInfo.js";import"../../renderers/DictionaryRenderer.js";import"../../chunks/LRUCache.js";import"../../chunks/MemCache.js";import"../../chunks/DictionaryScriptEvaluator.js";import"../../chunks/Version.js";import"../../layers/support/FieldsIndex.js";import"../../chunks/ArcadeExpression.js";import"../../chunks/utils6.js";import"../../chunks/defaultCIMValues.js";import"../../renderers/DotDensityRenderer.js";import"../../renderers/support/AttributeColorInfo.js";import"../../renderers/HeatmapRenderer.js";import"../../renderers/support/HeatmapColorStop.js";import"../../chunks/heatmapUtils.js";import"../../chunks/vec4.js";import"../../chunks/vec4f64.js";import"../../renderers/PieChartRenderer.js";import"../../layers/support/FeatureReductionCluster.js";import"../../layers/support/FeatureReductionSelection.js";import"../../chunks/clusterUtils.js";import"../../chunks/MD5.js";import"../../layers/mixins/OperationalLayer.js";import"../../layers/mixins/OrderedLayer.js";import"../../layers/support/OrderByInfo.js";import"../../layers/mixins/PortalLayer.js";import"../../portal/PortalItem.js";import"../../portal/PortalItemResource.js";import"../../portal/PortalRating.js";import"../../layers/mixins/PublishableLayer.js";import"../../layers/support/PublishingInfo.js";import"../../layers/mixins/RefreshableLayer.js";import"../../layers/mixins/ScaleRangeLayer.js";import"../../layers/mixins/TemporalLayer.js";import"../../layers/support/TimeInfo.js";import"../../time/TimeInterval.js";import"../../layers/mixins/TrackableLayer.js";import"../../layers/support/TrackInfo.js";import"../../layers/support/TrackPartInfo.js";import"../../layers/support/FeatureTemplate.js";import"../../layers/support/FeatureType.js";import"../../chunks/fieldProperties.js";import"../../chunks/labelingInfo.js";import"../../chunks/TitleCreator.js";import"../../chunks/versionUtils.js";import"../../chunks/styleUtils2.js";import"../../support/popupUtils.js";const q="#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY";let Q=class extends Z{constructor(e){super(e),this._fieldReferencesLookup=new Map,this._fieldsAffectedLookup=new Map,this.preserveFieldValuesWhenHidden=!0,this._latestFieldValues={...e.feature.attributes}}initialize(){this._dependencyGraph=this._buildDependencyGraph()}destroy(){this.resetExecutors()}get _asyncExecutors(){return this.executors.filter(e=>e.isAsync)}get _baseContext(){const{editType:e,layer:t,map:s,originalFeature:i,spatialReference:o,timeZone:r}=this.arcadeContextInfo,n="scene"===t?.type&&null!=t.associatedLayer?t.associatedLayer:t;return[{$originalfeature:i,$editcontext:{editType:e},$layer:n,$featureset:n,$datastore:t?.url,$map:s},{rawOutput:!0,spatialReference:o??void 0,timeZone:r}]}set feature(e){this._latestFieldValues={...e?.attributes},this._set("feature",e)}evaluateAll(){return this._evaluate(this.executors)}evaluateAsyncExpressions(){return this._evaluate(this._asyncExecutors)}evaluateExpressions(e){return this._evaluate(e)}evaluateInvalidated(e){const{_fieldReferencesLookup:t,_latestFieldValues:s,feature:i}=this,o=new Set;for(const r of e)if(s[r]=i.getAttribute(r),t.has(r))for(const e of t.get(r))o.add(e);return this._evaluate([...o])}async evaluateInvalidatedByGeometry(){if(this._fieldReferencesLookup.has(q))return this._evaluate([...this._fieldReferencesLookup.get(q)])}resetExecutors(){for(const e of this.executors)e.reset()}_buildDependencyGraph(){const{_fieldReferencesLookup:e,_fieldsAffectedLookup:t,executors:s,preserveFieldValuesWhenHidden:i}=this,o=new Map(this.fieldInputs.map(e=>[e.name,e])),r=!1===i,n=new Map(s.map(e=>[e,new Array]));for(const i of s){for(const s of i.fieldsUsed){G(e,s,()=>new Set).add(i);const a=o.get(s);[a?.valueExpressionExecutor,a?.editableExpressionExecutor,r?a?.group?.visibilityExpressionExecutor:null,r?a?.visibilityExpressionExecutor:null].filter(e=>null!=e&&e!==i).forEach(e=>{n.get(e).push(i),G(t,e,()=>new Set).add(a)})}i.geometryUsed&&G(e,q,()=>new Set).add(i)}return n}async _evaluate(e){const t=new Map,{_dependencyGraph:s,_fieldsAffectedLookup:i,_latestFieldValues:r}=this;for(const i of e)K(i,t,s);for(const[e,{resolver:s,dependencyPromises:o}]of t)Promise.all(o).then(async()=>{const[t,s]=this._makeContext(r);return e.executeAsync(t,s)}).then(()=>{if(i.has(e))for(const t of i.get(e))this._latestFieldValues[t.name]=t.value;s.resolve()},t=>{!t||a(t)||Y(t)||e.markStale(),s.reject(t)});const n=(await Promise.allSettled(Array.from(t.values(),({resolver:e})=>e.promise))).filter(e=>"rejected"===e.status&&!(a(e.reason)||Y(e.reason)));if(n.length>0){const e=new AggregateError(n,`One or more expression executions failed. First error message: ${n[0].reason}`);throw o.getLogger(this).error(e),e}}_makeContext(e){const[t,s]=this._baseContext,i=this.feature.clone();return i.attributes=e,[{...t,$feature:i},s]}get test(){}};e([y()],Q.prototype,"_asyncExecutors",null),e([y()],Q.prototype,"_baseContext",null),e([y()],Q.prototype,"feature",null),e([y({constructOnly:!0})],Q.prototype,"preserveFieldValuesWhenHidden",void 0),e([y()],Q.prototype,"executors",void 0),e([y()],Q.prototype,"fieldInputs",void 0),e([y()],Q.prototype,"arcadeContextInfo",void 0),Q=e([f("esri.widgets.FeatureForm.FormExpressionsManager")],Q);const K=(e,t,s)=>{if(t.has(e))return;const i=l();t.set(e,{resolver:i,dependencyPromises:[]}),e.abort();const o=s.get(e);for(const e of o)K(e,t,s),t.get(e).dependencyPromises.push(i.promise)},Y=e=>e&&"object"==typeof e&&"message"in e&&"Cancelled"===e.message;var X;const ee=Symbol("FormExpressionArcadeExecutor");let te=class extends Z{static{X=ee}constructor(e){super(e),this[X]=!0,this._lastEvaluatedValue=null,this._abortController=new AbortController,this._initialExecutionComplete=!1,this._stale=!1,this._updatingTracking=new j,this._executeAsyncDebounced=p(async(e,t,s)=>{const i=await this.executor.executeAsync(e,{...t,abortSignal:s});return s.aborted?this._lastEvaluatedValue:(this._lastEvaluatedValue=i,this._stale=!1,i)})}get initialExecutionComplete(){return this._initialExecutionComplete}get isAsync(){return this.executor.isAsync}get fieldsUsed(){return this.executor.fieldsUsed}get syntaxTree(){return this.executor.syntaxTree}get updating(){return this._updatingTracking.updating}get stale(){return this._stale}get geometryUsed(){return this.executor.geometryUsed}get variablesUsed(){return this.executor.variablesUsed}get lastEvaluatedValue(){return this._lastEvaluatedValue}abort(){this._abortController.abort()}execute(e,t){this._abortController=new AbortController;const s=this.executor.execute(e,{...t,abortSignal:this._abortController.signal});return this._lastEvaluatedValue=s,this._initialExecutionComplete=!0,s}async executeAsync(e,t){return this._abortController=new AbortController,this._updatingTracking.addPromise(this._executeAsyncDebounced(e,t??{},this._abortController.signal).then(()=>{this._initialExecutionComplete=!0}))}markStale(){this._stale=!0}reset(){this.abort(),this._lastEvaluatedValue=null,this._stale=!1}};e([y()],te.prototype,"_lastEvaluatedValue",void 0),e([y()],te.prototype,"_initialExecutionComplete",void 0),e([y()],te.prototype,"_stale",void 0),e([y()],te.prototype,"_updatingTracking",void 0),e([y({constructOnly:!0})],te.prototype,"executor",void 0),e([y()],te.prototype,"initialExecutionComplete",null),e([y()],te.prototype,"isAsync",null),e([y()],te.prototype,"fieldsUsed",null),e([y()],te.prototype,"syntaxTree",null),e([y()],te.prototype,"updating",null),e([y()],te.prototype,"stale",null),e([y()],te.prototype,"geometryUsed",null),e([y()],te.prototype,"variablesUsed",null),e([y()],te.prototype,"lastEvaluatedValue",null),te=e([f("esri.widgets.support.forms.expressions.FormExpressionArcadeExecutor")],te);const se=new t({attributes:{}}),ie={field:["editableExpression","requiredExpression","valueExpression","visibilityExpression"],group:["visibilityExpression"],relationship:["editableExpression","visibilityExpression"],text:["visibilityExpression"],utilityNetworkAssociations:["editableExpression","visibilityExpression"]},oe="#JSAPI_CONTINGENT_VALUE_ANY_HASH";let re=class extends(n(i)){constructor(e){super(e),this._expressionExecutorsInUse=new Set,this._expressionExecutorLookup=new Map,this._expressionsManager=null,this._contingentValuesCache=null,this._featureClone=se.clone(),this._initialFeature=se.clone(),this._timeZone=null,this._updatingHandles=new j,this.activeAssociation=null,this.editType="NA",this.contingencyConstraintViolations=new Map,this.disabled=!1,this.highlightHelper=null,this.inputs=[],this.map=null,this.callbacks=null,this.strict=!1,this.pendingSubtypeChoice=null,this._updateInputs=p(async()=>{this._stopExpressions();const{_featureClone:e,_initialFeature:t,editType:s,formTemplate:i,inputs:o,layer:r,timeZone:n}=this;if(!r)return;const a={editType:s,feature:e,initialFeature:t,layer:r,timeZone:n},l=o.slice(),p=i?.elements&&i.elements.length>0?await this._updateInputsUsingFormElements(l,i.elements,a):this._updateInputsUsingLayerFields(l,r?.fields,a);this.inputs=p,this._startExpressions()})}initialize(){const e=u(()=>[this.layer,!!this.layer?.loaded,this.formTemplate,this.feature,this.timeZone,this.editType],([e,t])=>{null!=e&&(t?this._updatingHandles.addPromise(this._updateInputs()):e.load().catch(()=>{}))},m),t=u(()=>this._arcadeContextInfo,e=>{null!=this._expressionsManager&&(this._expressionsManager.arcadeContextInfo=e,this._evaluateExpressions(e=>e.evaluateAll()))}),s=u(()=>this.layer,e=>{const t="subtype-sublayer"===e?.type?e.parent:"feature"===e?.type?e:null;t&&this.addResolvingPromise(v.createLoadedLayerContingentValuesCache(t).then(e=>{this._contingentValuesCache=e,this.notifyChange("fieldsWithContingentValues")}))},{initial:!0});this.addHandles([e,t,s])}destroy(){this.feature=null,this.layer=null,this._contingentValuesCache=r(this._contingentValuesCache),this.highlightHelper?.removeAll(),this._updatingHandles.destroy()}get _expressionInfosLookup(){return new Map(this.formTemplate?.expressionInfos?.map(e=>[e.name,e]))}get activeAssociationInput(){return this.allAssociationInputs.find(e=>e.uid===this.associationId)}get activeRelationshipInput(){return this.allRelationshipInputs.find(e=>e.relationshipId===this.relationshipId||e.activeCategory||e.showAllEnabled)}get _arcadeContextInfo(){const{_initialFeature:e,editType:t,layer:s,map:i,spatialReference:o,timeZone:r}=this;return{layer:C(s)?s:null,originalFeature:e,editType:t,map:i,spatialReference:o,timeZone:r}}get associationId(){return this._get("associationId")}set associationId(e){null==e&&this.activeAssociationInput?.viewModel&&(this.activeAssociationInput.associatedLayer=null,this.activeAssociationInput.viewModel.activeAssociationType=null),this._set("associationId",e)}get associatedLayer(){return this.activeAssociationInput?.associatedLayer}set associatedLayer(e){this.activeAssociationInput&&(this.activeAssociationInput.associatedLayer=e)}get allAssociationInputs(){return S(this.inputs)}get allFieldInputs(){return U(this.inputs)}get allGroupInputs(){return this.inputs.filter(w)}get allRelationshipInputs(){return T(this.inputs)}get _layerFieldsByName(){return new Map(this.layer?.fields.map(e=>[e.name,e]))}get feature(){return this._get("feature")}set feature(e){const t=this._get("feature");this._featureClone=e?e.clone():se.clone(),this._initialFeature=this._featureClone.clone(),this._expressionsManager&&(this._expressionsManager.feature=this._featureClone),e?(this._resetFieldInputValues(this._featureClone),this.allRelationshipInputs.forEach(t=>t.feature=e)):(this.inputs.forEach(e=>e.destroy()),this.inputs.length=0),t!==e&&(this.pendingSubtypeChoice=null),this.contingencyConstraintViolations.clear(),this._set("feature",e)}get fieldsWithContingentValues(){if(null==this._contingentValuesCache)return new Set;const e=this._contingentValuesCache.fieldGroups.flatMap(e=>e.fields);return new Set(e)}get formTemplate(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null}set formTemplate(e){void 0===e?this._clearOverride("formTemplate"):this._override("formTemplate",e)}get formDescription(){const{formTemplate:e,layer:t}=this;return e?.description&&t?L({label:e.description,attributes:this.getValues(),fieldsIndex:t.fieldsIndex,timeZone:this.timeZone}):null}get formTitle(){const{formTemplate:e,layer:t}=this;return e?.title&&t?L({label:e.title,attributes:this.getValues(),fieldsIndex:t.fieldsIndex,timeZone:this.timeZone}):null}get formHeaderVisible(){const{activeRelationshipInput:e,activeAssociationInput:t,formDescription:s,formTitle:i}=this;return!(e||t||!s&&!i)}get joinedContingentValues(){return this._joinContingentValues()}get layer(){return this.feature?.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null}set layer(e){this._override("layer",e)}get relationshipId(){return this._get("relationshipId")}set relationshipId(e){const t=this.allRelationshipInputs;if(null!=e&&e===this.relationshipId||t.forEach(e=>{e.showAllEnabled=!1,e.activeCategory=null}),null!=e){const s=t.find(t=>t.relationshipId===e);s&&(s.showAllEnabled=!0)}this._set("relationshipId",e)}get spatialReference(){return this.layer?.spatialReference??null}set spatialReference(e){this._override("spatialReference",e)}get state(){return this.layer?.loaded?"ready":"disabled"}get submittable(){return!!this.valid||this.allFieldInputs.filter(e=>!e.valid).every(({submittable:e})=>e)}get timeZone(){const{layer:e}=this;if(e&&"datesInUnknownTimezone"in e&&e.datesInUnknownTimezone)return F;const t=e&&"preferredTimeZone"in e&&e.preferredTimeZone;return this._timeZone===V?t||F:this._timeZone||A}set timeZone(e){this._timeZone=e}get updating(){return this._updatingHandles.updating}get valid(){const e=this.allFieldInputs;return e.length>0&&e.every(({valid:e})=>e)}findField(e){return this.allFieldInputs.find(t=>t.name===e)}findGroup(e){return this.allGroupInputs.find(t=>t.id===e)}getFieldValueOptionsForField(e,t){const s=this.findField(e);if(!s)return[[],[],[]];const i="coded-value"===s.domain?.type?s.domain.codedValues.map(({name:e,code:t})=>({name:e,value:t})):[],o=null==s.value||i.some(e=>e.value===s.value)?[]:[{name:`${s.value}`,value:s.value}],r=this.fieldsWithContingentValues.has(e)?this._getContingentValueOptionsForField(e,t):[];if(r.length>0){const e=new Set(r.map(e=>e.value));return[r,i.filter(t=>!e.has(t.value)),o]}return[i,[],o]}getValue(e){const t=this.layer?.getField(e);if(null!=t)return this._featureClone.getAttribute(t.name)??null}setValue(e,t){const{_featureClone:s,strict:i}=this,o=this.findField(e);t=""===t?null:t,o&&s.getAttribute(e)!==t&&(o.value=t,i&&!o.valid||(this._afterValueChange(o),this._evaluateExpressions(t=>t.evaluateInvalidated([e]))))}getValues(){return{...this._featureClone.attributes}}overrideInitialFeature(e){this._initialFeature=e}submit(){const e=this.allFieldInputs,t=new Set(e.filter(e=>e.valid).map(({name:e})=>e)),s=e.filter(e=>!e.valid).map(({name:e})=>e),i=this.getValues();if(this.validateContingencyConstraints(i,{includeIncompleteViolations:!0}).length>0)for(const[e,i]of this.contingencyConstraintViolations.entries())"error"===i.type&&(t.delete(e),s.push(e));this.notifyChange("submittable"),this.notifyChange("valid"),this.emit("submit",{valid:[...t],invalid:s,values:i})}validateContingencyConstraints(e,t){const{_contingentValuesCache:s}=this,i=new Map;if(this.contingencyConstraintViolations=i,null==s)return[];const{invalid:o,incomplete:r}=s.validateContingencyConstraints(e),n=[...o,...t?.includeIncompleteViolations?r:[]];for(const e of n)for(const t of e.fieldGroup.fields)i.set(t,e);return n}notifyFeatureGeometryChanged(){const{feature:e,_featureClone:t}=this;e&&(t.geometry=e.geometry,this._evaluateExpressions(e=>e.evaluateInvalidatedByGeometry()))}applySubtypeDefaults(e){const{defaultValues:t}=e,{allFieldInputs:s}=this;for(const{name:e}of s){const s=t[e];null!=s&&this.setValue(e,s)}}_emitChangeEvent({name:e,valid:t,value:s}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:e,value:s,valid:t})}_evaluateExpressions(e){const t=this._expressionsManager;null!=t&&this._updatingHandles.addPromise(e(t).finally(()=>this._afterExpressionsEvaluated()))}async _updateInputsUsingFormElements(e,t,s){const i=new Map;for(const t of e)if(w(t)){i.set(t.element,t);for(const e of t.inputs)e.element&&i.set(e.element,e)}else t.element&&i.set(t.element,t);const o=new Map,r=await this._updateInputsUsingFormElementsRecursive({existingInputsByElement:i,updatedElements:t.filter(e=>this._isSupportedElement(e)),sharedInitializationProperties:s,group:null,newExpressionExecutorPromises:o});for(const[e,t]of i.entries())i.delete(e),t.destroy();return await Promise.all(Array.from(o.values())),r}async _updateInputsUsingFormElementsRecursive(e){const{existingInputsByElement:t,updatedElements:s,sharedInitializationProperties:i,group:o,newExpressionExecutorPromises:r}=e,n=[];for(const e of s){const s=t.has(e),a=s?t.get(e):b(e)?await this._makeUtilityNetworkAssociationInputFromElement(e,i,o):this._makeInputFromElement(e,i,o);if(a){if(n.push(a),await c(()=>!a.updating),this._assignExpressionExecutors(a,e,r),s)if(t.delete(e),w(a)){const{feature:e,timeZone:t}=i;a.set({feature:e,timeZone:t})}else if(M(a)){const t=this.relationshipId===e.relationshipId;a.set(i),a.set({map:this.map,showAllEnabled:t})}else b(a)?(a.set(i),a.set({map:this.map})):a.set(i);if(_(e)){const s=e.elements.filter(e=>this._isSupportedElement(e));a.inputs=await this._updateInputsUsingFormElementsRecursive({existingInputsByElement:t,updatedElements:s,sharedInitializationProperties:i,group:a,newExpressionExecutorPromises:r})}}}return n}_updateInputsUsingLayerFields(e,t,s){if(!Array.isArray(t))return o.getLogger(this).warn(this.declaredClass,"No attribute fields found."),[];const i=new Map;for(const t of e)if(w(t)){for(const e of t.inputs)e.destroy();t.inputs.length=0,t.destroy()}else M(t)?t.destroy():R(t)&&(null!==t.element?t.destroy():i.set(t.field,t));const r=[];for(const e of t){const t=s.feature?.getAttribute(e.name)??null,o=i.get(e)??new N({field:e,preservesValueWhenHidden:this.formTemplate?.preserveFieldValuesWhenHidden});r.push(o.set({...s,value:t})),i.delete(e)}for(const[e,t]of i.entries())i.delete(e),t.destroy();return r}_resetFieldInputValues(e){for(const t of this.allFieldInputs)t.value=e.getAttribute(t.name)??null}_makeInputFromElement(e,t,i){return _(e)?function(e,t){const{feature:s,layer:i}=t;return new H({element:e,inputs:[],feature:s,layer:i})}(e,t):k(e)?this._makeFieldInputFromElement(e,t,i):x(e)?this._makeRelationshipInputFromElement(e,t,i):b(e)?this._makeUtilityNetworkAssociationInputFromElement(e,t,i):I(e)?function(e,t,s=null){const{feature:i,layer:o,timeZone:r}=t;return new W({element:e,feature:i,group:s,layer:o,timeZone:r})}(e,t):b(e)?this._makeUtilityNetworkAssociationInputFromElement(e,t,i):s()}_makeFieldInputFromElement(e,t,s){const{editType:i,feature:o,initialFeature:r,layer:n,timeZone:a}=t,{fieldName:l}=e,p=l&&this._layerFieldsByName.get(l);return p?new N({editType:i,element:e,field:p,value:o?.getAttribute(e.fieldName)??null,feature:o,initialFeature:r,layer:n,group:s,preservesValueWhenHidden:this.formTemplate?.preserveFieldValuesWhenHidden,timeZone:a}):null}_makeRelationshipInputFromElement(e,t,s=null){const{map:i}=this,{feature:o,layer:r,timeZone:n}=t,a=new B({element:e,feature:o,group:s,layer:r,map:i,timeZone:n});return a.addHandles(h(()=>a.relatedLayer,"edits",()=>this._evaluateExpressions(e=>e.evaluateAsyncExpressions()))),a}async _makeUtilityNetworkAssociationInputFromElement(e,t,s=null){const{map:i}=this,{feature:o,layer:r,timeZone:n}=t;return new(0,(await import("./UtilityNetworkAssociationInput.js")).default)({element:e,feature:o,group:s,layer:r,map:i,timeZone:n})}_assignExpressionExecutors(e,t,s){const i=ie[t.type],o=[];for(const r of i){const i=`${r}Executor`;if(e[i]){this._useExecutor(e[i]);continue}const n=t[r];if(null!=n&&""!==n){const t=this._expressionInfosLookup.get(n)?.expression??n;o.push(this._getOrCreateExecutorForExpression(t,s).then(t=>{e[i]=this._useExecutor(t)}))}}return P(e)&&o.push(...this._assignTextElementExpressionExecutors(e,s)),o}_assignTextElementExpressionExecutors(e,t){const{_expressionInfosLookup:s}=this,i=[];for(const r of e.expressionsUsed){const n=s.get(r);null!=n?i.push(this._getOrCreateExecutorForExpression(n.expression,t).then(t=>e.setExpressionExecutor(r,this._useExecutor(t)))):o.getLogger(this).error("feature-form:expression-not-found",`Could not find expressionInfo object with name '${r}'`)}for(const s of e.fieldsUsed){const o=`return $feature['${s}'];`;i.push(this._getOrCreateExecutorForExpression(o,t).then(t=>e.setFieldExecutor(s,this._useExecutor(t))))}return i}async _getOrCreateExecutorForExpression(e,t){const{_expressionExecutorLookup:s}=this;if(s.has(e))return s.get(e);if(t.has(e))return t.get(e);const i=(async(e,t)=>{const s=$("form-calculation"),i=await z(e,s,{});return t?.fieldsIndex&&(i.fieldsUsed=J(t.fieldsIndex,i.fieldsUsed)),new te({executor:i})})(e,this.layer);t.set(e,i);const o=await i;return s.set(e,o),o}_createExpressionsManager(e){const{_arcadeContextInfo:t,_featureClone:s,allFieldInputs:i,formTemplate:o}=this;this._expressionsManager=new Q({executors:e,feature:s,arcadeContextInfo:t,fieldInputs:i,preserveFieldValuesWhenHidden:!0===o?.preserveFieldValuesWhenHidden})}_startExpressions(){if(0===this._expressionExecutorsInUse.size)return;const e=Array.from(this._expressionExecutorsInUse);this._createExpressionsManager(e),this._evaluateExpressions(e=>e.evaluateAll())}_stopExpressions(){this._expressionsManager=r(this._expressionsManager),this._expressionExecutorsInUse.clear()}_useExecutor(e){return this._expressionExecutorsInUse.add(e),e}_afterValueChange(e){const{name:t,value:s}=e,{_featureClone:i,formTemplate:o,layer:r}=this;if(!r)return;const n=i.getAttribute(t);i.setAttribute(t,s);const{typeFieldName:a,types:l}=D(r);if((e.isSubtypeField||t===a)&&s!==n){if("subtype-sublayer"===r.type){const e=r.parent?.findSublayerForFeature(i);e&&(this.feature&&(this.feature.sourceLayer=e),i.sourceLayer=e)}const e=new Set;for(const t of l)if(t.domains&&"object"==typeof t.domains)for(const s of Object.keys(t.domains))e.add(s);for(const t of e){const e=this.findField(t);e&&e.notifyChange("domain")}this.notifyChange("joinedContingentValues")}if(null!=o){const{description:e,title:s}=o;s&&d(s,t)&&this.notifyChange("formTitle"),e&&d(e,t)&&this.notifyChange("formDescription")}this._emitChangeEvent(e)}_afterExpressionsEvaluated(){const{_featureClone:e}=this;for(const t of this.allFieldInputs)t.value!==e.getAttribute(t.name)&&this._afterValueChange(t)}_joinContingentValues(){const e=this._contingentValuesCache;if(null==e)return[];const{typeFieldName:t}=D(this.layer),s=t?this.getValue(t):null,i=[];for(const t of e.fieldGroups){const{contingencies:e,fields:o,name:r}=t,n=[];for(const t of e)t.isRetired||null!=t.subtype&&t.subtype.code!==s||n.push({values:t.values});n.length>0&&i.push({name:r,fields:o,contingencies:n})}const[o,r]=this._generateJoinPlan(i);return[...o.flatMap(e=>this._joinFieldGroupContingencies(e)),...r.flatMap(e=>e.contingencies)]}_generateJoinPlan(e){const t=new Map,s=[],i=new Set;for(const o of e)for(const e of o.fields)if(t.has(e)){const r=t.get(e),n=o,a=[r.name,n.name].sort().join("|");if(i.has(a))continue;s.push([r,n]),i.add(a),t.set(e,n)}else t.set(e,o);const o=new Set(s.flat()),r=new Set(e);for(const e of o)r.delete(e);const n=new Map,a=new Map;for(const e of new Set(s.flat())){const t=Symbol(e.name);n.set(t,new Set([e])),a.set(e,t)}for(const[e,t]of s){const s=a.get(e),i=a.get(t);if(s===i)continue;const o=n.get(s),r=n.get(i);for(const e of r)o.add(e),a.set(e,s);n.delete(i)}return[[...n.values()].map(e=>[...e]),[...r]]}_joinFieldGroupContingencies(e){const t=e.slice(),s=t.shift();let i=t.shift(),o=this._generateJoinKey(s.fields,i.fields),r=new Set([...s.fields,...i.fields]),n=new Map;for(const e of s.contingencies){const[t]=this._hashContingency(e,o.codedValueFields,!0);n.has(t)?n.get(t)?.push(e):n.set(t,[e])}for(;t.length>0;){const e=new Map,s=t.shift(),a=this._generateJoinKey(r,s.fields);for(const t of i.contingencies){const[s,i]=this._hashContingency(t,o.codedValueFields),r=i?this._findMatchingContingenciesWithAnyHashMask(n,s):n.get(s);if(n.has(oe)&&r?.push(...this._findMatchingContingenciesContainingAny(t,n.get(oe),o.codedValueFields)),null!=r)for(const s of r){const i=o.rangeFields.length>0?this._joinContingenciesWithRangeDomains(s,t,o.rangeFields):this._joinContingencies(s,t);if(null==i)break;const[r]=this._hashContingency(i,a.codedValueFields,!0);e.has(r)?e.get(r)?.push(i):e.set(r,[i])}}n=e,i=s,o=a,r=new Set([...r,...i.fields])}const a=[];for(const e of i.contingencies){const[t,s]=this._hashContingency(e,o.codedValueFields),i=s?this._findMatchingContingenciesWithAnyHashMask(n,t):n.get(t);if(n.has(oe)&&i.push(...this._findMatchingContingenciesContainingAny(e,n.get(oe),o.codedValueFields)),null!=i)for(const t of i){const s=o.rangeFields.length>0?this._joinContingenciesWithRangeDomains(t,e,o.rangeFields):this._joinContingencies(t,e);null!=s&&a.push(s)}}return a}_joinContingencies(e,t){const s={values:{...e.values,...t.values}};for(const[t,i]of Object.entries(s.values))"any"===i.objectType&&null!=e.values[t]&&(s.values[t]=e.values[t]);return s}_joinContingenciesWithRangeDomains(e,t,s){const i=this._joinContingencies(e,t);for(const o of s){const s=e.values[o],r=t.values[o],{leftIsNull:n,rightIsNull:a,bothAreNull:l,leftIsAny:p,rightIsAny:u,bothAreAny:m,leftIsRange:c,rightIsRange:h}=this._compareObjectTypes(s.objectType,r.objectType);if(l||m)continue;if(n&&u||a&&p){i.values[o]=new E({objectType:"null"});continue}if(n&&h||a&&c)return null;p?(s.minValue=-1/0,s.maxValue=1/0):u&&(r.minValue=-1/0,r.maxValue=1/0);const d=Math.max(s.minValue,r.minValue),y=Math.min(s.maxValue,r.maxValue);if(d>y)return null;i.values[o]=new E({objectType:"range",minValue:d,maxValue:y})}return i}_findMatchingContingenciesContainingAny(e,t,s){return t.filter(t=>s.every(s=>{const i=t.values[s],o=e.values[s];return"any"===i.objectType||"any"===o.objectType||i.codedValue?.code===o.codedValue?.code}))}_findMatchingContingenciesWithAnyHashMask(e,t){const s=RegExp(`${t}$`),i=[];for(const[t,o]of e){if(t===oe)break;s.test(t)&&i.push(...o)}return i}_generateJoinKey(e,t){const s=Array.isArray(e)?new Set(e):e,i=Array.isArray(t)?new Set(t):t,o=s.size<i.size?s:i,r=o===s?i:s,{feature:n}=this,a=new Set,l=new Set;for(const e of o)if(r.has(e)){const t=this.layer?.getFieldDomain(e,{feature:n??void 0,excludeImpliedDomains:!0});if(null==t)continue;switch(t.type){case"coded-value":a.add(e);break;case"range":l.add(e)}}return{codedValueFields:[...a],rangeFields:[...l]}}_contingencyIsValid(e,t){const s={};for(const{name:t,value:i}of this.allFieldInputs)this.fieldsWithContingentValues.has(t)&&null!=i&&t!==e&&(s[t]=i);return Object.entries(s).every(([e,s])=>!t.values.hasOwnProperty(e)||O(s,t.values[e]))}_getContingentValueOptionsForField(e,t){const s=this.joinedContingentValues.slice(),i=new Map,o={code:"",name:t??"No value"};for(const t of s){const s=t.values[e];if("code"===s?.objectType||"null"===s?.objectType){const{code:r,name:n}=s.codedValue&&"null"!==s.objectType?s.codedValue:o;!i.has(r)&&this._contingencyIsValid(e,t)&&i.set(r,{name:n,value:r})}}return[...i.values()]}_hashContingency(e,t,s=!1){if(t.length<1)return["#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",!1];const i=[];let o=!1;for(const r of t){const t=e.values[r];if("any"===t.objectType){if(s)return[oe,!0];o=!0,i.push(`${r}:.*`)}else"null"===t.objectType?i.push(`${r}:#JSAPI_CONTINGENT_VALUE_NULL_HASH`):i.push(`${r}:${t.codedValue?.code}`)}return[i.sort().join("&"),o]}_compareObjectTypes(e,t){return{leftIsNull:"null"===e,rightIsNull:"null"===t,bothAreNull:"null"===e&&"null"===t,leftIsAny:"any"===e,rightIsAny:"any"===t,bothAreAny:"any"===e&&"any"===t,leftIsRange:"range"===e,rightIsRange:"range"===t}}_isSupportedElement(e){return"field"===e.type||"group"===e.type||"relationship"===e.type||"text"===e.type||"utilityNetworkAssociations"===e.type||(o.getLogger(this).warn("form-info::unsupported-element-type","Only element types 'field', 'group' and 'relationship' are supported",`Element ${e.label} has unsupported type '${e.type}'`),!1)}get test(){return{featureClone:this._featureClone}}};e([y()],re.prototype,"_expressionInfosLookup",null),e([y()],re.prototype,"_featureClone",void 0),e([y()],re.prototype,"_timeZone",void 0),e([y()],re.prototype,"activeAssociation",void 0),e([y()],re.prototype,"activeAssociationInput",null),e([y()],re.prototype,"activeRelationshipInput",null),e([y()],re.prototype,"_arcadeContextInfo",null),e([y()],re.prototype,"associationId",null),e([y()],re.prototype,"associatedLayer",null),e([y()],re.prototype,"allAssociationInputs",null),e([y()],re.prototype,"allFieldInputs",null),e([y()],re.prototype,"allGroupInputs",null),e([y()],re.prototype,"allRelationshipInputs",null),e([y()],re.prototype,"_layerFieldsByName",null),e([y()],re.prototype,"editType",void 0),e([y()],re.prototype,"contingencyConstraintViolations",void 0),e([y()],re.prototype,"disabled",void 0),e([y()],re.prototype,"feature",null),e([y()],re.prototype,"fieldsWithContingentValues",null),e([y({type:g})],re.prototype,"formTemplate",null),e([y()],re.prototype,"formDescription",null),e([y()],re.prototype,"formTitle",null),e([y()],re.prototype,"formHeaderVisible",null),e([y()],re.prototype,"highlightHelper",void 0),e([y()],re.prototype,"inputs",void 0),e([y()],re.prototype,"joinedContingentValues",null),e([y()],re.prototype,"layer",null),e([y()],re.prototype,"map",void 0),e([y()],re.prototype,"callbacks",void 0),e([y()],re.prototype,"relationshipId",null),e([y()],re.prototype,"spatialReference",null),e([y()],re.prototype,"state",null),e([y()],re.prototype,"strict",void 0),e([y()],re.prototype,"submittable",null),e([y()],re.prototype,"timeZone",null),e([y()],re.prototype,"updating",null),e([y()],re.prototype,"valid",null),e([y()],re.prototype,"pendingSubtypeChoice",void 0),e([y()],re.prototype,"getValues",null),e([y()],re.prototype,"submit",null),e([y()],re.prototype,"test",null),re=e([f("esri.widgets.FeatureForm.FeatureFormViewModel")],re);const ne=re;export{ne as default};
