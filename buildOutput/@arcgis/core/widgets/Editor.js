/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import"../intl.js";import t,{b as s}from"../core/Accessor.js";import{L as i}from"../chunks/Logger.js";import{d as o,a as r,m as n}from"../chunks/maybe.js";import{createResolver as a}from"../core/promiseUtils.js";import{watch as l,sync as c,on as p,when as m,initial as u}from"../core/reactiveUtils.js";import{property as d}from"../core/accessorSupport/decorators/property.js";import{i as h}from"../core/lang.js";import{subclass as y}from"../core/accessorSupport/decorators/subclass.js";import{U as g}from"../chunks/UpdatingHandles.js";import k from"../views/interactive/sketch/SketchValueOptions.js";import j from"./Attachments.js";import b,{V as f}from"./BatchAttributeForm.js";import v from"./FeatureForm.js";import w,{I as _,r as I}from"./FeatureTemplates.js";import{S as F}from"../chunks/Spinner.js";import M from"./Widget.js";import C,{S,i as L,a as T,b as A}from"./Editor/EditorViewModel.js";import{i as E}from"./Editor/CreateFeaturesWorkflow.js";import x,{S as U}from"./support/SnappingControls.js";import{M as P,J as D,K as V}from"../chunks/workflowUtils.js";import{l as W}from"../chunks/componentsUtils.js";import{c as B,s as O}from"../chunks/widgetUtils.js";import{t as R,a as N}from"../chunks/jsxFactory.js";import{getDisplayFieldName as H}from"../layers/support/fieldUtils.js";import{i as $}from"../chunks/iconUtils.js";import{a as z,S as G}from"../chunks/SketchTooltipControls.js";import{l as q,P as Z}from"../chunks/Prompt.js";import{s as Q}from"../chunks/substitute.js";import{H as J,i as K}from"../chunks/Heading.js";import{f as X}from"../chunks/symbolPreviewUtils.js";import{m as Y}from"../chunks/messageBundle.js";import ee from"../core/Error.js";import{C as te,M as se,f as ie}from"../chunks/uploadAssetErrors.js";import{V as oe,S as re,C as ne}from"../chunks/VisibleElements.js";import{g as ae}from"../chunks/globalCss.js";import{h as le,m as ce}from"../chunks/handleUtils.js";import{f as pe}from"../chunks/number.js";import me,{S as ue}from"./support/SelectionToolbar.js";import{v as de}from"../chunks/vmEvent.js";import"../chunks/date.js";import"../chunks/jsonMap.js";import"../chunks/object.js";import"../chunks/locale.js";import"../chunks/constants.js";import"../chunks/datetime.js";import"../chunks/messages.js";import"../request.js";import"../config.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/jsonUtils.js";import"../chunks/string.js";import"../chunks/MapUtils.js";import"../chunks/persistableUrlUtils.js";import"../chunks/events.js";import"../chunks/assets.js";import"../core/Handles.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/Lifecycle.js";import"../chunks/metadata.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../chunks/SetUtils.js";import"../chunks/SimpleTrackingTarget.js";import"../chunks/ensureType.js";import"../chunks/Warning.js";import"../chunks/unitFormatUtils.js";import"../chunks/Cyclical.js";import"../chunks/mathUtils.js";import"../chunks/quantityUtils.js";import"../chunks/unitUtils.js";import"../chunks/pe.js";import"../core/accessorSupport/decorators/cast.js";import"./Attachments/AttachmentsViewModel.js";import"../Graphic.js";import"../PopupTemplate.js";import"../core/Clonable.js";import"../core/Collection.js";import"../core/Evented.js";import"../chunks/shared.js";import"../chunks/SimpleObservable.js";import"../core/JSONSupport.js";import"../chunks/reader.js";import"../chunks/writer.js";import"../popup/content.js";import"../popup/content/AttachmentsContent.js";import"../popup/content/Content.js";import"../popup/support/AttachmentsOrderByInfo.js";import"../popup/content/CustomContent.js";import"../popup/content/ExpressionContent.js";import"../popup/ElementExpressionInfo.js";import"../popup/content/FieldsContent.js";import"../popup/FieldInfo.js";import"../chunks/enumeration.js";import"../popup/support/FieldInfoFormat.js";import"../popup/content/MediaContent.js";import"../popup/content/BarChartMediaInfo.js";import"../popup/content/mixins/ChartMediaInfo.js";import"../popup/content/mixins/MediaInfo.js";import"../popup/content/support/ChartMediaInfoValue.js";import"../Color.js";import"../chunks/colorUtils.js";import"../popup/content/support/ChartMediaInfoValueSeries.js";import"../chunks/chartMediaInfoUtils.js";import"../popup/content/ColumnChartMediaInfo.js";import"../popup/content/ImageMediaInfo.js";import"../popup/content/support/ImageMediaInfoValue.js";import"../popup/content/LineChartMediaInfo.js";import"../popup/content/PieChartMediaInfo.js";import"../popup/content/RelationshipContent.js";import"../popup/support/RelatedRecordsInfoFieldOrder.js";import"../popup/content/TextContent.js";import"../popup/content/UtilityNetworkAssociationsContent.js";import"../popup/support/UtilityNetworkAssociationType.js";import"../popup/ExpressionInfo.js";import"../popup/LayerOptions.js";import"../popup/RelatedRecordsInfo.js";import"../support/actions/ActionBase.js";import"../core/Identifiable.js";import"../support/actions/ActionButton.js";import"../support/actions/ActionToggle.js";import"../core/sql.js";import"../chunks/guards.js";import"../geometry/support/jsonUtils.js";import"../geometry/Extent.js";import"../geometry/Geometry.js";import"../geometry/SpatialReference.js";import"../geometry/Point.js";import"../geometry/support/webMercatorUtils.js";import"../geometry/Multipoint.js";import"../chunks/zmUtils.js";import"../geometry/Polygon.js";import"../chunks/coordsUtils.js";import"../chunks/extentUtils.js";import"../chunks/boundsUtils.js";import"../chunks/aaBoundingRect.js";import"../geometry/Polyline.js";import"../chunks/typeUtils.js";import"../chunks/createFeatureId.js";import"../chunks/typeUtils2.js";import"../symbols/CIMSymbol.js";import"../symbols/Symbol.js";import"../symbols/LabelSymbol3D.js";import"../symbols/Symbol3D.js";import"../chunks/collectionUtils.js";import"../portal/Portal.js";import"../core/Loadable.js";import"../core/Promise.js";import"../portal/PortalGroup.js";import"../portal/PortalQueryParams.js";import"../portal/PortalQueryResult.js";import"../portal/PortalUser.js";import"../portal/PortalFolder.js";import"../symbols/ExtrudeSymbol3DLayer.js";import"../symbols/Symbol3DLayer.js";import"../chunks/utils3.js";import"../symbols/edges/Edges3D.js";import"../chunks/screenUtils.js";import"../chunks/materialUtils.js";import"../chunks/opacityUtils.js";import"../symbols/edges/SketchEdges3D.js";import"../symbols/edges/SolidEdges3D.js";import"../chunks/Symbol3DMaterial.js";import"../symbols/FillSymbol3DLayer.js";import"../symbols/patterns/LineStylePattern3D.js";import"../symbols/patterns/StylePattern3D.js";import"../chunks/utils4.js";import"../chunks/colors.js";import"../chunks/symbolLayerUtils3D.js";import"../chunks/vec3f64.js";import"../chunks/aaBoundingBox.js";import"../chunks/DoubleArray.js";import"../symbols/IconSymbol3DLayer.js";import"../symbols/LineSymbol3DLayer.js";import"../symbols/LineStyleMarker3D.js";import"../chunks/lineMarkers.js";import"../symbols/ObjectSymbol3DLayer.js";import"../symbols/PathSymbol3DLayer.js";import"../symbols/TextSymbol3DLayer.js";import"../symbols/Font.js";import"../symbols/WaterSymbol3DLayer.js";import"../symbols/support/StyleOrigin.js";import"../chunks/Thumbnail.js";import"../chunks/calloutUtils.js";import"../symbols/callouts/Callout3D.js";import"../symbols/callouts/LineCallout3D.js";import"../symbols/support/Symbol3DVerticalOffset.js";import"../symbols/LineSymbol3D.js";import"../symbols/MeshSymbol3D.js";import"../symbols/PictureFillSymbol.js";import"../symbols/FillSymbol.js";import"../symbols/SimpleLineSymbol.js";import"../symbols/LineSymbol.js";import"../symbols/LineSymbolMarker.js";import"../chunks/urlUtils.js";import"../symbols/PictureMarkerSymbol.js";import"../symbols/MarkerSymbol.js";import"../symbols/PointSymbol3D.js";import"../symbols/PolygonSymbol3D.js";import"../symbols/SimpleFillSymbol.js";import"../symbols/SimpleMarkerSymbol.js";import"../symbols/TextSymbol.js";import"../symbols/WebStyleSymbol.js";import"../rest/query/support/AttachmentInfo.js";import"../rest/support/AttachmentQuery.js";import"../chunks/featureUtils.js";import"../chunks/layerUtils.js";import"../layers/catalog/catalogUtils.js";import"../chunks/utils7.js";import"../chunks/basemapUtils.js";import"../chunks/utils5.js";import"../chunks/mat4.js";import"../chunks/common.js";import"../chunks/basemapDefinitions.js";import"../chunks/timeZoneUtils.js";import"../chunks/attachmentUtils.js";import"../chunks/legacyIcon.js";import"../chunks/domUtils.js";import"../chunks/uuid.js";import"../chunks/projector.js";import"../chunks/sanitizerUtils.js";import"../chunks/jsxWidgetSupport.js";import"./BatchAttributeForm/BatchAttributeFormViewModel.js";import"../chunks/asyncUtils.js";import"../chunks/ReactiveMap.js";import"../chunks/formUtils2.js";import"../chunks/formUtils.js";import"../form/elements/AttachmentElement.js";import"../form/elements/Element.js";import"../form/elements/inputs/attachments/AttachmentInput.js";import"../chunks/Input.js";import"../form/elements/inputs/attachments/AudioInput.js";import"../chunks/utils2.js";import"../form/elements/inputs/attachments/DocumentInput.js";import"../form/elements/inputs/attachments/ImageInput.js";import"../form/elements/inputs/attachments/SignatureInput.js";import"../form/elements/inputs/attachments/VideoInput.js";import"../form/elements/FieldElement.js";import"../form/elements/inputs.js";import"../form/elements/inputs/BarcodeScannerInput.js";import"../form/elements/inputs/TextInput.js";import"../form/elements/inputs/Input.js";import"../form/elements/inputs/ComboBoxInput.js";import"../form/elements/inputs/DatePickerInput.js";import"../form/elements/inputs/DateTimeOffsetPickerInput.js";import"../form/elements/inputs/DateTimePickerInput.js";import"../form/elements/inputs/RadioButtonsInput.js";import"../form/elements/inputs/SwitchInput.js";import"../form/elements/inputs/TextAreaInput.js";import"../form/elements/inputs/TextBoxInput.js";import"../form/elements/inputs/TimePickerInput.js";import"../chunks/domains.js";import"../layers/support/CodedValueDomain.js";import"../layers/support/Domain.js";import"../layers/support/InheritedDomain.js";import"../layers/support/RangeDomain.js";import"../form/elements/RelationshipElement.js";import"../form/elements/TextElement.js";import"../form/elements/UtilityNetworkAssociationsElement.js";import"../chunks/dateUtils.js";import"../arcade.js";import"../chunks/TimeOnly.js";import"../chunks/enum.js";import"../chunks/UnknownTimeZone.js";import"../chunks/arcadeEnvironment.js";import"../chunks/ImmutableArray.js";import"../layers/FeatureLayer.js";import"../chunks/MultiOriginJSONSupport.js";import"../chunks/layerContainerType.js";import"../form/FormTemplate.js";import"../form/ExpressionInfo.js";import"../form/elements/GroupElement.js";import"../graphic/FeatureGraphicOrigin.js";import"../graphic/GraphicOrigin.js";import"../chunks/isFeatureGraphicOrigin.js";import"../layers/Layer.js";import"../time/TimeExtent.js";import"../chunks/timeUtils.js";import"../core/workers/workers.js";import"../core/workers/Connection.js";import"../chunks/Queue.js";import"../core/workers/RemoteClient.js";import"../chunks/editsZScale.js";import"../chunks/queryZScale.js";import"../chunks/zscale.js";import"../rest/support/FeatureSet.js";import"../layers/support/Field.js";import"../chunks/fieldType.js";import"../layers/mixins/APIKeyMixin.js";import"../chunks/ArcGISService.js";import"../layers/mixins/BlendLayer.js";import"../chunks/jsonUtils2.js";import"../chunks/parser.js";import"../layers/mixins/CustomParametersMixin.js";import"../layers/mixins/DisplayFilteredLayer.js";import"../layers/support/DisplayFilterInfo.js";import"../chunks/scaleUtils.js";import"../layers/support/DisplayFilter.js";import"../chunks/displayFilterUtils.js";import"../chunks/EditBusLayer.js";import"../layers/mixins/FeatureEffectLayer.js";import"../layers/support/FeatureEffect.js";import"../layers/support/FeatureFilter.js";import"../rest/support/Query.js";import"../chunks/DataLayerSource.js";import"../chunks/FullTextSearch.js";import"../chunks/spatialRelationships.js";import"../rest/support/StatisticDefinition.js";import"../layers/mixins/FeatureLayerBase.js";import"../geometry/HeightModelInfo.js";import"../chunks/commonProperties.js";import"../symbols/support/ElevationInfo.js";import"../symbols/support/FeatureExpressionInfo.js";import"../chunks/unitConversionUtils.js";import"../chunks/lengthUtils.js";import"../tables/AttributeTableTemplate.js";import"../tables/elements/AttributeTableGroupElement.js";import"../tables/elements/AttributeTableAttachmentElement.js";import"../tables/elements/AttributeTableElement.js";import"../tables/elements/AttributeTableFieldElement.js";import"../tables/elements/AttributeTableRelationshipElement.js";import"../chunks/featureLayerUtils.js";import"../chunks/featureQueryAll.js";import"../renderers/SimpleRenderer.js";import"../renderers/Renderer.js";import"../renderers/support/AuthoringInfo.js";import"../renderers/support/AuthoringInfoVisualVariable.js";import"../chunks/colorRamps.js";import"../rest/support/AlgorithmicColorRamp.js";import"../rest/support/ColorRamp.js";import"../rest/support/MultipartColorRamp.js";import"../renderers/mixins/VisualVariablesMixin.js";import"../renderers/visualVariables/ColorVariable.js";import"../renderers/visualVariables/VisualVariable.js";import"../renderers/visualVariables/support/ColorStop.js";import"../renderers/visualVariables/OpacityVariable.js";import"../renderers/visualVariables/support/OpacityStop.js";import"../renderers/visualVariables/RotationVariable.js";import"../renderers/visualVariables/SizeVariable.js";import"../renderers/visualVariables/support/SizeStop.js";import"../chunks/visualVariableUtils.js";import"../chunks/commonProperties2.js";import"../symbols/support/jsonUtils.js";import"../chunks/defaults.js";import"../chunks/defaultsJSON.js";import"../renderers/UniqueValueRenderer.js";import"../chunks/diffUtils.js";import"../chunks/RendererLegendOptions.js";import"../renderers/support/UniqueValue.js";import"../renderers/support/UniqueValueClass.js";import"../renderers/support/UniqueValueGroup.js";import"../renderers/support/UniqueValueInfo.js";import"../chunks/styleUtils.js";import"../rest/support/NormalizationBinParametersMixin.js";import"../rest/support/RelationshipQuery.js";import"../layers/support/GeometryFieldsInfo.js";import"../layers/support/LayerFloorInfo.js";import"../chunks/multiLayerServiceUtils.js";import"../layers/support/Relationship.js";import"../chunks/serviceCapabilitiesUtils.js";import"../chunks/infoFor3D.js";import"../layers/support/Subtype.js";import"../chunks/portalItemUtils.js";import"../chunks/projectionUtils.js";import"../chunks/projectBuffer.js";import"../chunks/geodesicConstants.js";import"../chunks/projectXYZToVector.js";import"../geometry/support/GeographicTransformation.js";import"../geometry/support/GeographicTransformationStep.js";import"../layers/mixins/FeatureReductionLayer.js";import"../layers/support/AggregateField.js";import"../layers/support/ExpressionInfo.js";import"../chunks/FeatureReduction.js";import"../layers/support/FeatureReductionBinning.js";import"../layers/support/LabelClass.js";import"../chunks/labelUtils.js";import"../renderers/support/jsonUtils.js";import"../chunks/typeUtils3.js";import"../renderers/ClassBreaksRenderer.js";import"../renderers/support/ClassBreakInfo.js";import"../renderers/DictionaryRenderer.js";import"../chunks/LRUCache.js";import"../chunks/MemCache.js";import"../chunks/DictionaryScriptEvaluator.js";import"../chunks/Version.js";import"../layers/support/FieldsIndex.js";import"../chunks/ArcadeExpression.js";import"../chunks/utils6.js";import"../chunks/defaultCIMValues.js";import"../renderers/DotDensityRenderer.js";import"../renderers/support/AttributeColorInfo.js";import"../renderers/HeatmapRenderer.js";import"../renderers/support/HeatmapColorStop.js";import"../chunks/heatmapUtils.js";import"../chunks/vec4.js";import"../chunks/vec4f64.js";import"../renderers/PieChartRenderer.js";import"../layers/support/FeatureReductionCluster.js";import"../layers/support/FeatureReductionSelection.js";import"../chunks/clusterUtils.js";import"../chunks/MD5.js";import"../layers/mixins/OperationalLayer.js";import"../layers/mixins/OrderedLayer.js";import"../layers/support/OrderByInfo.js";import"../layers/mixins/PortalLayer.js";import"../portal/PortalItem.js";import"../portal/PortalItemResource.js";import"../portal/PortalRating.js";import"../layers/mixins/PublishableLayer.js";import"../layers/support/PublishingInfo.js";import"../layers/mixins/RefreshableLayer.js";import"../layers/mixins/ScaleRangeLayer.js";import"../layers/mixins/TemporalLayer.js";import"../layers/support/TimeInfo.js";import"../time/TimeInterval.js";import"../layers/mixins/TrackableLayer.js";import"../layers/support/TrackInfo.js";import"../layers/support/TrackPartInfo.js";import"../layers/support/FeatureTemplate.js";import"../layers/support/FeatureType.js";import"../chunks/fieldProperties.js";import"../chunks/labelingInfo.js";import"../chunks/TitleCreator.js";import"../chunks/versionUtils.js";import"../chunks/styleUtils2.js";import"../support/popupUtils.js";import"../chunks/inputUtils.js";import"./BatchAttributeForm/inputs/BatchFormInputs.js";import"./BatchAttributeForm/inputs/FieldInput.js";import"./BatchAttributeForm/inputs/EditableInput.js";import"./BatchAttributeForm/inputs/InputBase.js";import"./BatchAttributeForm/inputs/GroupInput.js";import"../chunks/LayerContingentValuesCache.js";import"../chunks/featureFormUtils.js";import"./FeatureForm/FeatureFormViewModel.js";import"../chunks/editableLayers.js";import"./FeatureForm/FieldInput.js";import"./FeatureForm/EditableInput.js";import"./FeatureForm/InputBase.js";import"./FeatureForm/GroupInput.js";import"./FeatureForm/RelationshipInput.js";import"../chunks/FeatureRelationshipViewModel.js";import"./FeatureForm/TextElementInput.js";import"../chunks/ReactiveSet.js";import"./FeatureTemplates/FeatureTemplatesViewModel.js";import"../chunks/templateUtils2.js";import"../editing/sharedTemplates/SharedTemplateMetadata.js";import"../chunks/utils12.js";import"../rest/featureService/FeatureService.js";import"../chunks/applyEditsUtils.js";import"../geometry/support/MeshTransform.js";import"../chunks/mat4f64.js";import"../chunks/quat.js";import"../chunks/vec3.js";import"../chunks/quatf64.js";import"../chunks/axisAngleDegrees.js";import"../chunks/editingSupport.js";import"../geometry/support/normalizeUtils.js";import"../chunks/normalizeUtilsCommon.js";import"../chunks/simplify.js";import"../chunks/utils9.js";import"../chunks/utils10.js";import"./FeatureTemplates/TemplateItem.js";import"./FeatureTemplates/TemplateItemGroup.js";import"../symbols/support/symbolUtils.js";import"../chunks/gfxUtils.js";import"../symbols/support/cimSymbolUtils.js";import"../chunks/renderUtils.js";import"../chunks/colorUtils2.js";import"../chunks/svgUtils.js";import"../chunks/mat2df32.js";import"../chunks/mat2d.js";import"../chunks/utils8.js";import"../chunks/webStyleSymbolUtils.js";import"../chunks/devEnvironmentUtils.js";import"../chunks/SpinnerViewModel.js";import"../chunks/AnchorElementViewModel.js";import"../layers/GraphicsLayer.js";import"../chunks/GraphicsCollection.js";import"../chunks/SelectionManager.js";import"../chunks/selectionUtils.js";import"../chunks/SketchOptions.js";import"../views/interactive/sketch/SketchLabelOptions.js";import"../views/interactive/sketch/SketchTooltipOptions.js";import"../chunks/SketchTooltipVisibleElements.js";import"../chunks/SnappingManager.js";import"../chunks/elevationInfoUtils.js";import"../chunks/normalizedPoint.js";import"../chunks/dehydratedPoint.js";import"../chunks/Settings.js";import"../views/interactive/snapping/SnappingOptions.js";import"../views/interactive/snapping/FeatureSnappingLayerSource.js";import"../chunks/constraints.js";import"../chunks/InputManager.js";import"../chunks/signal.js";import"../chunks/keybindings.js";import"../chunks/utils11.js";import"../chunks/Version2.js";import"../chunks/vec2.js";import"../chunks/vec2f64.js";import"../geometry/support/geodesicUtils.js";import"../chunks/plane.js";import"../chunks/vector.js";import"../chunks/mat3f64.js";import"../chunks/mathUtils2.js";import"../chunks/sphere.js";import"../chunks/ray.js";import"../chunks/mat3.js";import"../chunks/geometry2dUtils.js";import"../chunks/RightAngleSnappingHint.js";import"../chunks/geodesicLengthMeasurementUtils.js";import"../chunks/projectVectorToVector.js";import"../chunks/projectPointToVector.js";import"../chunks/spatialReferenceEllipsoidUtils.js";import"../geometry/operators/geodeticLengthOperator.js";import"../chunks/geodeticCurveType.js";import"../chunks/geodesicMeasurementUtils.js";import"./Editor/UpdateFeaturesWorkflow.js";import"./Editor/UpdateFeaturesWorkflowData.js";import"./Editor/Edits.js";import"../chunks/SharedTemplateProvider.js";import"../chunks/drapedUtils.js";import"../chunks/GraphicState.js";import"../chunks/DrawingMode.js";import"../chunks/hitTestSelectUtils.js";import"../chunks/sketchUtils.js";import"./Editor/Workflow.js";import"./Sketch/SketchViewModel.js";import"../chunks/isSupportedObject.js";import"../chunks/layerUtils2.js";import"../chunks/automaticAreaMeasurementUtils.js";import"../chunks/geodesicAreaMeasurementUtils.js";import"../chunks/earcut.js";import"../chunks/triangle.js";import"../chunks/lineSegment.js";import"../chunks/automaticLengthMeasurementUtils.js";import"../chunks/HighlightDefaults.js";import"../chunks/screenUtils2.js";import"./Editor/UpdateWorkflow.js";import"../rest/featureService/utils.js";import"../views/draw/support/HighlightHelper.js";import"../chunks/layerViewUtils.js";import"./Editor/UpdateWorkflowData.js";import"../chunks/helpMessageUtils.js";import"./Editor/CreateFeaturesWorkflowData.js";import"./Editor/support/EditorItem.js";import"../chunks/goToUtils.js";import"./support/Selector2D/selectorUtils.js";import"./support/SelectionToolbar/SelectionToolbarViewModel.js";import"../chunks/SelectionOperation.js";import"../chunks/LabeledSwitch.js";import"./support/SnappingControls/SnappingControlsViewModel.js";import"../chunks/layerListUtils.js";import"./LayerList/LayerListViewModel.js";import"../chunks/utils23.js";import"./LayerList/ListItem.js";import"./LayerList/ListItemPanel.js";import"./support/widget.js";import"../chunks/accessibleHandler.js";import"../chunks/modeUtils.js";import"../chunks/VisibleElements2.js";import"../chunks/directionModeIcons.js";const he="esri-editor",ye={base:he,helpMessage:`${he}__help-message`,updateActions:`${he}__update-actions`,updateActionsList:`${he}__update-actions-list`,featureTemplatesContainer:`${he}__feature-templates-container`,templateItemContentEnd:`${he}__template-item-content-end`,sketchContainer:`${he}__sketch-container`,pendingFeatureListIcon:`${he}__pending-feature-list-icon`,selectionToolbarContainer:`${he}__selection-toolbar-container`};let ge=class extends t{constructor(e){super(e),this.batchUpdateActions=!0,this.createFeaturesSection=!0,this.directionModePicker=!1,this.editFeaturesSection=!0,this.flow=!0,this.labelsToggle=!0,this.selectionToolbar=!0,this.settingsMenu=!0,this.sketch=!0,this.snappingControls=!0,this.snappingControlsElements=new U,this.tooltipsToggle=!0,this.undoRedoButtons=!0,this.zoomToButton=!0}};e([d({type:Boolean,nonNullable:!0})],ge.prototype,"batchUpdateActions",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"createFeaturesSection",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"directionModePicker",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"editFeaturesSection",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"flow",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"labelsToggle",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"selectionToolbar",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"settingsMenu",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"sketch",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"snappingControls",void 0),e([d({type:U,nonNullable:!0})],ge.prototype,"snappingControlsElements",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"tooltipsToggle",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"undoRedoButtons",void 0),e([d({type:Boolean,nonNullable:!0})],ge.prototype,"zoomToButton",void 0),ge=e([y("esri.widgets.Editor.VisibleElements")],ge);const ke=ge,je="esri-editor__panel-content",be={base:je,message:`${je}__message`,section:`${je}__section`,sectionGroup:`${je}__section__group`,scrimContainer:`${je}__scrim-container`},fe=()=>W({scrim:()=>import("../chunks/index22.js")});function ve(e,...t){return R("div",{class:B(be.base,e?.showScrimOverlay?be.scrimContainer:void 0),key:e?.key??"panel-content"},...t,e?.showScrimOverlay?R("calcite-scrim",null):void 0)}function we(e,...t){return R("div",{class:be.message,"data-testid":"panel-content-message",key:e?.key??"panel-content-message"},...t)}function _e(e,...t){return R("div",{class:be.section,key:e?.key??"panel-content-section"},...t)}function Ie(e,...t){return R("div",{class:be.sectionGroup,key:e?.key??"panel-content-section-group"},...t)}function Fe({helpMessage:e,renderSketchToolbar:t}){return R(N,null,t(),R(ve,{key:"creating-features-panel-content"},R(we,{key:"content-message"},e)))}function Me({editorItems:e,filterText:t,id:s,messagesTemplates:i,onFilterTextChange:o,onSelectFeature:r,onZoomTo:n,workflow:a,editorMessages:l}){const c=new Map,p=a.data.candidates;let m=0;p.map(e=>{const t=function(e){const t=e.layer;if(!t)return null;const s=t.fieldsIndex.get(t.objectIdField),i=s.alias||s.name,{attributes:o}=e,r=H(t);return r&&o[r]&&`${o[r]}`||`${i}: ${o[s.name]}`}(e);return{label:t,id:e.attributes[e.layer.objectIdField],data:e}}).filter(({label:s,data:i})=>{const o=t.toLowerCase(),{title:r}=i.layer,n=e.find(e=>e.layer===i.sourceLayer);return n?n.supportsUpdateWorkflow&&(!o||s?.toLowerCase().includes(o)||r?.toLowerCase().includes(o)):null}).filter(h).forEach(e=>{m++;const t=e.data.layer;c.has(t)?c.get(t)?.items.push(e):c.set(t,{id:`${t.id}`,label:t.title??"",items:[e]})});const u=e.toArray().map(({layer:e})=>c.get(e)).filter(h),d=m>10||t.length>0;return R(ve,{key:"feature-list"},R(_e,null,_({enableListScroll:!1,filterEnabled:d,filterText:t,id:s,items:u,messages:{filterPlaceholder:i.filterPlaceholder,noItems:i.noItems,noMatches:i.noMatches},onFilterChange:e=>o(e),onItemMouseEnter:e=>r(e.data),onItemMouseLeave:()=>r(null),onItemSelect:e=>r(e.data,!0),renderItemActionEnd:e=>{return t=e.data,s=n,i=l.zoomTo,R("calcite-action",{appearance:"transparent",icon:"zoom-to-object",onclick:()=>s(t),scale:"s",slot:"actions-end",text:i,title:i});var t,s,i}})))}const Ce=()=>W({button:()=>import("../chunks/index6.js"),"split-button":()=>import("../chunks/index64.js"),"dropdown-group":()=>import("../chunks/index9.js"),"dropdown-item":()=>import("../chunks/index8.js"),icon:()=>import("../chunks/index.js")});function Se({buttons:e,key:t,notice:s}){return R("div",{class:"esri-editor__actions",key:t??"footer-actions",slot:"footer"},s?R("div",{class:"esri-editor__actions--notice"},s.icon?R("calcite-icon",{icon:s.icon,scale:"s"}):void 0,R("span",null,s.text)):void 0,R("div",null,e.filter(h).map((e,t)=>"split-button"===e.type?Te(e,t):Le(e,t))))}const Le=({disabled:e,onClick:t,label:s,key:i,...o},r)=>R("calcite-button",{disabled:e??!1,key:i??`action-${r}`,onclick:t,width:"full",...o},s),Te=({disabled:e,onClick:t,key:s,dropdownItems:i,...o},r)=>R("calcite-split-button",{disabled:e??!1,key:s??`split-action-${r}`,width:"full",onCalciteSplitButtonPrimaryClick:t,...o},R("calcite-dropdown-group",{selectionMode:"none"},i.filter(h).map(Ae))),Ae=({disabled:e,onClick:t,label:s,key:i,...o},r)=>R("calcite-dropdown-item",{disabled:e??!1,key:i??`dropdown-item-${r}`,onCalciteDropdownItemSelect:t,...o},s),Ee=()=>W({notice:()=>import("../chunks/index20.js")});function xe({activeFeatureCount:e,workflow:t,messages:s}){const i=[],o="content-start";if(t?.reliesOnOwnerAdminPrivileges){const e=s.ownerAdminNotice;i.push(R(Ue,{key:"owner-admin-notice",message:e,slot:o}))}if(t?.hasInvalidFormTemplate){const t=e>1?s.multiFeature.formFieldUpdateError:s.singleFeature.formFieldUpdateError;i.push(R(Ue,{key:"form-field-error",kind:"warning",message:t,slot:o}))}if("create-features"===t?.type&&"georeferenced-reprojected"===t.data.upload?.result?.type){const e=s.helpMessages3d.meshReprojected;i.push(R(Ue,{key:"mesh-reprojected",kind:"warning",message:e,slot:o}))}return R(N,null,i)}function Ue(e){const t=e.kind??"brand";return R("calcite-notice",{class:"esri-editor__notice",icon:$[t],key:e.key,kind:t,open:!0,scale:"s"},e.title?R("div",{slot:"title"},e.title):null,R("div",{slot:"message"},e.message))}function Pe({editorViewModel:e,messagesCommon:t,visibleElements:s}){const{snappingOptions:i,sketchOptions:o,view:r,snappingManager:n}=e,a=[],l={directionModePicker:s.directionModePicker,labelsToggle:s.labelsToggle,tooltipsToggle:s.tooltipsToggle};return Object.values(l).includes(!0)&&a.push(R(G,{sketchOptions:o,viewType:r?.type,visibleElements:new z(l)})),s.snappingControls&&a.push(R(x,{afterCreate:e=>e.layerListOpen=!1,snappingManager:n,snappingOptions:i,view:r,visibleElements:s.snappingControlsElements??new U})),0===a.length?null:R("calcite-accordion",{appearance:"transparent",class:"esri-editor__settings",key:"settings"},R("calcite-accordion-item",{"data-testid":"settings",heading:t.settings,iconStart:"gear"},a))}function De({editorViewModel:e,messagesCommon:t,visibleElements:s}){return R("div",{class:"esri-editor__panel-toolbar",key:"panel-toolbar"},R(Pe,{editorViewModel:e,messagesCommon:t,visibleElements:s}))}let Ve=class extends M{constructor(){super(...arguments),this.workflow=null,this.headingLevel=4,this._iconIntersectionObserver=new IntersectionObserver((e,t)=>{e.forEach(async e=>{if(e.isIntersecting){const i=e.target;if(s=i,s?.["data-has-icon"])return void t.unobserve(i);const o=function(e){return e?.["data-item"]}(i),{graphic:r}=o,n=r.sourceLayer??this.workflow?.data.creationInfo?.layer;if(!n||!r)return;We(i,!0);const a=o.id?Q(this.messagesLegend.previewTemplateAriaLabel,{label:o.id}):this.messagesCommon.preview,l=await X(r,n,{ariaLabel:a}).catch(()=>(We(i,!1),null));if(null==l)return;i.appendChild(l)}var s})}),this.messages=null,this.messagesLegend=null,this.messagesCommon=null,this._renderActionEnd=({graphic:e})=>{const{workflow:t,messages:s}=this;if(!t)return;const i=e.geometry?R("calcite-action",{appearance:"transparent",icon:"zoom-to-object",onblur:()=>{t.data.temporaryHighlightFeature=null},onclick:()=>t.data.viewModel.zoomTo(e),onfocus:()=>{t.data.temporaryHighlightFeature=e},scale:"s",slot:"actions-end",text:this.messages.zoomTo,title:this.messages.zoomTo}):void 0,o=t.data.isSharedTemplateWorkflow?void 0:R("calcite-action",{appearance:"transparent",icon:"trash",onblur:()=>{t.data.temporaryHighlightFeature=null},onclick:()=>t.cancelFeature(e),onfocus:()=>{t.data.temporaryHighlightFeature=e},scale:"s",slot:"actions-end",text:s.createFeaturesSelectionList.discard,title:s.createFeaturesSelectionList.discard});return R(N,null,i,o)},this._renderItemContentEnd=({graphic:e})=>{const{workflow:t}=this,s=t?.data.isSubmittable(e);return[s?void 0:R("calcite-icon",{class:ye.pendingFeatureListIcon,icon:"exclamation-mark-triangle",scale:"s",slot:"content-end"})]},this._renderItemIcon=e=>{if(null!=e?.graphic?.geometry)return R("span",{afterCreate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,afterUpdate:this._afterItemCreateOrUpdate,"data-has-icon":!1,"data-item":e,key:"icon"})},this._afterItemCreateOrUpdate=e=>{this._iconIntersectionObserver?.observe(e)},this._afterItemRemoved=e=>{this._iconIntersectionObserver?.unobserve(e)}}loadDependencies(){return W({action:()=>import("../chunks/index5.js"),icon:()=>import("../chunks/index.js"),list:()=>import("../chunks/index19.js")})}destroy(){this._iconIntersectionObserver?.disconnect(),this._iconIntersectionObserver=null}render(){const e=this.workflow;if(!e)return R(N,null,void 0);const t=this.messages,s=e.pendingFeatures.filter(t=>e.data.isDisplayable(t)).map((s,i)=>{const o=e.data.isSubmittable(s),r=o?t.createFeaturesSelectionList.featureReadyToSubmit:t.createFeaturesSelectionList.featureNotReadyToSubmit;return{disabled:!1,id:`${e.data.getFeatureTitle(s)??i}`,graphic:s,label:r,submittable:o}}).toArray();return R("div",null,R(J,{level:K(this.headingLevel)},t.createFeaturesSelectionList.heading),R("calcite-list",{label:t.createFeaturesSelectionList.heading},_({enableListScroll:!1,filterEnabled:!1,filterText:"",id:"update-features-pick-list",items:s,messages:{filterPlaceholder:"",noItems:"",noMatches:""},renderIcon:this._renderItemIcon,renderItemTitle:e=>e.label,renderItemLabel:e=>e.id,onItemMouseEnter:t=>e.data.temporaryHighlightFeature=t.graphic,onItemMouseLeave:()=>e.data.temporaryHighlightFeature=null,onItemSelect:t=>e.updatePendingFeature(t.graphic),renderItemContentEnd:this._renderItemContentEnd,renderItemActionEnd:this._renderActionEnd})))}};function We(e,t){e&&(e["data-has-icon"]=t)}e([d()],Ve.prototype,"workflow",void 0),e([d()],Ve.prototype,"headingLevel",void 0),e([d(),Y("esri/widgets/Editor/t9n/Editor")],Ve.prototype,"messages",void 0),e([d(),Y("esri/widgets/Legend/t9n/Legend")],Ve.prototype,"messagesLegend",void 0),e([d(),Y("esri/t9n/common")],Ve.prototype,"messagesCommon",void 0),Ve=e([y("esri.widgets.Editor.components.PendingFeatureList")],Ve);const Be=Ve;function Oe({editorViewModel:e,headingLevel:t,messages:s,messagesCommon:i,onDelete:o,onDeleteAssociation:r,onSave:n,renderAttachments:a,renderFeatureForm:l,renderBatchAttributeForm:c,renderSketchToolbar:p}){const{activeFeatureCount:m,activeLeafWorkflow:u,activeWorkflow:d,formViewModel:h,syncing:y}=e;if(!u||!d||!h)return null;const g=u.type.includes("update"),k=P(h),j=m>1?s.multiFeature:s.singleFeature,b=g&&!u.hasPendingEdits||y||h.updating||h.disabled||P(h)&&h.readOnly,f=Q(g?j.update:j.create,{count:m}),v="create-features"!==u?.type||!!u.data.selectedPendingFeature,w="shouldShowAttachments"in u&&u.shouldShowAttachments&&!k&&!h.activeRelationshipInput&&!h.activeAssociationInput,_=k?h.activeForm.inputs:h.inputs,I=D(u)&&_.every(e=>!e.visible)&&!w,F=V(u)?c:l,M=I?R(_e,null,R(Be,{headingLevel:t,key:"pending-feature-list",workflow:u})):R(_e,{key:"panel-content-section"},R(xe,{activeFeatureCount:m,messages:s,workflow:d}),R(Ie,null,v||"create-features"!==u.type?F():R(Be,{headingLevel:t,key:"pending-feature-list",workflow:u}),w?R("div",{key:"attachments"},R(J,{level:K(t)},s.attachments),a()):null)),C={appearance:"solid",onClick:n,disabled:b,label:f,type:"button"},S={appearance:"outline",onClick:o,disabled:y,kind:"danger",label:Q(j.delete,{count:m}),type:"button"},L={...S,onClick:r,label:s.deleteAssociationTitle,type:"button"},T={...S,primaryLabel:i.delete,primaryText:i.delete,dropdownItems:[{onClick:r,label:s.deleteAssociationTitle}],type:"split-button"},A={appearance:"outline",onClick:()=>{const{featureFormViewModel:t}=e;null!=t?.associationId&&(t.associationId=null)},disabled:y,label:i.cancel,type:"button"},E="viewing-associated-features"===e.page||"viewing-associated-layers"===e.page?[A]:[C,e.shouldShowDeleteButton&&!e.featureFormHasAssociation?S:void 0,e.shouldShowDeleteButton&&e.featureFormHasAssociation?T:void 0,!e.shouldShowDeleteButton&&e.featureFormHasAssociation?L:void 0];return R(N,null,I?p?.():void 0,R(ve,{key:"attribute-panel-content"},M),R(Se,{buttons:E}))}const Re="esri-editor__upload-details",Ne={base:Re,status:`${Re}__status`,titleWrapper:`${Re}__title-wrapper`,title:`${Re}__title`,description:`${Re}__description`,loader:`${Re}__loader`,iconSuccess:`${Re}__icon ${Re}__icon--success`,iconError:`${Re}__icon ${Re}__icon--error`,fileList:`${Re}__file-list`,file:`${Re}__file`,fileIcon:`${Re}__file-icon`,fileName:`${Re}__file-name`};function He(e){const{messages:t,key:s,upload:i}=e;return R(N,null,R(ve,{key:s??"upload-details"},R(_e,null,function(e){const t=function({helpMessage:e,messages:t,upload:s}){switch(s.state){case"pending":{const{title:e,description:i}=t.modelUploads.pending;return{title:e,description:i,iconContent:R("calcite-loader",{"aria-hidden":"true",class:Ne.loader,label:"",scale:"s",type:"determinate",value:Math.min(Math.round(100*s.progress),1===s.progress?100:99)})}}case"success":{const{title:s}=t.modelUploads.success;return{title:s,description:e||t.helpMessages3d.mesh,iconContent:R("calcite-icon",{class:B(Ne.iconSuccess),icon:"check",scale:"l"})}}case"error":{const{title:e}=t.modelUploads.error;return{title:e,description:$e(s.error,t),iconContent:R("calcite-icon",{class:B(Ne.iconError),icon:"exclamation-mark-circle",scale:"l"})}}default:return null}}(e);return t?R("div",{class:Ne.base,"data-testid":"upload-details",key:"upload-details-content"},R("div",{class:Ne.status,key:"status"},t.iconContent,R("div",{class:Ne.titleWrapper,key:"text"},R("div",{class:Ne.title,key:"title"},t.title),R("div",{class:Ne.description,key:"description"},t.description))),function(e){return R("div",{class:Ne.fileList,key:"file-list"},e.files.map(e=>{return R("div",{class:Ne.file,key:`file-${e.name}`},R("calcite-icon",{class:Ne.fileIcon,icon:ze(e),scale:"s"}),R("span",{class:Ne.fileName},(t=e.name,t.split("/").pop()?.split("\\").pop()??"")));var t}))}(e.upload)):null}(e))),"error"===i.state?R(Se,{buttons:[{onClick:()=>i.retry(),label:t.modelUploads.error.uploadNew,iconStart:"upload-to",type:"button"}],key:"upload-details-footer-actions"}):null)}function $e(e,t){if(!e)return null;const s=t.modelUploads.error.messages;switch(e.constructor){case ie:return s.noModel;case se:return s.multipleModels;case te:return s.conversionFailed;case ee:switch(e.name){case"glt-loader-error":case"gltf-loader-invalid-glb":return s.loadFailed;case"gltf-loader-unsupported-feature":return s.unsupportedFeature;case"glt-loader-request-error":return s.resourceRequestFailed;default:return s.default}default:return s.default}}function ze(e){const t=e.name.split(".").pop()?.toLowerCase();return(t?Qe[t]:null)??Ge}const Ge="file",qe="file-shape",Ze="file-image",Qe={glb:qe,gltf:qe,jpeg:Ze,jpg:Ze,png:Ze,svg:Ze,zip:"file-zip"};function Je({getLoading:e,setEffectiveLoading:t}){let s,i;function o(){clearTimeout(i),i=void 0}function r(e){s=e?Date.now():void 0,t(e)}function n(e,t){if(e<=0)return r(t);i=setTimeout(()=>{o(),r(t)},e)}return r(e()),le([l(e,e=>{o(),e?n(500,!0):n(null!=s?1e3-(Date.now()-s):0,!1)},c),ce(o)])}let Ke=class extends t{constructor(e){super(e),this.filter=!0,this.filterNotice=!0,this.itemCloseActions=!0,this.itemCount=!0,this.itemIcons=!0,this.itemMenus=!0,this.header=!0,this.layerFilter=!0,this.menu=!0,this.totalCount=!0}};e([d({type:Boolean,nonNullable:!0})],Ke.prototype,"filter",void 0),e([d({type:Boolean,nonNullable:!0})],Ke.prototype,"filterNotice",void 0),e([d({type:Boolean,nonNullable:!0})],Ke.prototype,"itemCloseActions",void 0),e([d({type:Boolean,nonNullable:!0})],Ke.prototype,"itemCount",void 0),e([d({type:Boolean,nonNullable:!0})],Ke.prototype,"itemIcons",void 0),e([d({type:Boolean,nonNullable:!0})],Ke.prototype,"itemMenus",void 0),e([d({type:Boolean,nonNullable:!0})],Ke.prototype,"header",void 0),e([d({type:Boolean,nonNullable:!0})],Ke.prototype,"layerFilter",void 0),e([d({type:Boolean,nonNullable:!0})],Ke.prototype,"menu",void 0),e([d({type:Boolean,nonNullable:!0})],Ke.prototype,"totalCount",void 0),Ke=e([y("esri.widgets.support.SelectionList.VisibleElements")],Ke);const Xe=Ke,Ye="esri-selection-list",et=`${Ye}__list-item`,tt={base:Ye,container:`${Ye}__container`,flowItem:`${Ye}__flow-item`,layerDropdown:`${Ye}__layer-dropdown`,listItemFeature:`${et}__feature`,listItemFeatureIcon:`${et}__feature-icon`,listItemIcon:`${et}__icon`,itemCount:`${Ye}__item-count`,notice:`${Ye}__notice`,panel:`${Ye}__panel`,totalCount:`${Ye}__total-count`};let st=class extends M{constructor(e,t){super(e,t),this._iconIntersectionObserver=new IntersectionObserver((e,t)=>{e.forEach(async e=>{if(e.isIntersecting){const s=e.target;if(this._hasIcon(s))return void t.unobserve(s);const i=this._getListItem(s);if(!i)return;this._setHasIcon(s,!0);const o=i.title?Q(this.messagesLegend.previewTemplateAriaLabel,{label:i.title}):this.messagesCommon.preview,r=i.thumbnail??await i.fetchThumbnail({ariaLabel:o}).catch(()=>(this._setHasIcon(s,!1),null));if(null==r)return;s.appendChild(r)}})}),this._itemWithOpenMenu=null,this._list=null,this.displayMode="group",this.hightlightOnHoverEnabled=!1,this.itemActionConfigs=null,this.menuScale="m",this.messages=null,this.messagesCommon=null,this.messagesLegend=null,this.onListItemSelect=null,this.scale="s",this.viewModel=new S,this.visibleElements=new Xe,this._afterItemCreate=e=>{this._iconIntersectionObserver?.observe(e)},this._afterItemRemoved=e=>{this._iconIntersectionObserver?.unobserve(e)},this.clear=this.clear.bind(this),this.collapseItems=this.collapseItems.bind(this),this.removeTemporaryHighlight=this.removeTemporaryHighlight.bind(this)}initialize(){this.addHandles([p(()=>this.effectiveSelectionManager,"selection-change",()=>this._closeItemMenu()),l(()=>this.hightlightOnHoverEnabled,e=>{e||this.removeTemporaryHighlight()})])}destroy(){this._iconIntersectionObserver?.disconnect(),this._iconIntersectionObserver=null}loadDependencies(){return W({action:()=>import("../chunks/index5.js"),chip:()=>import("../chunks/index35.js"),combobox:()=>import("../chunks/index30.js"),"combobox-item":()=>import("../chunks/index31.js"),dropdown:()=>import("../chunks/index7.js"),"dropdown-group":()=>import("../chunks/index9.js"),"dropdown-item":()=>import("../chunks/index8.js"),flow:()=>import("../chunks/index32.js"),"flow-item":()=>import("../chunks/index33.js"),icon:()=>import("../chunks/index.js"),input:()=>import("../chunks/index10.js"),list:()=>import("../chunks/index19.js"),"list-item":()=>import("../chunks/index18.js"),notice:()=>import("../chunks/index20.js"),panel:()=>import("../chunks/index25.js").then(e=>e.i)})}get _hasFilterText(){const{filterText:e}=this;return null!=e&&""!==e}get activeLayerItem(){return this.viewModel.activeLayerItem}get allLayerItems(){return this.viewModel.allLayerItems}get effectiveCount(){return this.viewModel.effectiveCount}get effectiveSelectionManager(){return this.viewModel.effectiveSelectionManager}get filterText(){return this.viewModel.filterText}set filterText(e){this.viewModel.filterText=e}get icon(){return"selection"}set icon(e){this._overrideIfSome("icon",e)}get isUpdating(){return this.viewModel.isUpdating}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get layerItems(){return this.viewModel.layerItems}get layerViewMap(){return this.viewModel.layerViewMap}get maxVisibleFeatureCountExceeded(){return this.viewModel.maxVisibleFeatureCountExceeded}get maxVisibleFeatureCountPerLayer(){return this.viewModel.maxVisibleFeatureCountPerLayer}set maxVisibleFeatureCountPerLayer(e){this.viewModel.maxVisibleFeatureCountPerLayer=e}get selectionManager(){return this.viewModel.selectionManager}set selectionManager(e){this.viewModel.selectionManager=e}get state(){return this.viewModel.state}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get viewLayersAndTables(){return this.viewModel.viewLayersAndTables}get visibleFeatureCount(){return this.viewModel.visibleFeatureCount}get visibleFeatureItems(){return this.viewModel.visibleFeatureItems}get visibleLayerCount(){return this.viewModel.visibleLayerCount}addTemporaryHighlight(e){this.viewModel.addTemporaryHighlight(e)}clear(){this.viewModel.clear()}deselectFeatureItem(e){this.viewModel.deselectFeatureItem(e)}deselectGroupItem(e){this.viewModel.deselectGroupItem(e)}deselectLayerItem(e){this.viewModel.deselectLayerItem(e)}deselectItem(e){this.viewModel.deselectItem(e)}collapseItems(){this._list?.filteredItems.forEach(e=>e.expanded=!1)}goToItem(e){this.viewModel.goToItem(e)}removeFromSelection(e){this.viewModel.removeFromSelection(e)}removeTemporaryHighlight(){this.viewModel.removeTemporaryHighlight()}selectSingleFeatureItem(e){this.viewModel.selectSingleFeatureItem(e)}selectSingleGroupItem(e){this.viewModel.selectSingleGroupItem(e)}selectSingleItem(e){this.viewModel.selectSingleItem(e)}selectSingleLayerItem(e){this.viewModel.selectSingleLayerItem(e)}setSelection(e){this.viewModel.setSelection(e)}render(){return R("div",{class:this.classes(tt.base,ae.widget,ae.panel)},R("calcite-flow",null,R("calcite-flow-item",{class:tt.flowItem,heading:this.visibleElements.header?this.messages.selection:void 0,loading:"loading"===this.state,overlayPositioning:"fixed",scale:this.scale,selected:!0},R("calcite-panel",{class:tt.panel,overlayPositioning:"fixed",scale:this.scale},R("div",{class:tt.container},this._renderActiveLayerDropdown(),this._renderFilterInput(),this._renderList(),this._renderFilterNotice())),this._renderTotalChip(),this._renderMenuActions())))}_renderTotalChip(){const{visibleElements:e}=this;if(!e.totalCount||!e.header)return;const{effectiveCount:t}=this,s=pe(t),i=Q(this.messages.selectionCount,{count:s});return R("calcite-chip",{appearance:"outline",class:tt.totalCount,closable:t>0,closed:0===t,icon:this.maxVisibleFeatureCountExceeded?"exclamation-mark-triangle":void 0,label:s,scale:this.scale,slot:"header-actions-end",title:i,onCalciteChipClose:this.clear},s)}_renderMenuActions(){const{visibleElements:e}=this;if(!e.header||!e.menu)return;const{menuScale:t}=this,s=0===this.effectiveCount;return[R("calcite-action",{disabled:s,icon:"reset",key:"clear-action",onclick:this.clear,scale:t,slot:"header-menu-actions",text:this.messagesCommon.clear,textEnabled:!0}),R("calcite-action",{disabled:s,icon:"folders",key:"collapse-action",onclick:this.collapseItems,scale:t,slot:"header-menu-actions",text:this.messages.collapseAll,textEnabled:!0})]}_renderActiveLayerDropdown(){const{layerItems:e,messages:t}=this;if(!(0===this.effectiveCount||e.length<2)&&this.visibleElements.layerFilter)return R("calcite-combobox",{class:tt.layerDropdown,clearDisabled:!0,label:t.filterByLayer,overlayPositioning:"fixed",placeholder:t.filterByLayer,scale:this.scale,selectionMode:"single-persist",onCalciteComboboxChange:({currentTarget:e})=>{this.filterText=void 0;const t=e.selectedItems[0]?.value??void 0;this.layer="all-layers"===t?void 0:t}},R("calcite-combobox-item",{heading:Q(t.allLayersCount,{count:e.length}),icon:"layers",key:"all-layers",selected:null==this.layer,value:"all-layers"}),this.layerItems.map(e=>this._renderActiveLayerDropdownItem(e)))}_renderFilterInput(){if(this.visibleElements.filter&&0!==this.effectiveCount)return R("calcite-input",{clearable:!0,icon:"search",placeholder:this.messages.filter,scale:this.scale,value:this.filterText,onCalciteInputInput:({target:{value:e}})=>{this.filterText=e}})}_renderActiveLayerDropdownItem(e){const t=e.title||this.messages.untitledLayer;return R("calcite-combobox-item",{heading:t,icon:e.iconName,key:e.key,selected:e.layer===this.layer,value:e.layer})}_renderList(){const{messages:e}=this;if(0!==this.visibleFeatureCount)return R("calcite-list",{afterCreate:O,bind:this,"data-node-ref":"_list",displayMode:"nested",interactionMode:"interactive",label:e.widgetLabel,loading:this.isUpdating,scale:this.scale,selectionMode:"none"},this._renderListContent(this.allLayerItems))}_renderListContent(e){return this.activeLayerItem?this._renderLayerItem(this.activeLayerItem):e.map(e=>L(e)?this._renderGroupItem(e):T(e)?this._renderLayerItem(e):null).filter(h)}_renderFilterNotice(){const{visibleElements:e}=this;if(!("disabled"===this.state||this.visibleFeatureCount>0)&&e.filter&&e.filterNotice)return R("calcite-notice",{class:tt.notice,icon:"exclamation-mark-triangle",kind:"info",open:!0,scale:this.scale,width:"full"},R("div",{slot:"message"},this.messages.noMatchingFeatures))}_renderItemCount(e){if(!this.visibleElements.itemCount)return;const{messages:t}=this,s=pe(e.total),i=pe(e.visibleTotal),o=Q(t.selectionCount,{count:s});return!this._hasFilterText&&e.maxVisibleFeatureCountExceeded?R("span",{class:tt.itemCount,slot:"content-end",title:o},R("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s",title:t.tooManyFeatures}),`${pe(this.maxVisibleFeatureCountPerLayer)}+`):R("span",{class:tt.itemCount,slot:"content-end",title:o},i)}_renderItemActions(e){if(!this.visibleElements.itemMenus)return;const{messages:t,messagesCommon:s}=this,i=this._itemWithOpenMenu===e,o=A(e),r=T(e),n=L(e),a=o?t.deselectFeature:r?t.deselectLayer:t.deselectGroup;return[R("calcite-dropdown",{open:i,overlayPositioning:"fixed",scale:this.menuScale,slot:"actions-end",width:"m",onCalciteDropdownClose:()=>this._closeItemMenu(e),onCalciteDropdownOpen:()=>{this._itemWithOpenMenu=e}},R("calcite-action",{appearance:"transparent",icon:"ellipsis",scale:this.scale,slot:"trigger",text:s.menu,textEnabled:!1}),i?R("calcite-dropdown-group",{selectionMode:"none"},R("calcite-dropdown-item",{iconStart:"layer-zoom-to",onCalciteDropdownItemSelect:()=>this.goToItem(e)},t.zoomTo),R("calcite-dropdown-item",{iconStart:"selection-filter",onCalciteDropdownItemSelect:()=>this.selectSingleItem(e)},o?t.onlySelectFeature:t.onlySelectThis),R("calcite-dropdown-item",{iconStart:"selection-x",onCalciteDropdownItemSelect:()=>this.deselectItem(e)},a),this.itemActionConfigs?.map(t=>{if(!t.type||"feature"===t.type&&o||"layer"===t.type&&r||"group"===t.type&&n)return R("calcite-dropdown-item",{iconStart:t.icon??void 0,onCalciteDropdownItemSelect:()=>t.callback({item:e})},t.label)})):void 0)]}_renderGroupItem(e){const t=e.title||this.messages.untitledLayer;if(0===e.visibleTotal)return;const{displayMode:s}=this;if("layer"===s||"feature"===s)return this._renderListContent(e.items);const{visibleElements:i}=this;return R("calcite-list-item",{bind:this,closable:!!i.itemCloseActions,"data-type":"group",expanded:!0,iconStart:i.itemIcons?e.iconName:void 0,key:e.key,label:t,value:e.title,onCalciteListItemClose:t=>{t.stopPropagation(),this.deselectItem(e)},onCalciteListItemSelect:t=>this._onListItemSelect(e,t)},this._renderItemActions(e),this._renderListContent(e.items))}_renderLayerItem(e){if(0===e.visibleTotal||!e.visible)return;if("feature"===this.displayMode)return this._renderItems(e.featureItems);const{messages:t,visibleElements:s}=this,i=e.title||t.untitledLayer;return R("calcite-list-item",{bind:this,closable:!!s.itemCloseActions,"data-type":"layer",expanded:!0,iconStart:s.itemIcons?e.iconName:void 0,key:e.key,label:i,scale:this.scale,value:e.title,onCalciteListItemClose:t=>{t.stopPropagation(),this.deselectItem(e)},onCalciteListItemSelect:t=>this._onListItemSelect(e,t)},this._renderItemCount(e),this._renderItemActions(e),this._renderItems(e.featureItems),e.maxVisibleFeatureCountExceeded?R("calcite-notice",{class:tt.notice,icon:"exclamation-mark-triangle",kind:"info",open:!0,scale:this.scale},R("div",{slot:"message"},t.tooManyFeatures)):void 0)}_renderItems(e){return e.map(e=>this._renderItem(e))}_renderItem(e){if(!e.visible)return;const{hightlightOnHoverEnabled:t,messages:s,visibleElements:i}=this,o=e.title||s.untitledFeature,r=i.itemIcons&&"feature"!==this.displayMode;return R("calcite-list-item",{bind:this,class:r?tt.listItemFeatureIcon:tt.listItemFeature,closable:!!i.itemCloseActions,"data-item":e,"data-type":"feature",key:e.key,label:o,name:o,onblur:t?()=>this.removeTemporaryHighlight():void 0,onfocus:t?()=>this.addTemporaryHighlight(e):void 0,onpointerenter:t?()=>this.addTemporaryHighlight(e):void 0,onpointerleave:t?()=>this.removeTemporaryHighlight():void 0,scale:this.scale,value:o,onCalciteListItemClose:t=>{t.stopPropagation(),this.deselectItem(e)},onCalciteListItemSelect:t=>this._onListItemSelect(e,t)},this._renderItemIcon(e),this._renderItemActions(e))}_renderItemIcon(e){if(this.visibleElements.itemIcons)return R("div",{class:tt.listItemIcon,key:"content-start",slot:"content-start"},R("span",{afterCreate:this._afterItemCreate,afterRemoved:this._afterItemRemoved,"data-has-icon":!1,"data-item":e,key:e.thumbnailKey}))}_getListItem(e){return e?.["data-item"]}_hasIcon(e){return!!e?.["data-has-icon"]}_setHasIcon(e,t){e&&(e["data-has-icon"]=t)}_onListItemSelect(e,t){t.stopPropagation(),this._closeItemMenu(),this.onListItemSelect?.({item:e})}_closeItemMenu(e){e&&e!==this._itemWithOpenMenu||(this._itemWithOpenMenu=null)}};e([d()],st.prototype,"_hasFilterText",null),e([d()],st.prototype,"_itemWithOpenMenu",void 0),e([d()],st.prototype,"_list",void 0),e([d()],st.prototype,"activeLayerItem",null),e([d()],st.prototype,"allLayerItems",null),e([d()],st.prototype,"displayMode",void 0),e([d()],st.prototype,"effectiveCount",null),e([d()],st.prototype,"effectiveSelectionManager",null),e([d()],st.prototype,"filterText",null),e([d()],st.prototype,"hightlightOnHoverEnabled",void 0),e([d()],st.prototype,"icon",null),e([d()],st.prototype,"itemActionConfigs",void 0),e([d()],st.prototype,"isUpdating",null),e([d()],st.prototype,"label",null),e([d()],st.prototype,"layer",null),e([d()],st.prototype,"layerItems",null),e([d()],st.prototype,"layerViewMap",null),e([d()],st.prototype,"maxVisibleFeatureCountExceeded",null),e([d()],st.prototype,"maxVisibleFeatureCountPerLayer",null),e([d()],st.prototype,"menuScale",void 0),e([d(),Y("esri/widgets/support/SelectionList/t9n/SelectionList")],st.prototype,"messages",void 0),e([d(),Y("esri/t9n/common")],st.prototype,"messagesCommon",void 0),e([d(),Y("esri/widgets/Legend/t9n/Legend")],st.prototype,"messagesLegend",void 0),e([d()],st.prototype,"onListItemSelect",void 0),e([d()],st.prototype,"scale",void 0),e([d()],st.prototype,"selectionManager",null),e([d()],st.prototype,"state",null),e([d()],st.prototype,"view",null),e([d()],st.prototype,"viewLayersAndTables",null),e([d()],st.prototype,"viewModel",void 0),e([d({type:Xe,nonNullable:!0})],st.prototype,"visibleElements",void 0),e([d()],st.prototype,"visibleFeatureCount",null),e([d()],st.prototype,"visibleFeatureItems",null),e([d()],st.prototype,"visibleLayerCount",null),st=e([y("esri.widgets.support.SelectionList")],st);const it=st,ot=Symbol("sketch-setup-handles");let rt=class extends M{constructor(e,t){super(e,t),this._batchAttributeForm=new b({visibleElements:new f({loadingIndicator:!1})}),this._featureForm=new v,this._sketchToolbar=null,this._attachments=new j({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}}),this._associationItemList=null,this._associationSettings=null,this._featureTemplates=new w({enableListScroll:!1,renderItemContentEnd:e=>e.supportsUpload?R("calcite-icon",{class:ye.templateItemContentEnd,icon:"upload-to",key:"upload-icon"}):null,renderItemLabel:e=>e.label,renderCustomGroupContent:e=>this._renderCustomTemplateGroupContent(e)}),this._filterText="",this._prompt=null,this._spinner=new F,this._loading=!1,this._selectionList=new it({displayMode:"layer",itemActionConfigs:this._selectionListItemActionConfigs,onListItemSelect:({item:e})=>this._onSelectionListItemSelect(e),visibleElements:new Xe({header:!1})}),this._selectionToolbar=new me({visibleElements:new ue({chip:!1})}),this._updatingHandles=new g,this.headingLevel=4,this.messages=null,this.messagesBatchAttributeForm=null,this.messagesCommon=null,this.messagesTemplates=null,this.messagesFeature=null,this.supportingWidgetDefaults=null,this.viewModel=new C,this.visibleElements=new ke,this._renderAttachments=()=>this._attachments.render(),this._renderFeatureForm=()=>this._featureForm.render(),this._renderBatchAttributeForm=()=>this._batchAttributeForm.render(),this._renderFeatureTemplates=()=>this._featureTemplates.render(),this._renderSelectionList=()=>this._selectionList.render(),this._renderSelectionToolbar=()=>this._selectionToolbar.render(),this._renderSketch=()=>this._sketchToolbar?R("div",{class:ye.sketchContainer,key:"editor-sketch-container"},this._sketchToolbar?.render()):void 0,this._renderSelectIcon=()=>R("calcite-icon",{icon:"cursor",slot:"content-start"}),this.EditorPanel=({heading:e,key:t,selected:s},...i)=>{const{visibleElements:o}=this;return R("calcite-flow-item",{closable:!1,heading:e,headingLevel:this.headingLevel,key:t,loading:this._loading,selected:s,onCalciteFlowItemBack:this._onBack},o.zoomToButton&&this.viewModel.canZoomTo?R("calcite-action",{alignment:"center",appearance:"transparent",icon:"zoom-to-object",key:"zoom-to-button",onclick:()=>this.viewModel.zoomTo(),slot:"header-actions-end",text:this.messages.zoomTo,title:this.messages.zoomTo}):null,o.settingsMenu?R(De,{editorViewModel:this.viewModel,messagesCommon:this.messagesCommon,visibleElements:o}):null,...i)},this._showDiscardEditsPrompt=()=>{const{messages:e,activeWorkflow:t}=this,s={title:e.cancelEditTitle,message:e.cancelEditWarningMessage,yesLabel:e.discardEdits,noLabel:e.continueEditing};return"create-features"===t?.type&&E(t.data.creationInfo)?this._showPromptAndWait("success"===t.data.upload?.state?e.modelUploads.cancelPlacementPrompt:e.modelUploads.cancelUploadPrompt):"update"===t?.type&&t.activeFeatureFormViewModel?.activeAssociation?this._showPromptAndWait({...s,message:e.cancelAssociationEditWarning}):this._showPromptAndWait(s)},this._showGenericCancelPrompt=()=>{const{messages:e,messagesCommon:t}=this;return this._showPromptAndWait({title:e.cancelRequestTitle,message:e.cancelRequestWarningMessage,yesLabel:t.form.yes,noLabel:t.form.no})},this._showPrompt=e=>{this._prompt?.cancel?.(),this._prompt=e},this._clearPrompt=()=>{this._prompt=null},this._onSave=()=>{this.viewModel.saveWorkflow()},this._onDelete=()=>{const e=this.viewModel.activeFeatureCount,t=e>1?this.messages.multiFeature:this.messages.singleFeature;this._showPrompt({title:t.deleteWarningTitle,message:t.deleteWarningMessage,context:"danger",actions:{primary:{label:Q(t.delete,{count:e}),action:()=>{this.deleteFeatures(),this._clearPrompt()}},secondary:{label:t.keep,action:this._clearPrompt}}})},this._onDeleteAssociation=()=>{const{messages:e,messagesCommon:t}=this;this._showPrompt({title:e.deleteAssociationTitle,message:e.deleteAssociationMessage,context:"danger",actions:{primary:{label:t.delete,action:()=>{this.deleteAssociationFromWorkflow(),this._clearPrompt()}},secondary:{label:e.keepAssociation,action:this._clearPrompt}}})},this._onToggleUpdateWorkflow=()=>this.viewModel.toggleUpdateWorkflow(),this._onBack=e=>(e?.stopPropagation(),this.viewModel.back()),this._onAttachmentAdd=()=>{const{activeWorkflow:e}=this.viewModel;e&&("create-features"===e.type||"update"===e.type&&"create-features"===e.activeWorkflow?.type?(this._attachments.addFile(),e.back()):this._attachments.addAttachment().then(()=>e.back()))},this._onAttachmentUpdate=()=>{const{activeWorkflow:e}=this.viewModel;e&&("create-features"===e.type?(this._attachments.updateFile(),e.back()):this._attachments.updateAttachment().then(()=>e.back()))},this._onAttachmentDelete=()=>{const{messages:e,messagesCommon:t}=this;this._showPrompt({title:e.deleteAttachmentWarningTitle,message:e.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:t.delete,action:this._onAttachmentDeleteConfirm},secondary:{label:e.keepAttachment,action:this._clearPrompt}}})},this._onAttachmentDeleteConfirm=async()=>{const e=this._attachments,{activeWorkflow:t}=this.viewModel;t&&("create-features"===t.type?e.deleteFile():(await e.deleteAttachment(e.viewModel.activeAttachmentInfo),this._clearPrompt()),await t.back(),this._clearPrompt())},this._onAttachmentsError=e=>{this._showPrompt({title:this.messages.errorWarningTitle,message:e.message,context:"warning",actions:{primary:{label:this.messagesCommon.form.ok,action:this._clearPrompt}}})}}initialize(){this._featureForm.showPrompt=this._showPrompt,this._featureForm.clearPrompt=this._clearPrompt,this.addHandles([l(()=>K(this.headingLevel),e=>{this._featureForm.headingLevel=e,this._featureTemplates.headingLevel=e},u),p(()=>this.viewModel.activeWorkflow,"cancel-request",({controller:e})=>{(this.viewModel.hasPendingEdits?this._showDiscardEditsPrompt():this._showGenericCancelPrompt()).then(t=>t?e.allow():e.deny())}),m(()=>this.viewModel.formViewModel,e=>{P(e)?this._batchAttributeForm.viewModel=e:this._featureForm.viewModel=e},u),m(()=>this.viewModel.utilityNetworkAssociationAddAssociationViewModel,e=>{this._associationItemList?this._associationItemList.viewModel=e:this._updatingHandles.addPromise(this._initializeAssociationItemList(e))},u),m(()=>this.viewModel.utilityNetworkAssociationAddAssociationViewModel?.association,()=>{this._setUpAssociationSettings()}),l(()=>[this.viewModel,this.viewModel?.attachmentsViewModel,this.viewModel?.featureTemplatesViewModel,this.viewModel?.spinnerViewModel,this.viewModel?.selectionListViewModel,this.viewModel?.selectionToolbarViewModel],([e,t,s,i,o,r])=>{this._attachments.viewModel=t,this._featureTemplates.viewModel=s,this._spinner.viewModel=i,this._selectionList.viewModel=o,this._selectionToolbar.viewModel=r,e.showDiscardEditsPrompt=this._showDiscardEditsPrompt},u),l(()=>this.view,(e,t)=>{const s=`editor-${this.id}-spinner`;t?.ui.remove(this._spinner,s),e?.ui.add(this._spinner,{key:s,position:"manual"}),this._associationItemList&&(this._associationItemList.view=e)},u),l(()=>[this.supportingWidgetDefaults,this.viewModel.sketchViewModel],([e])=>{e&&(this._featureForm.set(e.featureForm),this._attachments.set(e.attachments),this._featureTemplates.set(e.featureTemplates),this.viewModel.sketchViewModel?.set(e.sketch))},u),m(()=>this._attachments?.error,e=>this._onAttachmentsError(e)),m(()=>this._selectionListItemActionConfigs,()=>{this._selectionList.itemActionConfigs=this._selectionListItemActionConfigs}),m(()=>this.viewModel?.failures,e=>{const{messages:t}=this,[{error:s,retry:i,cancel:o}]=e;this._showPrompt({title:t.errorWarningTitle,message:Q(t.errorWarningMessageTemplate,{errorMessage:s.message}),context:"warning",actions:{primary:{label:t.retry,action:()=>{i(),this._clearPrompt()}},secondary:{label:t.ignore,action:()=>{o(),this._clearPrompt()}}}})}),l(()=>this.viewModel?.state,e=>{switch(e){case"awaiting-feature-to-update":case"ready":case"disabled":this._filterText="",this._featureTemplates.filterText=""}}),l(()=>this.viewModel.featureFormDisabled,e=>this._featureForm.disabled=e),l(()=>this.visibleElements.sketch,()=>this._setupSketch(),u),Je({getLoading:()=>{const{viewModel:e}=this;return e.syncing||e.updating||this._attachments.submitting||this._updatingHandles.updating},setEffectiveLoading:e=>{this._loading=e}})])}destroy(){this._associationItemList?.destroy(),this._associationSettings?.destroy(),this._selectionList.destroy(),this._selectionToolbar.destroy(),this._attachments.destroy(),this._batchAttributeForm.destroy(),this._featureForm.destroy(),this._featureTemplates.destroy(),this._spinner.destroy(),this._sketchToolbar=o(this._sketchToolbar),this._sketchImportAbortController=r(this._sketchImportAbortController)}loadDependencies(){return Promise.all([W({action:()=>import("../chunks/index5.js"),flow:()=>import("../chunks/index32.js"),"flow-item":()=>import("../chunks/index33.js"),icon:()=>import("../chunks/index.js"),list:()=>import("../chunks/index19.js")}),fe(),Promise.all([fe(),W({action:()=>import("../chunks/index5.js")})]),Ce(),Ee(),fe(),W({accordion:()=>import("../chunks/index56.js"),"accordion-item":()=>import("../chunks/index57.js")}),q(),Promise.all([Ce(),Ee(),fe()]),Promise.all([W({icon:()=>import("../chunks/index.js"),loader:()=>import("../chunks/index28.js")}),Ce(),fe()])])}get _deleteButtonCommonInfo(){return{appearance:"outline",kind:"danger"}}get _selectionListItemActionConfigs(){const{messages:e}=this;return[{label:e?.batchEditing?.editThisFeature,icon:"edit-attributes",type:"feature",callback:({item:e})=>this._onSelectionListMenuItemSelect(e)},{label:e?.batchEditing?.editTheseFeatures,icon:"edit-attributes",type:"layer",callback:({item:e})=>this._onSelectionListMenuItemSelect(e)}]}get activeWorkflow(){return this.viewModel.activeWorkflow}get effectiveSelectionManager(){return this.viewModel.effectiveSelectionManager}get hideTemplatesForInactiveLayers(){return this.viewModel.hideTemplatesForInactiveLayers}set hideTemplatesForInactiveLayers(e){this.viewModel.hideTemplatesForInactiveLayers=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()}startCreateFeaturesWorkflowAtFeatureCreation(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(e)}startCreateFeaturesWorkflowAtFeatureEdit(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureEdit(e)}startUpdateFeaturesWorkflow(e){return this.viewModel.startUpdateFeaturesWorkflow(e)}startUpdateWorkflowAtFeatureSelection(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()}startUpdateWorkflowAtMultipleFeatureSelection(e){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(e)}startUpdateWorkflowAtFeatureEdit(e){return this.viewModel.startUpdateWorkflowAtFeatureEdit(e)}async startUpdateWorkflowWithActiveSelection(){await this.viewModel.startUpdateWorkflowWithActiveSelection()}deleteFeatureFromWorkflow(){return s(i.getLogger(this),"Editor.deleteFeatureFromWorkflow is deprecated. Use Editor.deleteFeatures instead.",{version:"4.33",replacement:"Editor.deleteFeatures",warnOnce:!0}),this.deleteFeatures()}async deleteFeatures(){await this.viewModel.deleteFeatures()}deleteAssociationFromWorkflow(){return this.viewModel.deleteAssociationFromWorkflow()}cancelWorkflow(e){return this.viewModel.cancelWorkflow(e)}render(){const{visibleElements:e,viewModel:t}=this,s=this.classes(ye.base,ae.widget,ae.panel);if(!t)return R("div",{class:s,key:"empty"});const{pageStack:i}=t,o=i.length-1,r=i.map((e,t)=>this._renderPage(e,t===o));return R("div",{class:s,key:"base"},e.flow?R("calcite-flow",{inert:!!this._prompt,key:"flow"},r):r,this._prompt?R(Z,{...this._prompt,headingLevel:this.headingLevel}):void 0)}_renderPage(e,t){const s={selected:t};switch(e){case"disabled":break;case"ready":return this._renderReady(s);case"viewing-selection-list":return this._renderSelectionListPage(s);case"awaiting-feature-creation-info":return this._renderAwaitingFeatureCreationInfo(s);case"creating-features-upload-details":return this._renderUploadDetails(s);case"creating-features":return this._renderCreatingFeatures(s);case"editing-existing-feature":case"editing-features":case"editing-attributes":return this._renderUpdateFeature(s);case"awaiting-update-feature-candidate":return this._renderFeatureList(s);case"adding-attachment":return this._renderAttachmentAdding(s);case"editing-attachment":return this._renderAttachmentEditing(s);case"viewing-associated-layers":case"viewing-associated-features":return this._renderViewAssociatedLayers(s);case"add-association-select-layer":case"add-association-select-feature":return this._renderSelectFeature(s);case"add-association-create-association":return this._renderAddAssociation(s)}return R("div",{key:"empty-page"})}_renderAwaitingFeatureCreationInfo(e){const{EditorPanel:t,messages:s}=this;return R(t,{heading:s.selectTemplate,key:"templates-panel",...e},R(ve,{key:"feature-templates"},R(_e,null,this._renderFeatureTemplates())))}_renderUploadDetails(e){const{EditorPanel:t,activeWorkflow:s,messages:i}=this;if("create-features"!==s?.type)return null;const o=s.data.upload;return o?R(t,{heading:i.createFeatures,key:"upload-details-panel",...e},R(He,{helpMessage:this._helpMessage,messages:i,upload:o})):null}_renderCreatingFeatures(e){const{EditorPanel:t,activeWorkflow:s,messages:i,messagesCommon:o,headingLevel:r,viewModel:n}=this;if(!s)return null;const a="create-features"===s.type&&s.numPendingFeatures>0||"update"===s.type&&"create-features"===s?.activeWorkflow?.type&&s.activeWorkflow?.numPendingFeatures>0;return R(t,{heading:i.createFeatures,key:"create-features-panel",...e},a?R(Oe,{editorViewModel:n,headingLevel:r,messages:i,messagesCommon:o,renderAttachments:this._renderAttachments,renderBatchAttributeForm:this._renderBatchAttributeForm,renderFeatureForm:this._renderFeatureForm,renderSketchToolbar:this._renderSketch,onDelete:this._onDelete,onDeleteAssociation:this._onDeleteAssociation,onSave:this._onSave}):R(Fe,{helpMessage:this._helpMessage,renderSketchToolbar:this._renderSketch}))}_renderUpdateFeature(e){const{EditorPanel:t,messages:s,messagesCommon:i,headingLevel:o,viewModel:r}=this,n=r.activeFeatureCount>1?s.multiFeature.editPanelTitle:s.singleFeature.editPanelTitle;return R(t,{heading:n,key:"update-feature-panel",...e},R(Oe,{editorViewModel:r,headingLevel:o,messages:s,messagesCommon:i,renderAttachments:this._renderAttachments,renderBatchAttributeForm:this._renderBatchAttributeForm,renderFeatureForm:this._renderFeatureForm,onDelete:this._onDelete,onDeleteAssociation:this._onDeleteAssociation,onSave:this._onSave}))}_getAssociationTypeTitle(e){const{messages:t}=this;if(!e)return t.singleFeature.editPanelTitle;if(e.title)return e.title;const{messagesFeature:s}=this;switch(e.type){case"attachment":return s.associationsAttachments;case"connectivity":return s.associationsConnectivity;case"structure":return s.associationsStructure;case"content":return s.associationsContents;case"container":return s.associationsContainer}}_getAddAssociationTypeTitle(e){const{messages:t}=this;if(!e)return t.singleFeature.editPanelTitle;const s=t.associations;switch(e.type){case"attachment":return s.addAttachment;case"connectivity":return s.addConnectivity;case"structure":return s.addStructure;case"content":return s.addContent;case"container":return s.addContainer}}async _initializeAssociationItemList(e){const t=(await import("../chunks/UtilityNetworkAssociationItemList.js")).default;this._associationItemList=new t({view:this.view,viewModel:e})}async _initializeAssociationSettings(){const e=new(0,(await import("../chunks/UtilityNetworkAssociationSettings.js")).default);return this._associationSettings=e,e}_renderViewAssociatedLayers(e){const{EditorPanel:t,messages:s,messagesCommon:i,headingLevel:o,viewModel:r}=this,n=r.featureFormViewModel?.activeAssociationInput?.activeAssociationType,a=this._getAssociationTypeTitle(n);return R(t,{heading:a,key:"viewing-associated-layers-panel",...e},R(Oe,{editorViewModel:r,headingLevel:o,messages:s,messagesCommon:i,renderAttachments:this._renderAttachments,renderBatchAttributeForm:this._renderBatchAttributeForm,renderFeatureForm:this._renderFeatureForm,renderSketchToolbar:this._renderSketch,onDelete:this._onDelete,onDeleteAssociation:this._onDeleteAssociation,onSave:this._onSave}))}_renderSelectFeature(e){const{_associationItemList:t,EditorPanel:s,viewModel:i,messagesCommon:o}=this,r=i.utilityNetworkAssociationAddAssociationViewModel,n=this._getAddAssociationTypeTitle(r?.associationType),a="ready"!==r?.state||this.viewModel.featureFormDisabled;return t?R(s,{heading:n,key:"add-association-select-feature",...e},R(ve,{key:"select-feature"},R(_e,null,t.render())),R(Se,{buttons:[t.filterOptionsVisible?{appearance:"solid",label:o.apply,disabled:a,onClick:()=>t.applyFilterOptions(),type:"button"}:void 0,{appearance:"outline",label:o.cancel,disabled:a,onClick:()=>{"update"===i.activeWorkflow?.type&&(r?.reset(),i.activeWorkflow.cancelActiveWorkflow())},type:"button"}]})):R(s,{heading:n,key:"add-association-select-feature",...e})}async _setUpAssociationSettings(){const{viewModel:e}=this,t=this._associationSettings??await this._updatingHandles.addPromise(this._initializeAssociationSettings()),s=e.utilityNetworkAssociationAddAssociationViewModel,i="update"===e.activeWorkflow?.type?e.activeWorkflow:null,o=i?i.activeWorkflow:null,r="add-association"===o?.type?o.sourceFeatureItem:null,n=s?.selectedFeature,a=s?.association,l=s?.utilityNetwork;r&&n&&a&&l&&(t.sourceFeature=r,t.targetFeature=n,t.association=a,t.utilityNetwork=l)}_renderAddAssociation(e){const{_associationSettings:t,EditorPanel:s,viewModel:i,messagesCommon:o}=this;if(!t)return null;const r=i.utilityNetworkAssociationAddAssociationViewModel,n=this._getAddAssociationTypeTitle(r?.associationType),a="ready"!==r?.state;return R(s,{heading:n,key:"add-association",...e},R(ve,{key:"add-association-content"},R(_e,null,t.render())),R(Se,{buttons:[{label:o.add,disabled:a||!r.canAddAssociation,onClick:()=>this._onSave(),type:"button"},{appearance:"outline",label:o.cancel,disabled:a,onClick:()=>{"update"===i.activeWorkflow?.type&&i.activeWorkflow.cancelActiveWorkflow()},type:"button"}]}))}_renderCustomTemplateGroupContent(e){const{messages:t,viewModel:s}=this,i=n(e.group.items,e=>s.itemHasInvalidFormTemplate(e)?t.formFieldCreateError:void 0);return i?R(Ue,{kind:"warning",message:i}):null}_renderAttachmentAdding(e){const{EditorPanel:t,_attachments:s,messages:i,messagesCommon:o}=this;return R(t,{heading:i.addAttachment,key:"attachment-adding-panel",...e},R(ve,{key:"attachments"},this._renderAttachments()),R(Se,{buttons:[{label:s.submitting?o.cancel:o.add,disabled:s.submitting||!s.selectedFile,onClick:this._onAttachmentAdd,type:"button"}]}))}_renderSelectionListPage(e){const{_selectionList:t,messages:s,EditorPanel:i}=this,{batchUpdateActions:o}=this.visibleElements,{effectiveCount:r,filterText:n,maxVisibleFeatureCountPerLayer:a,visibleFeatureCount:l,visibleLayerCount:c}=t,p=c>1,m=null!=n&&""!==n?l:r,u=1===c&&m>a,d=p||u||0===l;return R(i,{heading:s.widgetLabel,key:"selection-list-panel",...e},this.visibleElements.selectionToolbar&&"3d"!==this.view?.type?R("div",{class:ye.selectionToolbarContainer},this._renderSelectionToolbar()):void 0,R(ve,{key:"selection-list"},R(_e,null,this._renderSelectionList())),R(Se,{buttons:[o?{label:Q(s.batchEditing.editCount,{count:m}),disabled:d,onClick:()=>this.startUpdateWorkflowWithActiveSelection(),type:"button"}:void 0],notice:o&&p?{text:s.batchEditing.selectOneLayer,icon:"information"}:o&&u?{text:Q(this.messagesBatchAttributeForm.formFailedToLoadTooManyFeatures,{num:a}),icon:"information"}:void 0}))}_renderAttachmentEditing(e){const{EditorPanel:t,_attachments:s,activeWorkflow:i,messages:o,messagesCommon:r}=this;return i?R(t,{heading:o.editAttachment,key:"attachment-editing-panel",...e},R(ve,{key:"attachments"},this._renderAttachments()),i.shouldAllowAttachmentEditing?R(Se,{buttons:[{label:r.update,disabled:s.submitting||!s.selectedFile,onClick:this._onAttachmentUpdate,type:"button"},{...this._deleteButtonCommonInfo,onClick:this._onAttachmentDelete,disabled:s.submitting,label:r.delete,type:"button"}]}):void 0):null}_renderReady(e){const{EditorPanel:t,messages:s,viewModel:i,visibleElements:o}=this,r=this._helpMessage;return R(t,{heading:s.widgetLabel,key:"landing-panel",...e},R(ve,{key:"landing-content"},i.editorItems.length?[o.editFeaturesSection?R(_e,{key:"edit-actions"},this._renderUpdateActions()):null,o.createFeaturesSection&&i.canCreateVisible?R(_e,{key:"create-actions"},this._renderCreateActions()):null]:R(we,{key:"no-content"},s.noEditableLayers)),r?R("div",{class:ye.helpMessage,key:"footer-actions",slot:"footer"},r):void 0)}get _helpMessage(){const{activeWorkflow:e,messages:t,view:s}=this,i=e?.helpMessage;return i?t["3d"===s?.type?"helpMessages3d":"helpMessages2d"]?.[i]:void 0}_renderUpdateActions(){const{messages:e,messagesCommon:t,viewModel:s}=this,i={id:"select",label:t.select};return R("div",{class:ye.updateActions,key:"update-actions"},R(J,{level:K(this.headingLevel)},e.editFeatures),this.visibleElements.selectionToolbar&&"3d"!==this.view?.type?R("div",{class:ye.selectionToolbarContainer},this._renderSelectionToolbar()):R("calcite-list",{class:ye.updateActionsList,label:e.editFeaturesList,selectionAppearance:"border",selectionMode:"single"},I({disabled:!s.canUpdateVisible,grouped:!1,item:i,selectedItem:"awaiting-feature-to-update"===s.activeWorkflow?.stepId?i:void 0,renderIcon:this._renderSelectIcon,onItemSelect:this._onToggleUpdateWorkflow})))}_renderCreateActions(){return R("div",{key:"create-actions"},R(J,{level:K(this.headingLevel)},this.messages.createFeatures),R("div",{class:ye.featureTemplatesContainer,key:"templates"},this._renderFeatureTemplates()))}_renderFeatureList(e){const{EditorPanel:t,viewModel:s}=this,{activeWorkflow:i}=s;if("update"!==i?.type)return null;const o=i.data.candidates,r=Q(this.messages.multipleFeaturesTemplate,{total:o.length});return R(t,{heading:r,key:"feature-list",...e},R(Me,{editorItems:s.editorItems,editorMessages:this.messages,filterText:this._filterText,id:this.id,messagesTemplates:this.messagesTemplates,workflow:i,onFilterTextChange:e=>this._filterText=e,onSelectFeature:(e,t)=>s.selectFeature(e,t),onZoomTo:e=>s.zoomTo(e)}))}_showPromptAndWait({title:e,message:t,yesLabel:s,noLabel:i}){const o=a(),{view:r}=this,n=r?.focused;return this._showPrompt({title:e,message:t,context:"danger",actions:{primary:{label:s,action:()=>o.resolve(!0)},secondary:{label:i,action:()=>o.resolve(!1)}}}),o.promise.finally(()=>{this._clearPrompt(),n&&r?.focus()})}async _onSelectionListItemSelect(e){await this.viewModel.onSelectionListItemSelect(e)}async _onSelectionListMenuItemSelect(e){await this.viewModel.onSelectionListMenuItemSelect(e)}async _setupSketch(){if(!this.visibleElements.sketch)return this._sketchImportAbortController=r(this._sketchImportAbortController),this._sketchToolbar=o(this._sketchToolbar),void this.removeHandles(ot);if(this._sketchImportAbortController)return;const e=new AbortController;this._sketchImportAbortController=e;const t=await import("./Sketch.js");if(!e.signal.aborted)try{this._sketchToolbar=new t.default({toolbarKind:"docked",contextualToolLocation:"inline-end",scale:"s",visibleElements:new oe({deleteButton:!1,settingsMenu:!1,directionModePicker:!1,selectionCountLabel:!1,duplicateButton:!1,createTools:new ne({freehandPolygon:!0,freehandPolyline:!0}),selectionTools:new re({"lasso-selection":!1,"rectangle-selection":!1})})}),this.addHandles([l(()=>this.viewModel.activeLeafWorkflow?.availableCreateTools,e=>{this._sketchToolbar&&(this._sketchToolbar.availableCreateTools=e)},u),l(()=>this.visibleElements.undoRedoButtons,e=>{this._sketchToolbar&&(this._sketchToolbar.visibleElements.undoRedoMenu=e)},u),m(()=>this.viewModel?.sketchViewModel,e=>{this._sketchToolbar&&(this._sketchToolbar.viewModel=e)},u)],ot)}finally{this._sketchImportAbortController=null}}get test(){return{sketch:this._sketchToolbar,showPrompt:this._showPromptAndWait.bind(this)}}};e([d()],rt.prototype,"_batchAttributeForm",void 0),e([d()],rt.prototype,"_featureForm",void 0),e([d()],rt.prototype,"_sketchToolbar",void 0),e([d()],rt.prototype,"_attachments",void 0),e([d()],rt.prototype,"_associationItemList",void 0),e([d()],rt.prototype,"_associationSettings",void 0),e([d()],rt.prototype,"_featureTemplates",void 0),e([d()],rt.prototype,"_filterText",void 0),e([d()],rt.prototype,"_prompt",void 0),e([d()],rt.prototype,"_spinner",void 0),e([d()],rt.prototype,"_deleteButtonCommonInfo",null),e([d()],rt.prototype,"_loading",void 0),e([d()],rt.prototype,"_selectionList",void 0),e([d()],rt.prototype,"_selectionListItemActionConfigs",null),e([d()],rt.prototype,"_selectionToolbar",void 0),e([d({readOnly:!0})],rt.prototype,"activeWorkflow",null),e([d()],rt.prototype,"effectiveSelectionManager",null),e([d()],rt.prototype,"headingLevel",void 0),e([d()],rt.prototype,"hideTemplatesForInactiveLayers",null),e([d()],rt.prototype,"icon",null),e([d()],rt.prototype,"label",null),e([d()],rt.prototype,"labelOptions",null),e([d()],rt.prototype,"layerInfos",null),e([d(),Y("esri/widgets/Editor/t9n/Editor")],rt.prototype,"messages",void 0),e([d(),Y("esri/widgets/BatchAttributeForm/t9n/BatchAttributeForm")],rt.prototype,"messagesBatchAttributeForm",void 0),e([d(),Y("esri/t9n/common")],rt.prototype,"messagesCommon",void 0),e([d(),Y("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],rt.prototype,"messagesTemplates",void 0),e([d(),Y("esri/widgets/Feature/t9n/Feature")],rt.prototype,"messagesFeature",void 0),e([d()],rt.prototype,"snappingOptions",null),e([d()],rt.prototype,"tooltipOptions",null),e([d()],rt.prototype,"supportingWidgetDefaults",void 0),e([d({type:k,nonNullable:!0})],rt.prototype,"valueOptions",null),e([d()],rt.prototype,"view",null),e([d(),de(["sketch-create","sketch-delete","sketch-update","workflow-cancel","workflow-commit"])],rt.prototype,"viewModel",void 0),e([d({type:ke,nonNullable:!0})],rt.prototype,"visibleElements",void 0),e([d()],rt.prototype,"_helpMessage",null),rt=e([y("esri.widgets.Editor")],rt);const nt=rt;export{nt as default};
