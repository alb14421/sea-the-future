/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import e,{g as s}from"../core/Accessor.js";import{L as i}from"../chunks/Logger.js";import{watch as o}from"../core/reactiveUtils.js";import{property as n}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import{subclass as r}from"../core/accessorSupport/decorators/subclass.js";import a from"./Widget.js";import{c as l}from"../chunks/utils24.js";import c,{f as d,c as u,d as p,a as h}from"./DirectionalPad/DirectionalPadViewModel.js";import{l as m}from"../chunks/componentsUtils.js";import{g as b}from"../chunks/globalCss.js";import{i as v,b as j}from"../chunks/widgetUtils.js";import{m as g}from"../chunks/messageBundle.js";import{t as k}from"../chunks/jsxFactory.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/Lifecycle.js";import"../chunks/metadata.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/promiseUtils.js";import"../core/Error.js";import"../chunks/object.js";import"../config.js";import"../chunks/string.js";import"../chunks/events.js";import"../chunks/SetUtils.js";import"../chunks/SimpleTrackingTarget.js";import"../chunks/ensureType.js";import"../chunks/MapUtils.js";import"../chunks/Warning.js";import"../intl.js";import"../chunks/date.js";import"../chunks/jsonMap.js";import"../chunks/locale.js";import"../chunks/constants.js";import"../chunks/datetime.js";import"../chunks/number.js";import"../chunks/substitute.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/jsonUtils.js";import"../chunks/persistableUrlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Promise.js";import"../chunks/uuid.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/projector.js";import"../chunks/sanitizerUtils.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/mathUtils.js";import"./support/GoTo.js";import"../chunks/goToUtils.js";let _=class extends e{constructor(t){super(t),this.directionalButtons=!0,this.rotationSlider=!1,this.rotationResetButton=!1}};t([n({type:Boolean,nonNullable:!0})],_.prototype,"directionalButtons",void 0),t([n({type:Boolean,nonNullable:!0})],_.prototype,"rotationSlider",void 0),t([n({type:Boolean,nonNullable:!0})],_.prototype,"rotationResetButton",void 0),_=t([r("esri.widgets.DirectionalPad.VisibleElements")],_);const w=_;let y=class extends a{constructor(t,e){super(t,e),this._buttonsContainer=null,this._buttons={},this.messages=null,this.visibleElements=new w,this.viewModel=new c,this.visualScale="s",this._rotateIcon=t=>({"--rotation":`rotate(${t}deg)`}),this._afterButtonContainerCreate=t=>{this._buttonsContainer=t,this._buttonsContainer.addEventListener("contextmenu",this._onContextMenu,{capture:!0})},this._afterButtonContainerRemoved=()=>{this._buttonsContainer?.removeEventListener("contextmenu",this._onContextMenu,{capture:!0}),this._buttonsContainer=null},this._afterButtonCreate=(t,e)=>{this._buttons[t]=e},this._afterButtonRemoved=t=>{this._buttons[t]=void 0},this._onContextMenu=t=>t.preventDefault(),this._onButtonPointerDown=t=>{if(null===this._buttonsContainer)return;const e=t.target,s=e?.shadowRoot?.querySelector("button");s?.hasPointerCapture(t.pointerId)&&s.releasePointerCapture(t.pointerId);const i=d(this._buttonsContainer);this.viewModel.beginFollowingPointer(t,i)},this._onKeyDown=(t,{key:e})=>{v(e)&&this.viewModel.moveOnce(t)},this._onSliderInput=({currentTarget:t})=>{"number"==typeof t.value&&(this.viewModel.rotation=t.value)},this._onRotationReset=()=>{this.viewModel.rotation=0},s(i.getLogger(this),"Directional Pad","arcgis-directional-pad",{version:"4.32"})}loadDependencies(){return m({action:()=>import("../chunks/index5.js"),"action-group":()=>import("../chunks/index16.js").then(t=>t.i),"action-bar":()=>import("../chunks/index15.js"),icon:()=>import("../chunks/index.js"),slider:()=>import("../chunks/index71.js")})}initialize(){this.addHandles(o(()=>this.viewModel.angle,()=>{const t=this._buttonsContainer?.contains(document.activeElement);t&&(null==this.viewModel.angle?this.container?.focus():j(this._buttons[this.viewModel.angle]))}))}get disabled(){return this.viewModel.disabled}set disabled(t){this.viewModel.disabled=t}get icon(){return"move"}set icon(t){this._overrideIfSome("icon",t)}get label(){return this.messages?.widgetLabel??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}get speed(){return this.viewModel.speed}set speed(t){this.viewModel.speed=t}get _rotationEnabled(){return!this.view?.ready||this.view.constraints.rotationEnabled}render(){const{label:t,disabled:e,viewModel:s}=this,i=this.classes(u.base,b.widget,e?b.disabled:null);return k("div",{"aria-label":t,class:i,tabIndex:-1},s.supported?this._renderContent():this._renderUnsupportedMessage())}_renderUnsupportedMessage(){return k("section",{class:u.error,key:"unsupported"},k("p",null,this.messages.unsupported))}_renderContent(){return[this.visibleElements.directionalButtons?this._renderDirectionalButtons():void 0,this.visibleElements.rotationSlider?this._renderRotation():void 0]}_renderDirectionalButtons(){return k("calcite-action-bar",{expandDisabled:!0,floating:!0,key:"directional-buttons-container",layout:"grid",overflowActionsDisabled:!0},k("calcite-action-group",{afterCreate:this._afterButtonContainerCreate,afterRemoved:this._afterButtonContainerRemoved,class:u.buttonsContainer,dir:"ltr"},p.slice(0,4).map(t=>this._renderButton(t)),this._renderCompass(),p.slice(4).map(t=>this._renderButton(t))))}_renderButton(t){const{label:e,iconName:s}=h[t],i=this.messages[e];return k("calcite-action",{active:this.viewModel.angle===t,afterCreate:e=>this._afterButtonCreate(t,e),afterRemoved:()=>this._afterButtonRemoved(t),alignment:"center",class:u.button,"data-angle":t.toString(),disabled:this.disabled,key:t,onkeydown:this._onKeyDown.bind(void 0,t),onpointerdown:this._onButtonPointerDown,scale:this.visualScale,text:i,title:i},k("calcite-icon",{icon:s,scale:this.visualScale}))}_renderCompass(){const t=this.disabled||l(this.view)?"compass-needle":"arrow-up",e=0===this.viewModel.rotation,s=this.messages.resetHeading;return k("calcite-action",{alignment:"center",class:u.compassButton,disabled:this.disabled||!this._rotationEnabled||e,key:"compass",onclick:this._onRotationReset,scale:this.visualScale,styles:this._rotateIcon(this.viewModel.rotation),text:s,title:s},!e&&k("calcite-icon",{icon:t,scale:this.visualScale}))}_renderRotation(){return k("calcite-action-bar",{expandDisabled:!0,floating:!0,key:"slider-container",layout:"horizontal"},k("calcite-action-group",{class:u.rotationContainer},this.visibleElements.rotationResetButton?this._renderRotationResetButton():null,this._renderRotationSlider()))}_renderRotationResetButton(){const t=this.messages.resetHeading;return k("calcite-action",{alignment:"center",class:u.rotationReset,disabled:this.disabled||!this._rotationEnabled,onclick:this._onRotationReset,scale:this.visualScale,text:t,title:t},k("calcite-icon",{flipRtl:!0,icon:"rotate",scale:this.visualScale}))}_renderRotationSlider(){return k("div",{class:u.rotationSliderContainer},k("calcite-slider",{"aria-label":this.messages.heading,disabled:this.disabled||!this._rotationEnabled,labelHandles:!0,max:360,min:0,required:!0,scale:this.visualScale,value:Math.round(this.viewModel.rotation),onCalciteSliderInput:this._onSliderInput}))}};t([n()],y.prototype,"_buttonsContainer",void 0),t([n()],y.prototype,"_buttons",void 0),t([n()],y.prototype,"disabled",null),t([n()],y.prototype,"icon",null),t([n()],y.prototype,"label",null),t([n(),g("esri/widgets/DirectionalPad/t9n/DirectionalPad")],y.prototype,"messages",void 0),t([n({type:w,nonNullable:!0})],y.prototype,"visibleElements",void 0),t([n()],y.prototype,"view",null),t([n({type:c})],y.prototype,"viewModel",void 0),t([n()],y.prototype,"visualScale",void 0),t([n()],y.prototype,"speed",null),t([n({readOnly:!0})],y.prototype,"_rotationEnabled",null),y=t([r("esri.widgets.DirectionalPad")],y);const f=y;export{f as default};
