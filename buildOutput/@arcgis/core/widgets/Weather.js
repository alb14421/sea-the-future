/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import s,{g as t}from"../core/Accessor.js";import{L as o}from"../chunks/Logger.js";import{m as r}from"../chunks/memoize.js";import{property as n}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import{subclass as i}from"../core/accessorSupport/decorators/subclass.js";import{a}from"../chunks/weather.js";import l from"./Widget.js";import{l as c}from"../chunks/componentsUtils.js";import{g as p}from"../chunks/globalCss.js";import{H as d}from"../chunks/Heading.js";import{c as u}from"../chunks/widgetUtils.js";import{m as h}from"../chunks/messageBundle.js";import{t as m,a as g}from"../chunks/jsxFactory.js";import v from"./Weather/WeatherViewModel.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/Lifecycle.js";import"../chunks/metadata.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/promiseUtils.js";import"../core/Error.js";import"../chunks/object.js";import"../config.js";import"../chunks/string.js";import"../chunks/events.js";import"../chunks/SetUtils.js";import"../chunks/SimpleTrackingTarget.js";import"../chunks/ensureType.js";import"../chunks/MapUtils.js";import"../chunks/Warning.js";import"../views/3d/environment/CloudyWeather.js";import"../core/JSONSupport.js";import"../chunks/enumeration.js";import"../chunks/jsonMap.js";import"../views/3d/environment/FoggyWeather.js";import"../views/3d/environment/RainyWeather.js";import"../views/3d/environment/SnowyWeather.js";import"../views/3d/environment/SunnyWeather.js";import"../intl.js";import"../chunks/date.js";import"../chunks/locale.js";import"../chunks/constants.js";import"../chunks/datetime.js";import"../chunks/number.js";import"../chunks/substitute.js";import"../chunks/messages.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../chunks/jsonUtils.js";import"../chunks/persistableUrlUtils.js";import"../chunks/assets.js";import"../chunks/domUtils.js";import"../core/Evented.js";import"../core/Promise.js";import"../core/reactiveUtils.js";import"../chunks/uuid.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/projector.js";import"../chunks/sanitizerUtils.js";import"../chunks/jsxWidgetSupport.js";import"../chunks/mathUtils.js";const j="esri-weather",y={base:j,content:`${j}__content`,hasError:`${j}__content--has-error`,selector:`${j}__selector`,options:`${j}__options`,optionsHidden:`${j}__options--hidden`,error:`${j}__error`,warning:`${j}__warning`},k={base:`${j}__labeled-slider`};let b=class extends l{constructor(e){super(e),this._onChange=e=>{this.onChange(e.currentTarget.value)}}render(){const{label:e}=this;return m("div",{class:k.base},m("calcite-label",{scale:"s"},e,m("calcite-slider",{"aria-label":e,disabled:this.disabled,max:1,min:0,step:.01,value:this.value,onCalciteSliderChange:this._onChange,onCalciteSliderInput:this._onChange})))}loadDependencies(){return c({label:()=>import("../chunks/index2.js"),slider:()=>import("../chunks/index71.js")})}};e([n()],b.prototype,"value",void 0),e([n()],b.prototype,"onChange",void 0),e([n()],b.prototype,"disabled",void 0),b=e([i("esri.widgets.Weather.LabeledSlider")],b);let w=class extends s{constructor(e){super(e),this.header=!0}};e([n({type:Boolean,nonNullable:!0})],w.prototype,"header",void 0),w=e([i("esri.widgets.Weather.VisibleElements")],w);const C=w,_={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};let f=class extends l{constructor(e){super(e),this.viewModel=new v({isDefaultViewModel:!0}),this.headingLevel=4,this.visibleElements=new C,this._renderWeatherTypeButton=e=>{const s=this.viewModel,t=this.messages[e].label,o="disabled"===s.state,r=!o&&s.current.type===e;return m("calcite-button",{appearance:r?"solid":"outline","aria-checked":r?"true":"false",disabled:o,iconStart:_[e],key:`${e}-type-button`,kind:r?"brand":"neutral",label:t,onclick:()=>{r||s.setWeatherByType(e)},scale:"l",title:t})},this._memoizedCallbacks=r(e=>({onCloudCoverChange:s=>{"cloudCover"in e&&(e.cloudCover=s)},onPrecipitationChange:s=>{"precipitation"in e&&(e.precipitation=s)},onFogStrengthChange:s=>{"fogStrength"in e&&(e.fogStrength=s)},onSnowCoverChange:e=>{this.viewModel.setSnowCoverEnabled(e.currentTarget.checked)}})),t(o.getLogger(this),"Weather","arcgis-weather",{version:"4.33"})}render(){const e="disabled"===this.viewModel.state;return m("div",{"aria-label":this.messages.widgetLabelAccessible,class:this.classes(y.base,p.widget,e&&p.widgetDisabled),role:"region"},this._renderContent())}loadDependencies(){return c({button:()=>import("../chunks/index6.js"),checkbox:()=>import("../chunks/index21.js"),icon:()=>import("../chunks/index.js"),label:()=>import("../chunks/index2.js")})}get view(){return this.viewModel?.view}set view(e){this.viewModel&&(this.viewModel.view=e)}get icon(){return"partly-cloudy"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get _errorMessage(){const e=this.messages.error;switch(this.viewModel.error){case"local-scene":return e.localScene;case"no-atmosphere":return e.noAtmosphere;case"unsupported-view":return e.unsupported;default:return null}}get _warningMessage(){return"not-visible"===this.viewModel.error&&null!=this.view&&"3d"===this.view?.type&&this.view.environment.atmosphereEnabled?this.messages.error.notVisible:null}_renderContent(){const{headingLevel:e,messages:s,viewModel:t,visibleElements:o}=this,r=this._warningMessage,n=t.current,i="error"===t.state;return m(g,null,o.header?m(d,{level:e},s.widgetLabel):null,i?m("div",{class:y.error,key:"error"},this._errorMessage):null,m("div",{class:u({[y.content]:!0,[y.hasError]:i}),key:"content"},m("div",{"aria-label":s.weatherType,class:y.selector,key:"type-selector",role:"radiogroup"},a.map(this._renderWeatherTypeButton)),Object.values(t.weatherByType).map(e=>m("div",{class:u({[y.options]:!0,[y.optionsHidden]:e.type!==n?.type}),key:"options-container"},this._renderOptions(e))),null!=r?this._renderWarning(r):null))}_renderOptions(e){const{viewModel:s,messages:t}=this,o="disabled"===s.state,r=this._memoizedCallbacks(e);switch(e.type){case"sunny":return m(b,{disabled:o,key:"sunny-cover",label:t.sunny.cloudCover,value:e.cloudCover,onChange:r.onCloudCoverChange});case"cloudy":return m(b,{disabled:o,key:"cloudy-cover",label:t.cloudy.cloudCover,value:e.cloudCover,onChange:r.onCloudCoverChange});case"rainy":return m(g,null,m(b,{disabled:o,key:"rainy-cover",label:t.rainy.cloudCover,value:e.cloudCover,onChange:r.onCloudCoverChange}),m(b,{disabled:o,key:"rainy-precipitation",label:t.rainy.precipitation,value:e.precipitation,onChange:r.onPrecipitationChange}));case"snowy":return m(g,null,m(b,{disabled:o,key:"snowy-cloud-cover",label:t.snowy.cloudCover,value:e.cloudCover,onChange:r.onCloudCoverChange}),m(b,{disabled:o,key:"snowy-precipitation",label:t.snowy.precipitation,value:e.precipitation,onChange:r.onPrecipitationChange}),m("calcite-label",{key:"snow-cover",layout:"inline",scale:"s",title:t.snowy.snowCoverTooltip},m("calcite-checkbox",{checked:"enabled"===e.snowCover,disabled:o,onCalciteCheckboxChange:r.onSnowCoverChange}),t.snowy.snowCover));case"foggy":return m(b,{disabled:o,key:"foggy-cover",label:t.foggy.fogStrength,value:e.fogStrength,onChange:r.onFogStrengthChange})}}_renderWarning(e){return m("div",{class:y.warning,key:"warning"},m("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),e)}};e([n()],f.prototype,"viewModel",void 0),e([n()],f.prototype,"view",null),e([n()],f.prototype,"headingLevel",void 0),e([n({type:C,nonNullable:!0})],f.prototype,"visibleElements",void 0),e([n()],f.prototype,"icon",null),e([n()],f.prototype,"label",null),e([n(),h("esri/widgets/Weather/t9n/Weather")],f.prototype,"messages",void 0),e([n()],f.prototype,"_errorMessage",null),e([n()],f.prototype,"_warningMessage",null),f=e([i("esri.widgets.Weather")],f);const S=f;export{S as default};
