/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as r}from"../chunks/tslib.es6.js";import{clone as t}from"../core/lang.js";import{L as o}from"../chunks/Logger.js";import{isDataProtocol as e,isAbsolute as s,normalize as i,makeData as n}from"../core/urlUtils.js";import{property as c}from"../core/accessorSupport/decorators/property.js";import{e as l}from"../chunks/enumeration.js";import{subclass as a}from"../core/accessorSupport/decorators/subclass.js";import p from"./Symbol3DLayer.js";import{w as h,i as m}from"../chunks/colors.js";import{s as u}from"../chunks/jsonMap.js";import{JSONSupport as y}from"../core/JSONSupport.js";import{r as j}from"../chunks/reader.js";import{w as d}from"../chunks/writer.js";import{f,a as k}from"../chunks/persistableUrlUtils.js";import{c as g,s as b}from"../chunks/materialUtils.js";import v from"../core/Accessor.js";import w from"../Color.js";import{a as S}from"../chunks/screenUtils.js";import{S as x}from"../chunks/Symbol3DMaterial.js";import"../config.js";import"../chunks/object.js";import"../chunks/string.js";import"../core/Error.js";import"../chunks/jsonUtils.js";import"../chunks/ensureType.js";import"../chunks/MapUtils.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/metadata.js";import"../chunks/Lifecycle.js";import"../chunks/tracking.js";import"../chunks/Warning.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/promiseUtils.js";import"../chunks/events.js";import"../chunks/SetUtils.js";import"../chunks/SimpleTrackingTarget.js";import"../kernel.js";import"../chunks/opacityUtils.js";import"../chunks/colorUtils.js";import"../chunks/mathUtils.js";var U;const z=u()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let P=U=class extends y{constructor(r){super(r)}readHref(r,t,o){return r?f(r,o):t.dataURI}writeHref(r,t,o,n){r&&(e(r)?t.dataURI=r:(t.href=k(r,n),s(t.href)&&(t.href=i(t.href))))}clone(){return new U({href:this.href,primitive:this.primitive})}};r([c({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],P.prototype,"href",void 0),r([j("href")],P.prototype,"readHref",null),r([d("href",{href:{type:String},dataURI:{type:String}})],P.prototype,"writeHref",null),r([l(z)],P.prototype,"primitive",void 0),P=U=r([a("esri.symbols.support.IconSymbol3DLayerResource")],P);const I="circle";var R;let L=R=class extends v{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new R({x:this.x,y:this.y})}};var q;r([c({type:Number})],L.prototype,"x",void 0),r([c({type:Number})],L.prototype,"y",void 0),L=R=r([a("esri.symbols.support.Symbol3DAnchorPosition2D")],L);let D=q=class extends y{constructor(r){super(r),this.color=new w([0,0,0,1]),this.size=S(1)}clone(){const r={color:null!=this.color?this.color.clone():null,size:this.size};return new q(r)}};var O;r([c(g({colorRequiredOnWrite:!0}))],D.prototype,"color",void 0),r([c({...b,json:{write:{isRequired:!0}}})],D.prototype,"size",void 0),D=q=r([a("esri.symbols.support.Symbol3DIconOutline")],D);let M=class extends p{static{O=this}constructor(r){super(r),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0}clone(){return new O({anchor:this.anchor,anchorPosition:t(this.anchorPosition),enabled:this.enabled,material:t(this.material),outline:t(this.outline),resource:t(this.resource),angle:this.angle,size:this.size})}static fromSimpleMarkerSymbol(r){const t=r.color||h,e=N(r),s=r.outline&&r.outline.width>0?{size:r.outline.width,color:(r.outline.color||h).clone()}:null;return new O({size:r.size,angle:r.angle,resource:{primitive:(i=()=>o.getLogger(this.prototype),n=r.style,T[n]||(i().warn(`${n} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle"))},material:{color:t},outline:s,anchor:e?"relative":void 0,anchorPosition:e});var i,n}static fromPictureMarkerSymbol(r){const t=!r.color||m(r.color)?h:r.color,o=N(r);return new O({size:r.width<=r.height?r.height:r.width,angle:r.angle,resource:{href:r.url},material:{color:t.clone()},anchor:o?"relative":void 0,anchorPosition:o})}static fromCIMSymbol(r){return new O({resource:{href:n({mediaType:"application/json",data:JSON.stringify(r.data)})}})}};function N(r){const t="width"in r?r.width:r.size,o="height"in r?r.height:r.size,e=H(r.xoffset),s=H(r.yoffset);return(e||s)&&t&&o?{x:-e/t,y:s/o}:null}function H(r){return isFinite(r)?r:0}r([c({type:x,json:{write:!0}})],M.prototype,"material",void 0),r([c({type:P,json:{write:!0}})],M.prototype,"resource",void 0),r([l({Icon:"icon"},{readOnly:!0})],M.prototype,"type",void 0),r([c({...b,json:{write:{isRequired:!0}}})],M.prototype,"size",void 0),r([l({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],M.prototype,"anchor",void 0),r([c({type:L,json:{type:[Number],read:{reader:r=>new L({x:r[0],y:r[1]})},write:{writer:(r,t)=>{t.anchorPosition=[r.x,r.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],M.prototype,"anchorPosition",void 0),r([c({type:D,json:{write:!0}})],M.prototype,"outline",void 0),r([c({type:Number,json:{write:!0,default:0}})],M.prototype,"angle",void 0),M=O=r([a("esri.symbols.IconSymbol3DLayer")],M);const T={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};export{L as S,I as d,M as default};
