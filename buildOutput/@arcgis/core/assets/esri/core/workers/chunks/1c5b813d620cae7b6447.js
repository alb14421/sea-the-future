"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[3960,7780],{3112:(e,t,r)=>{r.d(t,{a:()=>y,b:()=>c,d:()=>h});var i=r(41390),n=r(17745),s=r(93181);const o=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function a(e){return e instanceof i.A}function l(e){return e instanceof n.A?Object.keys(e.items):a(e)?(0,s.g)(e).keys():e?Object.keys(e):[]}function u(e,t){return e instanceof n.A?e.items[t]:e[t]}function p(e){return e?e.declaredClass:null}function d(e,t){const r=e.diff;if(r&&"function"==typeof r)return r(e,t);const i=l(e),n=l(t);if(0===i.length&&0===n.length)return;if(!i.length||!n.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};const s=n.filter(e=>!i.includes(e)),c=i.filter(e=>!n.includes(e)),y=i.filter(r=>n.includes(r)&&u(e,r)!==u(t,r)).concat(s,c).sort(),h=p(e);if(h&&o.has(h)&&y.length)return{type:"complete",oldValue:e,newValue:t};let f;const m=a(e)&&a(t);for(const i of y){const n=u(e,i),s=u(t,i);let o;if((m||"function"!=typeof n&&"function"!=typeof s)&&n!==s&&(null!=n||null!=s)){if(r&&r[i]&&"function"==typeof r[i])o=r[i]?.(n,s);else if(n instanceof Date&&s instanceof Date){if(n.getTime()===s.getTime())continue;o={type:"complete",oldValue:n,newValue:s}}else o="object"==typeof n&&"object"==typeof s&&p(n)===p(s)?d(n,s):{type:"complete",oldValue:n,newValue:s};null!=o&&(null!=f?f.diff[i]=o:f={type:"partial",diff:{[i]:o}})}}return f}function c(e,t){return function(e,t){if(null==e)return!1;const r=t.split(".");let i=e;for(const e of r){if("complete"===i.type)return!0;if("partial"!==i.type)return!1;{const t=i.diff[e];if(!t)return!1;i=t}}return!0}(e,t)}function y(e,t){if(!e)return!1;if("partial"===e.type){const r=Object.keys(e.diff);return 1===r.length&&r[0]===t}return!1}function h(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&p(e)!==p(t)?{type:"complete",oldValue:e,newValue:t}:d(e,t)}},22522:(e,t,r)=>{r.d(t,{a:()=>s,d:()=>o,e:()=>a,n:()=>n});var i=r(32773);function n(e,t=!1){return e<=i.n?t?new Array(e).fill(0):new Array(e):new Float64Array(e)}function s(e){return((0,i.c)(e)?e.byteLength/8:e.length)<=i.n?Array.from(e):new Float64Array(e)}function o(e,t,r){return Array.isArray(e)?e.slice(t,t+r):e.subarray(t,t+r)}function a(e){return[...e]}},24330:(e,t,r)=>{r.d(t,{a:()=>g,b:()=>b,c:()=>_,d:()=>v,i:()=>s,t:()=>m});var i=r(35902),n=r(32773);function s(e){return"r"in e&&"g"in e&&"b"in e}function o(e){return"h"in e&&"s"in e&&"v"in e}function a(e){return"l"in e&&"a"in e&&"b"in e}function l(e){return"l"in e&&"c"in e&&"h"in e}r(16699),r(91276),r(62482);const u=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],p=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function d(e,t){const r=[];let i,n;if(e[0].length!==t.length)throw new Error("dimensions do not match");const s=e.length,o=e[0].length;let a=0;for(i=0;i<s;i++){for(a=0,n=0;n<o;n++)a+=e[i][n]*t[n];r.push(a)}return r}function c(e){const t=[e.r/255,e.g/255,e.b/255].map(e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4),r=d(u,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function y(e){const t=d(p,[e.x/100,e.y/100,e.z/100]).map(e=>{const t=e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055;return Math.min(1,Math.max(t,0))});return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function h(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map(e=>e>(6/29)**3?e**(1/3):1/3*(29/6)**2*e+4/29);return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function f(e){const t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map(e=>e>6/29?e**3:3*(6/29)**2*(e-4/29));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function m(e){return s(e)?e:l(e)?function(e){return y(f(function(e){const t=e.l,r=e.c,i=e.h;return{l:t,a:r*Math.cos(i),b:r*Math.sin(i)}}(e)))}(e):a(e)?function(e){return y(f(e))}(e):function(e){return"x"in e&&"y"in e&&"z"in e}(e)?y(e):o(e)?function(e){const t=(e.h+360)%360/60,r=e.s/100,i=e.v/100*255,n=i*r,s=n*(1-Math.abs(t%2-1));let o;switch(Math.floor(t)){case 0:o={r:n,g:s,b:0};break;case 1:o={r:s,g:n,b:0};break;case 2:o={r:0,g:n,b:s};break;case 3:o={r:0,g:s,b:n};break;case 4:o={r:s,g:0,b:n};break;case 5:case 6:o={r:n,g:0,b:s};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+i-n),o.g=Math.round(o.g+i-n),o.b=Math.round(o.b+i-n),o}(e):e}function g(e){return o(e)?e:function(e){const t=e.r,r=e.g,i=e.b,n=Math.max(t,r,i),s=n-Math.min(t,r,i);let o=n,a=0===s?0:n===t?(r-i)/s%6:n===r?(i-t)/s+2:(t-r)/s+4,l=0===s?0:s/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}(m(e))}function b(e){return a(e)?e:function(e){return h(c(e))}(m(e))}function _(e){return l(e)?e:function(e){return function(e){const t=e.l,r=e.a,i=e.b,n=Math.sqrt(r*r+i*i);let s=Math.atan2(i,r);return s=s>0?s:s+2*Math.PI,{l:t,c:n,h:s}}(h(c(e)))}(m(e))}function v(e,t,r={}){if(0===e.length||t<=0)return[];if(1===(e=e.map(e=>"string"==typeof e?new i.A(e):e)).length||1===t){const r=[],i=e[0];for(let e=0;e<t;e++)r.push(i.clone());return r}if(r.shuffle&&(e=(0,n.s)((0,n.o8)(e),r.seed)),e.length>=t){const r=[],i=(e.length-1)/(t-1);for(let n=0;n<t;n++){const t=Math.round(n*i);r.push(e[t].clone())}return r}return function(e,t,r={}){const i=[],s=e.length-1,o=Math.ceil((t-e.length)/s);e:for(let n=0;n<s;n++){const s=e[n],a=e[n+1];for(let n=1;n<=o;n++){const l=n/(o+1);if(i.push(F(s,a,l,r)),i.length+e.length===t)break e}}return[...e.map(e=>e.clone()),...(0,n.s)(i,r.seed??1)]}(e,t,r)}const w=(e,t)=>{const r=Math.floor(10*t())-5;return Math.min(255,Math.max(0,e+r))};function F(e,t,r,s={}){const o=e.r,a=e.g,l=e.b,u=t.r,p=t.g,d=t.b,c=Math.round(o+(u-o)*r),y=Math.round(a+(p-a)*r),h=Math.round(l+(d-l)*r);if(!s.offset)return new i.A([c,y,h]);const f=(0,n.g)(s.seed);return new i.A([w(c,f),w(y,f),w(h,f)])}},27084:(e,t,r)=>{r.d(t,{A:()=>d});var i=r(32816),n=r(52731),s=r(93804),o=r(99924),a=r(29298),l=(r(32773),r(20266),r(69421));r(41390),r(85176),r(93181),r(13671),r(50704),r(40499),r(36555),r(58498),r(91047),r(35819),r(45371),r(61532),r(80959),r(6407),r(59121),r(19247),r(36172),r(36544),r(90740),r(84699),r(48064);const u=new s.J({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),p=new s.J({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let d=class extends((0,n.O)(o.o)){constructor(e){super(e),this.cardinality=null,this.catalogId=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};(0,i._)([(0,a.MZ)({json:{read:u.read,write:u.write}})],d.prototype,"cardinality",void 0),(0,i._)([(0,a.MZ)({json:{name:"catalogID"}})],d.prototype,"catalogId",void 0),(0,i._)([(0,a.MZ)({json:{read:!0,write:!0}})],d.prototype,"composite",void 0),(0,i._)([(0,a.MZ)({json:{read:!0,write:!0}})],d.prototype,"id",void 0),(0,i._)([(0,a.MZ)({json:{read:!0,write:!0}})],d.prototype,"keyField",void 0),(0,i._)([(0,a.MZ)({json:{read:!0,write:!0}})],d.prototype,"keyFieldInRelationshipTable",void 0),(0,i._)([(0,a.MZ)({json:{read:!0,write:!0}})],d.prototype,"name",void 0),(0,i._)([(0,a.MZ)({json:{read:!0,write:!0}})],d.prototype,"relatedTableId",void 0),(0,i._)([(0,a.MZ)({json:{read:!0,write:!0}})],d.prototype,"relationshipTableId",void 0),(0,i._)([(0,a.MZ)({json:{read:p.read,write:p.write}})],d.prototype,"role",void 0),d=(0,i._)([(0,l.$)("esri.layers.support.Relationship")],d)},27281:(e,t,r)=>{r.d(t,{A:()=>v});var i,n=r(32816),s=r(72393),o=r(52731),a=r(41390),l=r(99924),u=r(20266),p=r(67321),d=r(35819),c=r(29298),y=(r(32773),r(69421)),h=r(12119),f=r(77037),m=r(92517),g=r(92963),b=r(91815);function _(e){if(null==e)return null;const t={};for(const r in e){const i=e[r];i&&(t[r]=i.toJSON())}return 0!==Object.keys(t).length?t:null}r(17745),r(81272),r(13671),r(90740),r(59121),r(84699),r(50704),r(40499),r(93181),r(91047),r(36544),r(48064),r(6407),r(85176),r(36555),r(58498),r(45371),r(61532),r(80959),r(19247),r(36172),r(44945),r(48844),r(49877),r(56273),r(30011),r(54483),r(51961),r(62399),r(64995),r(70861),r(93804),r(33150),r(58173),r(66110),r(67520),r(27532),r(88663),r(48103),r(50214),r(59192),r(16345),r(65085),r(33611),r(84857),r(60373),r(20568),r(35902),r(13226),r(16699),r(16794),r(52357),r(11090),r(49319),r(93546),r(29570),r(34592),r(79825),r(95101),r(67578),r(17857),r(82537),r(14896),r(95611),r(98089),r(91366),r(80473),r(43435),r(73435),r(44600),r(2160),r(7969),r(69763),r(96221),r(18683),r(64604),r(29512),r(99063),r(1178),r(64752),r(29208),r(36533),r(84200),r(97827),r(18169),r(20762),r(48402),r(67504),r(85232),r(93471),r(7182),r(47788),r(19297),r(82408),r(73509),r(28276),r(91658),r(70580),r(75191),r(24319),r(62092),r(53252),r(34039),r(12856),r(3495),r(97906),r(64524),r(65023),r(31424),r(74676),r(32368),r(7391),r(22529),r(70061),r(38094),r(67723),r(2589),r(47239),r(22522),r(63728),r(4157),r(62401),r(89322),r(20138),r(53370),r(59858),r(46946),r(3816),r(71992),r(80167),r(4478),r(91808),r(7161),r(55586),r(92229),r(18344),r(53610),r(29447),r(78273),r(49475),r(64884),r(23351),r(35121),r(51222),r(42870),r(54512),r(53103),r(19648),r(42948);let v=class extends((0,o.O)(l.o)){static{i=this}constructor(e){super(e),this.isAggregate=!1,this.layer=null,this.origin=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:(0,d.g)(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&(0,a.d)(u.L.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(e){const t=this._get("aggregateGeometries");JSON.stringify(t)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}set geometry(e){const t=this._get("geometry");t!==e&&(this._set("geometry",e),"mesh"!==e?.type&&this._notifyLayer("geometry",t,e))}set popupTemplate(e){const t=this._get("popupTemplate");t!==e&&(this._set("popupTemplate",e),this._notifyLayer("popupTemplate",t,e))}set symbol(e){const t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}get version(){return this._version}set visible(e){const t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}cloneShallow(){return new i({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const t=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const r of[t,this.sourceLayer,this.layer])if(r&&"object"==typeof r){if("popupTemplate"in r&&r.popupTemplate)return r.popupTemplate;if(e&&"defaultPopupTemplate"in r&&null!=r.defaultPopupTemplate)return r.defaultPopupTemplate}return null}getAttribute(e){return this.attributes?.[e]}setAttribute(e,t){if(this.attributes){const r=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",r,t,e)}else this.attributes={[e]:t}}getObjectId(){const e=this.sourceLayer??this.layer;return e?(0,g.c)(this,e):null}getGlobalId(){const e=this.sourceLayer??this.layer;return e&&"globalIdField"in e&&e.globalIdField?this.getAttribute(e.globalIdField):null}toJSON(){return{aggregateGeometries:_(this.aggregateGeometries),geometry:null!=this.geometry?this.geometry.toJSON():null,symbol:null!=this.symbol?this.symbol.toJSON():null,attributes:(0,h.i)(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:this.popupTemplate?.toJSON()??null}}notifyMeshTransformChanged(e={}){const{geometry:t}=this;if("mesh"===t?.type){const r={origin:t.origin,transform:t.transform};this._notifyLayer("origin-transform",r,r,e.action)}}_notifyLayer(e,t,r,i){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:e,oldValue:t,newValue:r};"origin-transform"===e&&(n.action=i),"attributes"===e&&(n.attributeName=i),this.layer.graphicChanged(n)}_watchMeshGeometryChanges(){this.addHandles([(0,p.z7)(()=>"mesh"===this.geometry?.type&&this.geometry.vertexSpace.origin?{localMatrix:this.geometry.transform?.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0,({localMatrix:e,origin:t})=>{this._lastMeshTransform.localMatrix===e&&this._lastMeshTransform.origin===t||(this._lastMeshTransform.localMatrix=e,this._lastMeshTransform.origin=t,this.notifyMeshTransformChanged())}),(0,p.z7)(()=>"mesh"===this.geometry?.type?{vertexAttributes:this.geometry.vertexAttributes}:void 0,()=>{const e=this.geometry;"mesh"===e?.type&&e.vertexSpace.origin?(this._lastMeshTransform.localMatrix=e.transform?.localMatrix,this._lastMeshTransform.origin=e.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(e,t)=>e===t,sync:!0})])}};(0,n._)([(0,c.MZ)({value:null,json:{read:function(e){if(!e)return null;const t={};for(const r in e){const i=(0,f.rS)(e[r]);i&&(t[r]=i)}return 0!==Object.keys(t).length?t:null}}})],v.prototype,"aggregateGeometries",null),(0,n._)([(0,c.MZ)({value:null})],v.prototype,"attributes",null),(0,n._)([(0,c.MZ)({value:null,types:m.g,json:{read:f.rS}})],v.prototype,"geometry",null),(0,n._)([(0,c.MZ)({type:Boolean})],v.prototype,"isAggregate",void 0),(0,n._)([(0,c.MZ)({clonable:!1})],v.prototype,"layer",void 0),(0,n._)([(0,c.MZ)({clonable:"reference"})],v.prototype,"origin",void 0),(0,n._)([(0,c.MZ)({type:s.A,value:null})],v.prototype,"popupTemplate",null),(0,n._)([(0,c.MZ)({clonable:"reference"})],v.prototype,"sourceLayer",void 0),(0,n._)([(0,c.MZ)({value:null,types:b.a})],v.prototype,"symbol",null),(0,n._)([(0,c.MZ)({clonable:!1,json:{read:!1,write:!1}})],v.prototype,"_version",void 0),(0,n._)([(0,c.MZ)({type:Boolean,value:!0})],v.prototype,"visible",null),v=i=(0,n._)([(0,y.$)("esri.Graphic")],v)},36309:(e,t,r)=>{r.d(t,{a:()=>v,b:()=>y,c:()=>f,d:()=>h,g:()=>c,s:()=>p,t:()=>d});var i=r(84699);const n="__begin__",s="__end__",o=new RegExp(n,"ig"),a=new RegExp(s,"ig"),l=new RegExp("^"+n,"i"),u=new RegExp(s+"$","i");function p(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function d(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function c(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=p(e.labelExpression),t.type="conventional"),t}function y(e){const t=c(e);if(!t)return null;switch(t.type){case"conventional":return f(t.expression);case"arcade":return t.expression}return null}function h(e){const t=c(e);if(!t)return null;switch(t.type){case"conventional":return function(e){const t=e?.match(m);return t?.[1].trim()||null}(t.expression);case"arcade":return v(t.expression)}return null}function f(e){let t;return e?(t=(0,i.r)(e,e=>n+'$feature["'+e+'"]'+s),t=l.test(t)?t.replace(l,""):'"'+t,t=u.test(t)?t.replace(u,""):t+'"',t=t.replaceAll(o,'" + ').replaceAll(a,' + "')):t='""',t}const m=/^\s*\{([^}]+)\}\s*$/i,g=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,b=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,_=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function v(e){if(!e)return null;let t=g.exec(e)||b.exec(e);return t?t[1]||t[3]:(t=_.exec(e),t?t[2]:null)}},47239:(e,t,r)=>{r.d(t,{A:()=>h,B:()=>f,C:()=>l,D:()=>M,a:()=>_,b:()=>p,c:()=>s,d:()=>w,e:()=>c,f:()=>o,g:()=>b,i:()=>v,m:()=>g,n:()=>F,q:()=>d,r:()=>y,s:()=>m,t:()=>u,v:()=>a});var i=r(44600),n=(r(48402),r(22522));function s(e=M){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function o(e,t,r,i,n,o,a=s()){return a[0]=e,a[1]=t,a[2]=r,a[3]=i,a[4]=n,a[5]=o,a}function a(e,t=s()){return function(e,t,r,i=s()){return m(i,F),function(e,t,r=0,i=t.length/3){let n=e[0],s=e[1],o=e[2],a=e[3],l=e[4],u=e[5];for(let e=0;e<i;e++)n=Math.min(n,t[r+3*e]),s=Math.min(s,t[r+3*e+1]),o=Math.min(o,t[r+3*e+2]),a=Math.max(a,t[r+3*e]),l=Math.max(l,t[r+3*e+1]),u=Math.max(u,t[r+3*e+2]);e[0]=n,e[1]=s,e[2]=o,e[3]=a,e[4]=l,e[5]=u}(i,e,t,r),i}(e,0,e.length/3,t)}function l(e,t=(0,n.n)(24)){const[r,i,s,o,a,l]=e;return t[0]=r,t[1]=i,t[2]=s,t[3]=r,t[4]=i,t[5]=l,t[6]=r,t[7]=a,t[8]=s,t[9]=r,t[10]=a,t[11]=l,t[12]=o,t[13]=i,t[14]=s,t[15]=o,t[16]=i,t[17]=l,t[18]=o,t[19]=a,t[20]=s,t[21]=o,t[22]=a,t[23]=l,t}function u(e,t){const r=isFinite(e[2])||isFinite(e[5]);return new i.A(r?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})}function p(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function d(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[3]=Math.max(e[3],t[2]),e[4]=Math.max(e[4],t[3])}function c(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function y(e,t=[0,0,0]){return t[0]=function(e){return e[0]>=e[3]?0:e[3]-e[0]}(e),t[1]=function(e){return e[1]>=e[4]?0:e[4]-e[1]}(e),t[2]=function(e){return e[2]>=e[5]?0:e[5]-e[2]}(e),t}function h(e,t,r=e){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r}function f(e,t,r=e){return r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e}function m(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function g(e){return e?m(e,F):s(F)}function b(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function _(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=Number.NEGATIVE_INFINITY,e[3]=i,e[4]=n,e[5]=Number.POSITIVE_INFINITY,e}function v(e){return 6===e.length}function w(e,t,r){if(null==e||null==t)return e===t;if(!v(e)||!v(t))return!1;if(r){for(let i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1}else for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}const F=[1/0,1/0,1/0,-1/0,-1/0,-1/0],M=[0,0,0,0,0,0];s()},47252:(e,t,r)=>{r.d(t,{T:()=>d});var i=r(32816),n=r(41390),s=r(32773),o=r(73067),a=r(17745),l=r(29298),u=(r(20266),r(69421)),p=r(30011);let d=class extends n.A{constructor(e){super(e),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||(0,o.c)(()=>(0,p.l)()):null}get featureUtilsPromise(){return this._get("featureUtilsPromise")??r.e(6533).then(r.bind(r,96533)).then(e=>this._featureUtils=e)}get calculatedExpressions(){const e=new a.A;if(!this.expressionsUsedInTitle.length)return e;if(!this._arcadeTask?.value){for(const t of this.expressionsUsedInTitle??[])e.push({name:t.name,invalid:!0});return e}for(const t of this.expressionsUsedInTitle)try{const r=this._arcadeTask.value.arcade.parseScript(t.expression,["$layer","$map","$datastore"]);if(r.isAsync){e.push({name:t.name,invalid:!0});break}e.push({name:t.name,syntax:r,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(r,{vars:{$feature:"any"}})})}catch{e.push({name:t.name,invalid:!0});break}return e}get expressionsUsedInTitle(){let e=this.effectivePopupTemplate?.title??"";return"string"!=typeof e?[]:(e=e.toLowerCase(),this.effectivePopupTemplate?.expressionInfos?.filter(t=>e.includes(`{expression/${t.name.toLowerCase()}}`))??[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some(e=>!0===e.invalid)}get requiredFields(){const e=new Set;if(this._arcadeTask?.value&&!this.hasBadExpressions)for(const t of this.calculatedExpressions?.toArray()??[])try{const r=this._arcadeTask.value.arcade.extractFieldLiterals(t.syntax);for(const t of r){const r=t.split("."),i=this.fieldsIndex.get(r.at(-1)??"");i&&e.add(i.name)}}catch{}const t=this._extractFieldNames(this.workingTitle);for(const r of t){const t=this.fieldsIndex.get(r);t&&e.add(t.name)}return null!=this.objectIdField&&e.add(this.objectIdField),e}get titleFromDisplayField(){let e="";return this.displayField&&(e=this.fieldsIndex.get(this.displayField)?.name??""),e||(e=this.fieldsIndex.get(this.objectIdField)?.name??""),e?`{${e}}`:""}get workingTitle(){const e=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return""===e||null==e||this.hasBadExpressions||"string"!=typeof e?this.titleFromDisplayField:e}async getTitle(e,t,r){const i=t.getObjectId()??t.attributes[e.objectIdField];return(await this.getTitles(e,[t],r)).get(i)??""}async getTitles(e,t,r){const i=new Map,n=r?.timeZone??"system";try{const[{substituteFieldsInLinksAndAttributes:s}]=await Promise.all([this.featureUtilsPromise,this._arcadeTask?.promise]);r?.fetchMissingFields&&(t=await this._checkAndReQueryGraphics(e,t));const{fieldInfoMap:o,workingTitle:a}=this,l=a&&o;t.forEach(t=>{const r=t.getObjectId()??t.attributes[e.objectIdField],u=l?s({attributes:t.attributes,expressionAttributes:null,fieldInfoMap:o,globalAttributes:this._createFormattedAttributes(e,t,n).global,layer:e,text:a}):"";i.set(r,u)})}catch{}return i}async _checkAndReQueryGraphics(e,t){const r=t.map(t=>t.getObjectId()??t.attributes[e.objectIdField]).filter(s.i);if(r.length!==t.length)return t;if(t.some(e=>!(0,p.Kl)(e,this.requiredFields))){const i=e.createQuery();i.where="1=1",i.outFields=[...this.requiredFields],i.objectIds=r;const n=await e.queryFeatures(i);if(n?.features.length===t.length)return n.features}return t}_createFieldInfoMap(e){const t=new Map;if(!e)return t;for(const r of e){if(!r.fieldName)continue;const e=this.fieldsIndex.get(r.fieldName),i=e?.name??r.fieldName;r.fieldName=i,t.set(i.toLowerCase(),r)}return t}_createFormattedAttributes(e,t,r="system"){const i=this.effectivePopupTemplate?.fieldInfos??[],n={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&this._arcadeTask?.value){const r=this._arcadeTask.value.Feature.createFromGraphicLikeObject(t.geometry,t.attributes,e,null);for(const e of this.calculatedExpressions)try{n[`expression/${e.name}`]=e.func({vars:{$feature:r}})}catch{}}const s={...t.attributes,...n};return{global:this._featureUtils.formatAttributes({fieldInfos:i,attributes:s,graphic:t,timeZone:r,layer:e,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(e){return(0,p.nw)(e).filter(e=>!(e.startsWith("relationships/")||e.startsWith("expression/")))}};(0,i._)([(0,l.MZ)({readOnly:!0})],d.prototype,"_arcadeTask",null),(0,i._)([(0,l.MZ)()],d.prototype,"_featureUtils",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],d.prototype,"featureUtilsPromise",null),(0,i._)([(0,l.MZ)({readOnly:!0})],d.prototype,"calculatedExpressions",null),(0,i._)([(0,l.MZ)()],d.prototype,"displayField",void 0),(0,i._)([(0,l.MZ)()],d.prototype,"effectivePopupTemplate",void 0),(0,i._)([(0,l.MZ)()],d.prototype,"expressionsUsedInTitle",null),(0,i._)([(0,l.MZ)()],d.prototype,"fieldsIndex",void 0),(0,i._)([(0,l.MZ)()],d.prototype,"fieldInfoMap",null),(0,i._)([(0,l.MZ)()],d.prototype,"fields",void 0),(0,i._)([(0,l.MZ)()],d.prototype,"objectIdField",void 0),(0,i._)([(0,l.MZ)()],d.prototype,"requiredFields",null),d=(0,i._)([(0,u.$)("esri.layers.support.TitleCreator")],d)},64035:(e,t,r)=>{r.d(t,{a:()=>o,c:()=>s});var i=r(16699),n=r(23381);function s(e,t){return{...t,filterMode:e.mode}}function o(e,t,r){const s=function(e){if("manual"===u(e))return null;const t=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:r,maxScale:i}of e.filters)t[0]=Math.max(t[0],p(r)),t[1]=Math.min(t[1],d(i));return t}(e);if(s&&((0,i.a)(t,s[0])||(0,i.b)(r,s[1])))return"";const o=Array.from(a(e,t,r)),l=function(e,t,r){if(0===e.length)return!0;const n=p(e.at(0)?.minScale),s=d(e.at(-1)?.maxScale);if((0,i.b)(n,t)||(0,i.a)(s,r))return!0;for(let t=0;t<e.length-1;t++){const r=e[t],n=e[t+1];if((0,i.b)(p(n.minScale),d(r.maxScale)))return!0}return!1}(o,t,r)?"1=1":o.map(e=>e.where||"1=1").reduce((e,t)=>(0,n.IW)(e,t),"");return l&&"1=1"!==l?l:""}function*a(e,t,r){if("manual"===u(e)){const t=e.filters.find(t=>t.id===e.activeFilterId);t&&(yield t)}else{"object"==typeof t&&(t=t.scale);for(const i of e.filters)l(i.minScale,i.maxScale,t,r)&&(yield i)}}function l(e,t,r,n){return e=p(e),r=p(r),t=d(t),!(!(0,i.f)(r,e)&&(n??r)>e||(0,i.d)(t,r)||void 0!==n&&(0,i.f)(n,e))}function u(e){return"mode"in e?e.mode:e.filterMode}function p(e){return e||Number.POSITIVE_INFINITY}function d(e){return e||0}},65283:(e,t,r)=>{r.d(t,{a:()=>a,l:()=>o});var i=r(73067),n=r(17745),s=r(73509);async function o(e,t){return await e.load(),a(e,t)}async function a(e,t){const r=[],o=(...e)=>{for(const t of e)null!=t&&(Array.isArray(t)?o(...t):n.A.isCollection(t)?t.forEach(e=>o(e)):(0,s.Zm)(t)&&r.push(t))};t(o);let a=null;if(await(0,i.m)(r,async e=>{const t=await(0,i.r)((r=e,"loadAll"in r&&"function"==typeof r.loadAll?e.loadAll():e.load()));var r;!1!==t.ok||a||(a=t)}),a)throw a.error;return e}},67315:(e,t,r)=>{r.d(t,{p:()=>o});var i=r(32816),n=r(29298),s=(r(32773),r(20266),r(69421));r(36544),r(85176),r(93181),r(13671),r(40499),r(6407),r(59121),r(90740),r(84699),r(50704),r(91047),r(48064);const o=e=>{const t=e;let r=class extends t{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):"portalItem"in this?this.portalItem?.apiKey:null}set apiKey(e){null!=e?this._override("apiKey",e):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return(0,i._)([(0,n.MZ)({type:String})],r.prototype,"apiKey",null),r=(0,i._)([(0,s.$)("esri.layers.mixins.APIKeyMixin")],r),r}},71895:(e,t,r)=>{r.d(t,{A:()=>u});var i,n=r(32816),s=r(17745),o=r(99924),a=r(29298),l=(r(32773),r(20266),r(69421));r(35819),r(36555),r(13671),r(45371),r(61532),r(80959),r(6407),r(59121),r(19247),r(85176),r(93181),r(50704),r(91047),r(36172),r(81272),r(41390),r(40499),r(58498),r(90740),r(84699),r(36544),r(48064),r(44945);let u=i=class extends o.o{constructor(e){super(e),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new s.A}clone(){return new i({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};(0,n._)([(0,a.MZ)({type:String,json:{write:{isRequired:!0}}})],u.prototype,"floorField",void 0),(0,n._)([(0,a.MZ)({json:{read:!1,write:!1}})],u.prototype,"viewAllMode",void 0),(0,n._)([(0,a.MZ)({json:{read:!1,write:!1}})],u.prototype,"viewAllLevelIds",void 0),u=i=(0,n._)([(0,l.$)("esri.layers.support.LayerFloorInfo")],u)},78644:(e,t,r)=>{r.d(t,{A:()=>p});var i=r(32816),n=r(52731),s=r(93804),o=r(99924),a=r(29298),l=(r(32773),r(20266),r(69421));r(41390),r(85176),r(93181),r(13671),r(50704),r(40499),r(36555),r(58498),r(91047),r(35819),r(45371),r(61532),r(80959),r(6407),r(59121),r(19247),r(36172),r(36544),r(90740),r(84699),r(48064);const u=new s.J({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let p=class extends((0,n.O)(o.o)){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};(0,i._)([(0,a.MZ)({json:{write:!0}})],p.prototype,"name",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],p.prototype,"description",void 0),(0,i._)([(0,a.MZ)({json:{read:u.read,write:u.write}})],p.prototype,"drawingTool",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],p.prototype,"prototype",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],p.prototype,"thumbnail",void 0),p=(0,i._)([(0,l.$)("esri.layers.support.FeatureTemplate")],p)},79747:(e,t,r)=>{r.d(t,{K:()=>c,Q:()=>u});var i=r(32816),n=r(93804),s=r(20266),o=r(29298),a=(r(32773),r(88663)),l=r(69421);r(59121),r(90740),r(84699),r(36544),r(85176),r(93181),r(13671),r(40499),r(6407),r(50704),r(91047),r(48064);const u=(0,n.s)()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),p="percent-of-total",d="field",c=e=>{const t=e;let r=class extends t{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,r=null!=this.normalizationTotal;return t||r?(e=t&&d||r&&p||null,t&&r&&s.L.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):e!==d&&e!==p||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}};return(0,i._)([(0,o.MZ)({type:String,json:{name:"parameters.normalizationField",write:!0}})],r.prototype,"normalizationField",void 0),(0,i._)([(0,o.MZ)({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],r.prototype,"normalizationMaxValue",void 0),(0,i._)([(0,o.MZ)({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],r.prototype,"normalizationMinValue",void 0),(0,i._)([(0,o.MZ)({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],r.prototype,"normalizationTotal",void 0),(0,i._)([(0,a.e)(u,{name:"parameters.normalizationType"})],r.prototype,"normalizationType",null),r=(0,i._)([(0,l.$)("esri.rest.support.NormalizationBinParametersMixin")],r),r}},79875:(e,t,r)=>{r.d(t,{A:()=>y});var i=r(6407),n=r(20266),s=r(93217),o=r(133),a=r(12119),l=r(30011),u=r(16345),p=r(78016),d=r(54483);r(32773),r(59121),r(90740),r(84699);const c=new Map;class y{static fromJSON(e){return new y(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new y(e.fields??[],g(e))}static fromLayerJSON(e){return new y(e.fields??[],g(e))}constructor(e=[],t){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=t?new Map(t):null;const r=[];for(const e of this.fields){const t=e?.name,i=f(t);if(t&&i){const n=h(t);this._fieldsMap.set(t,e),this._fieldsMap.set(n,e),this._normalizedFieldsMap.set(i,e),r.push(`${n}:${e.type}:${this._timeZoneByFieldName?.get(t)}`),(0,l.vE)(e)?(this.dateFields.push(e),this._dateFieldsSet.add(e)):(0,l.WA)(e)&&(this._numericFieldsSet.add(e),this.numericFields.push(e)),(0,l.te)(e)||(0,l.Xz)(e)||(e.editable=null==e.editable||!!e.editable,e.nullable=null==e.nullable||!!e.nullable)}}r.sort(),this.uid=r.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)(0,l.te)(e)||(0,l.Xz)(e)||e.nullable||void 0!==(0,l.lD)(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return null!=this.get(e)}get(e){if(!e)return;let t=this._fieldsMap.get(e);return t||(t=this._fieldsMap.get(h(e))??this._normalizedFieldsMap.get(f(e)),t&&this._fieldsMap.set(e,t),t)}getTimeZone(e){const t=this.get(e&&"string"!=typeof e?e.name:e);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):"date"===t.type||"esriFieldTypeDate"===t.type?(n.L.getLogger("esri.layers.support.FieldsIndex").errorOnce(new i.A("getTimeZone:no-timezone-information",`no time zone information for field '${t.name}'`)),u.a):m.has(t.type)?u.u:null:null}getLuxonTimeZone(e){const t=this.getTimeZone(e);return t?t===u.u?o.U.instance:t===u.a?d.F.utcInstance:(0,s.g)(c,t,()=>d.I.create(t)):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return(0,l.OH)(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map(e=>(0,a.i)(e)?e.toJSON():e),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function h(e){return e.trim().toLowerCase()}function f(e){return(0,l.rS)(e)?.toLowerCase()??""}const m=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function g(e){const t=new Map;if(!e.fields)return t;const r=!0===e.datesInUnknownTimezone,{timeInfo:i,editFieldsInfo:n}=e,s=(i?"startField"in i?i.startField:i.startTimeField:"")??"",o=(i?"endField"in i?i.endField:i.endTimeField:"")??"",a="dateFieldsTimeZone"in e?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?(0,p.f)(e.dateFieldsTimeReference):null,l=n?"timeZone"in n?n.timeZone??a:n.dateFieldsTimeReference?(0,p.f)(n.dateFieldsTimeReference):a??u.a:null,d=i?"timeZone"in i?i.timeZone??a:i.timeReference?(0,p.f)(i.timeReference):a:null,c=new Map([[h(n?.creationDateField??""),l],[h(n?.editDateField??""),l],[h(s),d],[h(o),d]]);for(const{name:i,type:n}of e.fields)if(m.has(n))t.set(i,u.u);else if("date"!==n&&"esriFieldTypeDate"!==n)t.set(i,null);else if(r)t.set(i,u.u);else{const e=c.get(h(i??""))??a;t.set(i,e)}return t}},87780:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Ee});var i=r(32816),n=r(52731),s=r(17745),o=r(6407),a=r(65283),l=r(93217),u=r(2810),p=r(80959),d=r(67321),c=r(23381),y=r(29298),h=r(32773),f=r(20266),m=r(49877),g=r(69421),b=r(73597),_=r(67315),v=r(8368),w=r(31315),F=r(4335),M=r(74285),T=r(99781),I=r(29201),x=r(88730),A=r(38424),S=r(46935),Z=r(96807),O=r(69448),j=r(64604),E=r(65174),L=r(58196),C=r(38093),N=r(30011),P=r(72393),q=r(80473),k=r(73509),R=r(57732),G=r(59121),$=r(56273),D=r(82530),z=r(50282),U=r(7969),V=r(99032);const J=Symbol("isSubtypeGroupGraphicOriginSymbol");var B;r(90740),r(84699),r(50704),r(40499),r(93181),r(13671),r(91047),r(36544),r(48064);class Q extends V.A{static{B=J}constructor(e){super(),this[B]=!0,this.type="subtype-group",this.sublayer=e}get layer(){return this.sublayer.parent}}var K=r(78644),H=r(10224),Y=r(60408),W=r(24330),X=r(91381),ee=r(60027),te=r(16677),re=r(17813),ie=r(23875),ne=r(69033),se=r(47252),oe=r(73600),ae=r(20978),le=r(54616),ue=r(53065);r(35819),r(36555),r(45371),r(61532),r(19247),r(85176),r(36172),r(81272),r(41390),r(58498),r(44945),r(99924),r(48844),r(51961),r(62399),r(64995),r(70861),r(93804),r(33150),r(58173),r(66110),r(67520),r(27532),r(88663),r(48103),r(50214),r(59192),r(16345),r(54483),r(65085),r(33611),r(84857),r(60373),r(20568),r(35902),r(13226),r(16699),r(16794),r(52357),r(11090),r(49319),r(93546),r(29570),r(34592),r(79825),r(95101),r(67578),r(17857),r(82537),r(14896),r(95611),r(98089),r(91366),r(43435),r(73435),r(28276),r(85472),r(79323),r(74148),r(77219),r(66959),r(78774),r(8884),r(81095),r(4798),r(67470),r(25579),r(69660),r(85994),r(43423),r(23070),r(95717),r(968),r(85901),r(82458),r(37740),r(25329),r(82140),r(40988),r(42586),r(44370),r(18653),r(95637),r(59930),r(45862),r(72762),r(71613),r(70534),r(45817),r(15806),r(69763),r(96221),r(18683),r(29512),r(99063),r(1178),r(44600),r(2160),r(64752),r(29208),r(17012),r(98203),r(54131),r(19869),r(64524),r(73067),r(93049),r(86941),r(23916),r(93074),r(1739),r(79747),r(81618),r(81284),r(44864),r(17872),r(92517),r(36533),r(84200),r(97827),r(18169),r(20762),r(48402),r(67504),r(91815),r(85232),r(93471),r(7182),r(47788),r(19297),r(82408),r(91658),r(70580),r(75191),r(24319),r(62092),r(53252),r(34039),r(12856),r(3495),r(97906),r(65023),r(31424),r(74676),r(32368),r(7391),r(22529),r(70061),r(38094),r(67723),r(2589),r(47239),r(22522),r(63728),r(4157),r(62401),r(89322),r(20138),r(53370),r(59858),r(46946),r(3816),r(71992),r(80167),r(4478),r(91808),r(7161),r(55586),r(92229),r(18344),r(53610),r(29447),r(78273),r(49475),r(64884),r(23351),r(35121),r(51222),r(42870),r(54512),r(53103),r(19648),r(42948),r(79875),r(133),r(78016),r(36309),r(78328),r(25018),r(91276),r(18527),r(62482),r(56487),r(6399),r(9498),r(24079),r(38149),r(19681),r(40328),r(84539),r(65299),r(38641),r(27281),r(77037),r(3827),r(98238),r(41740),r(57111),r(75651),r(88614),r(1030),r(15319),r(60785),r(3112),r(46626),r(45560),r(56303),r(85890),r(55884),r(44747),r(91524),r(60369),r(13201),r(43534),r(47812),r(56570),r(23787),r(22151),r(78860),r(26805),r(13983),r(58194),r(4734),r(20804),r(63834),r(87357),r(19969),r(9207);const pe={key:"type",base:ee.A,errorContext:"renderer",typeMap:{simple:te.A,"unique-value":re.A,"class-breaks":X.A}},de=(0,g.c)({types:pe}),ce=["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"],ye=(0,C.d)();let he=0;function fe(e,t){let r=e.json.write;return"object"!=typeof r&&(r=e.json.write={}),r.ignoreOrigin=!0,t?.spatialOnly&&(r.layerContainerTypes=D.e),e}function me(e){const t={write:{ignoreOrigin:!0}};return e?.name&&(t.name=e.name),"object"==typeof t.write&&(e?.spatialOnly&&(t.write.layerContainerTypes=D.e),e?.target&&(t.write.target=e.target)),t}function ge(e){switch(e){case"point":case"multipoint":return le.d.clone();case"polyline":return le.a.clone();case"polygon":case"multipatch":return le.c.clone();default:return null}}function be(e,t){return null==e?null:t.subtypes?.find(t=>t.code===e)}function _e(e,t){let r=null;switch(t.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":r="point";break;case"esriGeometryPolyline":r="line";break;case"esriGeometryPolygon":case"esriGeometryMultiPatch":r="polygon";break;default:t.type,r=null}const i={},n=be(e,t);if(null!=n){const{defaultValues:e}=n;for(const t in e)i[t]=e[t]}return i[t.subtypeField]=e,new K.A({name:"New Feature",drawingTool:r,prototype:{attributes:i}})}let ve=class extends((0,u.M)((0,n.O)((0,q.sA)(k.x_)))){constructor(e){super(e),this.attributeTableTemplate=null,this.charts=null,this.editingEnabled=!0,this.fieldOverrides=null,this.fieldsIndex=null,this.formTemplate=null,this.graphicOrigin=new Q(this),this.id=`${Date.now().toString(16)}-subtype-sublayer-${he++}`,this.type="subtype-sublayer",this.labelsVisible=!0,this.labelingInfo=null,this.layerType="ArcGISFeatureLayer",this.legendEnabled=!0,this.listMode="show",this.minScale=0,this.maxScale=0,this.opacity=1,this.parent=null,this.popupEnabled=!0,this.popupTemplate=null,this.subtypeCode=null,this.templates=null,this.title=null,this.visible=!0}load(e){return(0,N.yp)(this.renderer,this.fieldsIndex),Promise.resolve(this)}get _titleCreator(){const e=this._get("_titleCreator");return(0,R.d)(e),new se.T({fieldsIndex:this.fieldsIndex,objectIdField:this.objectIdField,displayField:this.parent?.displayField??"",fields:this.fields,effectivePopupTemplate:this.popupTemplate??this.defaultPopupTemplate})}get capabilities(){return this.parent?.capabilities}get effectiveCapabilities(){return this.parent?.effectiveCapabilities}get effectiveEditingEnabled(){const{parent:e}=this;return e?e.effectiveEditingEnabled&&this.editingEnabled:this.editingEnabled}get elevationInfo(){return this.parent?.elevationInfo}get featureTitleFields(){return[...this._titleCreator.requiredFields]}writeFieldOverrides(e,t,r){const{fields:i,parent:n}=this;let s;if(i){s=[];let e=0;i.forEach(({name:t,alias:r,editable:i,visible:o})=>{if(!o)return;const a=n?.fields?.find(e=>e.name===t);if(!a)return;const l={name:t};let u=!1;r!==a.alias&&(l.alias=r,u=!0),i!==a.editable&&(l.editable=i,u=!0),s.push(l),u&&e++}),0===e&&s.length===i.length&&(s=null)}else s=(0,h.o8)(e);s?.length&&(0,G.s)(r,s,t)}get fields(){const{parent:e,fieldOverrides:t,subtypeCode:r}=this,i=e?.fields;if(!e||!i?.length)return null;const{subtypes:n,subtypeField:s}=e,o=n?.find(e=>e.code===r),a=o?.defaultValues,l=o?.domains,u=[];for(const e of i){const i=e.clone(),{name:n}=i,o=t?.find(e=>e.name===n);if(i.visible=!t?.length||!!o,o){const{alias:e,editable:t}=o;e&&(i.alias=e),!1===t&&(i.editable=!1)}const p=a?.[n]??null;i.defaultValue=n===s?r:p;const d=l?.[n]??null;i.domain=n===s?null:d?"inherited"===d.type?i.domain:d.clone():null,u.push(i)}return u}get floorInfo(){return this.parent?.floorInfo}get isTable(){return!!this.parent?.isTable}get geometryType(){return this.parent?.geometryType}get globalIdField(){return this.parent?this.parent.globalIdField:(f.L.getLogger(this).error(Me("globalIdField")),null)}get effectiveScaleRange(){const{minScale:e,maxScale:t}=this;return{minScale:e,maxScale:t}}get objectIdField(){return this.parent||f.L.getLogger(this).error(Me("objectIdField")),this.parent?.objectIdField}get defaultPopupTemplate(){return this.createPopupTemplate()}get relationships(){return this.parent?.relationships}set renderer(e){(0,N.yp)(e,this.fieldsIndex),this._override("renderer",e)}get renderer(){if(this._isOverridden("renderer"))return this._get("renderer");const{parent:e}=this;return e&&!e.isTable&&"mesh"!==e.geometryType?(t=e.geometryType,new te.A({symbol:ge(t)})):null;var t}readRendererFromService(e,t,r){if("Table"===t.type)return null;const i=t.drawingInfo?.renderer,n=de(i,t,r);let s;const{subtypeCode:o}=this;if(null!=o&&function(e,t){return!(!t||"unique-value"!==e?.type||null==e.field||e.field.toLowerCase()!==t.toLowerCase()||e.field2||e.field3||e.valueExpression)}(n,t.subtypeField)){const e=n.uniqueValueInfos?.find(({value:e})=>(e="number"==typeof e?String(e):e)===String(o));e&&(s=new te.A({symbol:e.symbol}))}else"simple"!==n?.type||n.visualVariables?.length||(s=n);return s}readRenderer(e,t,r){const i=t?.layerDefinition?.drawingInfo?.renderer;if(!i)return;const n=i.visualVariables?.some(e=>"rotationInfo"!==e.type);return n?void 0:de(i,t,r)||void 0}get spatialReference(){return this.parent?.spatialReference??U.A.WGS84}get subtypeField(){return this.parent?.subtypeField}readTemplatesFromService(e,t){return[_e(this.subtypeCode,t)]}readTitleFromService(e,t){const r=be(this.subtypeCode,t);return null!=r?r.name:null}get url(){return this.parent?.url}get userHasUpdateItemPrivileges(){return!!this.parent?.userHasUpdateItemPrivileges}async addAttachment(e,t){const{parent:r}=this;if(!r)throw Me("addAttachment");if(e.getAttribute(r.subtypeField)!==this.subtypeCode)throw new o.A("subtype-sublayer:addAttachment","The feature provided does not belong to this SubtypeSublayer");return r.addAttachment(e,t)}async updateAttachment(e,t,r){const{parent:i}=this;if(!i)throw Me("updateAttachment");if(e.getAttribute(i.subtypeField)!==this.subtypeCode)throw new o.A("subtype-sublayer:updateAttachment","The feature provided does not belong to this SubtypeSublayer");return i.updateAttachment(e,t,r)}async deleteAttachments(e,t){const{parent:r}=this;if(!r)throw Me("deleteAttachments");if(e.getAttribute(r.subtypeField)!==this.subtypeCode)throw new o.A("subtype-sublayer:deleteAttachments","The feature provided does not belong to this SubtypeSublayer");return r.deleteAttachments(e,t)}async applyEdits(e,t){if(!this.parent)throw Me("applyEdits");return this.parent.applyEdits(e,t)}createPopupTemplate(e){let t=this;const{parent:r,fields:i,title:n}=this;if(r){const{displayField:e,editFieldsInfo:s,objectIdField:o}=r;t={displayField:e,editFieldsInfo:s,fields:i,objectIdField:o,title:n}}return(0,ae.tn)(t,e)}createQuery(){if(!this.parent)throw Me("createQuery");const e=(0,L.j)(this.parent),t=`${this.parent.subtypeField}=${this.subtypeCode}`;return e.where=(0,c.mA)(t,this.parent.definitionExpression),e}getFeatureTitle(e,t){return this._titleCreator.getTitle(this,e,t)}getFeatureTitles(e,t){return this._titleCreator.getTitles(this,e,t)}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){if(!t?.excludeImpliedDomains&&this.parent){const t=(0,L.m)(this.parent,e);if(t)return t}return this._getLayerDomain(e)}async queryAttachments(e,t){const r=await this.load();if(!r.parent)throw Me("queryAttachments");const i=e.clone();return i.where=Fe(i.where,r.parent.subtypeField,r.subtypeCode),r.parent.queryAttachments(e,t)}async queryFeatureCount(e,t){const r=await this.load();if(!r.parent)throw Me("queryFeatureCount");return r.parent.queryFeatureCount(we(r.parent,r,e),t)}async queryFeatures(e,t){const r=await this.load();if(!r.parent)throw Me("queryFeatures");return r.parent.queryFeatures(we(r.parent,r,e),t)}async queryObjectIds(e,t){const r=await this.load();if(!r.parent)throw Me("queryObjectIds");return r.parent.queryObjectIds(we(r.parent,r,e),t)}async queryRelatedFeatures(e,t){const r=await this.load();if(!r.parent)throw Me("queryRelatedFeatures");return r.parent.queryRelatedFeatures(e,t)}async queryRelatedFeaturesCount(e,t){const r=await this.load();if(!r.parent)throw Me("queryRelatedFeaturesCount");return r.parent.queryRelatedFeaturesCount(e,t)}_getLayerDomain(e){const t=this.fieldsIndex.get(e);return t?t.domain:null}};(0,i._)([(0,y.MZ)({clonable:!1,readOnly:!0})],ve.prototype,"_titleCreator",null),(0,i._)([(0,y.MZ)({type:ue.h,json:me({name:"attributeTableInfo"})})],ve.prototype,"attributeTableTemplate",void 0),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"capabilities",null),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"effectiveCapabilities",null),(0,i._)([(0,y.MZ)({json:me()})],ve.prototype,"charts",void 0),(0,i._)([(0,y.MZ)({type:Boolean,nonNullable:!0,json:me({name:"enableEditing"})})],ve.prototype,"editingEnabled",void 0),(0,i._)([(0,y.MZ)({type:Boolean,readOnly:!0})],ve.prototype,"effectiveEditingEnabled",null),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"elevationInfo",null),(0,i._)([(0,y.MZ)({clonable:!1,readOnly:!0})],ve.prototype,"featureTitleFields",null),(0,i._)([(0,y.MZ)({json:{name:"layerDefinition.fieldOverrides",origins:{service:{read:!1}},write:{ignoreOrigin:!0,allowNull:!0}}})],ve.prototype,"fieldOverrides",void 0),(0,i._)([(0,$.w)("fieldOverrides")],ve.prototype,"writeFieldOverrides",null),(0,i._)([(0,y.MZ)({...ye.fields,readOnly:!0,json:{read:!1}})],ve.prototype,"fields",null),(0,i._)([(0,y.MZ)(ye.fieldsIndex)],ve.prototype,"fieldsIndex",void 0),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"floorInfo",null),(0,i._)([(0,y.MZ)({type:z.A,json:me({name:"formInfo"})})],ve.prototype,"formTemplate",void 0),(0,i._)([(0,y.MZ)({readOnly:!0,clonable:!1})],ve.prototype,"graphicOrigin",void 0),(0,i._)([(0,y.MZ)({type:String,clonable:!1,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],ve.prototype,"id",void 0),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"isTable",null),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"geometryType",null),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"globalIdField",null),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"type",void 0),(0,i._)([(0,y.MZ)(fe((0,h.o8)(E.l)))],ve.prototype,"labelsVisible",void 0),(0,i._)([(0,y.MZ)({type:[H.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",origins:{service:{read:!1}},read:{reader:Y.r},write:{ignoreOrigin:!0,layerContainerTypes:D.e}}})],ve.prototype,"labelingInfo",void 0),(0,i._)([(0,y.MZ)({type:["ArcGISFeatureLayer"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,layerContainerTypes:D.e}}})],ve.prototype,"layerType",void 0),(0,i._)([(0,y.MZ)(fe((0,h.o8)(E.a)))],ve.prototype,"legendEnabled",void 0),(0,i._)([(0,y.MZ)({type:["show","hide"]})],ve.prototype,"listMode",void 0),(0,i._)([(0,y.MZ)((()=>{const e=(0,h.o8)(E.c);return e.json.origins.service.read=!1,fe(e,{spatialOnly:!0})})())],ve.prototype,"minScale",void 0),(0,i._)([(0,y.MZ)((()=>{const e=(0,h.o8)(E.m);return e.json.origins.service.read=!1,fe(e,{spatialOnly:!0})})())],ve.prototype,"maxScale",void 0),(0,i._)([(0,y.MZ)({readOnly:!0})],ve.prototype,"effectiveScaleRange",null),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"objectIdField",null),(0,i._)([(0,y.MZ)({type:Number,range:{min:0,max:1},nonNullable:!0,json:me({spatialOnly:!0})})],ve.prototype,"opacity",void 0),(0,i._)([(0,y.MZ)({clonable:!1})],ve.prototype,"parent",void 0),(0,i._)([(0,y.MZ)(fe((0,h.o8)(E.p)))],ve.prototype,"popupEnabled",void 0),(0,i._)([(0,y.MZ)({type:P.A,json:me({name:"popupInfo"})})],ve.prototype,"popupTemplate",void 0),(0,i._)([(0,y.MZ)({readOnly:!0})],ve.prototype,"defaultPopupTemplate",null),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"relationships",null),(0,i._)([(0,y.MZ)({types:pe,json:me({target:"layerDefinition.drawingInfo.renderer",spatialOnly:!0})})],ve.prototype,"renderer",null),(0,i._)([(0,m.r)("service","renderer",["drawingInfo.renderer","subtypeField","type"])],ve.prototype,"readRendererFromService",null),(0,i._)([(0,m.r)("renderer",["layerDefinition.drawingInfo.renderer"])],ve.prototype,"readRenderer",null),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"spatialReference",null),(0,i._)([(0,y.MZ)({type:Number,json:{origins:{service:{read:!1}},write:{ignoreOrigin:!0}}})],ve.prototype,"subtypeCode",void 0),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"subtypeField",null),(0,i._)([(0,y.MZ)({type:[K.A],json:me({name:"layerDefinition.templates"})})],ve.prototype,"templates",void 0),(0,i._)([(0,m.r)("service","templates",["geometryType","subtypeField","subtypes","type"])],ve.prototype,"readTemplatesFromService",null),(0,i._)([(0,y.MZ)({type:String,json:me()})],ve.prototype,"title",void 0),(0,i._)([(0,m.r)("service","title",["subtypes"])],ve.prototype,"readTitleFromService",null),(0,i._)([(0,y.MZ)({readOnly:!0,json:{read:!1}})],ve.prototype,"url",null),(0,i._)([(0,y.MZ)({readOnly:!0})],ve.prototype,"userHasUpdateItemPrivileges",null),(0,i._)([(0,y.MZ)({type:Boolean,nonNullable:!0,json:me({name:"visibility",spatialOnly:!0})})],ve.prototype,"visible",void 0),ve=(0,i._)([(0,g.$)("esri.layers.support.SubtypeSublayer")],ve);const we=(e,t,r)=>{if(!r)return t.createQuery();const i=oe.A.from(r);return i.where=Fe(i.where,e.subtypeField,t.subtypeCode),i},Fe=(e,t,r)=>{const i=new RegExp(`${t}\\s*=\\s*\\d+`),n=`${t}=${r}`,s=e??"";return i.test(s)?s.replace(i,n):(0,c.mA)(n,s)},Me=e=>new o.A("subtype-sublayer:parent-missing",`This sublayer must have a parent SubtypeGroupLayer in order to use ${e}`);var Te=r(35619),Ie=r(59955),xe=r(55032);r(91028),r(71361),r(86688),r(64035),r(32826),r(89575),r(71895),r(85728),r(27084),r(61904),r(21914),r(82454),r(88321),r(47387),r(46728),r(21632),r(64102),r(43059),r(89935),r(49813),r(31175);const Ae="SubtypeGroupLayer";function Se(e,t){return new o.A("layer:unsupported",`Layer (${e.title}, ${e.id}) of type '${e.declaredClass}' ${t}`,{layer:e})}function Ze(e,t){const r=[];for(const i of e){const e=new ve;e.read(i,t),r.push(e)}return r}const Oe=(0,C.d)();let je=class extends((0,I.j)((0,M.FJ)((0,T.E)((0,w.dM)((0,O.e)((0,Z.j)((0,S.J)((0,v.A)((0,x.q)((0,A.A)((0,u.M)((0,F.d)((0,_.p)((0,n.O)(b.A))))))))))))))){constructor(...e){super(...e),this._sublayerLookup=new Map,this.fields=null,this.fieldsIndex=null,this.outFields=null,this.sublayers=new(s.A.ofType(ve)),this.useUniqueColorsForSublayers=!0,this.supportedSourceTypes=new Set(["Feature Layer","Table"]),this.timeInfo=null,this.title="Layer",this.type="subtype-group",this._debouncedSaveOperations=(0,p.sg)(async(e,t,i)=>{const{save:n,saveAs:s}=await r.e(9223).then(r.bind(r,91604));switch(e){case 0:return n(this,t);case 1:return s(this,i,t)}}),this.addHandles((0,d.wB)(()=>this.sublayers,(e,t)=>this._handleSublayersChange(e,t),d.OH))}destroy(){this.source?.destroy()}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}load(e){const t=null!=e?e.signal:null,r=this.loadFromPortal({supportedTypes:["Feature Service"]},e).catch(p.QP).then(async()=>{if(!this.url)throw new o.A("subtype-grouplayer:missing-url-or-source","SubtypeGroupLayer must be created with either a url or a portal item");if(null==this.layerId)throw new o.A("subtype-grouplayer:missing-layerid","layerId is required for a SubtypeGroupLayer created with url");this._initLayerProperties(await this.createGraphicsSource(t))}).then(()=>(0,L.a)(this,"load",e));return this.addResolvingPromise(r),Promise.resolve(this)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){return this.loaded&&null!=this.capabilities&&this.capabilities.operations.supportsEditing&&this.userHasEditingPrivileges}get effectiveEditingEnabled(){return(0,L.f)(this)}get operationalLayerType(){return this.isTable?"SubtypeGroupTable":"SubtypeGroupLayer"}set source(e){this._get("source")!==e&&this._set("source",e)}readTitleFromService(e,{name:t}){return this.url?(0,j.t)(this.url,t):t}async addAttachment(e,t){const r=await(0,L.i)(this,e,t,Ae);return this.lastEditsEventDate=new Date,r}async updateAttachment(e,t,r){const i=await(0,L.u)(this,e,t,r,Ae);return this.lastEditsEventDate=new Date,i}async applyEdits(e,t){return(0,L.b)(this,e,t)}async createGraphicsSource(e){const{default:t}=await(0,p.qr)(Promise.all([r.e(3609),r.e(1921),r.e(8380),r.e(6767)]).then(r.bind(r,38380)),e);return new t({layer:this,supportedSourceTypes:this.supportedSourceTypes}).load({signal:e})}createQuery(){const e=(0,L.j)(this),t=this.sublayers.map(e=>e.subtypeCode);return e.where=(0,c.mA)(`${this.subtypeField} IN (${t.join(",")})`,this.definitionExpression),e}async deleteAttachments(e,t){const r=await(0,L.k)(this,e,t,Ae);return this.lastEditsEventDate=new Date,r}async fetchRecomputedExtents(e){return(0,L.l)(this,e,Ae)}findSublayerForFeature(e){const t=this.fieldsIndex.get(this.subtypeField),r=e.attributes[t.name];return this.findSublayerForSubtypeCode(r)}findSublayerForSubtypeCode(e){return this._sublayerLookup.get(e)}getFieldDomain(e,t){if(!t?.excludeImpliedDomains){const t=(0,L.m)(this,e);if(t)return t}const r=(0,L.n)(this,t?.feature);if(r){const t=r.domains?.[e];return"inherited"===t?.type?this._getLayerDomain(e):t}return this._getLayerDomain(e)}loadAll(){return(0,a.l)(this,e=>{e(this.sublayers)})}async queryAttachments(e,t){return(0,L.q)(this,e,t,Ae)}async queryFeatures(e,t){const r=await this.load(),i=oe.A.from(e)??r.createQuery(),n=i.outFields??[];n.includes(this.subtypeField)||(n.push(this.subtypeField),i.outFields=n);const s=await r.source.queryFeatures(i,t);if(s?.features)for(const e of s.features){const t=this.findSublayerForFeature(e);e.origin=t?.graphicOrigin,e.layer=e.sourceLayer=this.findSublayerForFeature(e)}return s}async queryObjectIds(e,t){return(await(0,L.o)(this,e,t,Ae)).filter(xe.a)}async queryFeatureCount(e,t){return(0,L.p)(this,e,t,Ae)}async queryExtent(e,t){return(0,L.r)(this,e,t,Ae)}async queryRelatedFeatures(e,t){return(0,L.s)(this,e,t,Ae)}async queryRelatedFeaturesCount(e,t){return(0,L.t)(this,e,t,Ae)}async save(e){return this._debouncedSaveOperations(0,e)}async saveAs(e,t){return this._debouncedSaveOperations(1,t,e)}write(e,t){const{origin:r,layerContainerType:i,messages:n}=t;if(this.isTable){if("web-scene"===r||"web-map"===r&&"tables"!==i)return n?.push(Se(this,"using a table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&"web-map"===r&&"tables"===i)return n?.push(Se(this,"using a non-table source cannot be written to tables in web maps")),null;return this.sublayers?.length?super.write(e,t):(n?.push(new o.A("web-document-write:invalid-property",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' has invalid value for 'sublayers' property. 'sublayers' collection should contain at least one sublayer`,{layer:this})),null)}serviceSupportsSpatialReference(e){return!!this.loaded&&(0,Ie.s)(this,e)}async getFeatureTitle(e,t){const r=this.findSublayerForFeature(e);return r?await r.getFeatureTitle(e,t):this._getFeatureTitleForUnknownSublayer(e)}async getFeatureTitles(e,t){const r=new Map,i=new Map,n=[i];e.forEach(e=>{const t=this.findSublayerForFeature(e);if(t)(0,l.g)(r,t,()=>[]).push(e);else{const t=e.getObjectId()??e.attributes[this.objectIdField];i.set(t,this._getFeatureTitleForUnknownSublayer(e))}});const s=await Promise.all(Array.from(r).map(([e,r])=>e.getFeatureTitles(r,t)));return s.forEach(e=>n.push(e)),new Map(n.flatMap(e=>[...e]))}get featureTitleFields(){const e=new Set;for(const t of this.sublayers){const r=t.featureTitleFields;for(const t of r)e.add(t)}return[...e]}_getLayerDomain(e){const t=this.fieldsIndex.get(e);return t?t.domain:null}_initLayerProperties(e){this._set("source",e);const{sourceJSON:t}=e;if(t&&(this.sourceJSON=t,this.read(t,{origin:"service",url:this.parsedUrl})),!this.subtypes?.length)throw new o.A("subtype-grouplayer:missing-subtypes","SubtypeGroupLayer must be created using a layer with subtypes");this._verifyFields(),(0,N.sv)(this.timeInfo,this.fieldsIndex)}async hasDataChanged(){return(0,L.h)(this)}_verifyFields(){const e=this.parsedUrl?.path??"undefined";this.objectIdField||console.log("SubtypeGroupLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||-1!==e.search(/\/FeatureServer\//i)||this.fields?.some(e=>"geometry"===e.type)||console.log("SubtypeGroupLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")}_handleSublayersChange(e,t){t&&(t.forEach(e=>{e.parent=null}),this.removeHandles("sublayers-owner"),this._sublayerLookup.clear()),e&&(e.forEach(e=>{e.parent=this,this._sublayerLookup.set(e.subtypeCode,e)}),this.addHandles([e.on("after-add",({item:e})=>{e.parent=this,this._sublayerLookup.set(e.subtypeCode,e)}),e.on("after-remove",({item:e})=>{e.parent=null,this._sublayerLookup.delete(e.subtypeCode)})],"sublayers-owner"))}_getFeatureTitleForUnknownSublayer(e){const{displayField:t,fieldsIndex:r,objectIdField:i}=this;if(t&&r.has(t))return e.attributes[r.get(t).name]??"";const n=e.getObjectId();return null!=n?n.toString():i&&r.has(i)?e.attributes[r.get(i).name]??"":""}};(0,i._)([(0,y.MZ)({readOnly:!0})],je.prototype,"createQueryVersion",null),(0,i._)([(0,y.MZ)({readOnly:!0})],je.prototype,"editingEnabled",null),(0,i._)([(0,y.MZ)({readOnly:!0})],je.prototype,"effectiveEditingEnabled",null),(0,i._)([(0,y.MZ)({...Oe.fields,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],je.prototype,"fields",void 0),(0,i._)([(0,y.MZ)(Oe.fieldsIndex)],je.prototype,"fieldsIndex",void 0),(0,i._)([(0,y.MZ)(E.i)],je.prototype,"id",void 0),(0,i._)([(0,y.MZ)({type:["show","hide","hide-children"],json:{origins:{"portal-item":{read:!1,write:!1}}}})],je.prototype,"listMode",void 0),(0,i._)([(0,y.MZ)({type:["SubtypeGroupLayer","SubtypeGroupTable"],json:{name:"layerType",read:{enabled:!0},write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{"web-document":{name:"layerType",read:{enabled:!0},write:{enabled:!0,ignoreOrigin:!0,isRequired:!0}},"portal-item":{name:"layerType",read:{enabled:!0},write:{enabled:!0,ignoreOrigin:!0,isRequired:!0}}}}})],je.prototype,"operationalLayerType",null),(0,i._)([(0,y.MZ)(Oe.outFields)],je.prototype,"outFields",void 0),(0,i._)([(0,y.MZ)({clonable:!1})],je.prototype,"source",null),(0,i._)([(0,y.MZ)({type:s.A.ofType(ve),json:{origins:{service:{read:{source:"subtypes",reader(e,t,r){let i=null;if(this.useUniqueColorsForSublayers){const n=function(e,t){const r=e.drawingInfo?.renderer,i=r?de(r,e,t):null;if("simple"===i?.type)return(0,ne.e)(i.symbol,null)?i.symbol.clone():null}(t,r);i=n?function(e,t){return(0,W.d)(ce,e,{offset:!0,shuffle:!0}).reverse().map(e=>{const r=t.clone();return"cim"===r.type?(0,ie.Fe)(r,e):(0,ne.c)(r,e),new te.A({symbol:r})})}(e.length,n):null}const n=e.map(({code:e},n)=>{const s=new ve({subtypeCode:e});s.read(t,r);const o=i?.[n];return o&&s.read({drawingInfo:{renderer:o.toJSON()}},r),s});return new(s.A.ofType(ve))(n)}}}},read:{source:["layers","tables"],reader(e,t,r){let i;return"SubtypeGroupLayer"===t.layerType&&t.layers?.length?i=Ze(t.layers,r):"SubtypeGroupTable"===t.layerType&&t.tables?.length&&(i=Ze(t.tables,r)),new(s.A.ofType(ve))(i)}},write:{ignoreOrigin:!0,writer(e,t,r,i){const n=[];for(const t of e){const e=t.write({},i);n.push(e)}this.isTable?t.tables=n:t.layers=n}}}})],je.prototype,"sublayers",void 0),(0,i._)([(0,y.MZ)()],je.prototype,"useUniqueColorsForSublayers",void 0),(0,i._)([(0,y.MZ)({type:Te.A})],je.prototype,"timeInfo",void 0),(0,i._)([(0,y.MZ)({json:{origins:{"portal-item":{write:{enabled:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}}}})],je.prototype,"title",void 0),(0,i._)([(0,m.r)("service","title",["name"])],je.prototype,"readTitleFromService",null),(0,i._)([(0,y.MZ)({json:{read:!1}})],je.prototype,"type",void 0),(0,i._)([(0,y.MZ)({clonable:!1,readOnly:!0})],je.prototype,"featureTitleFields",null),je=(0,i._)([(0,g.$)("esri.layers.SubtypeGroupLayer")],je);const Ee=je},92517:(e,t,r)=>{r.d(t,{f:()=>p,g:()=>c,t:()=>d});var i=r(93804),n=r(44600),s=r(2160),o=r(36533),a=r(64752),l=r(84200),u=r(67504);const p=(0,i.s)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),d=(0,i.s)()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),c={base:s.A,key:"type",typeMap:{extent:n.A,multipoint:o.A,point:a.A,polyline:u.A,polygon:l.A}}},92963:(e,t,r)=>{function i(e,t){switch(t.type){case"object-id":case"unique-id-simple":return e.attributes[t.fieldName];case"unique-id-composite":{const r=[];for(const i of t.fieldNames)r.push(e.attributes[i]??null);return JSON.stringify(r)}}}function n(e,t){if("uniqueIdFields"in t&&t.uniqueIdFields?.length){if(1===t.uniqueIdFields.length)return e.attributes?.[t.uniqueIdFields[0]];const r=t.uniqueIdFields.map(t=>e.attributes?.[t]);return JSON.stringify(r)}return"objectIdField"in t&&t.objectIdField?e.attributes?.[t.objectIdField]:null}r.d(t,{a:()=>i,c:()=>n})},93049:(e,t,r)=>{r.d(t,{a:()=>s,b:()=>o,g:()=>n,n:()=>a});const i="randomUUID"in crypto;function n(){if(i)return crypto.randomUUID();const e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;const t=t=>e[t].toString(16).padStart(4,"0");return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}function s(){return`{${n().toUpperCase()}}`}function o(){return`{${n()}}`}function a(e){const t=e.toUpperCase();return e.startsWith("{")?t:`{${t}}`}},99032:(e,t,r)=>{r.d(t,{A:()=>s});var i=r(32816),n=(r(20266),r(32773),r(6407),r(69421));r(90740),r(59121),r(84699),r(50704),r(40499),r(93181),r(13671),r(91047),r(36544),r(48064);let s=class{};s=(0,i._)([(0,n.$)("esri.graphic.GraphicOrigin")],s)}}]);