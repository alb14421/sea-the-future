"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[7585],{44864:(e,t,r)=>{r.d(t,{A:()=>g});var n,a=r(32816),o=r(93804),s=r(99924),i=r(29298),u=r(36544),l=(r(32773),r(88663)),c=r(49877),p=r(69421),d=r(95637),h=r(17872);r(59121),r(41390),r(20266),r(90740),r(84699),r(85176),r(93181),r(13671),r(50704),r(40499),r(36555),r(58498),r(91047),r(35819),r(45371),r(61532),r(80959),r(6407),r(19247),r(36172),r(48064),r(59930),r(45862),r(72762),r(71613);const y=new o.J({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",currency:"currency",dateAndTime:"date-and-time",description:"description",emailAddress:"email-address",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",phoneNumber:"phone-number",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let m=class extends s.o{static{n=this}constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:t}){let r=null;try{r=t?JSON.parse(t):null}catch(e){}return r?.value??null}readValueType(e,{description:t}){let r=null;try{r=t?JSON.parse(t):null}catch(e){}return r?y.fromJSON(r.fieldValueType):null}clone(){return new n({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain?.clone()??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};(0,a._)([(0,i.MZ)({type:String,json:{write:!0}})],m.prototype,"alias",void 0),(0,a._)([(0,i.MZ)({type:[String,Number],json:{write:{allowNull:!0}}})],m.prototype,"defaultValue",void 0),(0,a._)([(0,i.MZ)()],m.prototype,"description",void 0),(0,a._)([(0,c.r)("description")],m.prototype,"readDescription",null),(0,a._)([(0,i.MZ)({types:d.t,json:{read:{reader:d.f},write:!0}})],m.prototype,"domain",void 0),(0,a._)([(0,i.MZ)({type:Boolean,json:{write:!0}})],m.prototype,"editable",void 0),(0,a._)([(0,i.MZ)({type:u.I,json:{write:{overridePolicy:e=>({enabled:Number.isFinite(e)})}}})],m.prototype,"length",void 0),(0,a._)([(0,i.MZ)({type:String,json:{write:!0}})],m.prototype,"name",void 0),(0,a._)([(0,i.MZ)({type:Boolean,json:{write:!0}})],m.prototype,"nullable",void 0),(0,a._)([(0,l.e)(h.k)],m.prototype,"type",void 0),(0,a._)([(0,i.MZ)()],m.prototype,"valueType",void 0),(0,a._)([(0,c.r)("valueType",["description"])],m.prototype,"readValueType",null),(0,a._)([(0,i.MZ)({type:Boolean,json:{read:!1}})],m.prototype,"visible",void 0),m=n=(0,a._)([(0,p.$)("esri.layers.support.Field")],m);const g=m},45862:(e,t,r)=>{r.d(t,{A:()=>p});var n=r(32816),a=r(93804),o=r(99924),s=r(29298),i=(r(32773),r(20266),r(88663)),u=r(69421);r(59121),r(41390),r(85176),r(93181),r(13671),r(50704),r(40499),r(36555),r(58498),r(91047),r(35819),r(45371),r(61532),r(80959),r(6407),r(19247),r(36172),r(36544),r(90740),r(84699),r(48064);const l=new a.J({inherited:"inherited",codedValue:"coded-value",range:"range"});let c=class extends o.o{constructor(e){super(e),this.name=null,this.type=null}};(0,n._)([(0,s.MZ)({type:String,json:{write:!0}})],c.prototype,"name",void 0),(0,n._)([(0,i.e)(l),(0,s.MZ)({json:{write:{isRequired:!0}}})],c.prototype,"type",void 0),c=(0,n._)([(0,u.$)("esri.layers.support.Domain")],c);const p=c},59930:(e,t,r)=>{r.d(t,{A:()=>y,C:()=>p});var n,a=r(32816),o=r(32773),s=r(29298),i=(r(20266),r(88663)),u=r(69421),l=r(99924),c=r(45862);r(36544),r(85176),r(93181),r(13671),r(40499),r(6407),r(59121),r(90740),r(84699),r(93804),r(50704),r(91047),r(48064),r(41390),r(36555),r(58498),r(35819),r(45371),r(61532),r(80959),r(19247),r(36172);let p=n=class extends l.o{constructor(e){super(e),this.name=null,this.code=null}clone(){return new n({name:this.name,code:this.code})}};var d;(0,a._)([(0,s.MZ)({type:String,json:{write:{isRequired:!0}}})],p.prototype,"name",void 0),(0,a._)([(0,s.MZ)({type:[String,Number],json:{write:{isRequired:!0}}})],p.prototype,"code",void 0),p=n=(0,a._)([(0,u.$)("esri.layers.support.CodedValue")],p);let h=class extends c.A{static{d=this}constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const r=String(e);this.codedValues.some(e=>(String(e.code)===r&&(t=e.name),!!t))}return t}clone(){return new d({codedValues:(0,o.o8)(this.codedValues),name:this.name})}};(0,a._)([(0,s.MZ)({type:[p],json:{write:{isRequired:!0}}})],h.prototype,"codedValues",void 0),(0,a._)([(0,i.e)({codedValue:"coded-value"})],h.prototype,"type",void 0),h=d=(0,a._)([(0,u.$)("esri.layers.support.CodedValueDomain")],h);const y=h},71613:(e,t,r)=>{r.d(t,{A:()=>c});var n,a=r(32816),o=r(29298),s=(r(32773),r(20266),r(88663)),i=r(69421),u=r(45862);r(36544),r(85176),r(93181),r(13671),r(40499),r(6407),r(59121),r(90740),r(84699),r(93804),r(50704),r(91047),r(48064),r(99924),r(41390),r(36555),r(58498),r(35819),r(45371),r(61532),r(80959),r(19247),r(36172);let l=class extends u.A{static{n=this}constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new n({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};(0,a._)([(0,o.MZ)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(e,t,r){t[r]=[this.minValue||0,e]},isRequired:!0}}})],l.prototype,"maxValue",void 0),(0,a._)([(0,o.MZ)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[0]},write:{target:"range",writer(e,t,r){t[r]=[e,this.maxValue||0]},isRequired:!0}}})],l.prototype,"minValue",void 0),(0,a._)([(0,s.e)({range:"range"})],l.prototype,"type",void 0),l=n=(0,a._)([(0,i.$)("esri.layers.support.RangeDomain")],l);const c=l},72762:(e,t,r)=>{r.d(t,{A:()=>l});var n,a=r(32816),o=(r(20266),r(32773),r(6407),r(88663)),s=r(69421),i=r(45862);r(90740),r(59121),r(84699),r(93804),r(29298),r(36544),r(85176),r(93181),r(13671),r(40499),r(50704),r(91047),r(48064),r(99924),r(41390),r(36555),r(58498),r(35819),r(45371),r(61532),r(80959),r(19247),r(36172);let u=class extends i.A{static{n=this}constructor(e){super(e),this.type="inherited"}clone(){return new n}};(0,a._)([(0,o.e)({inherited:"inherited"})],u.prototype,"type",void 0),u=n=(0,a._)([(0,s.$)("esri.layers.support.InheritedDomain")],u);const l=u},73067:(e,t,r)=>{r.d(t,{a:()=>y,c:()=>m,f:()=>l,m:()=>c,r:()=>h});var n=r(32816),a=r(41390),o=r(57732),s=r(80959),i=r(29298),u=r(69421);function l(e,t,r){return(0,s.Lx)(e.map((e,n)=>t.apply(r,[e,n])))}async function c(e,t,r){return(await(0,s.Lx)(e.map((e,n)=>t.apply(r,[e,n])))).map(e=>e.value)}function p(e){return{ok:!0,value:e}}function d(e){return{ok:!1,error:e}}async function h(e){if(null==e)return{ok:!1,error:new Error("no promise provided")};try{return p(await e)}catch(e){return d(e)}}async function y(e){try{return p(await e)}catch(e){return(0,s.QP)(e),d(e)}}function m(e,t){return new g(e,t)}let g=class extends a.A{get value(){return null!=(e=this._result)&&!0===e.ok?e.value:null;var e}get error(){return null!=(e=this._result)&&!1===e.ok?e.error:null;var e}get finished(){return null!=this._result}constructor(e,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=(0,o.a)(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=e(r),this.promise.then(e=>{this._result=p(e),this._cleanup()},e=>{this._result=d(e),this._cleanup()}),this._abortHandle=(0,s.u7)(t,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=(0,o.r)(this._abortHandle),this._abortController=null}};(0,n._)([(0,i.MZ)()],g.prototype,"value",null),(0,n._)([(0,i.MZ)()],g.prototype,"error",null),(0,n._)([(0,i.MZ)()],g.prototype,"finished",null),(0,n._)([(0,i.MZ)()],g.prototype,"promise",void 0),(0,n._)([(0,i.MZ)()],g.prototype,"_result",void 0),g=(0,n._)([(0,u.$)("esri.core.asyncUtils.ReactiveTask")],g)},84698:(e,t,r)=>{r.d(t,{a:()=>u,c:()=>c,l:()=>g,m:()=>d,q:()=>_,s:()=>m});var n=r(58126),a=r(69763),o=r(30011);class s{constructor(e){this.description=e,this.code=null}}class i{constructor(e){this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error=new s(e)}}function u(e){return new i(e)}class l{constructor(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e}}function c(e){return new l(e)}const p=new Set;function d(e,t,r,n=!1){p.clear();for(const a in r){const s=e.get(a);if(!s)continue;const i=h(s,r[a]);if(p.add(s.name),s&&(n||s.editable)){const e=(0,o.CJ)(s,i);if(e)return u((0,o.uo)(e,s,i));t[s.name]=i}}for(const t of e.requiredFields??[])if(!p.has(t.name))return u(`missing required field "${t.name}"`);return null}function h(e,t){let r=t;return(0,o.WA)(e)&&"string"==typeof t?r=parseFloat(t):(0,o.yM)(e)&&null!=t&&"string"!=typeof t?r=String(t):(0,o.vE)(e)&&"string"==typeof t&&(r=(0,n.p)(t)),(0,o.WX)(r)}let y;function m(e,t){if(!e||!(0,a.A)(t))return e;if("rings"in e||"paths"in e){if(null==y)throw new TypeError("geometry engine not loaded");return y.simplify(t,e)}return e}async function g(e,t){!(0,a.A)(e)||"esriGeometryPolygon"!==t&&"esriGeometryPolyline"!==t||await async function(){return null==y&&(y=await Promise.all([r.e(9257),r.e(1394)]).then(r.bind(r,61394)).then(e=>e.g)),y}()}const _={supportsAutoIntervalBin:!0,supportsFixedIntervalBin:!0,supportsFixedBoundariesBin:!0,supportsDateBin:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsNormalization:!0,supportedStatisticTypes:["COUNT","SUM","AVG","VAR","STDDEV","MIN","MAX","PERCENTILE_CONT","PERCENTILE_DISC","CentroidAggregate","EnvelopeAggregate","ConvexHullAggregate"],supportedNormalizationTypes:["field","log","naturalLog","percentOfTotal","squareRoot"]}},87585:(e,t,r)=>{r.r(t),r.d(t,{default:()=>v});var n=r(73067),a=r(6407),o=r(20266),s=r(16699),i=r(80959),u=r(48064),l=r(69763),c=r(83637),p=r(9704),d=r(13141),h=r(2824),y=r(2232),m=r(73671),g=r(84698),_=r(34225),f=r(79875),w=r(55032),C=r(16345);r(32816),r(41390),r(32773),r(69421),r(50704),r(40499),r(93181),r(13671),r(91047),r(36544),r(59121),r(85176),r(36555),r(58498),r(29298),r(35819),r(45371),r(61532),r(36172),r(90740),r(84699),r(19247),r(93804),r(96221),r(18683),r(64604),r(29512),r(99063),r(1178),r(47239),r(44600),r(2160),r(99924),r(49877),r(7969),r(56273),r(64752),r(48844),r(29208),r(48402),r(22522),r(77037),r(36533),r(84200),r(97827),r(18169),r(20762),r(67504),r(58003),r(33489),r(96153),r(3952),r(339),r(79281),r(13978),r(47368),r(3687),r(88321),r(44945),r(2589),r(47387),r(46728),r(21632),r(64102),r(59700),r(81272),r(42614),r(11721),r(11618),r(56764),r(34362),r(23787),r(22151),r(38896),r(26589),r(7011),r(133),r(54483),r(59192),r(17872),r(70648),r(69310),r(30011),r(31572),r(4734),r(50214),r(9943),r(91276),r(18527),r(62482),r(45476),r(71044),r(17745),r(43534),r(13226),r(47812),r(83463),r(346),r(78016),r(16641),r(88817),r(88663),r(29403),r(40672),r(52731),r(96587),r(79747),r(14509),r(14549),r(26171),r(85842),r(75169),r(67321),r(7078),r(33348),r(58126),r(92517),r(44864),r(95637),r(59930),r(45862),r(72762),r(71613);const x="esri.layers.WFSLayer";class v{constructor(){this._customParameters=null,this._queryEngine=null,this._supportsPagination=!0}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}async load(e,t={}){const{getFeatureUrl:r,getFeatureOutputFormat:n,fields:o,geometryType:s,featureType:u,maxRecordCount:l,maxTotalRecordCount:c,maxPageCount:p,objectIdField:m,customParameters:g}=e,{spatialReference:w,getFeatureSpatialReference:x}=(0,_.UH)(r,u,e.spatialReference);try{await(0,h.c)(x,w)}catch{throw new a.A("unsupported-projection","Projection not supported",{inSpatialReference:x,outSpatialReference:w})}(0,i.Te)(t),this._customParameters=g,this._featureType=u,this._fieldsIndex=f.A.fromLayerJSON({fields:o,dateFieldsTimeReference:o.some(e=>"esriFieldTypeDate"===e.type)?{timeZoneIANA:C.a}:null}),this._geometryType=s,this._getFeatureUrl=r,this._getFeatureOutputFormat=n,this._getFeatureSpatialReference=x,this._maxRecordCount=l,this._maxTotalRecordCount=c,this._maxPageCount=p,this._objectIdField=m,this._spatialReference=w;let v=await this._snapshotFeatures(t);if(v.errors.length>0&&(this._supportsPagination=!1,v=await this._snapshotFeatures(t),v.errors.length>0))throw v.errors[0];const b={type:"object-id",fieldName:m};return this._queryEngine=new y.a({fieldsIndex:this._fieldsIndex,geometryType:s,hasM:!1,hasZ:!1,featureIdInfo:b,spatialReference:w,timeInfo:null,featureStore:new d.F({geometryType:s,hasM:!1,hasZ:!1})}),this._queryEngine.featureStore.addMany(v.features),{warnings:R(v),extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async applyEdits(){throw new a.A("wfs-source:editing-not-supported","applyEdits() is not supported on WFSLayer")}async queryFeatures(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQuery(e,t.signal)}async queryFeatureCount(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForCount(e,t.signal)}async queryObjectIds(e={},t={}){return await this._waitSnapshotComplete(),(await this._queryEngine.executeQueryForIds(e,t.signal)).filter(w.a)}async queryExtent(e={},t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeQueryForExtent(e,t.signal)}async querySnapping(e,t={}){return await this._waitSnapshotComplete(),(0,p.e)(this._queryEngine,e,t.signal)}async queryAttributeBins(e,t={}){return await this._waitSnapshotComplete(),this._queryEngine.executeAttributeBinsQuery(e,t.signal)}async refresh(e){return this._customParameters=e.customParameters,this._maxRecordCount=e.maxRecordCount,this._maxTotalRecordCount=e.maxTotalRecordCount,this._maxPageCount=e.maxPageCount,this._snapshotTask?.abort(),this._snapshotTask=(0,n.c)(e=>this._snapshotFeatures({signal:e})),this._snapshotTask.promise.then(e=>{this._queryEngine.featureStore.clear(),this._queryEngine.featureStore.addMany(e.features);for(const t of R(e))o.L.getLogger(x).warn(new u.W("wfs-layer:refresh-warning",t.message,t.details));e.errors?.length&&o.L.getLogger(x).warn(new u.W("wfs-layer:refresh-error","Refresh completed with errors",{errors:e.errors}))},()=>{this._queryEngine.featureStore.clear()}),await this._waitSnapshotComplete(),{extent:(await this._queryEngine.fetchRecomputedExtents()).fullExtent}}async _waitSnapshotComplete(){if(this._snapshotTask&&!this._snapshotTask.finished){try{await this._snapshotTask.promise}catch{}return this._waitSnapshotComplete()}}async _snapshotFeatures(e){const t=e?.signal,r=this._maxTotalRecordCount,n=this._maxPageCount,a=this._supportsPagination&&n>1?await(0,_.E)(this._getFeatureUrl,this._featureType.typeName,{customParameters:this._customParameters,signal:t}):void 0;let o=[];const u=[];if(null==a)try{o=await this._singleQuery(t)}catch(e){(0,i.zf)(e)||u.push(e)}else{const e=Math.min(a,r),l=function*(e,t,r){for(let n=0;n<t;n++)yield e._pageQuery(n,r)}(this,(0,s.c)(Math.ceil(e/this._maxRecordCount),1,n),t);await Promise.allSettled(Array.from({length:10}).map(()=>async function(e,t,r){let n=e.next();for(;!n.done;){try{const e=await n.value;t.push(...e)}catch(e){(0,i.zf)(e)||r.push(e)}n=e.next()}}(l,o,u)))}return(0,i.Te)(t),{features:o,totalRecordCount:a,maxTotalRecordCount:r,maxPageCount:n,errors:u}}async _singleQuery(e){const t=Number.isFinite(this._maxRecordCount)&&this._maxRecordCount>0?this._maxRecordCount:void 0,r=await(0,_.x$)(this._getFeatureUrl,this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,count:t,signal:e});return this._processGeoJSON(r,{signal:e})}async _pageQuery(e,t){const r=e*this._maxRecordCount,n=await(0,_.x$)(this._getFeatureUrl,this._featureType.typeName,this._getFeatureSpatialReference,this._getFeatureOutputFormat,{customParameters:this._customParameters,startIndex:r,count:this._maxRecordCount,signal:t});return this._processGeoJSON(n,{startIndex:r,signal:t})}_processGeoJSON(e,t){(0,m.v)(e,this._getFeatureSpatialReference.wkid);const{startIndex:r,signal:n}=t;(0,i.Te)(n);const a=(0,m.c)(e,{geometryType:this._geometryType,hasZ:!1,objectIdField:this._objectIdField});if(!(0,l.p)(this._spatialReference,this._getFeatureSpatialReference))for(const e of a)null!=e.geometry&&(e.geometry=(0,c.b)((0,h.p)((0,c.a)(e.geometry,this._geometryType,!1,!1),this._getFeatureSpatialReference,this._spatialReference)));let o=r??1;for(const e of a){const t={};(0,g.m)(this._fieldsIndex,t,e.attributes,!0),e.attributes=t,null==t[this._objectIdField]&&(e.objectId=t[this._objectIdField]=o++)}return a}}function R(e){const t=[];return null!=e.totalRecordCount&&(e.features.length<e.totalRecordCount&&t.push({name:"wfs-layer:maxRecordCount-too-low",message:`Could only fetch ${e.features.length} of ${e.totalRecordCount} in ${e.maxPageCount} queries. Try increasing the value of WFSLayer.maxRecordCount.`,details:{recordCount:e.features.length,totalRecordCount:e.totalRecordCount}}),e.totalRecordCount>e.maxTotalRecordCount&&t.push({name:"wfs-layer:large-dataset",message:`The number of ${e.totalRecordCount} features exceeds the maximum allowed of ${e.maxTotalRecordCount}.`,details:{recordCount:e.features.length,totalRecordCount:e.totalRecordCount,maxTotalRecordCount:e.maxTotalRecordCount}})),t}},95637:(e,t,r)=>{r.d(t,{f:()=>u,t:()=>i}),r(32773);var n=r(59930),a=r(45862),o=r(72762),s=r(71613);const i={key:"type",base:a.A,typeMap:{range:s.A,"coded-value":n.A,inherited:o.A}};function u(e){if(!e?.type)return null;switch(e.type){case"range":return s.A.fromJSON(e);case"codedValue":return n.A.fromJSON(e);case"inherited":return o.A.fromJSON(e)}return null}}}]);