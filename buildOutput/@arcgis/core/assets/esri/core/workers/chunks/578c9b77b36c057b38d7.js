/*! For license information please see 578c9b77b36c057b38d7.js.LICENSE.txt */
"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[4491],{13262:(e,t,s)=>{s.d(t,{s:()=>h});var r=s(20266),i=s(59121),o=s(84699),n=s(50214),a=s(95779);const l=()=>r.L.getLogger("esri.intl.substitute");function h(e,t,s={}){const{format:r={}}=s;return(0,o.r)(e,e=>function(e,t,s){let r,o;const h=e.indexOf(":");if(-1===h?r=e.trim():(r=e.slice(0,h).trim(),o=e.slice(h+1).trim()),!r)return"";const d=(0,i.g)(r,t);if(null==d)return"";const u=(o?s?.[o]:null)??s?.[r];return u?function(e,t){switch(t.type){case"date":return(0,n.f)(e,t.intlOptions);case"number":return(0,a.f)(e,t.intlOptions);default:return l().warn("missing format descriptor for key {key}"),c(e)}}(d,u):o?function(e,t){switch(t.toLowerCase()){case"dateformat":return(0,n.f)(e);case"numberformat":return(0,a.f)(e);default:return l().warn(`inline format is unsupported since 4.12: ${t}`),/^(dateformat|datestring)/i.test(t)?(0,n.f)(e):/^numberformat/i.test(t)?(0,a.f)(e):c(e)}}(d,o):c(d)}(e,t,r))}function c(e){switch(typeof e){case"string":return e;case"number":return(0,a.f)(e);case"boolean":return""+e;default:return e instanceof Date?(0,n.f)(e):""}}},28276:(e,t,s)=>{s.d(t,{Z:()=>c,g:()=>h});var r=s(32816),i=s(41390),o=s(13671),n=s(80959),a=s(69421);s(32773),s(20266),s(90740),s(59121),s(84699),s(85176),s(93181),s(50704),s(40499),s(36555),s(58498),s(91047),s(29298),s(36544),s(6407),s(35819),s(45371),s(61532),s(36172),s(19247),s(48064);class l{constructor(){this._resolver=(0,n.Tw)(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=1,this._cleanUp()},()=>{this._status=2,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return 1===this._status}isRejected(){return 2===this._status}isFulfilled(){return 0!==this._status}abort(){this._resolver.reject((0,n.NK)())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=(0,n.Tw)(),t=[...this._resolvingPromises,e.promise],s=this._allPromise=Promise.all(t);s.then(()=>{this.isFulfilled()||this._allPromise!==s||this._resolver.resolve()},e=>{this.isFulfilled()||this._allPromise!==s||(0,n.zf)(e)||this._resolver.reject(e)}),e.resolve()}}const h=e=>{const t=e;let s=class extends t{constructor(...e){super(...e),this._promiseProps=new l,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(e,t){return this._promiseProps.promise.then(()=>this).then(e,t)}catch(e){return this.when(null,e)}addResolvingPromise(e){e&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in e?e.when():e)}addResolvingTask(e){e&&!this._promiseProps.isFulfilled()&&(this.addHandles((0,o.a)(e)),this._promiseProps.addResolvingPromise(e.promise))}};return s=(0,r._)([(0,a.$)("esri.core.Promise")],s),s},c=h(i.A)},54491:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ot});var r=s(29512),i=s(32816),o=s(90740),n=s(64604),a=s(6407),l=s(81272),h=s(19247),c=s(32773),d=s(59121),u=s(80959),p=s(99063),f=s(29298),g=s(20266),m=s(69421);s(55270);var _=s(57732),v=s(28276),y=s(67321),w=s(93049),A=s(48844),S=s(91047),b=s(36172),k=s(42866);const I="http://www.w3.org/",U=`${I}2000/svg`,$=`${I}1999/xlink`;let C=[],P=(e,t)=>{let s={};return Object.keys(e).forEach(t=>{s[t]=e[t]}),t&&Object.keys(t).forEach(e=>{s[e]=t[e]}),s},T=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),x=e=>{if("string"!=typeof e)throw new Error("Style values must be strings")},E=(e,t,s)=>{if(""!==t.vnodeSelector)for(let r=s;r<e.length;r++)if(T(e[r],t))return r;return-1},R=(e,t,s,r)=>{let i=e[t];if(""===i.vnodeSelector)return;let o=i.properties;if(!(o?void 0===o.key?o.bind:o.key:void 0))for(let o=0;o<e.length;o++)if(o!==t){let t=e[o];if(T(t,i))throw new Error(`${s.vnodeSelector} had a ${i.vnodeSelector} child ${"added"===r?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}},O=e=>{if(e.properties){let t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},M=[],N=!1,L=e=>{(e.children||[]).forEach(L),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode])},D=()=>{N=!1,M.forEach(L),M.length=0},j=e=>{M.push(e),N||(N=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(D,{timeout:16}):setTimeout(D,16))},q=e=>{let t=e.domNode;if(e.properties){let s=e.properties.exitAnimation;if(s){t.style.pointerEvents="none";let r=()=>{t.parentNode&&(t.parentNode.removeChild(t),j(e))};return void s(t,r,e.properties)}}t.parentNode&&(t.parentNode.removeChild(t),j(e))},H=(e,t,s)=>{if(!t)return;let r=s.eventHandlerInterceptor,i=Object.keys(t),o=i.length;for(let n=0;n<o;n++){let o=i[n],a=t[o];if("className"===o)throw new Error('Property "className" is not supported, use "class".');if("class"===o)V(e,a,!0);else if("classes"===o){let t=Object.keys(a),s=t.length;for(let r=0;r<s;r++){let s=t[r];a[s]&&e.classList.add(s)}}else if("styles"===o){let t=Object.keys(a),r=t.length;for(let i=0;i<r;i++){let r=t[i],o=a[r];o&&(x(o),s.styleApplyer(e,r,o))}}else if("key"!==o&&null!=a){let i=typeof a;"function"===i?(0===o.lastIndexOf("on",0)&&(r&&(a=r(o,a,e,t)),"oninput"===o&&function(){let e=a;a=function(t){e.apply(this,[t]),t.target["oninput-value"]=t.target.value}}()),e[o]=a):s.namespace===U?"href"===o?e.setAttributeNS($,o,a):e.setAttribute(o,a):"string"===i&&"value"!==o?"innerHTML"===o?e[o]=k.r.sanitize(a):z(e)&&o in e?e[o]=a:e.setAttribute(o,a):e[o]=a}}};function z(e){if(!(e instanceof Element&&e.tagName.includes("-")))return!1;const t=window.customElements.get(e.tagName.toLowerCase());return!!t&&e instanceof t}let B,Z=(e,t,s)=>{((e,t,s)=>{if(t)for(let r of t)F(r,e,void 0,s)})(e,t.children,s),t.text&&(e.textContent=t.text),H(e,t.properties,s),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,s,t.vnodeSelector,t.properties,t.children])},F=(e,t,s,r)=>{let i,o=0,n=e.vnodeSelector,a=t.ownerDocument;if(""===n)i=e.domNode=a.createTextNode(e.text),void 0!==s?t.insertBefore(i,s):t.appendChild(i);else{for(let l=0;l<=n.length;++l){let h=n.charAt(l);if(l===n.length||"."===h||"#"===h){let h=n.charAt(o-1),c=n.slice(o,l);"."===h?i.classList.add(c):"#"===h?i.id=c:("svg"===c&&(r=P(r,{namespace:U})),void 0!==r.namespace?i=e.domNode=a.createElementNS(r.namespace,c):(i=e.domNode=e.domNode||a.createElement(c),"input"===c&&e.properties&&void 0!==e.properties.type&&i.setAttribute("type",e.properties.type)),void 0!==s?t.insertBefore(i,s):i.parentNode!==t&&t.appendChild(i)),o=l+1}}Z(i,e,r)}},V=(e,t,s)=>{t&&t.split(" ").forEach(t=>{t&&e.classList.toggle(t,s)})};B=(e,t,s)=>{let r=e.domNode,i=!1;if(e===t)return!1;let o=!1;if(""===t.vnodeSelector){if(t.text!==e.text){let e=r.ownerDocument.createTextNode(t.text);return r.parentNode.replaceChild(e,r),t.domNode=e,i=!0,i}t.domNode=r}else 0===t.vnodeSelector.lastIndexOf("svg",0)&&(s=P(s,{namespace:U})),e.text!==t.text&&(o=!0,void 0===t.text?r.removeChild(r.firstChild):r.textContent=t.text),t.domNode=r,o=((e,t,s,r,i)=>{if(s===r)return!1;r=r||C;let o,n=(s=s||C).length,a=r.length,l=0,h=0,c=!1;for(;h<a;){let a=l<n?s[l]:void 0,d=r[h];if(void 0!==a&&T(a,d))c=B(a,d,i)||c,l++;else{let a=E(s,d,l+1);if(a>=0){for(o=l;o<a;o++)q(s[o]),R(s,o,e,"removed");c=B(s[a],d,i)||c,l=a+1}else F(d,t,l<n?s[l].domNode:void 0,i),O(d),R(r,h,e,"added")}h++}if(n>l)for(o=l;o<n;o++)q(s[o]),R(s,o,e,"removed");return c})(t,r,e.children,t.children,s)||o,o=((e,t,s,r)=>{if(!s)return;let i=!1,o=Object.keys(s),n=o.length;for(let a=0;a<n;a++){let n=o[a],l=s[n],h=t[n];if("class"===n)h!==l&&(V(e,h,!1),V(e,l,!0));else if("classes"===n){let t=e.classList,s=Object.keys(l),r=s.length;for(let e=0;e<r;e++){let r=s[e],o=!!l[r];o!==!!h[r]&&(i=!0,o?t.add(r):t.remove(r))}}else if("styles"===n){let t=Object.keys(l),s=t.length;for(let o=0;o<s;o++){let s=t[o],n=l[s];n!==h[s]&&(i=!0,n?(x(n),r.styleApplyer(e,s,n)):r.styleApplyer(e,s,""))}}else if(l||"string"!=typeof h||(l=""),"value"!==n||z(e)){if(l!==h){let t=typeof l;"function"===t&&r.eventHandlerInterceptor||(r.namespace===U?"href"===n?e.setAttributeNS($,n,l):e.setAttribute(n,l):"string"===t?"innerHTML"===n?e[n]=k.r.sanitize(l):"role"===n&&""===l?e.removeAttribute(n):z(e)&&n in e?e[n]=l:e.setAttribute(n,l):e[n]!==l&&(e[n]=l),i=!0)}}else{let t=e[n];t!==l&&(e["oninput-value"]?t===e["oninput-value"]:l!==h)&&(e[n]=l,e["oninput-value"]=void 0),l!==h&&(i=!0)}}return i})(r,e.properties,t.properties,s)||o,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[r,s,t.vnodeSelector,t.properties,t.children]);return o&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(r,t.properties,e.properties),i};let W=(e,t)=>({getLastRender:()=>e,update:s=>{if(e.vnodeSelector!==s.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let r=e;e=s,B(r,s,t)},domNode:e.domNode});const J={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,s)=>{"-"===t.charAt(0)?e.style.setProperty(t,s):e.style[t]=s}};let G,K=e=>P(J,e),X=(e,t,s)=>(s=K(s),F(t,e,void 0,s),W(t,s)),Q=(e,t,s)=>(s=K(s),F(t,e.parentNode,e,s),W(t,s)),Y=(e,t,s)=>(s=K(s),t.domNode=e,Z(e,t,s),W(t,s)),ee=(e,t,s)=>(s=K(s),F(t,e.parentNode,e,s),e.parentNode.removeChild(e),W(t,s));G=Array.prototype.find?(e,t)=>e.find(t):(e,t)=>e.filter(t)[0];var te=s(96889),se=s(13671);const re=Symbol("widget"),ie=Symbol("widget-test-data"),oe=[],ne={},ae=new WeakMap;function le(e,t){let s=t.children;if(s?.length)for(let t=0;t<s.length;++t)s[t]=le(e,s[t]);else s=oe;const r=t.vnodeSelector;if(ue(r)){const i=t.properties||ne,o=i.key||r,n={key:o,afterCreate:he,afterUpdate:ce,afterRemoved:de,parentWidget:e,widgetConstructor:r,widgetProperties:{...i,key:o,children:s}};return{vnodeSelector:r.vnodeSelector,properties:n,children:void 0,text:void 0,domNode:null}}return t}function he(e,t,s,{parentWidget:r,widgetConstructor:i,widgetProperties:o}){const n=new i(o);n.container=e,ae.set(e,n),n.afterCreate?.(n,e),r.addHandles((0,se.m)(()=>de(e))),queueMicrotask(()=>{n[ie].projector.renderNow()})}function ce(e,t,s,{widgetProperties:r}){const i=ae.get(e);i&&(i.set(r),i.afterUpdate?.(i,e))}function de(e){const t=ae.get(e);t&&(t.afterRemoved?.(t,e),t.destroy(),ae.delete(e))}function ue(e){return"function"==typeof e&&e[re]}var pe=s(35819),fe=s(45371);const ge=new Map;function me(){ge.clear()}function _e(e){ge.delete(e)}function ve(...e){const t=pe.A.acquire();for(let s=0;s<e.length;s++){const r=e[s],i=typeof r;if("string"===i)t.push(r);else if(Array.isArray(r))t.push.apply(t,r);else if("object"===i)for(const e in r)r[e]&&t.push(e)}const s=t.join(" ");return pe.A.release(t),s}(()=>{const e=new Map;new ResizeObserver(t=>{me();for(const s of t)e.get(s.target)?.(s)})})();var ye=s(346),we=s(59192),Ae=(s(50214),s(93804),s(16345),s(54483),s(95779),s(13262));s(84699),s(1178),s(18683),s(41390),s(85176),s(93181),s(50704),s(40499),s(36555),s(58498),s(61532),s(36544),s(48064);const Se={handleInterceptedEvent:(e,t,s,r)=>(e.scheduleRender(),t.properties[`on${r.type}`].apply(t.properties.bind||s,[r]))},be={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,s)=>{t.startsWith("-")?e.style.setProperty(t,s):e.style[t]=s}},ke=(e,t,s=!1)=>{let r=e;return t.forEach((e,i)=>{const o=r?.children?(n=t=>t.domNode===e,r.children.find(n)):void 0;var n;s&&!o&&i!==t.length-1||(r=o)}),r},Ie=new Set;var Ue;let $e=0;function Ce(e,t){const s=Object.prototype.hasOwnProperty;for(const r in t)s.call(t,r)&&s.call(e,r)&&(null!=e[r]&&null!=t[r]&&"object"==typeof e[r]&&"object"==typeof t[r]?Ce(e[r],t[r]):e[r]=t[r]);return e}const Pe=(e=>{let t;const s={...Se,...e},r=(e=>({...be,...e}))(s),i=r.performanceLogger;let o,n=!0,a=!1;const l=[],h=[],c=(e,o,n)=>{let a;r.eventHandlerInterceptor=(e,r,o,n)=>function(e){let r;i("domEvent",e);const o=((e,t)=>{const s=[];for(;e&&e!==t;)s.push(e),e=e.parentNode;return s})(e.currentTarget,a.domNode),n=o.some(e=>customElements.get(e?.tagName?.toLowerCase()));if(e.eventPhase!==Event.CAPTURING_PHASE&&n){const t=e.composedPath(),s=t.slice(t.indexOf(e.currentTarget),t.indexOf(a.domNode)).reverse();r=ke(a.getLastRender(),s,!0)}else o.reverse(),r=ke(a.getLastRender(),o);let l;return r&&(l=s.handleInterceptedEvent(t,r,this,e)),i("domEventProcessed",e),l},s.postProcessProjectionOptions?.(r);const c=n();a=e(o,c,r),r.eventHandlerInterceptor=void 0,l.push(a),h.push(n),s.afterFirstVNodeRendered&&s.afterFirstVNodeRendered(a,c)};let d=()=>{if(o=void 0,n){n=!1,i("renderStart",void 0);for(let e=0;e<l.length;e++){const t=h[e]();i("rendered",void 0);try{l[e].update(t)}catch(e){console.error(e)}i("patched",void 0)}i("renderDone",void 0),n=!0}};return s.modifyDoRenderImplementation&&(d=s.modifyDoRenderImplementation(d,l,h)),t={renderNow:d,scheduleRender:()=>{o||a||(o=requestAnimationFrame(d))},stop:()=>{o&&(cancelAnimationFrame(o),o=void 0),a=!0},resume:()=>{a=!1,n=!0,t.scheduleRender()},append:(e,t)=>{c(X,e,t)},insertBefore:(e,t)=>{c(Q,e,t)},merge:(e,t)=>{c(Y,e,t)},replace:(e,t)=>{c(ee,e,t)},detach:e=>{for(let t=0;t<h.length;t++)if(h[t]===e)return h.splice(t,1),l.splice(t,1)[0];throw new Error("renderFunction was not found")}},t})({postProcessProjectionOptions(e){const t=e.eventHandlerInterceptor,s=/capture$/i;e.eventHandlerInterceptor=(e,r,i,o)=>{const n=t?.(e,r,i,o),a=s.test(e);if(!((e=e.replace(s,"")).toLowerCase()in i)||a){const t=e[2].toLowerCase()+e.slice(3),s=e=>n?.call(i,e);i.addEventListener(t,s,a);const r=()=>i.removeEventListener(t,s,a),l=o.afterRemoved;o.afterRemoved=e=>{l?.(e),r()}}return n}},handleInterceptedEvent(e,t,s,r){const{eventPhase:i,type:o}=r,n=i===Event.CAPTURING_PHASE;let a=`on${o}${n?"capture":""}`;const l=t.properties;(l&&a in l||(a=`on${o[0].toUpperCase()}${o.slice(1)}${n?"Capture":""}`,l&&a in l))&&(me(),e.scheduleRender(),l[a].call(l.bind||s,r))}});let Te=!1,xe=class extends((0,v.g)(l.nJ)){static{this[Ue]=!0}constructor(e,t){super(e,t),this._attached=!1,this._projector=Pe,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=(0,u.sg)(async()=>{if(this._messageBundleProps?.length){const e=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:e,propertyName:t})=>{if(this.destroyed)return;let s=await(0,ye.f)(e);this.destroyed||(this.uiStrings&&Object.keys(this.uiStrings)&&(s=Ce((0,c.o8)(s),this.uiStrings)),this[t]=s)}));if(this.destroyed)return;for(const t of e)"rejected"===t.status&&g.L.getLogger(this).error("widget-intl:locale-error",this.declaredClass,t.reason)}await this.loadLocale()}),this.addHandles((0,se.m)()),(0,te.I)();const s="esri-widget-uid-"+(0,w.g)(),r=this.render.bind(this);this._trackingTarget=new b.S(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const i=()=>({vnodeSelector:"div",properties:{key:`${s}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const e=r()??i(),t=e.properties??={};if(t.key??=s,ue(e.vnodeSelector)){if(!this.visible)return i()}else this.visible?t.styles||(t.styles={}):(t.class="",t.styles={display:"none"}),t.styles.display??="";let o=0;return e.children?.forEach(e=>{ue(e.vnodeSelector)||(e.properties??={},e.properties.key??=`${this.id}--${o++}`)}),le(this,e)};this.render=()=>{if(Te)return o();let e=function(e){return ge.get(e)}(this)??null;if(e)return e;this._trackingTarget.clear(),Te=!0;try{e=(0,S.r)(this._trackingTarget,o)}catch(e){throw g.L.getLogger(this).error(e),e}finally{Te=!1}return e&&function(e,t){ge.set(e,t)}(this,e),e};const n=this.beforeFirstRender();var a;n?this._resourcesFetch=n.then(()=>{this.destroyed||(this._readyForTrueRender=!0,this._postInitialize())}):(this._resourcesFetch=Promise.resolve().then(()=>{this.destroyed||this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),a=this._resourcesFetch,Ie.add(a),a.finally(()=>Ie.delete(a))}normalizeCtorArgs(e,t){const s={...e};return t&&(s.container=t),s}postInitialize(){}beforeFirstRender(){const e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(u.jH):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||((0,_.d)(this._trackingTarget),(0,_.d)(this.viewModel),this._detach(this.container),this._set("container",null),this.render=()=>null,this._projector=null,_e(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return"string"==typeof(t=e)?document.getElementById(t):t??null;var t}get destroyed(){return super.destroyed}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+$e++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(Ue=re,ie)](){return{projector:this._projector}}static{this.vnodeSelector="div"}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(_e(this),this._projector.scheduleRender())}classes(...e){return ve.apply(this,e)}renderNow(){_e(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles((0,y.wB)(()=>this.viewModel,(e,t)=>{t&&this.removeHandles("delegated-events"),e&&(0,h.i)(e)&&this.addHandles(this._delegatedEventNames.map(t=>(0,h.a)(e,t,e=>{this.emit(t,e)})),"delegated-events")},y.pc)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(u.jH),this.scheduleRender()};this.addHandles([(0,we.o)(e),(0,y.wB)(()=>this.uiStrings,e)]),this.addHandles((0,y.z7)(()=>this.container,e=>{this.destroyed||this._attach(e)},{initial:!0,once:!0}))}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}};(0,i._)([(0,f.MZ)()],xe.prototype,"_readyForTrueRender",void 0),(0,i._)([(0,f.MZ)({value:null})],xe.prototype,"container",null),(0,i._)([(0,A.w)("container")],xe.prototype,"castContainer",null),(0,i._)([(0,f.MZ)()],xe.prototype,"icon",null),(0,i._)([(0,f.MZ)()],xe.prototype,"id",null),(0,i._)([(0,f.MZ)()],xe.prototype,"label",null),(0,i._)([(0,f.MZ)()],xe.prototype,"renderable",null),(0,i._)([(0,f.MZ)()],xe.prototype,"uiStrings",void 0),(0,i._)([(0,f.MZ)()],xe.prototype,"viewModel",void 0),(0,i._)([(0,f.MZ)({value:!0})],xe.prototype,"visible",null),(0,i._)([(0,f.MZ)()],xe.prototype,"key",void 0),(0,i._)([(0,f.MZ)()],xe.prototype,"children",void 0),(0,i._)([(0,f.MZ)()],xe.prototype,"afterCreate",void 0),(0,i._)([(0,f.MZ)()],xe.prototype,"afterUpdate",void 0),(0,i._)([(0,f.MZ)()],xe.prototype,"afterRemoved",void 0),xe=(0,i._)([(0,m.$)("esri.widgets.Widget")],xe);const Ee=xe;function Re(e){return(t,s)=>{t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:s})}}var Oe=function(e){return{vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}},Me=function(e,t){for(var s=0,r=e.length;s<r;s++){var i=e[s];Array.isArray(i)?Me(i,t):null!=i&&!1!==i&&(i.hasOwnProperty("vnodeSelector")||(i=Oe(i)),t.push(i))}};function Ne(e,t,...s){return"function"!=typeof e||ue(e)?function(e,t){for(var s=[],r=2;r<arguments.length;r++)s[r-2]=arguments[r];if(1===s.length&&"string"==typeof s[0])return{vnodeSelector:e,properties:t||void 0,children:void 0,text:s[0],domNode:null};var i=[];return Me(s,i),{vnodeSelector:e,properties:t||void 0,children:i,text:void 0,domNode:null}}(e,t??null,...s):e(t,...s)}const Le=/\W/g;function De(){const e=getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(Le,"").toLowerCase();switch(e){case"dark":case"light":return`calcite-mode-${e}`;default:return null}}var je,qe=s(99924);let He=class extends qe.o{static{je=this}constructor(e){super(e),this._oAuthCred=null,this.appId=null,this.authNamespace="/",this.expiration=20160,this.flowType="auto",this.forceLogin=!1,this.forceUserId=!1,this.locale=null,this.minTimeUntilExpiration=30,this.popup=!1,this.popupCallbackUrl="oauth-callback.html",this.popupWindowFeatures="height=490,width=800,resizable,scrollbars,status",this.portalUrl="https://www.arcgis.com",this.preserveUrlHash=!1,this.userId=null}clone(){return je.fromJSON(this.toJSON())}};(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"appId",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"authNamespace",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"expiration",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"flowType",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"forceLogin",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"forceUserId",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"locale",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"minTimeUntilExpiration",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"popup",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"popupCallbackUrl",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"popupWindowFeatures",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"portalUrl",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"preserveUrlHash",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],He.prototype,"userId",void 0),He=je=(0,i._)([(0,m.$)("esri.identity.OAuthInfo")],He);const ze=He;let Be=class extends qe.o{constructor(e){super(e),this.adminTokenServiceUrl=null,this.currentVersion=null,this.hasPortal=null,this.hasServer=null,this.owningSystemUrl=null,this.owningTenant=null,this.server=null,this.shortLivedTokenValidity=null,this.tokenServiceUrl=null,this.webTierAuth=null}};(0,i._)([(0,f.MZ)({json:{write:!0}})],Be.prototype,"adminTokenServiceUrl",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],Be.prototype,"currentVersion",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],Be.prototype,"hasPortal",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],Be.prototype,"hasServer",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],Be.prototype,"owningSystemUrl",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],Be.prototype,"owningTenant",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],Be.prototype,"server",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],Be.prototype,"shortLivedTokenValidity",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],Be.prototype,"tokenServiceUrl",void 0),(0,i._)([(0,f.MZ)({json:{write:!0}})],Be.prototype,"webTierAuth",void 0),Be=(0,i._)([(0,m.$)("esri.identity.ServerInfo")],Be);const Ze=Be,Fe="esri-identity-modal",Ve={base:Fe,info:`${Fe}__info`,notice:`${Fe}__notice`};let We=class extends Ee{constructor(e,t){super(e,t),this.container=document.createElement("div"),this.error=null,this.oAuthPrompt=!1,this.open=!1,this.signingIn=!1,this.server=null,this.resource=null,this._usernameInputNode=null,this._passwordInputNode=null,document.body.appendChild(this.container)}loadDependencies(){return(0,te.l)({button:()=>Promise.all([s.e(3413),s.e(5464)]).then(s.bind(s,35464)),dialog:()=>Promise.all([s.e(3413),s.e(187)]).then(s.bind(s,10187)),input:()=>Promise.all([s.e(3413),s.e(7232)]).then(s.bind(s,37232)),label:()=>s.e(4260).then(s.bind(s,94260)),notice:()=>Promise.all([s.e(3413),s.e(3403)]).then(s.bind(s,83403))})}get title(){return this.commonMessages?.auth.signIn}render(){const{open:e,title:t,messages:s,signingIn:r,oAuthPrompt:i,server:o,resource:n,error:a}=this,{info:l,oAuthInfo:h,lblItem:c,invalidUser:d,noAuthService:u,lblUser:p,lblPwd:f,lblCancel:g,lblSigning:m,lblOk:_}=s;return Ne("div",{class:this.classes(Ve.base,De())},Ne("form",{bind:this,onsubmit:this._submit},Ne("calcite-dialog",{bind:this,heading:t,modal:!0,open:e,outsideCloseDisabled:!0,scale:"s",widthScale:"s",onCalciteDialogClose:this._cancel,onCalciteDialogOpen:this._focusUsernameInput},Ne("div",{class:Ve.info},(0,Ae.s)(i?h:l,{server:o&&/\.arcgis\.com/i.test(o)?"ArcGIS Online":o,resource:`(${n||c})`})),a?Ne("calcite-notice",{class:Ve.notice,icon:"exclamation-mark-triangle",kind:"danger",open:!0},Ne("div",{slot:"message"},a.details?.httpStatus?d:u)):null,i?null:[Ne("calcite-label",null,p,Ne("calcite-input",{afterCreate:e=>this._usernameInputNode=e,autocomplete:"off",bind:this,name:"username",required:!0,spellcheck:!1,type:"text",value:""})),Ne("calcite-label",null,f,Ne("calcite-input",{afterCreate:e=>this._passwordInputNode=e,bind:this,name:"password",required:!0,type:"password",value:""}))],Ne("calcite-button",{appearance:"outline",bind:this,onclick:this._cancel,slot:"footer-end",type:"button"},g),Ne("calcite-button",{loading:!!r,slot:"footer-end",type:"submit"},r?m:_))))}_focusUsernameInput(){return async function(e){await(0,fe.$m)((0,u.Mq)(void 0));const t=e();t&&("setFocus"in t&&"function"==typeof t.setFocus?await t.setFocus():t instanceof HTMLElement&&t.focus())}(()=>this._usernameInputNode)}_cancel(){this._set("signingIn",!1),this.open=!1,this._usernameInputNode&&(this._usernameInputNode.value=""),this._passwordInputNode&&(this._passwordInputNode.value=""),this.emit("cancel")}_submit(e){e.preventDefault(),this._set("signingIn",!0);const t=this.oAuthPrompt?{}:{username:this._usernameInputNode?.value,password:this._passwordInputNode?.value};this.emit("submit",t)}};(0,i._)([(0,f.MZ)({readOnly:!0})],We.prototype,"container",void 0),(0,i._)([(0,f.MZ)(),Re("esri/t9n/common")],We.prototype,"commonMessages",void 0),(0,i._)([(0,f.MZ)()],We.prototype,"error",void 0),(0,i._)([(0,f.MZ)(),Re("esri/identity/t9n/identity")],We.prototype,"messages",void 0),(0,i._)([(0,f.MZ)()],We.prototype,"oAuthPrompt",void 0),(0,i._)([(0,f.MZ)()],We.prototype,"open",void 0),(0,i._)([(0,f.MZ)()],We.prototype,"signingIn",void 0),(0,i._)([(0,f.MZ)()],We.prototype,"server",void 0),(0,i._)([(0,f.MZ)({readOnly:!0})],We.prototype,"title",null),(0,i._)([(0,f.MZ)()],We.prototype,"resource",void 0),We=(0,i._)([(0,m.$)("esri.identity.IdentityModal")],We);const Je=We,Ge="esriJSAPIOAuth";class Ke{constructor(e,t){this.oAuthInfo=null,this.storage=null,this.appId=null,this.codeVerifier=null,this.expires=null,this.refreshToken=null,this.ssl=null,this.stateUID=null,this.token=null,this.userId=null,this.oAuthInfo=e,this.storage=t,this._init()}isValid(){let e=!1;if(this.oAuthInfo&&this.userId&&(this.refreshToken||this.token))if(null==this.expires&&this.refreshToken)e=!0;else if(this.expires){const t=Date.now();this.expires>t&&(this.expires-t)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(e=!0)}return e}save(){if(!this.storage)return!1;const e=this._load(),t=this.oAuthInfo;if(t?.authNamespace&&t.portalUrl){let s=e[t.authNamespace];s||(s=e[t.authNamespace]={}),this.appId||(this.appId=t.appId),s[t.portalUrl]={appId:this.appId,codeVerifier:this.codeVerifier,expires:this.expires,refreshToken:this.refreshToken,ssl:this.ssl,stateUID:this.stateUID,token:this.token,userId:this.userId};try{this.storage.setItem(Ge,JSON.stringify(e))}catch(e){return console.warn(e),!1}return!0}return!1}destroy(){const e=this._load(),t=this.oAuthInfo;if(t?.appId&&t?.portalUrl&&(null==this.expires||this.expires>Date.now())&&(this.refreshToken||this.token)){const e=t.portalUrl.replace(/^http:/i,"https:")+"/sharing/rest/oauth2/revokeToken",s=new FormData;if(s.append("f","json"),s.append("auth_token",this.refreshToken||this.token),s.append("client_id",t.appId),s.append("token_type_hint",this.refreshToken?"refresh_token":"access_token"),"function"==typeof navigator.sendBeacon)navigator.sendBeacon(e,s);else{const t=new XMLHttpRequest;t.open("POST",e),t.send(s)}}if(t?.authNamespace&&t.portalUrl&&this.storage){const s=e[t.authNamespace];if(s){delete s[t.portalUrl];try{this.storage.setItem(Ge,JSON.stringify(e))}catch(e){console.log(e)}}}t&&(t._oAuthCred=null,this.oAuthInfo=null)}_init(){const e=this._load(),t=this.oAuthInfo;if(t?.authNamespace&&t.portalUrl){let s=e[t.authNamespace];s&&(s=s[t.portalUrl],s&&(this.appId=s.appId,this.codeVerifier=s.codeVerifier,this.expires=s.expires,this.refreshToken=s.refreshToken,this.ssl=s.ssl,this.stateUID=s.stateUID,this.token=s.token,this.userId=s.userId))}}_load(){let e={};if(this.storage){const t=this.storage.getItem(Ge);if(t)try{e=JSON.parse(t)}catch(e){console.warn(e)}}return e}}Ke.prototype.declaredClass="esri.identity.OAuthCredential";const Xe={},Qe=e=>{const t=new p.s0(e.owningSystemUrl).host,s=new p.s0(e.server).host,r=/.+\.arcgis\.com$/i;return r.test(t)&&r.test(s)},Ye=(e,t)=>!!(Qe(e)&&t&&t.some(t=>t.test(e.server)));let et=null,tt=null;try{et=window.localStorage,tt=window.sessionStorage}catch{}class st extends l.a${constructor(){super(),this._portalConfig=globalThis.esriGeowConfig,this.serverInfos=[],this.oAuthInfos=[],this.credentials=[],this._soReqs=[],this._xoReqs=[],this._portals=[],this._defaultOAuthInfo=null,this._defaultTokenValidity=60,this.dialog=null,this.tokenValidity=null,this.normalizeWebTierAuth=!1,this._appOrigin="null"!==window.origin?window.origin:window.location.origin,this._appUrlObj=(0,p.An)(window.location.href),this._busy=null,this._rejectOnPersistedPageShow=!1,this._oAuthLocationParams=null,this._gwTokenUrl="/sharing/rest/generateToken",this._agsRest="/rest/services",this._agsPortal=/\/sharing(\/|$)/i,this._agsAdmin=/(https?:\/\/[^/]+\/[^/]+)\/admin\/?(\/.*)?$/i,this._adminSvcs=/\/rest\/admin\/services(\/|$)/i,this._gwDomains=[{regex:/^https?:\/\/www\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:dev|[a-z\d-]+\.mapsdev)\.arcgis\.com/i,customBaseUrl:"mapsdev.arcgis.com",tokenServiceUrl:"https://dev.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:devext|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,customBaseUrl:"mapsdevext.arcgis.com",tokenServiceUrl:"https://devext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/(?:qaext|[a-z\d-]+\.mapsqa)\.arcgis\.com/i,customBaseUrl:"mapsqa.arcgis.com",tokenServiceUrl:"https://qaext.arcgis.com/sharing/rest/generateToken"},{regex:/^https?:\/\/[a-z\d-]+\.maps\.arcgis\.com/i,customBaseUrl:"maps.arcgis.com",tokenServiceUrl:"https://www.arcgis.com/sharing/rest/generateToken"}],this._legacyFed=[],this._regexSDirUrl=/http.+\/rest\/services\/?/gi,this._regexServerType=/(\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|KnowledgeGraphServer|MapServer|MissionServer|MobileServer|NAServer|NetworkDiagramServer|OGCFeatureServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer|VideoServer)).*/gi,this._gwUser=/http.+\/users\/([^/]+).*/i,this._gwItem=/http.+\/items\/([^/]+).*/i,this._gwGroup=/http.+\/groups\/([^/]+).*/i,this._rePortalTokenSvc=/\/sharing(\/rest)?\/generatetoken/i,this._createDefaultOAuthInfo=!0,this._hasTestedIfAppIsOnPortal=!1,this._getPlatformSelfError=null,this._getOAuthLocationParams(),window.addEventListener("pageshow",e=>{this._pageShowHandler(e)})}registerServers(e){const t=this.serverInfos;t?(e=e.filter(e=>!this.findServerInfo(e.server)),this.serverInfos=t.concat(e)):this.serverInfos=e,e.forEach(e=>{e.owningSystemUrl&&this._portals.push(e.owningSystemUrl),e.hasPortal&&this._portals.push(e.server)})}registerOAuthInfos(e){const t=this.oAuthInfos;if(t){for(const s of e){const e=this.findOAuthInfo(s.portalUrl);e&&t.splice(t.indexOf(e),1)}this.oAuthInfos=t.concat(e)}else this.oAuthInfos=e}registerToken(e){e={...e};const t=this._sanitizeUrl(e.server),s=this._isServerRsrc(t);let r,i=this.findServerInfo(t),o=!0;i||(i=new Ze,i.server=this._getServerInstanceRoot(t),s?i.hasServer=!0:(i.tokenServiceUrl=this._getTokenSvcUrl(t),i.hasPortal=!0),this.registerServers([i])),r=this._findCredential(t),r?(delete e.server,Object.assign(r,e),o=!1):(r=new rt({userId:e.userId,server:i.server??void 0,token:e.token,expires:e.expires,ssl:e.ssl,scope:s?"server":"portal"}),r.resources=[t],this.credentials.push(r)),r.emitTokenChange(!1),o||r.refreshServerTokens()}toJSON(){return(0,c.oy)({serverInfos:this.serverInfos.map(e=>e.toJSON()),oAuthInfos:this.oAuthInfos.map(e=>e.toJSON()),credentials:this.credentials.map(e=>e.toJSON())})}initialize(e){if(!e)return;"string"==typeof e&&(e=JSON.parse(e));const t=e.serverInfos,s=e.oAuthInfos,r=e.credentials;if(t){const e=[];t.forEach(t=>{t.server&&t.tokenServiceUrl&&e.push(t.declaredClass?t:new Ze(t))}),e.length&&this.registerServers(e)}if(s){const e=[];s.forEach(t=>{t.appId&&e.push(t.declaredClass?t:new ze(t))}),e.length&&this.registerOAuthInfos(e)}r&&r.forEach(e=>{e.server&&e.token&&e.expires&&e.expires>Date.now()&&((e=e.declaredClass?e:new rt(e)).emitTokenChange(),this.credentials.push(e))})}findServerInfo(e){let t;e=this._sanitizeUrl(e);for(const s of this.serverInfos)if(this._hasSameServerInstance(s.server,e)){t=s;break}return t}findOAuthInfo(e){let t;e=this._sanitizeUrl(e);for(const s of this.oAuthInfos)if(this._hasSameServerInstance(s.portalUrl,e)){t=s;break}return t}findCredential(e,t){if(!e)return;let s;e=this._sanitizeUrl(e);const r=this._isServerRsrc(e)?"server":"portal";if(t){for(const i of this.credentials)if(this._hasSameServerInstance(i.server,e)&&t===i.userId&&i.scope===r){s=i;break}}else for(const t of this.credentials)if(this._hasSameServerInstance(t.server,e)&&-1!==this._getIdenticalSvcIdx(e,t)&&t.scope===r){s=t;break}return s}getCredential(e,t){let s,r=!1,i=!0;t&&(r=!(!t.token&&!t.credential),s=t.error,i=!1!==t.prompt),t={...t},e=this._sanitizeUrl(e);const o=new AbortController,n=(0,u.Tw)();if(t.signal&&(0,u.u7)(t.signal,()=>{o.abort()}),(0,u.u7)(o,()=>{n.reject(new a.A("identity-manager:user-aborted","ABORTED"))}),(0,u.G4)(o))return n.promise;t.signal=o.signal;const l=this._isAdminResource(e),h=r?this.findCredential(e):null;let c;if(h&&498===s?.details?.httpStatus)h.destroy();else if(h)return c=new a.A("identity-manager:not-authorized","You are currently signed in as: '"+h.userId+"'. You do not have access to this resource: "+e,{error:s}),n.reject(c),n.promise;const d=this._findCredential(e,t);if(d)return n.resolve(d),n.promise;let f=this.findServerInfo(e);if(f)!f.hasPortal&&f.server&&f.owningSystemUrl&&this._hasSameServerInstance(f.server,f.owningSystemUrl)&&(f.hasPortal=!0),!f.hasServer&&this._isServerRsrc(e)&&(f._restInfoPms=this._getTokenSvcUrl(e),f.hasServer=!0);else{const t=this._getTokenSvcUrl(e);if(!t)return c=new a.A("identity-manager:unknown-resource","Unknown resource - could not find token service endpoint."),n.reject(c),n.promise;f=new Ze,f.server=this._getServerInstanceRoot(e),"string"==typeof t?(f.tokenServiceUrl=t,f.hasPortal=!0):(f._restInfoPms=t,f.hasServer=!0),this.registerServers([f])}return f.hasPortal&&void 0===f._selfReq&&(i||(0,p.FX)(f.tokenServiceUrl,this._appOrigin)||this._gwDomains.some(e=>e.tokenServiceUrl===f.tokenServiceUrl))&&(f._selfReq={owningTenant:t?.owningTenant,selfDfd:this._getPortalSelf(f.tokenServiceUrl.replace(this._rePortalTokenSvc,"/sharing/rest/portals/self"),e)}),this._enqueue(e,f,t,n,l)}getResourceName(e){return this._isRESTService(e)?e.replace(this._regexSDirUrl,"").replace(this._regexServerType,"")||"":this._gwUser.test(e)&&e.replace(this._gwUser,"$1")||this._gwItem.test(e)&&e.replace(this._gwItem,"$1")||this._gwGroup.test(e)&&e.replace(this._gwGroup,"$1")||""}generateToken(e,t,s){const r=this._rePortalTokenSvc.test(e.tokenServiceUrl),i=new p.s0(this._appOrigin),o=e.shortLivedTokenValidity;let l,h,c,d,u,f,g,m;t&&(m=this.tokenValidity||o||this._defaultTokenValidity,m>o&&o>0&&(m=o)),s&&(l=s.isAdmin,h=s.serverUrl,c=s.token,f=s.signal,g=s.ssl,e.customParameters=s.customParameters),l?d=e.adminTokenServiceUrl:(d=e.tokenServiceUrl,u=new p.s0(d.toLowerCase()),e.webTierAuth&&s?.serverUrl&&!g&&"http"===i.scheme&&((0,p.FX)(i.uri,d,!0)||"https"===u.scheme&&i.host===u.host&&"7080"===i.port&&"7443"===u.port)&&(d=d.replace(/^https:/i,"http:").replace(/:7443/i,":7080")));const _={query:{request:"getToken",username:t?.username,password:t?.password,serverUrl:h,token:c,expiration:m,referer:l||r?this._appOrigin:null,client:l?"referer":null,f:"json",...e.customParameters},method:"post",authMode:"anonymous",useProxy:this._useProxy(e,s),signal:f,...s?.ioArgs};return r||(_.withCredentials=!1),(0,n.A)(d,_).then(s=>{const r=s.data;if(!r?.token)return new a.A("identity-manager:authentication-failed","Unable to generate token");const i=e.server;return Xe[i]||(Xe[i]={}),t&&(Xe[i][t.username]=t.password),r.validity=m,r})}isBusy(){return!!this._busy}async checkSignInStatus(e){return(await this.checkAppAccess(e,"")).credential}checkAppAccess(e,t,s){let r=!1;return this.getCredential(e,{prompt:!1}).then(i=>{let o;const l={f:"json"};if("portal"===i.scope)if(t&&(this._doPortalSignIn(e)||s?.force))o=i.server+"/sharing/rest/oauth2/validateAppAccess",l.client_id=t;else{if(!i.token)return{credential:i};o=i.server+"/sharing/rest"}else{if(!i.token)return{credential:i};o=i.server+"/rest/services"}return i.token&&(l.token=i.token),(0,n.A)(o,{query:l,authMode:"anonymous"}).then(e=>{if(!1===e.data.valid)throw new a.A("identity-manager:not-authorized",`You are currently signed in as: '${i.userId}'.`,e.data);return r=!!e.data.viewOnlyUserTypeApp,{credential:i}}).catch(e=>{if("identity-manager:not-authorized"===e.name)throw e;const t=e.details?.httpStatus;if(498===t)throw i.destroy(),new a.A("identity-manager:not-authenticated","User is not signed in.");if(400===t)throw new a.A("identity-manager:invalid-request","Bad request");return{credential:i}})}).then(e=>({credential:e.credential,viewOnly:r}))}setOAuthResponseHash(e){e&&(e.startsWith("#")&&(e=e.slice(1)),this._processOAuthPopupParams((0,p.zf)(e)))}setOAuthRedirectionHandler(e){this._oAuthRedirectFunc=e}setProtocolErrorHandler(e){this._protocolFunc=e}signIn(e,t,s={}){const r=(0,u.Tw)(),i=()=>{l?.remove(),h?.remove(),this.dialog?.destroy(),this.dialog=l=h=null},o=()=>{i(),this._oAuthDfd=null,r.reject(new a.A("identity-manager:user-aborted","ABORTED"))};s.signal&&(0,u.u7)(s.signal,()=>{o()});const n=new Je({open:!0,resource:this.getResourceName(e),server:t.server});this.dialog=n,this.emit("dialog-create");let l=n.on("cancel",o),h=n.on("submit",e=>{this.generateToken(t,e,{isAdmin:s.isAdmin,signal:s.signal}).then(o=>{i();const n=new rt({userId:e.username,server:t.server??void 0,token:o.token,expires:null!=o.expires?Number(o.expires):null,ssl:!!o.ssl,isAdmin:s.isAdmin,validity:o.validity});r.resolve(n)}).catch(e=>{n.error=e,n.signingIn=!1})});return r.promise}oAuthSignIn(e,t,s,r){this._oAuthDfd=(0,u.Tw)();const i=this._oAuthDfd;let o;r?.signal&&(0,u.u7)(r.signal,()=>{const e=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;e&&!e.closed?e.close():this.dialog&&c()}),i.resUrl_=e,i.sinfo_=t,i.oinfo_=s;const n=s._oAuthCred;if(n.storage&&("authorization-code"===s.flowType||"auto"===s.flowType&&t.currentVersion>=8.4)){let e=crypto.getRandomValues(new Uint8Array(32));o=(0,p.$1)(e),n.codeVerifier=o,e=crypto.getRandomValues(new Uint8Array(32)),n.stateUID=(0,p.$1)(e),n.save()||(n.codeVerifier=o=null)}else n.codeVerifier=null;let l,h;this._getCodeChallenge(o).then(i=>{const o=!r||!1!==r.oAuthPopupConfirmation;if(!s.popup||!o)return void this._doOAuthSignIn(e,t,s,i);const n=new Je({oAuthPrompt:!0,server:t.server,open:!0});this.dialog=n,this.emit("dialog-create"),l=n.on("cancel",c),h=n.on("submit",()=>{d(),this._doOAuthSignIn(e,t,s,i)})});const c=()=>{d(),this._oAuthDfd=null,i.reject(new a.A("identity-manager:user-aborted","ABORTED"))},d=()=>{l?.remove(),h?.remove(),this.dialog?.destroy(),this.dialog=null};return i.promise}destroyCredentials(){this.credentials&&this.credentials.slice().forEach(e=>{e.destroy()}),this.emit("credentials-destroy")}enablePostMessageAuth(e="https://www.arcgis.com/sharing/rest"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=(0,h.a)(window,"message",t=>{if((t.origin===this._appOrigin||t.origin.endsWith(".arcgis.com"))&&"arcgis:auth:requestCredential"===t.data?.type){const s=t.source;this.getCredential(e).then(e=>{s.postMessage({type:"arcgis:auth:credential",credential:{expires:e.expires,server:e.server,ssl:e.ssl,token:e.token,userId:e.userId}},t.origin)}).catch(e=>{s.postMessage({type:"arcgis:auth:error",error:{name:e.name,message:e.message}},t.origin)})}})}disablePostMessageAuth(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)}_getOAuthLocationParams(){let e=window.location.hash;if(e){e.startsWith("#")&&(e=e.slice(1));const t=(0,p.zf)(e);let s=!1;if(t.access_token&&t.expires_in&&t.state&&t.hasOwnProperty("username"))try{t.state=JSON.parse(t.state),t.state.portalUrl&&(this._oAuthLocationParams=t,s=!0)}catch{}else if(t.error&&t.error_description&&(console.log("IdentityManager OAuth Error: ",t.error," - ",t.error_description),"access_denied"===t.error&&(s=!0,t.state)))try{t.state=JSON.parse(t.state)}catch{}s&&(window.location.hash=t.state?.hash||"")}let t=window.location.search;if(t){t.startsWith("?")&&(t=t.slice(1));const e=(0,p.zf)(t);let s=!1;if(e.code&&e.state)try{e.state=JSON.parse(e.state),e.state.portalUrl&&e.state.uid&&(this._oAuthLocationParams=e,s=!0)}catch{}else if(e.error&&e.error_description&&(console.log("IdentityManager OAuth Error: ",e.error," - ",e.error_description),"access_denied"===e.error&&(s=!0,e.state)))try{e.state=JSON.parse(e.state)}catch{}if(s){const t={...e};["code","error","error_description","message_code","persist","state"].forEach(e=>{delete t[e]});const s=(0,p.x0)(t),r=window.location.pathname+(s?`?${s}`:"")+(e.state?.hash||"");window.history.replaceState(window.history.state,"",r)}}}_getOAuthToken(e,t,s,r,i){return e=e.replace(/^http:/i,"https:"),(0,n.A)(`${e}/sharing/rest/oauth2/token`,{authMode:"anonymous",method:"post",query:r&&i?{grant_type:"authorization_code",code:t,redirect_uri:r,client_id:s,code_verifier:i}:{grant_type:"refresh_token",refresh_token:t,client_id:s}}).then(e=>e.data)}async _getCodeChallenge(e){if(e&&globalThis.isSecureContext){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t);return(0,p.$1)(new Uint8Array(s))}return null}_pageShowHandler(e){if(e.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow){const e=new a.A("identity-manager:user-aborted","ABORTED");this._errbackFunc(e)}}_findCredential(e,t){let s,r,i,o,n=-1;const a=t?.token,l=t?.resource,h=this._isServerRsrc(e)?"server":"portal",c=this.credentials.filter(t=>this._hasSameServerInstance(t.server,e)&&t.scope===h);if(e=l||e,c.length)if(1===c.length){if(s=c[0],i=this.findServerInfo(s.server),r=i?.owningSystemUrl,o=r?this.findCredential(r,s.userId):void 0,n=this._getIdenticalSvcIdx(e,s),!a)return-1===n&&s.resources.push(e),this._addResource(e,o),s;-1!==n&&(s.resources.splice(n,1),this._removeResource(e,o))}else{let t,s;if(c.some(a=>(s=this._getIdenticalSvcIdx(e,a),-1!==s&&(t=a,i=this.findServerInfo(t.server),r=i?.owningSystemUrl,o=r?this.findCredential(r,t.userId):void 0,n=s,!0))),a)t&&(t.resources.splice(n,1),this._removeResource(e,o));else if(t)return this._addResource(e,o),t}}_findOAuthInfo(e){let t=this.findOAuthInfo(e);if(!t)for(const s of this.oAuthInfos)if(this._isIdProvider(s.portalUrl,e)){t=s;break}return t}_addResource(e,t){t&&-1===this._getIdenticalSvcIdx(e,t)&&t.resources.push(e)}_removeResource(e,t){let s=-1;t&&(s=this._getIdenticalSvcIdx(e,t),s>-1&&t.resources.splice(s,1))}_useProxy(e,t){return t?.isAdmin&&!(0,p.FX)(e.adminTokenServiceUrl,this._appOrigin)||!this._isPortalDomain(e.tokenServiceUrl)&&"10.1"===String(e.currentVersion)&&!(0,p.FX)(e.tokenServiceUrl,this._appOrigin)}_getOrigin(e){const t=new p.s0(e);return t.scheme+"://"+t.host+(null!=t.port?":"+t.port:"")}_getServerInstanceRoot(e){const t=e.toLowerCase();let s=t.indexOf(this._agsRest);return-1===s&&this._isAdminResource(e)&&(s=this._agsAdmin.test(e)?e.replace(this._agsAdmin,"$1").length:e.search(this._adminSvcs)),-1!==s||(0,p.i)(t)||(s=t.indexOf("/sharing")),-1===s&&t.endsWith("/")&&(s=t.length-1),s>-1?e.slice(0,s):e}_hasSameServerInstance(e,t){return e.endsWith("/")&&(e=e.slice(0,-1)),e=e.toLowerCase(),t=this._getServerInstanceRoot(t).toLowerCase(),e=(0,p.n)(e),t=(0,p.n)(t),(e=e.slice(Math.max(0,e.indexOf(":"))))===t.slice(Math.max(0,t.indexOf(":")))}_sanitizeUrl(e){const t=(o.A.request.proxyUrl||"").toLowerCase(),s=t?e.toLowerCase().indexOf(t+"?"):-1;return-1!==s&&(e=e.slice(s+t.length+1)),e=(0,p.S8)(e),(0,p.An)(e).path}_isRESTService(e){return e.includes(this._agsRest)}_isAdminResource(e){return this._agsAdmin.test(e)||this._adminSvcs.test(e)}_isServerRsrc(e){return this._isRESTService(e)||this._isAdminResource(e)}_isIdenticalService(e,t){let s=!1;if(this._isRESTService(e)&&this._isRESTService(t)){const r=this._getSuffix(e).toLowerCase(),i=this._getSuffix(t).toLowerCase();if(s=r===i,!s){const e=/(.*)\/(MapServer|FeatureServer|UtilityNetworkServer).*/gi;s=r.replaceAll(e,"$1")===i.replaceAll(e,"$1")}}else this._isAdminResource(e)&&this._isAdminResource(t)?s=!0:this._isServerRsrc(e)||this._isServerRsrc(t)||!this._isPortalDomain(e)||(s=!0);return s}_isPortalDomain(e){const t=new p.s0(e.toLowerCase()),s=this._portalConfig;let r=this._gwDomains.some(e=>e.regex.test(t.uri));return!r&&s&&(r=this._hasSameServerInstance(this._getServerInstanceRoot(s.restBaseUrl),t.uri)),r||o.A.portalUrl&&(r=(0,p.FX)(t,o.A.portalUrl,!0)),r||(r=this._portals.some(e=>this._hasSameServerInstance(e,t.uri))),r=r||this._agsPortal.test(t.path),r}_isIdProvider(e,t){let s=-1,r=-1;this._gwDomains.forEach((i,o)=>{-1===s&&i.regex.test(e)&&(s=o),-1===r&&i.regex.test(t)&&(r=o)});let i=!1;if(s>-1&&r>-1&&(0===s||4===s?0!==r&&4!==r||(i=!0):1===s?1!==r&&2!==r||(i=!0):2===s?2===r&&(i=!0):3===s&&3===r&&(i=!0)),!i){const s=this.findServerInfo(t),r=s?.owningSystemUrl;r&&Qe(s)&&this._isPortalDomain(r)&&this._isIdProvider(e,r)&&(i=!0)}return i}_getIdenticalSvcIdx(e,t){let s=-1;for(let r=0;r<t.resources.length;r++){const i=t.resources[r];if(this._isIdenticalService(e,i)){s=r;break}}return s}_getSuffix(e){return e.replace(this._regexSDirUrl,"").replace(this._regexServerType,"$1")}_getTokenSvcUrl(e){let t,s,r;if(this._isRESTService(e)||this._isAdminResource(e)){const r=this._getServerInstanceRoot(e);return t=r+"/admin/generateToken",s=(0,n.A)(e=r+"/rest/info",{query:{f:"json"}}).then(e=>e.data),{adminUrl:t,promise:s}}if(this._isPortalDomain(e)){let t="";if(this._gwDomains.some(s=>(s.regex.test(e)&&(t=s.tokenServiceUrl),!!t)),t||this._portals.some(s=>(this._hasSameServerInstance(s,e)&&(t=s+this._gwTokenUrl),!!t)),t||(r=e.toLowerCase().indexOf("/sharing"),-1!==r&&(t=e.slice(0,r)+this._gwTokenUrl)),t||(t=this._getOrigin(e)+this._gwTokenUrl),t){const s=new p.s0(e).port;/^http:\/\//i.test(e)&&"7080"===s&&(t=t.replace(/:7080/i,":7443")),t=t.replace(/http:/i,"https:")}return t}}_processOAuthResponseParams(e,t,s){const r=t._oAuthCred;if(e.code){const i=r.codeVerifier;return r.codeVerifier=null,r.stateUID=null,r.save(),this._getOAuthToken(s.server,e.code,t.appId,this._getRedirectURI(t,!0),i).then(i=>{const o=new rt({userId:i.username,server:s.server??void 0,token:i.access_token,expires:Date.now()+1e3*i.expires_in,ssl:i.ssl,oAuthState:e.state,_oAuthCred:r});return t.userId=o.userId,r.storage=i.persist?et:tt,r.refreshToken=i.refresh_token,r.token=null,r.expires=i.refresh_token_expires_in?Date.now()+1e3*i.refresh_token_expires_in:null,r.userId=o.userId,r.ssl=o.ssl,r.save(),o})}const i=new rt({userId:e.username,server:s.server??void 0,token:e.access_token,expires:Date.now()+1e3*Number(e.expires_in),ssl:"true"===e.ssl,oAuthState:e.state,_oAuthCred:r});return t.userId=i.userId,r.storage=e.persist?et:tt,r.refreshToken=null,r.token=i.token,r.expires=i.expires,r.userId=i.userId,r.ssl=i.ssl,r.save(),Promise.resolve(i)}_processOAuthPopupParams(e){const t=this._oAuthDfd;if(this._oAuthDfd=null,t)if(clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle?.remove(),e.error){const s="access_denied"===e.error,r=new a.A(s?"identity-manager:user-aborted":"identity-manager:authentication-failed",s?"ABORTED":"OAuth: "+e.error+" - "+e.error_description);t.reject(r)}else this._processOAuthResponseParams(e,t.oinfo_,t.sinfo_).then(e=>{t.resolve(e)}).catch(e=>{t.reject(e)})}_setOAuthResponseQueryString(e){e&&(e.startsWith("?")&&(e=e.slice(1)),this._processOAuthPopupParams((0,p.zf)(e)))}async _exchangeToken(e,t,s){return(await(0,n.A)(`${e}/sharing/rest/oauth2/exchangeToken`,{authMode:"anonymous",method:"post",query:{f:"json",client_id:t,token:s}})).data.token}async _getPlatformSelf(e,t){if(this._getPlatformSelfError&&Date.now()-this._getPlatformSelfError[1]<1e3)throw this._getPlatformSelfError[0];e=e.replace(/^http:/i,"https:");try{const s=await(0,n.A)(`${e}/sharing/rest/oauth2/platformSelf`,{authMode:"anonymous",headers:{"X-Esri-Auth-Client-Id":t,"X-Esri-Auth-Redirect-Uri":window.location.href.replace(/#.*$/,"")},method:"post",query:{f:"json",expiration:30},withCredentials:!0});return this._getPlatformSelfError=null,s.data}catch(e){throw"OAUTH_0066"===e.details?.messageCode&&(this._getPlatformSelfError=[e,Date.now()]),e}}_getPortalSelf(e,t){let s;return this._gwDomains.some(t=>(t.regex.test(e)&&(s=t.customBaseUrl),!!s)),s?Promise.resolve({allSSL:!0,currentVersion:"8.4",customBaseUrl:s,portalMode:"multitenant",supportsOAuth:!0}):(this._appOrigin.startsWith("https:")?e=e.replace(/^http:/i,"https:").replace(/:7080/i,":7443"):/^http:/i.test(t)&&(e=e.replace(/^https:/i,"http:").replace(/:7443/i,":7080")),(0,n.A)(e,{query:{f:"json"},authMode:"anonymous",withCredentials:!0}).then(e=>e.data))}_doPortalSignIn(e){const t=this._portalConfig,s=window.location.href,r=this.findServerInfo(e);return!(!t&&!this._isPortalDomain(s)||!(r?r.hasPortal||r.owningSystemUrl&&this._isPortalDomain(r.owningSystemUrl):this._isPortalDomain(e))||!(this._isIdProvider(s,e)||t&&(this._hasSameServerInstance(this._getServerInstanceRoot(t.restBaseUrl),e)||this._isIdProvider(t.restBaseUrl,e))||(0,p.FX)(s,e,!0)))}_checkProtocol(e,t,s,r){let i=!0;const o=r?t.adminTokenServiceUrl:t.tokenServiceUrl;return o.trim().toLowerCase().startsWith("https:")&&!this._appOrigin.startsWith("https:")&&(0,p.zs)(o)&&(i=!!this._protocolFunc&&!!this._protocolFunc({resourceUrl:e,serverInfo:t}),!i)&&s(new a.A("identity-manager:aborted","Aborted the Sign-In process to avoid sending password over insecure connection.")),i}_enqueue(e,t,s,r,i,o){return r||(r=(0,u.Tw)()),r.resUrl_=e,r.sinfo_=t,r.options_=s,r.admin_=i,r.refresh_=o,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(e),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(r)):this._xoReqs.push(r):this._doSignIn(r),r.promise}_doSignIn(e){this._busy=e,this._rejectOnPersistedPageShow=!1;const t=t=>{const s=e.options_?.resource,r=e.resUrl_,i=e.refresh_;let o=!1;this.credentials.includes(t)||(i&&this.credentials.includes(i)?(i.userId=t.userId,i.token=t.token,i.expires=t.expires,i.validity=t.validity,i.ssl=t.ssl,i.creationTime=t.creationTime,o=!0,t=i):this.credentials.push(t)),t.resources||(t.resources=[]),t.resources.includes(s||r)||t.resources.push(s||r),t.scope=this._isServerRsrc(r)?"server":"portal",t.emitTokenChange();const n=this._soReqs,a={};this._soReqs=[],n.forEach(e=>{if(!this._isIdenticalService(r,e.resUrl_)){const s=this._getSuffix(e.resUrl_);a[s]||(a[s]=!0,t.resources.push(e.resUrl_))}}),e.resolve(t),n.forEach(e=>{this._hasSameServerInstance(this._getServerInstanceRoot(r),e.resUrl_)?e.resolve(t):this._soReqs.push(e)}),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,o||this.emit("credential-create",{credential:t}),this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},s=t=>{e.reject(t),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},r=(i,o,n,l)=>{const c=e.sinfo_,d=!e.options_||!1!==e.options_.prompt,f=c.hasPortal&&this._findOAuthInfo(e.resUrl_);let g,m;if(i)t(new rt({userId:i,server:c.server??void 0,token:n??void 0,expires:null!=l?Number(l):null,ssl:!!o}));else if(window!==window.parent&&this._appUrlObj.query?.["arcgis-auth-origin"]&&this._appUrlObj.query?.["arcgis-auth-portal"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query["arcgis-auth-portal"]),e.resUrl_)){window.parent.postMessage({type:"arcgis:auth:requestCredential"},this._appUrlObj.query["arcgis-auth-origin"]);const r=(0,h.a)(window,"message",e=>{e.source===window.parent&&e.data&&("arcgis:auth:credential"===e.data.type?(r.remove(),e.data.credential.expires<Date.now()?s(new a.A("identity-manager:credential-request-failed","Parent application's token has expired.")):t(new rt(e.data.credential))):"arcgis:auth:error"===e.data.type&&(r.remove(),"tokenExpiredError"===e.data.error.name?s(new a.A("identity-manager:credential-request-failed","Parent application's token has expired.")):s(a.A.fromJSON(e.data.error))))});(0,u.u7)(e.options_?.signal,()=>{r.remove()})}else if(f){let i=f._oAuthCred;if(!i){const e=new Ke(f,et),t=new Ke(f,tt);e.isValid()&&t.isValid()?e.expires>t.expires?(i=e,t.destroy()):(i=t,e.destroy()):i=e.isValid()?e:t,f._oAuthCred=i}if(i.isValid()){g=new rt({userId:i.userId??void 0,server:c.server??void 0,token:i.token??void 0,expires:i.expires,ssl:i.ssl??void 0,_oAuthCred:i});const o=f.appId!==i.appId&&this._doPortalSignIn(e.resUrl_);o||i.refreshToken?(e._pendingDfd=i.refreshToken?this._getOAuthToken(c.server,i.refreshToken,i.appId).then(e=>(g.expires=Date.now()+1e3*e.expires_in,g.token=e.access_token,g)):Promise.resolve(g),e._pendingDfd.then(e=>o?this._exchangeToken(e.server,f.appId,e.token).then(t=>(e.token=t,e)).catch(()=>e):e).then(e=>{t(e)}).catch(e=>{const t=e.details?.httpStatus;t>0&&404!==t?(i.destroy(),r()):s(e)})):t(g)}else if(this._oAuthLocationParams&&this._hasSameServerInstance(f.portalUrl,this._oAuthLocationParams.state.portalUrl)&&(this._oAuthLocationParams.access_token||this._oAuthLocationParams.code&&this._oAuthLocationParams.state.uid===i.stateUID&&i.codeVerifier)){const r=this._oAuthLocationParams;this._oAuthLocationParams=null,e._pendingDfd=this._processOAuthResponseParams(r,f,c).then(e=>{t(e)}).catch(s)}else{const r=()=>{d?e._pendingDfd=this.oAuthSignIn(e.resUrl_,c,f,e.options_).then(t,s):(m=new a.A("identity-manager:not-authenticated","User is not signed in."),s(m))};this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._getPlatformSelf(c.server,f.appId).then(e=>{(0,p.FX)(e.portalUrl,this._appOrigin,!0)?(g=new rt({userId:e.username,server:c.server??void 0,expires:Date.now()+1e3*e.expires_in,token:e.token}),t(g)):r()}).catch(r):r()}}else if(d){if(this._checkProtocol(e.resUrl_,c,s,e.admin_)){let r=e.options_;e.admin_&&(r=r||{},r.isAdmin=!0),e._pendingDfd=this.signIn(e.resUrl_,c,r).then(t,s)}}else m=new a.A("identity-manager:not-authenticated","User is not signed in."),s(m)},i=()=>{const r=e.sinfo_,i=r.owningSystemUrl,o=e.options_;let n,a,l,h;if(o&&(n=o.token,a=o.error,l=o.prompt),h=this._findCredential(i,{token:n,resource:e.resUrl_}),!h)for(const e of this.credentials)if(this._isIdProvider(i,e.server)){h=e;break}if(h){const i=this.findCredential(e.resUrl_,h.userId);if(i)t(i);else if(Ye(r,this._legacyFed)){const e=h.toJSON();e.server=r.server,e.resources=null,t(new rt(e))}else(e._pendingDfd=this.generateToken(this.findServerInfo(h.server),null,{serverUrl:e.resUrl_,token:h.token,signal:e.options_.signal,ssl:h.ssl})).then(s=>{t(new rt({userId:h?.userId,server:r.server??void 0,token:s.token,expires:null!=s.expires?Number(s.expires):null,ssl:!!s.ssl,isAdmin:e.admin_,validity:s.validity}))},s)}else this._busy=null,n&&(e.options_.token=null),(e._pendingDfd=this.getCredential(i.replace(/\/?$/,"/sharing"),{resource:e.resUrl_,owningTenant:r.owningTenant,signal:e.options_.signal,token:n,error:a,prompt:l})).then(()=>{this._enqueue(e.resUrl_,e.sinfo_,e.options_,e,e.admin_)},t=>{e.resUrl_=e.sinfo_=e.refresh_=null,e.reject(t)})};this._errbackFunc=s;const o=e.sinfo_.owningSystemUrl,n=this._isServerRsrc(e.resUrl_),l=e.sinfo_._restInfoPms;l?l.promise.then(t=>{const s=e.sinfo_;if(s._restInfoPms){s.adminTokenServiceUrl=s._restInfoPms.adminUrl,s._restInfoPms=null,s.tokenServiceUrl=((0,d.g)("authInfo.tokenServicesUrl",t)||(0,d.g)("authInfo.tokenServiceUrl",t)||(0,d.g)("tokenServiceUrl",t))??null,s.shortLivedTokenValidity=(0,d.g)("authInfo.shortLivedTokenValidity",t)??null,s.currentVersion=t.currentVersion,s.owningTenant=t.owningTenant;const e=s.owningSystemUrl=t.owningSystemUrl;e&&this._portals.push(e)}n&&s.owningSystemUrl?i():r()},()=>{e.sinfo_._restInfoPms=null;const t=new a.A("identity-manager:server-identification-failed","Unknown resource - could not find token service endpoint.");s(t)}):n&&o?i():e.sinfo_._selfReq?e.sinfo_._selfReq.selfDfd.then(t=>{const s={};let r,i,o,n;return t&&(r=t.user?.username,s.username=r,s.allSSL=t.allSSL,i=t.supportsOAuth,n=parseFloat(t.currentVersion),"multitenant"===t.portalMode&&(o=t.customBaseUrl),e.sinfo_.currentVersion=n),e.sinfo_.webTierAuth=!!r,r&&this.normalizeWebTierAuth?this.generateToken(e.sinfo_,null,{ssl:s.allSSL}).catch(()=>null).then(e=>(s.portalToken=e?.token,s.tokenExpiration=e?.expires,s)):!r&&i&&n>=4.4&&!this._findOAuthInfo(e.resUrl_)?this._generateOAuthInfo({portalUrl:e.sinfo_.server,customBaseUrl:o,owningTenant:e.sinfo_._selfReq.owningTenant}).catch(()=>null).then(()=>s):s}).catch(()=>null).then(t=>{e.sinfo_._selfReq=null,t?r(t.username,t.allSSL,t.portalToken,t.tokenExpiration):r()}):r()}_generateOAuthInfo(e){let t,s=null,r=e.portalUrl;const i=e.customBaseUrl,o=e.owningTenant,a=!this._defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal;if(a){s=this._appUrlObj.path;const e=s.search(/\/(apps|home)\//);s=e>-1?s.slice(0,e):null}return a&&s?(this._hasTestedIfAppIsOnPortal=!0,t=(0,n.A)(s+"/sharing/rest",{query:{f:"json"}}).then(()=>{this._defaultOAuthInfo=new ze({appId:"arcgisonline",popupCallbackUrl:s+"/home/oauth-callback.html"})})):t=Promise.resolve(),t.then(()=>{if(this._defaultOAuthInfo)return r=r.replace(/^http:/i,"https:"),(0,n.A)(r+"/sharing/rest/oauth2/validateRedirectUri",{query:{accountId:o,client_id:this._defaultOAuthInfo.appId,redirect_uri:(0,p.s2)(this._defaultOAuthInfo.popupCallbackUrl),f:"json"}}).then(e=>{if(e.data.valid){const t=this._defaultOAuthInfo.clone();e.data.urlKey&&i?t.portalUrl="https://"+e.data.urlKey.toLowerCase()+"."+i:t.portalUrl=r,t.popup=window!==window.top||!((0,p.FX)(r,this._appOrigin)||this._gwDomains.some(e=>e.regex.test(r)&&e.regex.test(this._appOrigin))),this.oAuthInfos.push(t)}})})}_doOAuthSignIn(e,t,s,r){const i=s._oAuthCred,o={portalUrl:s.portalUrl};!s.popup&&s.preserveUrlHash&&window.location.hash&&(o.hash=window.location.hash),i.stateUID&&(o.uid=i.stateUID);const n={client_id:s.appId,response_type:i.codeVerifier?"code":"token",state:JSON.stringify(o),expiration:s.expiration,locale:s.locale,redirect_uri:this._getRedirectURI(s,!!i.codeVerifier)};s.forceLogin&&(n.force_login=!0),s.forceUserId&&s.userId&&(n.prepopulatedusername=s.userId),!s.popup&&this._doPortalSignIn(e)&&(n.redirectToUserOrgUrl=!0),i.codeVerifier&&(n.code_challenge=r||i.codeVerifier,n.code_challenge_method=r?"S256":"plain");const l=s.portalUrl.replace(/^http:/i,"https:")+"/sharing/oauth2/authorize",c=l+"?"+(0,p.x0)(n);if(s.popup){const e=window.open(c,"esriJSAPIOAuth",s.popupWindowFeatures);if(e)e.focus(),this._oAuthDfd.oAuthWin_=e,this._oAuthIntervalId=setInterval(()=>{if(e.closed){clearInterval(this._oAuthIntervalId),this._oAuthOnPopupHandle.remove();const e=this._oAuthDfd;if(e){const t=new a.A("identity-manager:user-aborted","ABORTED");e.reject(t)}}},500),this._oAuthOnPopupHandle=(0,h.a)(window,["arcgis:auth:hash","arcgis:auth:location:search"],e=>{"arcgis:auth:hash"===e.type?this.setOAuthResponseHash(e.detail):this._setOAuthResponseQueryString(e.detail)});else{const e=new a.A("identity-manager:popup-blocked","ABORTED");this._oAuthDfd.reject(e)}}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:n,authorizeUrl:l,resourceUrl:e,serverInfo:t,oAuthInfo:s}):window.location.href=c}_getRedirectURI(e,t){const s=window.location.href.replace(/#.*$/,"");if(e.popup)return(0,p.s2)(e.popupCallbackUrl);if(t){const e=(0,p.An)(s);return e.query&&["code","error","error_description","message_code","persist","state"].forEach(t=>{delete e.query[t]}),(0,p.a6)(e.path,e.query)}return s}}st.prototype.declaredClass="esri.identity.IdentityManagerBase";let rt=class extends l.nJ{constructor(e){super(e),this._oAuthCred=null,this.tokenRefreshBuffer=2,e?._oAuthCred&&(this._oAuthCred=e._oAuthCred)}initialize(){this.resources=this.resources||[],null==this.creationTime&&(this.creationTime=Date.now())}refreshToken(){const e=r.id,t=e.findServerInfo(this.server),s=t?.owningSystemUrl,i=!!s&&"server"===this.scope,o=i&&Ye(t,e._legacyFed),n=t.webTierAuth,a=n&&e.normalizeWebTierAuth,l=Xe[this.server],h=l?.[this.userId];let c,d=this.resources&&this.resources[0],u=i?e.findServerInfo(s):null,p={username:this.userId,password:h};if(n&&!a)return;i&&!u&&e.serverInfos.some(t=>(e._isIdProvider(s,t.server)&&(u=t),!!u));const f=u?e.findCredential(u.server,this.userId):null;if(!i||f){if(!o){if(i)c={serverUrl:d,token:f?.token,ssl:f?.ssl};else if(a)p=null,c={ssl:this.ssl};else{if(!h){let s;return d&&(d=e._sanitizeUrl(d),this._enqueued=1,s=e._enqueue(d,t,null,null,this.isAdmin,this),s.then(()=>{this._enqueued=0,this.refreshServerTokens()}).catch(()=>{this._enqueued=0})),s}this.isAdmin&&(c={isAdmin:!0})}return e.generateToken(i?u:t,i?null:p,c).then(e=>{this.token=e.token,this.expires=null!=e.expires?Number(e.expires):null,this.creationTime=Date.now(),this.validity=e.validity,this.emitTokenChange(),this.refreshServerTokens()}).catch(()=>{})}f?.refreshToken()}}refreshServerTokens(){if("portal"===this.scope){const e=r.id;e.credentials.forEach(t=>{const s=e.findServerInfo(t.server),r=s?.owningSystemUrl;t!==this&&t.userId===this.userId&&r&&"server"===t.scope&&(e._hasSameServerInstance(this.server,r)||e._isIdProvider(r,this.server))&&(Ye(s,e._legacyFed)?(t.token=this.token,t.expires=this.expires,t.creationTime=this.creationTime,t.validity=this.validity,t.emitTokenChange()):t.refreshToken())})}}emitTokenChange(e){clearTimeout(this._refreshTimer);const t=r.id,s=this.server?t.findServerInfo(this.server):null,i=s?.owningSystemUrl,o=i?t.findServerInfo(i):null;!1===e||i&&"portal"!==this.scope&&(!o?.webTierAuth||t.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer(),this.emit("token-change")}destroy(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null,this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const e=r.id,t=e.credentials.indexOf(this);t>-1&&e.credentials.splice(t,1),this.emitTokenChange(),this.emit("destroy")}toJSON(){const e=(0,c.oy)({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),t=this.resources;return t&&t.length>0&&(e.resources=t.slice()),e}_startRefreshTimer(){clearTimeout(this._refreshTimer);const e=6e4*this.tokenRefreshBuffer,t=2**31-1;let s=(this.validity?this.creationTime+6e4*this.validity:this.expires)-Date.now();s<0?s=0:s>t&&(s=t),this._refreshTimer=setTimeout(this.refreshToken.bind(this),s>e?s-e:s)}};(0,i._)([(0,f.MZ)()],rt.prototype,"creationTime",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"expires",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"isAdmin",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"oAuthState",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"resources",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"scope",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"server",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"ssl",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"token",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"tokenRefreshBuffer",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"userId",void 0),(0,i._)([(0,f.MZ)()],rt.prototype,"validity",void 0),rt=(0,i._)([(0,m.$)("esri.identity.Credential")],rt);class it extends st{}it.prototype.declaredClass="esri.identity.IdentityManager";const ot=new it;(0,r.Aq)(ot)},55270:(e,t,s)=>{s(50214),s(95779),s(13262),s(59192);var r=s(346),i=s(64604),o=s(6407),n=s(18683);async function a(e){if(null!=l.fetchBundleAsset)return l.fetchBundleAsset(e);const t=await(0,i.A)(e,{responseType:"text"});return JSON.parse(t.data)}s(93804),s(59121),s(32773),s(16345),s(54483),s(20266),s(90740),s(84699),s(13671),s(80959),s(19247),s(29512),s(99063),s(1178);const l={};var h;(0,r.r)((h={pattern:"esri/",location:n.g},new class{constructor({base:e="",pattern:t,location:s=new URL(window.location.href)}){let r;r="string"==typeof s?e=>new URL(e,new URL(s,window.location.href)).href:s instanceof URL?e=>new URL(e,s).href:s,this.pattern="string"==typeof t?new RegExp(`^${t}`):t,this.getAssetUrl=r,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,t){return async function(e,t,s,i){const n=t.exec(s);if(!n)throw new o.A("esri-intl:invalid-bundle",`Bundle id "${s}" is not compatible with the pattern "${t}"`);const l=n[1]?`${n[1]}/`:"",h=n[2],c=(0,r.n)(i),d=`${l}${h}.json`,u=c?`${l}${h}_${c}.json`:d;let p;try{p=await a(e(u))}catch(t){if(u===d)throw new o.A("intl:unknown-bundle",`Bundle "${s}" cannot be loaded`,{error:t});try{p=await a(e(d))}catch(e){throw new o.A("intl:unknown-bundle",`Bundle "${s}" cannot be loaded`,{error:e})}}return p}(this.getAssetUrl,this.matcher,e,t)}}(h)))},67321:(e,t,s)=>{s.d(t,{C_:()=>u,OH:()=>g,Vh:()=>m,on:()=>d,pc:()=>_,wB:()=>l,z7:()=>h});var r=s(19247),i=s(13671),o=s(57732),n=s(80959),a=s(35819);function l(e,t,s={}){return c(e,t,s,p)}function h(e,t,s={}){return c(e,t,s,f)}function c(e,t,s={},r){let i=null;const n=s.once?(e,s)=>{r(e)&&((0,o.r)(i),t(e,s))}:(e,s)=>{r(e)&&t(e,s)};if(i=(0,a.w)(e,n,s.sync,s.equals),s.initial){const t=e();n(t,t)}return i}function d(e,t,s,n={}){let a=null,h=null,c=null;function d(){a&&h&&(h.remove(),n.onListenerRemove?.(a),a=null,h=null)}function u(e){n.once&&n.once&&(0,o.r)(c),s(e)}const p=l(e,(e,s)=>{d(),(0,r.i)(e)&&(a=e,h=(0,r.a)(e,t,u),n.onListenerAdd?.(e))},{sync:n.sync,initial:!0});return c=(0,i.m)(()=>{p.remove(),d()}),c}function u(e,t){return function(e,t,s){if((0,n.G4)(s))return Promise.reject((0,n.NK)());const r=e();if(t?.(r))return Promise.resolve(r);let a=null;function l(){a=(0,o.r)(a)}return new Promise((r,o)=>{a=(0,i.h)([(0,n.u7)(s,()=>{l(),o((0,n.NK)())}),c(e,e=>{l(),r(e)},{sync:!1,once:!0},t??p)])})}(e,f,t)}function p(e){return!0}function f(e){return!!e}s(6407),s(32773),s(20266),s(90740),s(59121),s(84699),s(36555),s(45371),s(61532),s(85176),s(93181),s(50704),s(91047),s(36172);const g={sync:!0},m={initial:!0},_={sync:!0,initial:!0}},93049:(e,t,s)=>{s.d(t,{a:()=>o,b:()=>n,g:()=>i,n:()=>a});const r="randomUUID"in crypto;function i(){if(r)return crypto.randomUUID();const e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;const t=t=>e[t].toString(16).padStart(4,"0");return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}function o(){return`{${i().toUpperCase()}}`}function n(){return`{${i()}}`}function a(e){const t=e.toUpperCase();return e.startsWith("{")?t:`{${t}}`}},95779:(e,t,s)=>{s.d(t,{c:()=>a,f:()=>l});var r=s(59192);const i={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let o=new WeakMap,n={};function a(e={}){const t={};return null!=e.digitSeparator&&(t.useGrouping=e.digitSeparator),null!=e.places&&(t.minimumFractionDigits=t.maximumFractionDigits=e.places),t}function l(e,t){return Object.is(e,-0)&&(e=0),function(e){const t=e||n;if(!o.has(t)){const s=(0,r.g)(),n=s&&i[s]||(0,r.n)();o.set(t,new Intl.NumberFormat(n,e))}return o.get(t)}(t).format(e)}(0,r.b)(()=>{o=new WeakMap,n={}}),new Map},96889:(e,t,s)=>{s.d(t,{A:()=>Te,C:()=>Ut,D:()=>$t,E:()=>de,F:()=>Nt,G:()=>xt,I:()=>qt,L:()=>vt,T:()=>ce,Z:()=>ke,a:()=>Mt,b:()=>Et,c:()=>Je,d:()=>ct,e:()=>ht,f:()=>he,g:()=>bt,h:()=>St,i:()=>I,k:()=>wt,l:()=>Ht,m:()=>Me,n:()=>At,o:()=>Ne,p:()=>De,q:()=>We,r:()=>Ct,s:()=>yt,t:()=>lt,u:()=>Be,v:()=>Ke,w:()=>g,x:()=>le,y:()=>_,z:()=>Ee});var r=s(18683),i=(s(32773),s(99063));class o{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}const n={},a=(e,t,...s)=>{try{return e?.call(t,...s)}catch(t){console.error(t,e)}},l=async(e,t,...s)=>{try{const r=e?.call(t,...s);return await r}catch(t){console.error(t,e)}},h="ar,bg,bs,ca,cs,da,de,el,en,es,et,fi,fr,he,hr,hu,id,it,ja,ko,lt,lv,nl,nb,no,pl,pt-BR,pt-PT,ro,ru,sk,sl,sr,sv,th,tr,uk,vi,zh-CN,zh-HK,zh-TW".split(","),c=new Set(h),d="en",u={pt:"pt-PT",nb:"no",nn:"no",zh:"zh-CN"},p={},f=async(e,t)=>{const s=`${t}${e}.json`;try{const e=await fetch(s);if(e.ok)return await e.json()}catch(e){return console.error(e),{}}return e===d?{}:await f(d,t)},g=e=>{const t=((e,t,s)=>{const r=((e,t)=>{let s=e;for(;s;){const e=s.closest?.(t);if(e)return e;const r=s.getRootNode?.();if(r===globalThis.document)return null;s=r.host}return null})(e,`[${t}]`);return r?.getAttribute(t)??s})(e,"lang",globalThis.navigator?.language||d);return{lang:t,t9nLocale:m(t)}},m=e=>{const[t,s]=e.split("-"),r=t.toLowerCase();let i=r;return s&&(i=`${r}-${s.toUpperCase()}`),i=u[i]??i,c.has(i)?i:s?m(r):d},_=(e,t,s,r)=>{let i;const o=()=>v(e,t(),r).then(e=>{i?.lang===e.lang&&i.t9nLocale===e.t9nLocale&&i.t9nStrings===e.t9nStrings||s(e),i=e}).catch(console.error);return queueMicrotask(o),((e,t,s)=>(0,(e=>{const t=e.join(","),s=n[t];if(void 0!==s)return s;const r=new Set,i=new MutationObserver(e=>r.forEach(t=>t(e)));globalThis.document&&i.observe(document.documentElement,{attributes:!0,attributeFilter:e,subtree:!0});const o={subscribe:e=>(r.add(e),()=>{r.delete(e),0===r.size&&(i.disconnect(),n[t]=void 0)})};return n[t]=o,o})(["lang"]).subscribe)(t=>{const r=t.some(t=>((e,t)=>{let s=e;for(;s;){if(s===t)return!0;if(!s.parentNode)return!1;s=s.parentNode instanceof ShadowRoot?s.parentNode.host:s.parentNode}return!1})(e,t.target));r&&s()}))(e,0,o)},v=async(e,t,s=e.localName.split("-").slice(1).join("-"))=>{const{lang:r,t9nLocale:i}=g(e),o=`${t}/${s}/t9n`,n=null===s?{}:await(async(e,t,s="")=>{const r=`${t}/${s}`,i=`${r}${e}.json`;return p[i]??(p[i]=f(e,r)),await p[i]})(i,o,"messages.");return{lang:r,t9nLocale:i,t9nStrings:n}},y=/[A-Z]+(?![a-z])|[A-Z]/gu,w=globalThis,A=w.ShadowRoot&&(void 0===w.ShadyCSS||w.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,S=Symbol(),b=new WeakMap;let k=class{constructor(e,t,s){if(this._$cssResult$=!0,s!==S)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(A&&void 0===e){const s=void 0!==t&&1===t.length;s&&(e=b.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),s&&b.set(t,e))}return e}toString(){return this.cssText}};const I=(e,...t)=>{const s=1===e.length?e[0]:t.reduce((t,s,r)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+e[r+1],e[0]);return new k(s,e,S)},U=A?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const s of e.cssRules)t+=s.cssText;return(e=>new k("string"==typeof e?e:e+"",void 0,S))(t)})(e):e,{is:$,defineProperty:C,getOwnPropertyDescriptor:P,getOwnPropertyNames:T,getOwnPropertySymbols:x,getPrototypeOf:E}=Object,R=globalThis,O=R.trustedTypes,M=O?O.emptyScript:"",N=R.reactiveElementPolyfillSupport,L=(e,t)=>e,D={toAttribute(e,t){switch(t){case Boolean:e=e?M:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let s=e;switch(t){case Boolean:s=null!==e;break;case Number:s=null===e?null:Number(e);break;case Object:case Array:try{s=JSON.parse(e)}catch(e){s=null}}return s}},j=(e,t)=>!$(e,t),q={attribute:!0,type:String,converter:D,reflect:!1,useDefault:!1,hasChanged:j};Symbol.metadata??=Symbol("metadata"),R.litPropertyMetadata??=new WeakMap;let H=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=q){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const s=Symbol(),r=this.getPropertyDescriptor(e,s,t);void 0!==r&&C(this.prototype,e,r)}}static getPropertyDescriptor(e,t,s){const{get:r,set:i}=P(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get:r,set(t){const o=r?.call(this);i?.call(this,t),this.requestUpdate(e,o,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??q}static _$Ei(){if(this.hasOwnProperty(L("elementProperties")))return;const e=E(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(L("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(L("properties"))){const e=this.properties,t=[...T(e),...x(e)];for(const s of t)this.createProperty(s,e[s])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,s]of t)this.elementProperties.set(e,s)}this._$Eh=new Map;for(const[e,t]of this.elementProperties){const s=this._$Eu(e,t);void 0!==s&&this._$Eh.set(s,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const s=new Set(e.flat(1/0).reverse());for(const e of s)t.unshift(U(e))}else void 0!==e&&t.push(U(e));return t}static _$Eu(e,t){const s=t.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const s of t.keys())this.hasOwnProperty(s)&&(e.set(s,this[s]),delete this[s]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{if(A)e.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const s of t){const t=document.createElement("style"),r=w.litNonce;void 0!==r&&t.setAttribute("nonce",r),t.textContent=s.cssText,e.appendChild(t)}})(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,s){this._$AK(e,s)}_$ET(e,t){const s=this.constructor.elementProperties.get(e),r=this.constructor._$Eu(e,s);if(void 0!==r&&!0===s.reflect){const i=(void 0!==s.converter?.toAttribute?s.converter:D).toAttribute(t,s.type);this._$Em=e,null==i?this.removeAttribute(r):this.setAttribute(r,i),this._$Em=null}}_$AK(e,t){const s=this.constructor,r=s._$Eh.get(e);if(void 0!==r&&this._$Em!==r){const e=s.getPropertyOptions(r),i="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:D;this._$Em=r;const o=i.fromAttribute(t,e.type);this[r]=o??this._$Ej?.get(r)??o,this._$Em=null}}requestUpdate(e,t,s){if(void 0!==e){const r=this.constructor,i=this[e];if(s??=r.getPropertyOptions(e),!((s.hasChanged??j)(i,t)||s.useDefault&&s.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(r._$Eu(e,s))))return;this.C(e,t,s)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,{useDefault:s,reflect:r,wrapped:i},o){s&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??t??this[e]),!0!==i||void 0!==o)||(this._$AL.has(e)||(this.hasUpdated||s||(t=void 0),this._$AL.set(e,t)),!0===r&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,s]of e){const{wrapped:e}=s,r=this[t];!0!==e||this._$AL.has(t)||void 0===r||this.C(t,void 0,s,r)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach(e=>e.hostUpdate?.()),this.update(t)):this._$EM()}catch(t){throw e=!1,this._$EM(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(e=>e.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(e=>this._$ET(e,this[e])),this._$EM()}updated(e){}firstUpdated(e){}};H.elementStyles=[],H.shadowRootOptions={mode:"open"},H[L("elementProperties")]=new Map,H[L("finalized")]=new Map,N?.({ReactiveElement:H}),(R.reactiveElementVersions??=[]).push("2.1.1");const z=globalThis,B=z.trustedTypes,Z=B?B.createPolicy("lit-html",{createHTML:e=>e}):void 0,F="$lit$",V=`lit$${Math.random().toFixed(9).slice(2)}$`,W="?"+V,J=`<${W}>`,G=document,K=()=>G.createComment(""),X=e=>null===e||"object"!=typeof e&&"function"!=typeof e,Q=Array.isArray,Y="[ \t\n\f\r]",ee=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,te=/-->/g,se=/>/g,re=RegExp(`>|${Y}(?:([^\\s"'>=/]+)(${Y}*=${Y}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),ie=/'/g,oe=/"/g,ne=/^(?:script|style|textarea|title)$/i,ae=e=>(t,...s)=>({_$litType$:e,strings:t,values:s}),le=ae(1),he=ae(2),ce=Symbol.for("lit-noChange"),de=Symbol.for("lit-nothing"),ue=new WeakMap,pe=G.createTreeWalker(G,129);function fe(e,t){if(!Q(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==Z?Z.createHTML(t):t}class ge{constructor({strings:e,_$litType$:t},s){let r;this.parts=[];let i=0,o=0;const n=e.length-1,a=this.parts,[l,h]=((e,t)=>{const s=e.length-1,r=[];let i,o=2===t?"<svg>":3===t?"<math>":"",n=ee;for(let t=0;t<s;t++){const s=e[t];let a,l,h=-1,c=0;for(;c<s.length&&(n.lastIndex=c,l=n.exec(s),null!==l);)c=n.lastIndex,n===ee?"!--"===l[1]?n=te:void 0!==l[1]?n=se:void 0!==l[2]?(ne.test(l[2])&&(i=RegExp("</"+l[2],"g")),n=re):void 0!==l[3]&&(n=re):n===re?">"===l[0]?(n=i??ee,h=-1):void 0===l[1]?h=-2:(h=n.lastIndex-l[2].length,a=l[1],n=void 0===l[3]?re:'"'===l[3]?oe:ie):n===oe||n===ie?n=re:n===te||n===se?n=ee:(n=re,i=void 0);const d=n===re&&e[t+1].startsWith("/>")?" ":"";o+=n===ee?s+J:h>=0?(r.push(a),s.slice(0,h)+F+s.slice(h)+V+d):s+V+(-2===h?t:d)}return[fe(e,o+(e[s]||"<?>")+(2===t?"</svg>":3===t?"</math>":"")),r]})(e,t);if(this.el=ge.createElement(l,s),pe.currentNode=this.el.content,2===t||3===t){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(r=pe.nextNode())&&a.length<n;){if(1===r.nodeType){if(r.hasAttributes())for(const e of r.getAttributeNames())if(e.endsWith(F)){const t=h[o++],s=r.getAttribute(e).split(V),n=/([.?@])?(.*)/.exec(t);a.push({type:1,index:i,name:n[2],strings:s,ctor:"."===n[1]?we:"?"===n[1]?Ae:"@"===n[1]?Se:ye}),r.removeAttribute(e)}else e.startsWith(V)&&(a.push({type:6,index:i}),r.removeAttribute(e));if(ne.test(r.tagName)){const e=r.textContent.split(V),t=e.length-1;if(t>0){r.textContent=B?B.emptyScript:"";for(let s=0;s<t;s++)r.append(e[s],K()),pe.nextNode(),a.push({type:2,index:++i});r.append(e[t],K())}}}else if(8===r.nodeType)if(r.data===W)a.push({type:2,index:i});else{let e=-1;for(;-1!==(e=r.data.indexOf(V,e+1));)a.push({type:7,index:i}),e+=V.length-1}i++}}static createElement(e,t){const s=G.createElement("template");return s.innerHTML=e,s}}function me(e,t,s=e,r){if(t===ce)return t;let i=void 0!==r?s._$Co?.[r]:s._$Cl;const o=X(t)?void 0:t._$litDirective$;return i?.constructor!==o&&(i?._$AO?.(!1),void 0===o?i=void 0:(i=new o(e),i._$AT(e,s,r)),void 0!==r?(s._$Co??=[])[r]=i:s._$Cl=i),void 0!==i&&(t=me(e,i._$AS(e,t.values),i,r)),t}class _e{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:s}=this._$AD,r=(e?.creationScope??G).importNode(t,!0);pe.currentNode=r;let i=pe.nextNode(),o=0,n=0,a=s[0];for(;void 0!==a;){if(o===a.index){let t;2===a.type?t=new ve(i,i.nextSibling,this,e):1===a.type?t=new a.ctor(i,a.name,a.strings,this,e):6===a.type&&(t=new be(i,this,e)),this._$AV.push(t),a=s[++n]}o!==a?.index&&(i=pe.nextNode(),o++)}return pe.currentNode=G,r}p(e){let t=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(e,s,t),t+=s.strings.length-2):s._$AI(e[t])),t++}}class ve{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,s,r){this.type=2,this._$AH=de,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=s,this.options=r,this._$Cv=r?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e?.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=me(this,e,t),X(e)?e===de||null==e||""===e?(this._$AH!==de&&this._$AR(),this._$AH=de):e!==this._$AH&&e!==ce&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):(e=>Q(e)||"function"==typeof e?.[Symbol.iterator])(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==de&&X(this._$AH)?this._$AA.nextSibling.data=e:this.T(G.createTextNode(e)),this._$AH=e}$(e){const{values:t,_$litType$:s}=e,r="number"==typeof s?this._$AC(e):(void 0===s.el&&(s.el=ge.createElement(fe(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===r)this._$AH.p(t);else{const e=new _e(r,this),s=e.u(this.options);e.p(t),this.T(s),this._$AH=e}}_$AC(e){let t=ue.get(e.strings);return void 0===t&&ue.set(e.strings,t=new ge(e)),t}k(e){Q(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let s,r=0;for(const i of e)r===t.length?t.push(s=new ve(this.O(K()),this.O(K()),this,this.options)):s=t[r],s._$AI(i),r++;r<t.length&&(this._$AR(s&&s._$AB.nextSibling,r),t.length=r)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class ye{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,s,r,i){this.type=1,this._$AH=de,this._$AN=void 0,this.element=e,this.name=t,this._$AM=r,this.options=i,s.length>2||""!==s[0]||""!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=de}_$AI(e,t=this,s,r){const i=this.strings;let o=!1;if(void 0===i)e=me(this,e,t,0),o=!X(e)||e!==this._$AH&&e!==ce,o&&(this._$AH=e);else{const r=e;let n,a;for(e=i[0],n=0;n<i.length-1;n++)a=me(this,r[s+n],t,n),a===ce&&(a=this._$AH[n]),o||=!X(a)||a!==this._$AH[n],a===de?e=de:e!==de&&(e+=(a??"")+i[n+1]),this._$AH[n]=a}o&&!r&&this.j(e)}j(e){e===de?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class we extends ye{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===de?void 0:e}}class Ae extends ye{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==de)}}class Se extends ye{constructor(e,t,s,r,i){super(e,t,s,r,i),this.type=5}_$AI(e,t=this){if((e=me(this,e,t,0)??de)===ce)return;const s=this._$AH,r=e===de&&s!==de||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,i=e!==de&&(s===de||r);r&&this.element.removeEventListener(this.name,this,s),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class be{constructor(e,t,s){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(e){me(this,e)}}const ke={I:ve},Ie=z.litHtmlPolyfillSupport;Ie?.(ge,ve),(z.litHtmlVersions??=[]).push("3.3.1");const Ue=globalThis;let $e=class extends H{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,s)=>{const r=s?.renderBefore??t;let i=r._$litPart$;if(void 0===i){const e=s?.renderBefore??null;r._$litPart$=i=new ve(t.insertBefore(K(),e),e,void 0,s??{})}return i._$AI(e),i})(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return ce}};$e._$litElement$=!0,$e.finalized=!0,Ue.litElementHydrateSupport?.({LitElement:$e});const Ce=Ue.litElementPolyfillSupport;Ce?.({LitElement:$e}),(Ue.litElementVersions??=[]).push("4.2.1");const Pe=Symbol.for("controller"),Te=e=>"function"==typeof e?.then;let xe;const Ee=e=>{xe!==e&&(xe=e,queueMicrotask(()=>xe===e?xe=void 0:0))},Re=e=>xe;let Oe=[];const Me=e=>{if(void 0===e)return void(Oe=[]);const t=Oe.indexOf(e);Oe=-1===t?[...Oe,e]:Oe.slice(0,t+1),queueMicrotask(()=>Oe=[])},Ne=()=>Oe;let Le;const De=e=>{Le!==e&&(Le=e,queueMicrotask(()=>Le===e?Le=void 0:0))},je=async(e,t)=>{const s=He(e);if(void 0===s)return e;if(await s.ready,"function"==typeof t){const e=s.watchExports(s=>t(s,e))}return s.exports},qe=async e=>{const t=He(e);return await t.ready,t},He=e=>{const t=Re().manager.X(e);if(void 0!==t)return t;if((e=>"object"==typeof e&&null!==e&&(Pe in e||"hostConnected"in e||"hostDisconnected"in e||"hostUpdate"in e||"hostUpdated"in e))(e))return e;const s=(()=>{const e=Le;return Le=void 0,e})();return void 0!==s?s:void 0};let ze=!1;const Be=e=>{ze=!0;try{return e()}finally{ze=!1}};let Ze;const Fe=()=>{Ze?.forEach(({callbacks:e},t)=>{const s=Object.keys(t);e.forEach(e=>e(s))}),Ze=void 0},Ve=(e,t,s)=>{const r=e.manager;return r.V!==de&&r.V!==s&&r.S(void 0,void 0),0===r.T.length&&queueMicrotask(()=>r.S(void 0,void 0)),r.V=s,r.T.push((e,r)=>a(t,void 0,s===r?e:void 0)),s},We=(e=[Re(),...Ne()],t,s)=>{const r=Array.isArray(e)?e:[e];let i=r.length+1;const o=e=>{i-=1,void 0!==e&&(i=Math.min(i,0)),0===i&&t(e)};r.forEach(e=>((e,t,s)=>{const r=Object.keys(e),i=r.length;void 0===Ze&&queueMicrotask(Fe),Ze??=new Map;let o=Ze.get(e);return void 0===o&&(o={callbacks:[],keyCount:i},Ze.set(e,o)),o.keyCount!==i&&(o.callbacks.forEach(e=>e(r)),o.callbacks=[],o.keyCount=i),o.callbacks.push(r=>{const o=e=>a(t,null,e),n=r[i];void 0===n?o(void 0):e[n]===s?o(n):o(void 0)}),s})(e,t=>o(void 0===t?void 0:{key:t,host:e,isReactive:!1}),s));for(const e of r)if("manager"in e&&e.manager.component===e){Ve(e,t=>o(void 0===t?void 0:{key:t,host:e,isReactive:!0}),s);break}return s},Je=((e="",t={},s=Re())=>{const r={emit:r=>{""===e&&Fe();const i=new CustomEvent(e,{detail:r,cancelable:!0,bubbles:!0,composed:!0,...t});return s.el.dispatchEvent(i),i}};return""===e&&We(void 0,t=>e=t.key,r),r}).bind(null,"");var Ge;Ge=Pe;class Ke{constructor(e){this.#e=[],this.#t=[],this.#s=[],this.#r=[],this.#i=[],this.#o=[],this.#n=[],this.#a=[],this.#l=[],this.#h=!1,this.P=new o,this.connectedCalled=!1,this.loadedCalled=!1,this[Ge]=!0,this.#c=[];const t=this,s=e??Re();t.#d=s,t.ready=t.P.promise,t.#u=Ye(t),t.component=s,t.#d.addController(t),void 0===t.#d.manager||(Me(t),queueMicrotask(()=>t.catchUpLifecycle()))}#e;#t;#s;#r;#i;#o;#n;#a;#l;#h;#d;catchUpLifecycle(){const{manager:e}=this.#d;!e.connectedCalled||this.connectedCalled||this.triggerConnected(),!e.#h||this.triggerLoad().then(()=>e.loadedCalled&&this.triggerLoaded()).catch(console.error)}#u;get exports(){return this.#u}set exports(e){const t=this.#u;t!==e&&(this.#u=e,this.#c.forEach(a),this.connectedCalled&&!1!==this.O&&this.#d.requestUpdate(this.O,t)),this.P.resolve(e)}setProvisionalExports(e,t=!0){this.#u=t?Ye(e):e,this.#c.forEach(a)}#c;watchExports(e){const t=()=>e(this.#u);return this.#c.push(t),()=>{this.#c.splice(this.#c.indexOf(t),1)}}get use(){return Ee(this.#d),je}get useRef(){return Ee(this.#d),qe}get useRefSync(){return Ee(this.#d),He}controllerRemoved(){this.#d.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(e){this.#e.push(e)}onDisconnected(e){this.#t.push(e)}onLoad(e){this.#s.push(e)}onLoaded(e){this.#r.push(e)}onUpdate(e){this.#i.push(e)}onUpdated(e){this.#o.push(e)}onDestroy(e){this.#n.push(e)}onLifecycle(e){this.#a.push(e),this.connectedCalled&&this.#d.el.isConnected&&this.#p(e)}triggerConnected(){const e=this;e.hostConnected&&a(e.hostConnected,e),e.#e.forEach(a),e.triggerLifecycle(),e.connectedCalled=!0}triggerDisconnected(){const e=this;e.hostDisconnected&&a(e.hostDisconnected,e),e.#t.forEach(a),e.#l.forEach(a),e.#l=[]}async triggerLoad(){if(this.#h)return;this.#h=!0;const e=this;e.hostLoad&&await l(e.hostLoad,e),this.#s.length>0&&await Promise.allSettled(this.#s.map(l)),this.P.resolve(this.#u)}triggerLoaded(){this.loadedCalled||(this.hostLoaded&&a(this.hostLoaded,this),this.#r.forEach(a),this.loadedCalled=!0)}triggerUpdate(e){this.hostUpdate&&a(this.hostUpdate,this,e),this.#i.forEach(Xe,e)}triggerUpdated(e){this.hostUpdated&&a(this.hostUpdated,this,e),this.#o.forEach(Xe,e)}triggerDestroy(){this.hostDestroy&&a(this.hostDestroy,this),this.#n.forEach(a)}triggerLifecycle(){this.hostLifecycle&&this.#p(()=>this.hostLifecycle()),this.#a.forEach(this.#p,this)}#p(e){Ee(this.#d);const t=a(e);(Array.isArray(t)?t:[t]).forEach(e=>{"function"==typeof e?this.#l.push(e):"object"==typeof e&&"function"==typeof e.remove&&this.#l.push(e.remove)})}}function Xe(e){a(e,void 0,this)}const Qe=Ke,Ye=e=>{if("object"!=typeof e&&"function"!=typeof e||null===e)return e;const t=new Proxy(e,{get(e,s,r){if("exports"!==s&&"_exports"!==s||!(s in e)||e[s]!==t)return s in e||s in Promise.prototype||"symbol"==typeof s?"function"==typeof e?e[s]:Reflect.get(e,s,r):void 0}});return t},et=e=>{let t=e;for(;t=t.parentNode??t.host;)if(t?.constructor?.lumina){const s=t;return s.manager?.loadedCalled||(s.J??s._offspring).push(e),(s.I??s._postLoad).promise}return!1},tt={};function st(){}const rt=Object.defineProperty,it=globalThis.HTMLElement??st;class ot extends it{constructor(){super(),this.#f={},this.#g=[],this.I=new o,this.H=new o,this.J=[];const e=this,t=e.constructor;e._offspring=e.J,e._postLoad=e.I,t.C?.forEach(t=>{Object.hasOwn(e,t)&&(e.#f[t]=e[t],delete e[t])}),t.A?e.#m({a:t.A}):t.B.then(async s=>{await t.K.p,e.#m(await(s.default?.then(e=>"function"==typeof e?{a:e}:e)??s))}).catch(t=>{e.H.reject(t),setTimeout(()=>{throw t})})}static{this.lumina=!0}static F(){for(const e of this.C??[])rt(this.prototype,e,{configurable:!0,enumerable:!0,get(){return this.#f[e]},set(t){this.#f[e]=t}});for(const e of this.E??[])rt(this.prototype,e,{async value(...t){this.#_||await this.H.promise;const s=this.#_;return await s[e](...t)},configurable:!0});for(const e of this.D??[])rt(this.prototype,e,{value(...t){return this.#_[e](...t)},configurable:!0})}#_;#f;#g;get manager(){return this.#_?.manager}attributeChangedCallback(e,t,s){this.#_?.attributeChangedCallback(e,t,s),this.#_||this.#g.push(e)}connectedCallback(){this.#_?this.#_.connectedCallback?.():queueMicrotask(()=>this.G=et(this))}disconnectedCallback(){this.#_?.disconnectedCallback?.()}async componentOnReady(){return await this.H.promise,this}#m(e){const t=this.constructor,s=t.L,r=this.#f,i=Object.values(e).find(e=>e.L===s),o=`${s}--lazy`;let n=i;for(;n&&!Object.hasOwn(n,"lumina");)n=Object.getPrototypeOf(n);at(n),!t.A&&(t.A=i,customElements.define(o,i)),i.N=this;const a=document.createElement(o);i.N=void 0,this.#_=a,this.#f=a,this.#g.forEach(e=>a.attributeChangedCallback(e,null,this.getAttribute(e))),Object.entries(r).forEach(nt,a);const l=this.isConnected;(l||this.G)&&(a.connectedCallback?.(),l||a.disconnectedCallback())}addController(){}requestUpdate(){this.#_?.requestUpdate()}}function nt([e,t]){this[e]=t}const at=e=>{const t=e.prototype,s=Element.prototype;Object.hasOwn(t,"isConnected")||(t.setAttribute=function(e,t){s.setAttribute.call(this.el,e,t)},t.removeAttribute=function(e){s.removeAttribute.call(this.el,e)},rt(t,"isConnected",{get(){return Reflect.get(s,"isConnected",this.el)}}))},lt={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},ht=e=>(...t)=>({_$litDirective$:e,values:t});let ct=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,s){this._$Ct=e,this._$AM=t,this._$Ci=s}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}};const dt=ht(class extends ct{constructor(e){if(super(e),e.type!==lt.ATTRIBUTE||"class"!==e.name||e.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter(t=>e[t]).join(" ")+" "}update(e,[t]){if(void 0===this.st){this.st=new Set,void 0!==e.strings&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter(e=>""!==e)));for(const e in t)t[e]&&!this.nt?.has(e)&&this.st.add(e);return this.render(t)}const s=e.element.classList;for(const e of this.st)e in t||(s.remove(e),this.st.delete(e));for(const e in t){const r=!!t[e];r===this.st.has(e)||this.nt?.has(e)||(r?(s.add(e),this.st.add(e)):(s.remove(e),this.st.delete(e)))}return ce}}),ut="important",pt=" !"+ut,ft=ht(class extends ct{constructor(e){if(super(e),e.type!==lt.ATTRIBUTE||"style"!==e.name||e.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(e){return Object.keys(e).reduce((t,s)=>{const r=e[s];return null==r?t:t+`${s=s.includes("-")?s:s.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`},"")}update(e,[t]){const{style:s}=e.element;if(void 0===this.ft)return this.ft=new Set(Object.keys(t)),this.render(t);for(const e of this.ft)null==t[e]&&(this.ft.delete(e),e.includes("-")?s.removeProperty(e):s[e]=null);for(const e in t){const r=t[e];if(null!=r){this.ft.add(e);const t="string"==typeof r&&r.endsWith(pt);e.includes("-")||t?s.setProperty(e,t?r.slice(0,-11):r,t?ut:""):s[e]=r}}return ce}});class gt extends Qe{constructor(e){super(e),this.destroyed=!1,this.R=!1,this.V=de,this.T=[],this.#v=new WeakMap,this.#d=e,this.exports=void 0,this.hasDestroy=_t in e&&"function"==typeof e.destroy,$e.prototype.addController.call(e,{hostConnected:()=>{if(this.destroyed){const t=e.el.localName;throw e.el.remove(),new Error(`The ${t} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${_t} prop.`)}void 0!==this.#y&&clearTimeout(this.#y),Fe();for(const t of e.M)"triggerConnected"in t?t.triggerConnected():a(t.hostConnected,t)},hostDisconnected:()=>{for(const t of e.M)"triggerDisconnected"in t?t.triggerDisconnected():a(t.hostDisconnected,t);this.hasDestroy&&!this.destroyed&&this.U()},hostUpdate:()=>{for(const t of e.M)"triggerUpdate"in t?t.triggerUpdate(this.Q):a(t.hostUpdate,t,this.Q)},hostUpdated:()=>{for(const t of e.M)"triggerUpdated"in t?t.triggerUpdated(this.Q):a(t.hostUpdated,t,this.Q);this.Q=void 0}}),queueMicrotask(()=>this.R=!0),Ee(e)}#y;#d;async destroy(){if(!this.destroyed){this.#d.el.isConnected&&(this.hasDestroy=!1,this.#d.el.remove()),this.#y=void 0,this.destroyed=!0;for(const e of this.#d.M)"triggerDestroy"in e?e.triggerDestroy():a(e.hostDestroy,e);this.#d.M.splice(0)}}U(){if(void 0!==this.#y&&clearTimeout(this.#y),!this.#d.el.isConnected&&!this.#d.autoDestroyDisabled){const e=()=>{this.#d.destroy()};this.#y=((e,t)=>{const s=t/4;let r=0;const i=setInterval(()=>{r+=s,r>=t&&(clearInterval(i),e())},s);return i})(e,mt)}}S(e,t){const s=this.T;this.V=de,this.T=[],s.forEach(s=>s(e,t))}#v;W(e,t){("object"==typeof t&&null!==t||"function"==typeof t)&&this.#v.set(t,e)}X(e){return"object"==typeof e&&null!==e||"function"==typeof e?this.#v.get(e):void 0}}let mt=1e3;const _t="autoDestroyDisabled";class vt extends $e{constructor(){super(),this.M=[],this.manager=new gt(this);const e=this,t=e.constructor,s=t.N,r=t.K.o,i=vt.prototype.shouldUpdate;e.#w=s?.H??new o,e.I=s?.I??new o,e.J=s?.J??[],e._offspring=e.J,e._postLoad=e.I,e.el=s??e,e.#A=e.enableUpdating,e.enableUpdating=st,e.shouldUpdate!==i&&(e.#S=e.shouldUpdate,e.shouldUpdate=i),r&&(e.#b=new Map,t.elementProperties.forEach((t,s)=>e.#b.set(s,r())))}static finalizeStyles(e){const t=super.finalizeStyles(e),s=this.shadowRootOptions===tt;return void 0===this.K?.commonStyles||s?t:[this.K.commonStyles,...t]}static createProperty(e,t){const s="number"==typeof t?t:Array.isArray(t)?t[0]:0,r=Array.isArray(t)?t[1]:void 0,i=r?.hasChanged??j,o={attribute:!!(1&s&&"string"==typeof e)&&(n=e,n.replace(y,(e,t)=>`${0===t?"":"-"}${e.toLowerCase()}`)),reflect:!!(2&s),type:4&s?Boolean:8&s?Number:void 0,state:!!(16&s),readOnly:!!(32&s),noAccessor:!!(64&s),c:!1,...r,hasChanged(e,t){const s=i(e,t);return o.c=s,s}};var n;super.createProperty(e,o)}static getPropertyDescriptor(e,t,s){const r=this.K,i=super.getPropertyDescriptor(e,t,s);return s.d=i,{...i,get(){return r.t?.(this.#b.get(e)),i.get?.call(this)},set(t){const r=this.manager;if(s.readOnly&&!ze&&(r.R||r.connectedCalled))throw Error(`Cannot assign to read-only property "${e}" of ${this.el.localName}. Trying to assign "${t}"`);i.set.call(this,t??void 0),s.c&&this.#b?.get(e)?.notify(),r.T.length>0&&r?.S(e,t)}}}static{this.lumina=!0}#b;#S;#A;#w;#k;connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const e=this.constructor.K.c?.(()=>this.requestUpdate());this.#k=e;const t=!this.manager.connectedCalled;super.connectedCallback(),t?queueMicrotask(()=>this.#I().catch(e=>{this.#w.reject(e),setTimeout(()=>{throw e})})):e&&this.requestUpdate()}#U(e){try{this.#k.clear(),this.constructor.K.r(this.#k,()=>super.update(e))}catch(e){throw this.#k.clear(),e}}disconnectedCallback(){super.disconnectedCallback(),this.#k?.destroy(),this.#k=void 0}createRenderRoot(){const e=this.el.shadowRoot,t=this.constructor,s=t.shadowRootOptions,r=e??(s===tt?this.el:this.el.attachShadow(s));if(e)return $e.prototype.createRenderRoot.call(this),e;if(this.isConnected){const e=r.getRootNode();e.adoptedStyleSheets=[...e.adoptedStyleSheets,...t.elementStyles.map(e=>"styleSheet"in e?e.styleSheet:e)]}return r}async#I(){const e=this.el.G??et(this.el);e&&await e;const t=[];for(const e of this.M)"triggerLoad"in e?t.push(e.triggerLoad()):t.push(l(e.hostLoad,e));await Promise.all(t),await(this.load?.()),this.manager.hasDestroy&&this.manager.onUpdate(e=>e.has(_t)&&this.manager.U()),this.#A(!0),this.performUpdate(),this.I.resolve(),await Promise.resolve();const s=this.J.filter(e=>!e.manager?.loadedCalled);s.length&&await Promise.allSettled(s.map(async e=>await e.componentOnReady())),this.J.length=0,this.el.setAttribute(this.constructor.K.hydratedAttribute,"");for(const e of this.M)"triggerLoaded"in e?e.triggerLoaded():a(e.hostLoaded,e);this.loaded?.(),this.#w.resolve()}shouldUpdate(e){return this.manager.Q=e,this.#S?.(e)??!0}update(e){this.#k?this.#U(e):super.update(e)}listen(e,t,s){const r=t?.bind(this)??t;this.manager.onLifecycle(()=>(this.el.addEventListener(e,r,s),()=>this.el.removeEventListener(e,r,s)))}listenOn(e,t,s,r){const i=s?.bind(this)??s;this.manager.onLifecycle(()=>(e.addEventListener(t,i,r),()=>e.removeEventListener(t,i,r)))}async componentOnReady(){return await this.#w.promise,this}addController(e){this.M.push(e),!(Pe in e)&&this.renderRoot&&this.el.isConnected&&e.hostConnected?.()}removeController(e){this.M.splice(this.M.indexOf(e),1),e.controllerRemoved?.()}}const yt=e=>"object"==typeof e&&null!=e?dt(e):e,wt=e=>"object"==typeof e&&null!=e?ft(e):e,At=de;function St(e,t,s){null==s?e.removeAttribute(t):e.setAttribute(t,s)}const bt={toAttribute:e=>!0===e?"":!1===e?null:e},kt="calcite-mode-auto",It="calcite-mode-dark",Ut={autoMode:kt,darkMode:It,lightMode:"calcite-mode-light",rtl:"calcite--rtl"},$t={filter:250,nextTick:0,resize:150,reposition:100},Ct=25;function Pt(){const{classList:e}=document.body,t=window.matchMedia("(prefers-color-scheme: dark)").matches,s=()=>e.contains(It)||e.contains(kt)&&t?"dark":"light",r=e=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:e}})),i=e=>{o!==e&&r(e),o=e};let o=s();r(o),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>i(e.matches?"dark":"light")),new MutationObserver(()=>i(s())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const Tt=globalThis.calciteConfig,xt=Tt?.focusTrapStack||[],Et=Tt?.logLevel||"info",Rt="3.2.1";"interactive"===document.readyState?Pt():document.addEventListener("DOMContentLoaded",()=>Pt(),{once:!0}),function(){if(Tt&&Tt.version)return;console.info(`Using Calcite Components ${Rt} [Date: 2025-05-29, Revision: 618973fec]`);const e=Tt||globalThis.calciteConfig||{};Object.defineProperty(e,"version",{value:Rt,writable:!1}),globalThis.calciteConfig=e}();const Ot=(e=>{let t;const s=e=>{t=new URL(e,globalThis.location?.href||void 0).href},r={...e,getAssetPath(e){const s=new URL(e,t);return s.origin!==globalThis.location?.origin?s.href:s.pathname},setAssetPath:s,customElement(e,t){t.K=r,t.L=e,customElements.get(e)||customElements.define(e,t)}};return s(e.defaultAssetPath),r})({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.2.1/",hydratedAttribute:"calcite-hydrated"}),{customElement:Mt,getAssetPath:Nt,setAssetPath:Lt}=Ot;let Dt,jt=!1;function qt(){var e;jt||(e=(0,i.s2)((0,r.g)("esri/widgets/support/components/assets")),jt=!0,Lt(e))}function Ht(e){const t=[];for(const s of Object.keys(e))customElements.get(`calcite-${s}`)||t.push(e[s]?.());return t.length>0?Promise.all(t):null}Dt="esri/widgets/support/components/assets"}}]);