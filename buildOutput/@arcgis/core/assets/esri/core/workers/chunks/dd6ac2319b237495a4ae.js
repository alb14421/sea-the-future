"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[7372],{4335:(t,e,s)=>{s.d(e,{d:()=>n});var r=s(32816),o=s(29298),i=(s(32773),s(20266),s(69421));s(36544),s(85176),s(93181),s(13671),s(40499),s(6407),s(59121),s(90740),s(84699),s(50704),s(91047),s(48064);const n=t=>{const e=t;let s=class extends e{constructor(){super(...arguments),this.customParameters=null}};return(0,r._)([(0,o.MZ)({type:Object,json:{write:{overridePolicy:t=>({enabled:!!(t&&Object.keys(t).length>0)})}}})],s.prototype,"customParameters",void 0),s=(0,r._)([(0,i.$)("esri.layers.mixins.CustomParametersMixin")],s),s}},8368:(t,e,s)=>{s.d(e,{A:()=>p});var r=s(32816),o=s(20266),i=s(29298),n=(s(32773),s(69421)),u=s(64604);const p=t=>{const e=t;let s=class extends e{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const t=(0,u.p)(this.url);if(t?.title)return t.title}return this._get("title")||""}set title(t){this._set("title",t)}set url(t){this._set("url",(0,u.s)(t,o.L.getLogger(this)))}};return(0,r._)([(0,i.MZ)()],s.prototype,"title",null),(0,r._)([(0,i.MZ)({type:String})],s.prototype,"url",null),s=(0,r._)([(0,n.$)("esri.layers.mixins.ArcGISService")],s),s}},38424:(t,e,s)=>{s.d(e,{A:()=>P});var r=s(32816),o=s(90740),i=s(29512),n=s(64604),u=s(73067),p=s(6407),a=s(20266),l=s(57732),c=s(80959),d=s(99063),y=s(29298),h=(s(32773),s(49877)),m=s(69421),g=s(56273),f=s(23916),v=s(82408),C=s(43059),I=s(24319),w=s(82454);s(59121),s(1178),s(41390),s(85176),s(93181),s(13671),s(50704),s(40499),s(36555),s(58498),s(91047),s(35819),s(45371),s(61532),s(36172),s(84699),s(19247),s(36544),s(48064),s(17745),s(81272),s(44945),s(93074),s(67321),s(99924),s(73509),s(28276),s(44600),s(2160),s(7969),s(69763),s(93804),s(96221),s(18683),s(64752),s(48844),s(29208),s(59192),s(91658),s(70580),s(75191),s(89935),s(49813),s(62092),s(88321),s(2589),s(36533),s(84200),s(97827),s(18169),s(20762),s(48402),s(16699),s(67504),s(47387),s(46728),s(21632),s(64102);const P=t=>{const e=t;let P=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,l.d)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(t){t!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",t))}readPortalItem(t,e,s){if(e.itemId)return new C.default({id:e.itemId,portal:s?.portal})}writePortalItem(t,e){t?.id&&(e.itemId=t.id)}async loadFromPortal(t,e){if(this.portalItem?.id)try{const{load:r}=await s.e(4295).then(s.bind(s,24295));return(0,c.Te)(e),await r({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData,layerModuleTypeMap:t.layerModuleTypeMap,populateGroupLayer:t.populateGroupLayer},e)}catch(t){throw(0,c.zf)(t)||a.L.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${t}`),t}}async finishLoadEditablePortalLayer(t){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(t).catch(t=>((0,c.QP)(t),!0)))}async setUserPrivileges(t,e){if(!o.A.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(e);if(this.url)try{const{features:{edit:s,fullEdit:r},content:{updateItem:o}}=await this._fetchUserPrivileges(t,e);this._set("userHasEditingPrivileges",s),this._set("userHasFullEditingPrivileges",r),this._set("userHasUpdateItemPrivileges",o)}catch(t){(0,c.QP)(t)}}async _fetchUserPrivileges(t,e){let s=this.portalItem;if(!t||!s||!s.loaded||s.sourceUrl)return this._fetchFallbackUserPrivileges(e);const r=!i.id?.findCredential(this.url),o=t===s.id;if(o&&s.portal.user)return this._getUserPrivileges(s,r);let n,u;if(o)n=s.portal.url;else try{n=await(0,f.h)(this.url,e)}catch(t){(0,c.QP)(t)}if(!n||!(0,d.b8)(n,s.portal.url))return this._fetchFallbackUserPrivileges(e);try{const t=null!=e?e.signal:null;u=await(i.id?.getCredential(`${n}/sharing`,{prompt:!1,signal:t}))}catch(t){(0,c.QP)(t)}const p=!0,a=!1,l=!1;if(!u)return{features:{edit:p,fullEdit:a},content:{updateItem:l}};try{if(o?await s.reload():(s=new C.default({id:t,portal:{url:n}}),await s.load(e)),s.portal.user)return this._getUserPrivileges(s,r)}catch(t){(0,c.QP)(t)}return{features:{edit:p,fullEdit:a},content:{updateItem:l}}}_getUserPrivileges(t,e){const s=(0,w.g)(t);return e&&(s.features.edit=!0),s}async _fetchFallbackUserPrivileges(t){let e=!0;try{e=await this._fetchUserHasEditingPrivileges(t)}catch(t){(0,c.QP)(t)}return{features:{edit:e,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(t){const e=this.url?i.id?.findCredential(this.url):null;if(!e)return!0;const s=S.credential===e?S.user:await this._fetchEditingUser(t);return S.credential=e,S.user=s,null==s?.privileges||s.privileges.includes("features:user:edit")}async _fetchEditingUser(t){const e=this.portalItem?.portal?.user;if(e)return e;const s=i.id?.findServerInfo(this.url??"");if(!s?.owningSystemUrl)return null;const r=`${s.owningSystemUrl}/sharing/rest`,o=v.A.getDefault();if(o&&o.loaded&&(0,d.S8)(o.restUrl)===(0,d.S8)(r))return o.user;const p=`${r}/community/self`,a=null!=t?t.signal:null,l=await(0,u.r)((0,n.A)(p,{authMode:"no-prompt",query:{f:"json"},signal:a}));return l.ok?I.A.fromJSON(l.value.data):null}read(t,e){e&&(e.layer=this),super.read(t,e)}write(t,e){const s=e?.portal,r=this.portalItem?.id&&(this.portalItem.portal||v.A.getDefault());return s&&r&&!(0,d.ut)(r.restUrl,s.restUrl)?(e.messages&&e.messages.push(new p.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(t,{...e,layer:this})}};return(0,r._)([(0,y.MZ)({type:C.default})],P.prototype,"portalItem",null),(0,r._)([(0,h.r)("web-document","portalItem",["itemId"])],P.prototype,"readPortalItem",null),(0,r._)([(0,g.w)("web-document","portalItem",{itemId:{type:String}})],P.prototype,"writePortalItem",null),(0,r._)([(0,y.MZ)({clonable:!1})],P.prototype,"resourceReferences",void 0),(0,r._)([(0,y.MZ)({type:Boolean,readOnly:!0})],P.prototype,"userHasEditingPrivileges",void 0),(0,r._)([(0,y.MZ)({type:Boolean,readOnly:!0})],P.prototype,"userHasFullEditingPrivileges",void 0),(0,r._)([(0,y.MZ)({type:Boolean,readOnly:!0})],P.prototype,"userHasUpdateItemPrivileges",void 0),P=(0,r._)([(0,m.$)("esri.layers.mixins.PortalLayer")],P),P},S={credential:null,user:null}},61904:(t,e,s)=>{s.d(e,{b:()=>F,g:()=>h});var r=s(32773),o=s(64604),i=s(80488);function n(t,e,s){return!!p(t,e,s)}function u(t,e,s){return p(t,e,s)}function p(t,e,s){return t&&t.hasOwnProperty(e)?t[e]:s}const a={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function l(t){const e=t?.supportedSpatialAggregationStatistics?.map(t=>t.toLowerCase());return{envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function c(t,e){const s=t?.supportedOperationsWithCacheHint?.map(t=>t.toLowerCase());return!!s?.includes(e.toLowerCase())}function d(t){const e=t?.supportedStatisticTypes?.map(t=>t.toLowerCase());return{count:!!e?.includes("count"),sum:!!e?.includes("sum"),min:!!e?.includes("min"),max:!!e?.includes("max"),avg:!!e?.includes("avg"),var:!!e?.includes("var"),stddev:!!e?.includes("stddev"),percentileContinuous:!!e?.includes("percentile_cont"),percentileDiscrete:!!e?.includes("percentile_disc"),envelope:!!e?.includes("envelopeaggregate"),centroid:!!e?.includes("centroidaggregate"),convexHull:!!e?.includes("convexhullaggregate")}}function y(t){const e=t?.supportedNormalizationTypes?.map(t=>t.toLowerCase());return{field:!!e?.includes("field"),log:!!e?.includes("log"),naturalLog:!!e?.includes("naturallog"),percentOfTotal:!!e?.includes("percentoftotal"),squareRoot:!!e?.includes("squareroot")}}function h(t,e){return{analytics:m(t),attachment:g(t),data:f(t),metadata:v(t),operations:C(t.capabilities,t,e),query:I(t,e),queryAttributeBins:S(t),queryRelated:w(t),queryTopFeatures:P(t),editing:A(t)}}function m(t){return{supportsCacheHint:c(t.advancedQueryCapabilities,"queryAnalytics")}}function g(t){const e=t.attachmentProperties,s={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:c(t.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:n(t.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:n(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach(t=>{const e=a[t.name];e&&(s[e]=!!t.isEnabled)}),s}function f(t){return{isVersioned:n(t,"isDataVersioned",!1),isBranchVersioned:n(t,"isDataBranchVersioned",!1),supportsAttachment:n(t,"hasAttachments",!1),supportsM:n(t,"hasM",!1),supportsZ:n(t,"hasZ",!1)}}function v(t){return{supportsAdvancedFieldProperties:n(t,"supportsFieldDescriptionProperty",!1)}}function C(t,e,s){const r=t?.toLowerCase().split(",").map(t=>t.trim())??[],i=s?(0,o.p)(s):null,u=r.includes("MapServer"===i?.serverType?"data":"query"),p=r.includes("editing")&&!e.datesInUnknownTimezone&&!(!0===e.uniqueIdInfo?.OIDFieldContainsHashValue);let a=p&&r.includes("create"),l=p&&r.includes("delete"),c=p&&r.includes("update");const d=r.includes("changetracking"),y=e.advancedQueryCapabilities;return p&&!(a||l||c)&&(a=l=c=!0),{supportsCalculate:n(e,"supportsCalculate",!1),supportsTruncate:n(e,"supportsTruncate",!1),supportsValidateSql:n(e,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:l,supportsEditing:p,supportsChangeTracking:d,supportsQuery:u,supportsQueryAnalytics:n(y,"supportsQueryAnalytic",!1),supportsQueryAttachments:n(y,"supportsQueryAttachments",!1),supportsQueryBins:n(y,"supportsQueryBins",!1)||!!e.queryBinsCapabilities,supportsQueryTopFeatures:n(y,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:n(e,"supportsAttachmentsResizing",!1),supportsSync:r.includes("sync"),supportsUpdate:c,supportsExceedsLimitStatistics:n(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:n(e,"supportsAsyncConvert3D",!1)}}function I(t,e){const s=t.advancedQueryCapabilities,p=t.ownershipBasedAccessControlForFeatures,a=t.archivingInfo,d=t.currentVersion,y=e?.includes("MapServer"),h=!y||d>=(0,r.h)("mapserver-pbf-version-support"),m=(0,o.i)(e),g=new Set((t.supportedQueryFormats??"").split(",").map(t=>t.toLowerCase().trim()));return{maxRecordCount:u(t,"maxRecordCount",void 0),maxRecordCountFactor:u(t,"maxRecordCountFactor",void 0),maxUniqueIDCount:u(t,"maxUniqueIDCount",void 0),standardMaxRecordCount:u(t,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:l(s),supportsCacheHint:n(s,"supportsQueryWithCacheHint",!1)||c(s,"query"),supportsCentroid:n(s,"supportsReturningGeometryCentroid",!1),supportsCompactGeometry:m,supportsCurrentUser:n(s,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:n(s,"supportsDefaultSR",!1),supportsDisjointSpatialRelationship:n(s,"supportsDisjointSpatialRel",!1),supportsDistance:n(s,"supportsQueryWithDistance",!1),supportsDistinct:n(s,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:n(s,"supportsReturningQueryExtent",!1),supportsFormatPBF:h&&g.has("pbf"),supportsFullTextSearch:n(s,"supportsFullTextSearch",!1),supportsGeometryProperties:n(s,"supportsReturningGeometryProperties",!1),supportsHavingClause:n(s,"supportsHavingClause",!1),supportsHistoricMoment:n(a,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:n(s,"supportsMaxRecordCountFactor",!1),supportsOrderBy:n(s,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:n(s,"supportsPagination",!1),supportsPaginationOnAggregatedQueries:n(s,"supportsPaginationOnAggregatedQueries",!1),supportsPercentileStatistics:n(s,"supportsPercentileStatistics",!1),supportsQuantization:n(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:n(t,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:n(p,"allowAnonymousToQuery",!0),supportsQueryByOthers:n(p,"allowOthersToQuery",!0),supportsQueryGeometry:n(t,"supportsReturningQueryGeometry",!1),supportsResultType:n(s,"supportsQueryWithResultType",!1),supportsReturnMesh:!!(0,i.c)(t.infoFor3D),supportsSpatialAggregationStatistics:n(s,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:n(s,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:n(t,"useStandardizedQueries",!1),supportsStatistics:n(s,"supportsStatistics",t.supportsStatistics),supportsTopFeaturesQuery:n(s,"supportsTopFeaturesQuery",!1),supportsTrueCurve:n(s,"supportsTrueCurve",!1),tileMaxRecordCount:u(t,"tileMaxRecordCount",void 0)}}function w(t){const e=t.advancedQueryCapabilities,s=n(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:n(e,"supportsQueryRelatedPagination",!1),supportsCount:s,supportsOrderBy:s,supportsCacheHint:c(e,"queryRelated")}}function P(t){return{supportsCacheHint:c(t.advancedQueryCapabilities,"queryTopFilter")}}function S(t){const e=t?t.queryBinsCapabilities:void 0;return{supportsDate:n(e,"supportsDateBin",!1),supportsFixedInterval:n(e,"supportsFixedIntervalBin",!1),supportsAutoInterval:n(e,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:n(e,"supportsFixedBoundariesBin",!1),supportsStackBy:n(e,"supportsStackBy",!1),supportsSplitBy:n(e,"supportsSplitBy",!1),supportsSnapToData:n(e,"supportsSnapToData",!1),supportsReturnFullIntervalBin:n(e,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:n(e,"supportsFirstDayOfWeek",!1),supportsNormalization:n(e,"supportsNormalization",!1),supportedStatistics:d(e),supportedNormalizationTypes:y(e)}}function A(t){const e=t.ownershipBasedAccessControlForFeatures,s=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:n(t,"allowGeometryUpdates",!0),supportsGlobalId:n(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:n(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:n(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:n(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:n(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:n(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:n(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:n(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:n(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:n(s,"supportsAsyncApplyEdits",!1),zDefault:u(t,"zDefault",void 0)}}function F(t){return{operations:{supportsAppend:n(t,"supportsAppend",!1),supportsCoverageQuery:t?.playbackInfo?.klv["0601"]??!1,supportsExportClip:n(t,"supportsExportClip",!1),supportsExportFrameset:n(t,"supportsExportFrameset",!1),supportsMensuration:n(t,"supportsMensuration",!1),supportsPreviews:n(t,"supportsPreviews",!1),supportsUpdate:n(t,"supportsUpdate",!1)}}}},80488:(t,e,s)=>{s.d(e,{a:()=>l,b:()=>I,c:()=>y,d:()=>p,f:()=>m,g:()=>a,h:()=>h,i:()=>d,j:()=>c,k:()=>n,l:()=>i,m:()=>o});const r=[["binary","application/octet-stream","bin",""]];function o(t,e){return null!=f(e.name,t?.supportedFormats??[])}function i(t,e){if(!t)return!1;const s=a(e,t.supportedFormats??[]);return null!=s&&t.editFormats.includes(s)}function n(t,e){return v(function(t,e){const s=t.toLowerCase();return g(e).find(t=>C(t)===s)}(t,e))}function u(t,e){return v(f(t,e))}function p(t,e){return C(function(t,e){return g(e).find(e=>v(e)===t)}(t,e))}function a(t,e){return u(t.name,e)??n(t.type,e)}function l(t,e,s){return n(t,s)??u(e,s)}function c({supportedFormats:t}){return l("model/gltf-binary","glb",t)}function d(t){const e=c(t);return null!=e&&t.editFormats.includes(e)}function y(t){if(!t)return null;const e=c(t),s=function({supportedFormats:t}){return l("model/gltf+json","gltf",t)}(t);let r=null;for(const o of t.queryFormats){if(o===e)return o;o===s&&(r=o)}return r}function h({supportedFormats:t}){return l("application/esri3do-SR_world","wld",t)}function m({supportedFormats:t}){return l("application/esri3do-SR_prj","prj",t)}function g(t){return[...r,...t]}function f(t,e){const s=t.toLowerCase();return g(e).find(t=>function(t){return t?.[2].split(",").map(t=>t.toLowerCase())??[]}(t).some(t=>s.endsWith(t)))}function v(t){return t?.[0]}function C(t){return t?.[1].toLowerCase()}function I(t){return t.tables?.find(t=>"assetMaps"===t.role)}}}]);