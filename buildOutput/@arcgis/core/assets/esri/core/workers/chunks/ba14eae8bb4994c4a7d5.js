"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[99],{20527:(e,t,r)=>{r.d(t,{R:()=>n});var s=r(91047),i=r(44945);class n{constructor(e){this._observable=new i.S,this._map=new Map(e)}get size(){return(0,s.t)(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const t=this._map.delete(e);return t&&this._observable.notify(),t}entries(){return(0,s.t)(this._observable),this._map.entries()}forEach(e,t){(0,s.t)(this._observable),this._map.forEach((r,s)=>e.call(t,r,s,this),t)}get(e){return(0,s.t)(this._observable),this._map.get(e)}has(e){return(0,s.t)(this._observable),this._map.has(e)}keys(){return(0,s.t)(this._observable),this._map.keys()}set(e,t){return this._map.set(e,t),this._observable.notify(),this}values(){return(0,s.t)(this._observable),this._map.values()}[Symbol.iterator](){return(0,s.t)(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}}},41003:(e,t,r)=>{r.d(t,{Q:()=>n});var s=r(91047),i=r(44945);class n{constructor(e=e=>e.values().next().value){this._peeker=e,this._observable=new i.S,this._items=new Set}get length(){return(0,s.t)(this._observable),this._items.size}clear(){0!==this.length&&(this._items.clear(),this._observable.notify())}last(){if(0===this.length)return;let e;for(e of this._items);return e}peek(){if(0!==this.length)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return(0,s.t)(this._observable),this._items.has(e)}pop(){if(0===this.length)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(0===this.length)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const t=this.length;return this._items.forEach(t=>{e(t)||this._items.delete(t)}),t!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){(0,s.t)(this._observable),yield*this._items}}},45681:(e,t,r)=>{function s(e,{timeZone:t,timeExtent:r}){return{$view:{scale:e,timeZone:t,timeProperties:{currentStart:r?.start,currentEnd:r?.end}}}}r.d(t,{c:()=>s})},47334:(e,t,r)=>{r.d(t,{G:()=>l,g:()=>y});var s=r(32773),i=r(84200),n=r(77037),o=r(96153),a=r(48402),h=r(20762),u=r(97827),_=r(44600);class l{static fromOptimized(e,t,r=!1,s=!1,i=1){return(new c).initialize(e,t,r,s,i)}static fromJSON(e,t=!1,r=!1){const[s,i]=f(e);return(new p).initialize(s,i,t,r,1)}static fromOptimizedCIM(e,t,r=!1,s=!1,i=1){return(new g).initialize(e,t,r,s,i)}static fromJSONCIM(e,t=!1,r=!1,s=1){const[i,n]=f(e);return(new m).initialize(i,n,t,r,s)}static fromFeatureSetReader(e){const t=e.readGeometryForDisplay(),r=e.geometryType;return t&&r?this.fromOptimized(t,r):null}static fromFeatureSetReaderCIM(e){const t=e.readGeometryForDisplay(),r=e.geometryType;return t&&r?this.fromOptimizedCIM(t,r):null}static createEmptyOptimized(e,t=!1,r=!1,s=1){return(new c).initialize(new o.O,e,t,r,s)}static createEmptyJSON(e,t=!1,r=!1){return(new p).initialize([],e,t,r,1)}static createEmptyOptimizedCIM(e,t=!1,r=!1,s=1){return(new g).initialize(new o.O,e,t,r,s)}static createEmptyJSONCIM(e,t=!1,r=!1,s=1){return(new m).initialize([],e,t,r,s)}asJSON(){const e=(0,i.c)(this);return"esriGeometryEnvelope"===this.geometryType?{xmin:e[0][0][0],ymin:e[0][0][1],xmax:e[0][2][0],ymax:e[0][2][1]}:"esriGeometryMultipoint"===this.geometryType?{points:e.flat()}:"esriGeometryPoint"===this.geometryType?{x:e[0][0][0],y:e[0][0][1]}:"esriGeometryPolygon"===this.geometryType?{rings:e}:{paths:e}}getCurrentRingArea(){if(this.pathSize<3)return 0;let e,t,r=0;if(this.seekPathStart(),!this.nextPoint())return 0;e=this.x,t=this.y;const s=e,i=t;for(;this.nextPoint();)r+=(e-this.x)*(t+this.y),e=this.x,t=this.y;return r+=(e-s)*(t+i),-.5*r}invertY(){this.yFactor*=-1}}class c extends l{constructor(){super(...arguments),this._end=-1}initialize(e,t,r,s,i){return this.hasZ=r,this.hasM=s,this.geometryType=t,this._stride=2+Number(r)+Number(s),this._geometry=e,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=i,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(e){if(e>=0&&e<this.totalSize){if(this._pathIndex<e)for(;this._pathIndex<e&&this.nextPath(););else if(this._pathIndex>e)for(;this._pathIndex>e&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(e){const t=this._pathOffset+e*this._stride;return t>=0&&t<this._end&&(this._pointOffset=t,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){return!(this.pathIndex>=this.totalSize-1||(this._pathIndex>=0&&(this._pathOffset+=this._stride*this.pathSize),this._pathIndex++,this._pointOffset=this._pathOffset-this._stride,this._end=this._pointOffset+this._stride+this._stride*this.pathSize,0))}prevPath(){return!(this.pathIndex<=0||(this._pathIndex--,this._end=this._pathOffset,this._pathOffset-=this._stride*this.pathSize,this._pointOffset=this._pathOffset-this._stride,0))}getCurrentPath(){const e=this._end,t=this._geometry.coords,r=this._pathOffset;return(new c).initialize(new o.O([this.pathSize],t.slice(r,e)),this.geometryType,this.hasZ,this.hasM,this.yFactor)}pathLength(){const e=this._end,t=this._stride,r=this._geometry.coords;let s=0;for(let i=this._pathOffset+t;i<e;i+=t){const e=r[i-t],n=r[i-t+1],o=r[i]-e,a=r[i+1]-n;s+=Math.sqrt(o*o+a*a)}return s}startPath(){this._geometry.lengths.push(0)}pushPath(e){this.startPath(),this.pushPoints(e)}pushPoint(e){for(let t=0;t<this._stride;++t)this._geometry.coords.push(e[t]);this._geometry.lengths[this.totalSize-1]++}pushXY(e,t){this._geometry.coords.push(e,t),this._geometry.lengths[this.totalSize-1]++}pushPoints(e){for(const t of e)for(let e=0;e<this._stride;++e)this._geometry.coords.push(t[e]);this._geometry.lengths[this.totalSize-1]+=e.length}pushCursor(e){const t=e.asOptimized();this._geometry.coords.push(...t.coords),this._geometry.lengths.push(...t.lengths)}asOptimized(){const e=this._geometry.clone();if(1!==this.yFactor)for(let t=1;t<e.coords.length;t+=this._stride)e.coords[t]*=this.yFactor;return"esriGeometryPoint"===this.geometryType&&(e.lengths.length=0),e}isClosed(){const e=this._geometry.coords,t=this._pathOffset,r=this._end-this._stride;for(let s=0;s<this._stride;s++)if(e[t+s]!==e[r+s])return!1;return!0}clone(){return(new c).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.isPoint?1:this._geometry.lengths.reduce((e,t)=>e+t)}get pathSize(){const{lengths:e}=this._geometry;return this._geometry.isPoint?1:this._pathIndex<0||this._pathIndex>e.length-1?0:e[this._pathIndex]}get totalSize(){return this._geometry.isPoint?1:this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(e){this._geometry.coords[this._pointOffset]=e}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(e){this._geometry.coords[this._pointOffset+1]=this.yFactor*e}get z(){return this._geometry.coords[this._pointOffset+2]}set z(e){this._geometry.coords[this._pointOffset+2]=e}get m(){const e=this.hasZ?3:2;return this._geometry.coords[this._pointOffset+e]}set m(e){this._geometry.coords[this._pointOffset+3]=e}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}}function d(e){const t=[e.x,e.y];return e.z&&t.push(e.z),e.m&&t.push(e.m),t}function f(e){return(0,n.Bi)(e)?[e.rings,"esriGeometryPolygon"]:(0,n.Rg)(e)?[e.paths,"esriGeometryPolyline"]:(0,n.U9)(e)?[[e.points],"esriGeometryMultipoint"]:(0,n.ZC)(e)?[[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]],"esriGeometryEnvelope"]:(0,n.fT)(e)?[[[d(e)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}class p extends l{initialize(e,t,r,s,i){return this._paths=e,this.geometryType=t,this.hasZ=r,this.hasM=s,this._pathIndex=this._pointIndex=-1,this.yFactor=i,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(e){return this._pathIndex=e,this._pointIndex=-1,e>=0&&e<this.totalSize&&(this._currentPath=this._paths[e],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(e){return e>=0&&e<this._currentPath.length&&(this._pointIndex=e,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this.pathIndex>0&&(this._pointIndex=-1,this._pathIndex--,this._currentPath=this._paths[this._pathIndex],!0)}pathLength(){const e=this._currentPath.length,t=this._currentPath;let r=0;for(let s=1;s<e;s++){const e=t[s-1],i=t[s],n=e[0],o=e[1],a=i[0]-n,h=i[1]-o;r+=Math.sqrt(a*a+h*h)}return r}startPath(){this._paths.push([])}getCurrentPath(){return(new p).initialize([this._currentPath],this.geometryType,this.hasZ,this.hasM,this.yFactor)}pushPath(e){this._paths.push(e)}pushPoint(e){this._paths[this.totalSize-1].push(e)}pushXY(e,t){this._paths[this.totalSize-1].push([e,t])}pushPoints(e){this._paths[this.totalSize-1].push(...e)}pushCursor(e){const t=(0,i.c)(e);for(const e of t)this.pushPath(e)}asOptimized(){const e=new o.O;if("esriGeometryPoint"===this.geometryType)e.coords.push(...this._paths[0][0]),e.lengths.length=0;else for(const t of this._paths){for(const r of t)e.coords.push(r[0]),e.coords.push(r[1]*this.yFactor),this.hasZ&&e.coords.push(r[2]),this.hasM&&e.coords.push(r[this._mIndex]);e.lengths.push(t.length)}return e}isClosed(){const e=this._currentPath[0],t=this._currentPath[this._currentPath.length-1];for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}clone(){return(new p).initialize((0,s.o8)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map(e=>e.length).reduce((e,t)=>e+t)}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(e){this._currentPoint[0]=e}get y(){return this.yFactor*this._currentPoint[1]}set y(e){this._currentPoint[1]=this.yFactor*e}get z(){return this._currentPoint[2]}set z(e){this._currentPoint[2]=e}get m(){return this._currentPoint[this._mIndex]}set m(e){this._currentPoint[this._mIndex]=e}get pathIndex(){return this._pathIndex}}class g extends c{initialize(e,t,r,s,i){return super.initialize(e,t,r,s,i),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map(e=>new Set)),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const e=(new g).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return e._controlPoints=this._controlPoints,e}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(e){this._controlPoints[this.pathIndex].add(e)}getControlPointAt(e){return this._controlPoints[this.pathIndex].has(e)}}class m extends p{initialize(e,t,r,s,i){return super.initialize(e,t,r,s,i)}clone(){return(new m).initialize((0,s.o8)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][4]=1}getControlPoint(){return 1===this._paths[this.pathIndex][this._pointIndex][4]}setControlPointAt(e){this._paths[this.pathIndex][e][4]=1}getControlPointAt(e){return 1===this._paths[this.pathIndex][e][4]}}function y(e){if(0===e.totalSize)return null;const t=(0,h.d)(e);if(!t)return null;const r=4*(Math.abs(t[0])+Math.abs(t[2])+Math.abs(t[1])+Math.abs(t[3])+1)*222045e-19;let s=0,n=0;e.reset();for(let t=0;e.nextPath();t++){const r=e.getCurrentRingArea();r>n&&(n=r,s=t)}if(e.seekPath(s),0===e.pathSize)return null;e.seekPathStart();const o=(0,h.e)(e);if(Math.abs(n)<=2*r*r)return[(o[0]+o[2])/2,(o[1]+o[3])/2];e.seekPathStart();const u=(0,i.r)(e,(0,a.c)());if(null===u)return null;if(e.totalPoints<4)return u;const _=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],l=[NaN,NaN,NaN,NaN],c=[NaN,NaN,NaN,NaN];let d=!1,f=w(u,e,!0);0===f.distance&&(d=!0,_[0][0]=u[0],_[0][1]=u[1],f=w(u,e,!1)),l[0]=f.distance,c[0]=0;const p=[NaN,NaN];let g=!1,m=.25,y=-1,I=NaN;do{if(I=NaN,_[1]=x(e,k(o[0],o[2],m),0,t),isNaN(_[1][0])||isNaN(_[1][1])||(f=w(_[1],e,!1),I=f.distance),!isNaN(I)&&I>r&&b(_[1],e))g=!0,l[1]=I,c[1]=P(_[1],u);else if(!isNaN(I)&&I>y&&(y=I,p[0]=_[1][0],p[1]=_[1][1]),m-=.01,m<.1){if(!(y>=0))break;g=!0,l[1]=y,_[1][0]=p[0],_[1][1]=p[1],c[1]=P(_[1],u)}}while(!g);g=!1,m=.5,y=-1;let v=.01,T=1;do{if(I=NaN,_[2]=x(e,k(o[0],o[2],m),0,t),isNaN(_[2][0])||isNaN(_[2][1])||(f=w(_[2],e,!1),I=f.distance),!isNaN(I)&&I>r&&b(_[2],e))g=!0,l[2]=I,c[2]=P(_[2],u);else if(!isNaN(I)&&I>y)y=I,p[0]=_[2][0],p[1]=_[2][1];else if(I>y&&(y=I,p[0]=_[2][0],p[1]=_[2][1]),m=.5+v*T,v+=.01,T*=-1,m<.3||m>.7){if(!(y>=0))break;g=!0,l[2]=y,_[2][0]=p[0],_[2][1]=p[1],c[2]=P(_[2],u)}}while(!g);g=!1,m=.75,y=-1;do{if(I=NaN,_[3]=x(e,k(o[0],o[2],m),0,t),isNaN(_[3][0])||isNaN(_[3][1])||(f=w(_[3],e,!1),I=f.distance),!isNaN(I)&&I>r&&b(_[3],e))g=!0,l[3]=I,c[3]=P(_[3],u);else if(I>y&&(y=I,p[0]=_[3][0],p[1]=_[3][1]),m+=.01,m>.9){if(!(y>=0))break;g=!0,l[3]=y,_[3][0]=p[0],_[3][1]=p[1],c[3]=P(_[3],u)}}while(!g);const F=[0,1,2,3],S=d?0:1;let M;for(let e=S;e<4;e++)for(let e=S;e<3;e++){const t=c[e],r=c[e+1];A(t,r)>0&&(M=F[e],F[e]=F[e+1],F[e+1]=M,c[e]=r,c[e+1]=t)}let O=S,z=0,C=0;for(let e=S;e<4;e++){switch(e){case 0:C=2*l[F[e]];break;case 1:C=1.66666666*l[F[e]];break;case 2:C=1.33333333*l[F[e]];break;case 3:C=l[F[e]]}C>z&&(z=C,O=F[e])}return _[O]}function b(e,t){let r,s,i,n,o=0;for(t.reset();t.nextPath()&&t.nextPoint();)for(r=t.x,s=t.y;t.nextPoint();r=i,s=n)i=t.x,n=t.y,s>e[1]!=n>e[1]&&((i-r)*(e[1]-s)-(n-s)*(e[0]-r)>0?o++:o--);return 0!==o}function w(e,t,r){if(r&&b(e,t))return{coord:e,distance:0};let s=1/0,i=0,n=0,o=[0,0],a=[0,0];const h=[0,0];for(t.reset();t.nextPath()&&t.nextPoint();)if(!(t.pathSize<2))for(o[0]=t.x,o[1]=t.y;t.nextPoint();o=a){a=[t.x,t.y],(0,u.p)(h,e,o,a);const r=P(e,h);r<s&&(s=r,i=h[0],n=h[1])}return{coord:[i,n],distance:Math.sqrt(s)}}function x(e,t,r,s){const i=[t,0];let n=1/0,o=1/0,h=!1,u=!1;const l=[[t,s[1]-1],[t,s[3]+1]],c=[0,0],d=[0,0],f=[0,0],p=[[0,0],[0,0]],g=(0,a.c)();for(e.reset();e.nextPath()&&e.nextPoint();)if(!(e.pathSize<2))for(p[0][0]=e.x,p[0][1]=e.y;e.nextPoint();p[0][0]=p[1][0],p[0][1]=p[1][1]){if(p[1][0]=e.x,p[1][1]=e.y,null===I(g,p))continue;if(d[0]=l[0][0],d[1]=l[0][1],f[0]=l[1][0],f[1]=l[1][1],0===M(g,d,f))continue;if(!(0,_.s)(l[0],l[1],p[0],p[1],c))continue;const t=c[1];n>o?t<n&&(n=t,h=!0):t<o&&(o=t,u=!0)}return h&&u?i[1]=(n+o)/2:i[0]=i[1]=NaN,i}function I(e,t){if(t.length<2)return null;e||(e=(0,a.c)());const[r,s]=t[0],[i,n]=t[1];return e[0]=Math.min(r,i),e[1]=Math.min(s,n),e[2]=Math.max(r,i),e[3]=Math.max(s,n),e}const v=1,T=4,F=3,S=12;function M(e,t,r){let s=O(t,e),i=O(r,e);const n=e[0],o=e[1],a=e[2],h=e[3];if(s&i)return 0;if(!(s|i))return 4;const u=(s?1:0)|(i?2:0);do{const u=r[0]-t[0],_=r[1]-t[1];if(u>_)s&F?(s&v?(t[1]+=_*(n-t[0])/u,t[0]=n):(t[1]+=_*(a-t[0])/u,t[0]=a),s=O(t,e)):i&F?(i&v?(r[1]+=_*(n-r[0])/u,r[0]=n):(r[1]+=_*(a-r[0])/u,r[0]=a),i=O(r,e)):s?(s&T?(t[0]+=u*(o-t[1])/_,t[1]=o):(t[0]+=u*(h-t[1])/_,t[1]=h),s=O(t,e)):(i&T?(r[0]+=u*(o-r[1])/_,r[1]=o):(r[0]+=u*(h-r[1])/_,r[1]=h),i=O(r,e));else if(s&S?(s&T?(t[0]+=u*(o-t[1])/_,t[1]=o):(t[0]+=u*(h-t[1])/_,t[1]=h),s=O(t,e)):i&S?(i&T?(r[0]+=u*(o-r[1])/_,r[1]=o):(r[0]+=u*(h-r[1])/_,r[1]=h),i=O(r,e)):s?(s&v?(t[1]+=_*(n-t[0])/u,t[0]=n):(t[1]+=_*(a-t[0])/u,t[0]=a),s=O(t,e)):(i&v?(r[1]+=_*(n-r[0])/u,r[0]=n):(r[1]+=_*(a-r[0])/u,r[0]=a),i=O(r,e)),s&i)return 0}while(s|i);return u}function O(e,t){return(e[0]<t[0]?1:0)|(e[0]>t[2]?1:0)<<1|(e[1]<t[1]?1:0)<<2|(e[1]>t[3]?1:0)<<3}function k(e,t,r){return e+(t-e)*r}function P(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}function A(e,t){if(e<t)return-1;if(e>t)return 1;if(e===t)return 0;const r=isNaN(e),s=isNaN(t);return r<s?-1:r>s?1:0}},56988:(e,t,r)=>{r.d(t,{r:()=>i});var s=r(32159);function i(e,t){if(!(this instanceof i))return new i(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this.toBBox=t:this._initFormat(t)),this.clear()}function n(e,t,r){if(!r)return t.indexOf(e);for(var s=0;s<t.length;s++)if(r(e,t[s]))return s;return-1}function o(e,t){a(e,0,e.children.length,t,e)}function a(e,t,r,s,i){i||(i=m(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var n,o=t;o<r;o++)n=e.children[o],h(i,e.leaf?s(n):n);return i}function h(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function u(e,t){return e.minX-t.minX}function _(e,t){return e.minY-t.minY}function l(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function c(e){return e.maxX-e.minX+(e.maxY-e.minY)}function d(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function f(e,t){var r=Math.max(e.minX,t.minX),s=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),n=Math.min(e.maxY,t.maxY);return Math.max(0,i-r)*Math.max(0,n-s)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function g(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function m(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(e,t,r,i,n){for(var o,a=[t,r];a.length;)(r=a.pop())-(t=a.pop())<=i||(o=t+Math.ceil((r-t)/i/2)*i,(0,s.q)(e,o,t,r,n),a.push(t,o,o,r))}i.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,r=[],s=this.toBBox;if(!g(e,t))return r;for(var i,n,o,a,h=[];t;){for(i=0,n=t.children.length;i<n;i++)o=t.children[i],g(e,a=t.leaf?s(o):o)&&(t.leaf?r.push(o):p(e,a)?this._all(o,r):h.push(o));t=h.pop()}return r},collides:function(e){var t=this.data,r=this.toBBox;if(!g(e,t))return!1;for(var s,i,n,o,a=[];t;){for(s=0,i=t.children.length;s<i;s++)if(n=t.children[s],g(e,o=t.leaf?r(n):n)){if(t.leaf||p(e,o))return!0;a.push(n)}t=a.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var s=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===s.height)this._splitRoot(this.data,s);else{if(this.data.height<s.height){var i=this.data;this.data=s,s=i}this._insert(s,this.data.height-s.height-1,!0)}else this.data=s;return this},insert:function(e){return null!=e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(e,t){if(null==e)return this;for(var r,s,i,o,a=this.data,h=this.toBBox(e),u=[],_=[];a||u.length;){if(a||(a=u.pop(),s=u[u.length-1],r=_.pop(),o=!0),a.leaf&&-1!==(i=n(e,a.children,t)))return a.children.splice(i,1),u.push(a),this._condense(u),this;o||a.leaf||!p(a,h)?s?(r++,a=s.children[r],o=!1):a=null:(u.push(a),_.push(r),r=0,s=a,a=a.children[0])}return this},toBBox:function(e){return e},compareMinX:u,compareMinY:_,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},_build:function(e,t,r,s){var i,n=r-t+1,a=this._maxEntries;if(n<=a)return o(i=m(e.slice(t,r+1)),this.toBBox),i;s||(s=Math.ceil(Math.log(n)/Math.log(a)),a=Math.ceil(n/Math.pow(a,s-1))),(i=m([])).leaf=!1,i.height=s;var h,u,_,l,c=Math.ceil(n/a),d=c*Math.ceil(Math.sqrt(a));for(y(e,t,r,d,this.compareMinX),h=t;h<=r;h+=d)for(y(e,h,_=Math.min(h+d-1,r),c,this.compareMinY),u=h;u<=_;u+=c)l=Math.min(u+c-1,_),i.children.push(this._build(e,u,l,s-1));return o(i,this.toBBox),i},_chooseSubtree:function(e,t,r,s){for(var i,n,o,a,h,u,_,c;s.push(t),!t.leaf&&s.length-1!==r;){for(_=c=1/0,i=0,n=t.children.length;i<n;i++)h=l(o=t.children[i]),(u=d(e,o)-h)<c?(c=u,_=h<_?h:_,a=o):u===c&&h<_&&(_=h,a=o);t=a||t.children[0]}return t},_insert:function(e,t,r){var s=this.toBBox,i=r?e:s(e),n=[],o=this._chooseSubtree(i,this.data,t,n);for(o.children.push(e),h(o,i);t>=0&&n[t].children.length>this._maxEntries;)this._split(n,t),t--;this._adjustParentBBoxes(i,n,t)},_split:function(e,t){var r=e[t],s=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,s);var n=this._chooseSplitIndex(r,i,s),a=m(r.children.splice(n,r.children.length-n));a.height=r.height,a.leaf=r.leaf,o(r,this.toBBox),o(a,this.toBBox),t?e[t-1].children.push(a):this._splitRoot(r,a)},_splitRoot:function(e,t){this.data=m([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,r){var s,i,n,o,h,u,_,c;for(u=_=1/0,s=t;s<=r-t;s++)o=f(i=a(e,0,s,this.toBBox),n=a(e,s,r,this.toBBox)),h=l(i)+l(n),o<u?(u=o,c=s,_=h<_?h:_):o===u&&h<_&&(_=h,c=s);return c},_chooseSplitAxis:function(e,t,r){var s=e.leaf?this.compareMinX:u,i=e.leaf?this.compareMinY:_;this._allDistMargin(e,t,r,s)<this._allDistMargin(e,t,r,i)&&e.children.sort(s)},_allDistMargin:function(e,t,r,s){e.children.sort(s);var i,n,o=this.toBBox,u=a(e,0,t,o),_=a(e,r-t,r,o),l=c(u)+c(_);for(i=t;i<r-t;i++)n=e.children[i],h(u,e.leaf?o(n):n),l+=c(u);for(i=r-t-1;i>=t;i--)n=e.children[i],h(_,e.leaf?o(n):n),l+=c(_);return l},_adjustParentBBoxes:function(e,t,r){for(var s=r;s>=0;s--)h(t[s],e)},_condense:function(e){for(var t,r=e.length-1;r>=0;r--)0===e[r].children.length?r>0?(t=e[r-1].children).splice(t.indexOf(e[r]),1):this.clear():o(e[r],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},65892:(e,t,r)=>{r.d(t,{Q:()=>$,c:()=>ne,r:()=>oe});var s=r(64604),i=r(6407),n=r(18683);let o,a=null;function h(e){const t=o.__externref_table_alloc();return o.__wbindgen_export_2.set(t,e),t}function u(e,t){try{return e.apply(this,t)}catch(e){const t=h(e);o.__wbindgen_exn_store(t)}}Symbol.dispose||(Symbol.dispose=Symbol("Symbol.dispose"));const _="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&_.decode();let l=null;function c(){return null!==l&&0!==l.byteLength||(l=new Uint8Array(o.memory.buffer)),l}function d(e,t){return e>>>=0,_.decode(c().subarray(e,e+t))}let f=0;const p="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},g="function"==typeof p.encodeInto?function(e,t){return p.encodeInto(e,t)}:function(e,t){const r=p.encode(e);return t.set(r),{read:e.length,written:r.length}};function m(e,t,r){if(void 0===r){const r=p.encode(e),s=t(r.length,1)>>>0;return c().subarray(s,s+r.length).set(r),f=r.length,s}let s=e.length,i=t(s,1)>>>0;const n=c();let o=0;for(;o<s;o++){const t=e.charCodeAt(o);if(t>127)break;n[i+o]=t}if(o!==s){0!==o&&(e=e.slice(o)),i=r(i,s,s=o+3*e.length,1)>>>0;const t=c().subarray(i+o,i+s);o+=g(e,t).written,i=r(i,s,o,1)>>>0}return f=o,i}let y=null;function b(){return(null===y||!0===y.buffer.detached||void 0===y.buffer.detached&&y.buffer!==o.memory.buffer)&&(y=new DataView(o.memory.buffer)),y}function w(e){return null==e}const x="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>{o.__wbindgen_export_6.get(e.dtor)(e.a,e.b)});let I=null;function v(){return null!==I&&0!==I.byteLength||(I=new Float64Array(o.memory.buffer)),I}let T=null;function F(){return null!==T&&0!==T.byteLength||(T=new Uint32Array(o.memory.buffer)),T}function S(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`)}function M(e,t){e>>>=0;const r=b(),s=[];for(let i=e;i<e+4*t;i+=4)s.push(o.__wbindgen_export_2.get(r.getUint32(i,!0)));return o.__externref_drop_slice(e,t),s}function O(e,t){const r=t(8*e.length,8)>>>0;return v().set(e,r/8),f=e.length,r}function k(e,t){const r=t(4*e.length,4)>>>0;return F().set(e,r/4),f=e.length,r}function P(e,t,r){o.closure83_externref_shim(e,t,r)}const A=Object.freeze({Point:0,0:"Point",Polygon:1,1:"Polygon",Polyline:2,2:"Polyline",Multipoint:3,3:"Multipoint"}),z=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeBigInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"],C="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_columndescriptor_free(e>>>0,1));class N{static __wrap(e){e>>>=0;const t=Object.create(N.prototype);return t.__wbg_ptr=e,C.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,C.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_columndescriptor_free(e,0)}[Symbol.dispose](){this.free()}name(){let e,t;try{const r=o.columndescriptor_name(this.__wbg_ptr);return e=r[0],t=r[1],d(r[0],r[1])}finally{o.__wbindgen_free(e,t,1)}}physicalType(){let e,t;try{const r=o.columndescriptor_physicalType(this.__wbg_ptr);return e=r[0],t=r[1],d(r[0],r[1])}finally{o.__wbindgen_free(e,t,1)}}logicalType(){const e=o.columndescriptor_logicalType(this.__wbg_ptr);let t;return 0!==e[0]&&(t=d(e[0],e[1]).slice(),o.__wbindgen_free(e[0],1*e[1],1)),t}encodings(){const e=o.columndescriptor_encodings(this.__wbg_ptr);var t=M(e[0],e[1]).slice();return o.__wbindgen_free(e[0],4*e[1],4),t}pageEncodings(){const e=o.columndescriptor_pageEncodings(this.__wbg_ptr);let t;return 0!==e[0]&&(t=M(e[0],e[1]).slice(),o.__wbindgen_free(e[0],4*e[1],4)),t}numValues(){return o.columndescriptor_numValues(this.__wbg_ptr)}compression(){let e,t;try{const r=o.columndescriptor_compression(this.__wbg_ptr);return e=r[0],t=r[1],d(r[0],r[1])}finally{o.__wbindgen_free(e,t,1)}}compressedSize(){return o.columndescriptor_compressedSize(this.__wbg_ptr)}uncompressedSize(){return o.columndescriptor_uncompressedSize(this.__wbg_ptr)}nullCount(){const e=o.columndescriptor_nullCount(this.__wbg_ptr);return 0===e[0]?void 0:e[1]}distinctCount(){const e=o.columndescriptor_distinctCount(this.__wbg_ptr);return 0===e[0]?void 0:e[1]}minValue(){return o.columndescriptor_minValue(this.__wbg_ptr)}maxValue(){return o.columndescriptor_maxValue(this.__wbg_ptr)}}const G="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_fieldmetadata_free(e>>>0,1));class W{static __wrap(e){e>>>=0;const t=Object.create(W.prototype);return t.__wbg_ptr=e,G.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,G.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_fieldmetadata_free(e,0)}[Symbol.dispose](){this.free()}get column(){return o.__wbg_get_fieldmetadata_column(this.__wbg_ptr)>>>0}set column(e){o.__wbg_set_fieldmetadata_column(this.__wbg_ptr,e)}get name(){let e,t;try{const r=o.fieldmetadata_name(this.__wbg_ptr);return e=r[0],t=r[1],d(r[0],r[1])}finally{o.__wbindgen_free(e,t,1)}}get type(){const e=o.fieldmetadata_esri_type(this.__wbg_ptr);return z[e]}get physicalType(){const e=o.fieldmetadata_physical_type(this.__wbg_ptr);let t;return 0!==e[0]&&(t=d(e[0],e[1]).slice(),o.__wbindgen_free(e[0],1*e[1],1)),t}get logicalType(){const e=o.fieldmetadata_logical_type(this.__wbg_ptr);let t;return 0!==e[0]&&(t=d(e[0],e[1]).slice(),o.__wbindgen_free(e[0],1*e[1],1)),t}}const D="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_geometryinfo_free(e>>>0,1));class B{static __wrap(e){e>>>=0;const t=Object.create(B.prototype);return t.__wbg_ptr=e,D.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_geometryinfo_free(e,0)}[Symbol.dispose](){this.free()}static new(e,t,r,s,i){S(s,J);var n=s.__destroy_into_raw();const a=function(e){const t=(0,o.__wbindgen_malloc)(4*e.length,4)>>>0;for(let r=0;r<e.length;r++){const s=h(e[r]);b().setUint32(t+4*r,s,!0)}return f=e.length,t}(i),u=f,_=o.geometryinfo_new(e,t,r,n,a,u);return B.__wrap(_)}}const R="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_multiscalegeometryfield_free(e>>>0,1));class q{static __wrap(e){e>>>=0;const t=Object.create(q.prototype);return t.__wbg_ptr=e,R.register(t,t.__wbg_ptr,t),t}static __unwrap(e){return e instanceof q?e.__destroy_into_raw():0}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,R.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_multiscalegeometryfield_free(e,0)}[Symbol.dispose](){this.free()}get level(){return o.__wbg_get_multiscalegeometryfield_level(this.__wbg_ptr)}set level(e){o.__wbg_set_multiscalegeometryfield_level(this.__wbg_ptr,e)}static new(e,t,r,s){const i=m(t,o.__wbindgen_malloc,o.__wbindgen_realloc),n=f,a=O(r,o.__wbindgen_malloc),h=f,u=O(s,o.__wbindgen_malloc),_=f,l=o.multiscalegeometryfield_new(e,i,n,a,h,u,_);return q.__wrap(l)}has_field(e){const t=m(e,o.__wbindgen_malloc,o.__wbindgen_realloc),r=f;return 0!==o.multiscalegeometryfield_has_field(this.__wbg_ptr,t,r)}}const X="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_pageencodingdescriptor_free(e>>>0,1));class j{static __wrap(e){e>>>=0;const t=Object.create(j.prototype);return t.__wbg_ptr=e,X.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,X.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_pageencodingdescriptor_free(e,0)}[Symbol.dispose](){this.free()}pageType(){let e,t;try{const r=o.pageencodingdescriptor_pageType(this.__wbg_ptr);return e=r[0],t=r[1],d(r[0],r[1])}finally{o.__wbindgen_free(e,t,1)}}encoding(){let e,t;try{const r=o.pageencodingdescriptor_encoding(this.__wbg_ptr);return e=r[0],t=r[1],d(r[0],r[1])}finally{o.__wbindgen_free(e,t,1)}}count(){return o.pageencodingdescriptor_count(this.__wbg_ptr)}}const E="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_parquetchunk_free(e>>>0,1));class Y{static __wrap(e){e>>>=0;const t=Object.create(Y.prototype);return t.__wbg_ptr=e,E.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,E.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_parquetchunk_free(e,0)}[Symbol.dispose](){this.free()}size(){return o.parquetchunk_size(this.__wbg_ptr)>>>0}isEmpty(e){return 0!==o.parquetchunk_isEmpty(this.__wbg_ptr,e)}rowId(e){return o.parquetchunk_rowId(this.__wbg_ptr,e)}readX(e){const t=o.parquetchunk_readX(this.__wbg_ptr,e);return 0===t[0]?void 0:t[1]}readY(e){const t=o.parquetchunk_readY(this.__wbg_ptr,e);return 0===t[0]?void 0:t[1]}readCoords(e){const t=o.parquetchunk_readCoords(this.__wbg_ptr,e);let r;var s,i;return 0!==t[0]&&(r=(s=t[0],i=t[1],s>>>=0,v().subarray(s/8,s/8+i)).slice(),o.__wbindgen_free(t[0],8*t[1],8)),r}readLengths(e){const t=o.parquetchunk_readLengths(this.__wbg_ptr,e);let r;var s,i;return 0!==t[0]&&(r=(s=t[0],i=t[1],s>>>=0,F().subarray(s/4,s/4+i)).slice(),o.__wbindgen_free(t[0],4*t[1],4)),r}transformGeometry(e,t,r,s,i,n){S(e,$);const a=o.parquetchunk_transformGeometry(this.__wbg_ptr,e.__wbg_ptr,t,r,s,i,n);return 16777215===a?void 0:0!==a}boundsXMin(e){const t=o.parquetchunk_boundsXMin(this.__wbg_ptr,e);return 0===t[0]?void 0:t[1]}boundsYMin(e){const t=o.parquetchunk_boundsYMin(this.__wbg_ptr,e);return 0===t[0]?void 0:t[1]}boundsXMax(e){const t=o.parquetchunk_boundsXMax(this.__wbg_ptr,e);return 0===t[0]?void 0:t[1]}boundsYMax(e){const t=o.parquetchunk_boundsYMax(this.__wbg_ptr,e);return 0===t[0]?void 0:t[1]}readAttribute(e,t){return o.parquetchunk_readAttribute(this.__wbg_ptr,e,t)}}const L="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_parquetfile_free(e>>>0,1));class U{static __wrap(e){e>>>=0;const t=Object.create(U.prototype);return t.__wbg_ptr=e,L.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,L.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_parquetfile_free(e,0)}[Symbol.dispose](){this.free()}static fromUrl(e,t,r,s){const i=m(e,o.__wbindgen_malloc,o.__wbindgen_realloc),n=f;let a=0;return w(s)||(S(s,B),a=s.__destroy_into_raw()),o.parquetfile_fromUrl(i,n,t,r,a)}static fromBinary(e,t){const r=function(e){const t=(0,o.__wbindgen_malloc)(1*e.length,1)>>>0;return c().set(e,t/1),f=e.length,t}(e),s=f;let i=0;return w(t)||(S(t,B),i=t.__destroy_into_raw()),o.parquetfile_fromBinary(r,s,i)}version(){return o.parquetfile_version(this.__wbg_ptr)}numRows(){return o.parquetfile_numRows(this.__wbg_ptr)>>>0}numFields(){return o.parquetfile_numFields(this.__wbg_ptr)>>>0}numColumns(){return o.parquetfile_numColumns(this.__wbg_ptr)>>>0}createdBy(){const e=o.parquetfile_createdBy(this.__wbg_ptr);let t;return 0!==e[0]&&(t=d(e[0],e[1]).slice(),o.__wbindgen_free(e[0],1*e[1],1)),t}keyValueMetadata(e){const t=m(e,o.__wbindgen_malloc,o.__wbindgen_realloc),r=f,s=o.parquetfile_keyValueMetadata(this.__wbg_ptr,t,r);let i;return 0!==s[0]&&(i=d(s[0],s[1]).slice(),o.__wbindgen_free(s[0],1*s[1],1)),i}keys(){const e=o.parquetfile_keys(this.__wbg_ptr);let t;return 0!==e[0]&&(t=M(e[0],e[1]).slice(),o.__wbindgen_free(e[0],4*e[1],4)),t}columnForFieldName(e){const t=m(e,o.__wbindgen_malloc,o.__wbindgen_realloc),r=f,s=o.parquetfile_columnForFieldName(this.__wbg_ptr,t,r);return 4294967297===s?void 0:s}fields(){const e=o.parquetfile_fields(this.__wbg_ptr);var t=M(e[0],e[1]).slice();return o.__wbindgen_free(e[0],4*e[1],4),t}rowGroups(){const e=o.parquetfile_rowGroups(this.__wbg_ptr);var t=M(e[0],e[1]).slice();return o.__wbindgen_free(e[0],4*e[1],4),t}ensureFields(e){const t=k(e,o.__wbindgen_malloc),r=f;return o.parquetfile_ensureFields(this.__wbg_ptr,t,r)}readFirstChunk(e){const t=k(e,o.__wbindgen_malloc),r=f;return o.parquetfile_readFirstChunk(this.__wbg_ptr,t,r)}readChunk(e,t,r,s,i){const n=k(r,o.__wbindgen_malloc),a=f;return o.parquetfile_readChunk(this.__wbg_ptr,e,t,n,a,s,i)}readAllChunks(e,t,r){const s=k(e,o.__wbindgen_malloc),i=f;return o.parquetfile_readAllChunks(this.__wbg_ptr,s,i,t,r)}queryZChunks(e,t,r,s){const i=k(t,o.__wbindgen_malloc),n=f;return o.parquetfile_queryZChunks(this.__wbg_ptr,e,i,n,r,s)}queryXZChunks(e,t,r){return o.parquetfile_queryXZChunks(this.__wbg_ptr,e,t,r)}}const Z="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_primarygeometryfield_free(e>>>0,1));class J{static __wrap(e){e>>>=0;const t=Object.create(J.prototype);return t.__wbg_ptr=e,Z.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Z.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_primarygeometryfield_free(e,0)}[Symbol.dispose](){this.free()}static fromNative(e){const t=m(e,o.__wbindgen_malloc,o.__wbindgen_realloc),r=f,s=o.primarygeometryfield_fromNative(t,r);return J.__wrap(s)}static fromWkb(e){const t=m(e,o.__wbindgen_malloc,o.__wbindgen_realloc),r=f,s=o.primarygeometryfield_fromWkb(t,r);return J.__wrap(s)}static fromLocation(e,t){const r=m(e,o.__wbindgen_malloc,o.__wbindgen_realloc),s=f,i=m(t,o.__wbindgen_malloc,o.__wbindgen_realloc),n=f,a=o.primarygeometryfield_fromLocation(r,s,i,n);return J.__wrap(a)}}const V="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_quantizedgeometrybuffer_free(e>>>0,1));class ${static __wrap(e){e>>>=0;const t=Object.create($.prototype);return t.__wbg_ptr=e,V.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,V.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_quantizedgeometrybuffer_free(e,0)}[Symbol.dispose](){this.free()}static new(){const e=o.quantizedgeometrybuffer_new();return $.__wrap(e)}readCoordsUnsafe(){return o.quantizedgeometrybuffer_readCoordsUnsafe(this.__wbg_ptr)}readLengthsUnsafe(){return o.quantizedgeometrybuffer_readLengthsUnsafe(this.__wbg_ptr)}}const Q="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_rangeproviderjs_free(e>>>0,1));class H{static __wrap(e){e>>>=0;const t=Object.create(H.prototype);return t.__wbg_ptr=e,Q.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,Q.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_rangeproviderjs_free(e,0)}[Symbol.dispose](){this.free()}static new(e,t){const r=o.rangeproviderjs_new(e,t);return H.__wrap(r)}static withFetch(){const e=o.rangeproviderjs_withFetch();return H.__wrap(e)}}const K="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(e=>o.__wbg_rowgroup_free(e>>>0,1));class ee{static __wrap(e){e>>>=0;const t=Object.create(ee.prototype);return t.__wbg_ptr=e,K.register(t,t.__wbg_ptr,t),t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,K.unregister(this),e}free(){const e=this.__destroy_into_raw();o.__wbg_rowgroup_free(e,0)}[Symbol.dispose](){this.free()}columnDescriptorForAttribute(e){const t=o.rowgroup_columnDescriptorForAttribute(this.__wbg_ptr,e);return N.__wrap(t)}}function te(){const e={wbg:{}};return e.wbg.__wbg_aborted_c078e36031795a9a=function(e){return e.aborted},e.wbg.__wbg_apply_36be6a55257c99bf=function(){return u(function(e,t,r){return e.apply(t,r)},arguments)},e.wbg.__wbg_buffer_609cc3eee51ed158=function(e){return e.buffer},e.wbg.__wbg_call_672a4d21634d4a24=function(){return u(function(e,t){return e.call(t)},arguments)},e.wbg.__wbg_call_7cccdd69e0791ae2=function(){return u(function(e,t,r){return e.call(t,r)},arguments)},e.wbg.__wbg_error_7534b8e9a36f1ab4=function(e,t){let r,s;try{r=e,s=t,console.error(d(e,t))}finally{o.__wbindgen_free(r,s,1)}},e.wbg.__wbg_fieldmetadata_new=function(e){return W.__wrap(e)},e.wbg.__wbg_get_67b2ba62fc30de12=function(){return u(function(e,t){return Reflect.get(e,t)},arguments)},e.wbg.__wbg_length_6ca527665d89694d=function(e){return e.length},e.wbg.__wbg_length_a446193dc22c12f8=function(e){return e.length},e.wbg.__wbg_multiscalegeometryfield_unwrap=function(e){return q.__unwrap(e)},e.wbg.__wbg_new_23a2665fac83c611=function(e,t){try{var r={a:e,b:t};const s=new Promise((e,t)=>{const s=r.a;r.a=0;try{return function(e,t,r,s){o.closure9_externref_shim(e,t,r,s)}(s,r.b,e,t)}finally{r.a=s}});return s}finally{r.a=r.b=0}},e.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},e.wbg.__wbg_new_a12002a7f91c75be=function(e){return new Uint8Array(e)},e.wbg.__wbg_new_e3b321dcfef89fc7=function(e){return new Uint32Array(e)},e.wbg.__wbg_newnoargs_105ed471475aaf50=function(e,t){return new Function(d(e,t))},e.wbg.__wbg_newwithbyteoffsetandlength_f1dead44d1fc7212=function(e,t,r){return new Uint32Array(e,t>>>0,r>>>0)},e.wbg.__wbg_newwithbyteoffsetandlength_f254047f7e80e7ff=function(e,t,r){return new Int16Array(e,t>>>0,r>>>0)},e.wbg.__wbg_newwithlength_c4c419ef0bc8a1f8=function(e){return new Array(e>>>0)},e.wbg.__wbg_pageencodingdescriptor_new=function(e){return j.__wrap(e)},e.wbg.__wbg_parquetchunk_new=function(e){return Y.__wrap(e)},e.wbg.__wbg_parquetfile_new=function(e){return U.__wrap(e)},e.wbg.__wbg_queueMicrotask_98e746b9f850fe3d=function(e){queueMicrotask(e)},e.wbg.__wbg_queueMicrotask_c847cc8372bec908=function(e){return e.queueMicrotask},e.wbg.__wbg_resolve_4851785c9c5f573d=function(e){return Promise.resolve(e)},e.wbg.__wbg_rowgroup_new=function(e){return ee.__wrap(e)},e.wbg.__wbg_set_37837023f3d740e8=function(e,t,r){e[t>>>0]=r},e.wbg.__wbg_set_65595bdd868b3009=function(e,t,r){e.set(t,r>>>0)},e.wbg.__wbg_set_d23661d19148b229=function(e,t,r){e.set(t,r>>>0)},e.wbg.__wbg_stack_0ed75d68575b0f3c=function(e,t){const r=m(t.stack,o.__wbindgen_malloc,o.__wbindgen_realloc),s=f;b().setInt32(e+4,s,!0),b().setInt32(e+0,r,!0)},e.wbg.__wbg_static_accessor_GLOBAL_88a902d13a557d07=function(){const e=void 0===r.g?null:r.g;return w(e)?0:h(e)},e.wbg.__wbg_static_accessor_GLOBAL_THIS_56578be7e9f832b0=function(){const e="undefined"==typeof globalThis?null:globalThis;return w(e)?0:h(e)},e.wbg.__wbg_static_accessor_SELF_37c5d418e4bf5819=function(){const e="undefined"==typeof self?null:self;return w(e)?0:h(e)},e.wbg.__wbg_static_accessor_WINDOW_5de37043a91a9c40=function(){const e="undefined"==typeof window?null:window;return w(e)?0:h(e)},e.wbg.__wbg_then_44b73946d2fb3e7d=function(e,t){return e.then(t)},e.wbg.__wbg_then_48b406749878a531=function(e,t,r){return e.then(t,r)},e.wbg.__wbg_valueOf_fdbb54fcdfe33477=function(e){return e.valueOf()},e.wbg.__wbindgen_array_new=function(){return[]},e.wbg.__wbindgen_array_push=function(e,t){e.push(t)},e.wbg.__wbindgen_bigint_from_i64=function(e){return e},e.wbg.__wbindgen_cb_drop=function(e){const t=e.original;return 1==t.cnt--&&(t.a=0,!0)},e.wbg.__wbindgen_closure_wrapper1683=function(e,t,r){const s=function(e,t,r,s){const i={a:e,b:t,cnt:1,dtor:84},n=(...e)=>{i.cnt++;const t=i.a;i.a=0;try{return s(t,i.b,...e)}finally{0===--i.cnt?(o.__wbindgen_export_6.get(i.dtor)(t,i.b),x.unregister(i)):i.a=t}};return n.original=i,x.register(n,i,i),n}(e,t,0,P);return s},e.wbg.__wbindgen_init_externref_table=function(){const e=o.__wbindgen_export_2,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},e.wbg.__wbindgen_is_function=function(e){return"function"==typeof e},e.wbg.__wbindgen_is_undefined=function(e){return void 0===e},e.wbg.__wbindgen_memory=function(){return o.memory},e.wbg.__wbindgen_number_get=function(e,t){const r="number"==typeof t?t:void 0;b().setFloat64(e+8,w(r)?0:r,!0),b().setInt32(e+0,!w(r),!0)},e.wbg.__wbindgen_number_new=function(e){return e},e.wbg.__wbindgen_string_new=function(e,t){return d(e,t)},e.wbg.__wbindgen_throw=function(e,t){throw new Error(d(e,t))},e.wbg.__wbindgen_uint8_array_new=function(e,t){var r,s,i=(r=e,s=t,r>>>=0,c().subarray(r/1,r/1+s)).slice();return o.__wbindgen_free(e,1*t,1),i},e}function re(e,t){return o=e.exports,se.__wbindgen_wasm_module=t,y=null,I=null,T=null,l=null,o.__wbindgen_start(),o}async function se(e){if(void 0!==o)return o;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead"));const t=te();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:s}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}(await e,t);return re(r,s)}const ie=Object.freeze(Object.defineProperty({__proto__:null,ColumnDescriptor:N,FieldMetadata:W,GeometryInfo:B,GeometryType:A,MultiscaleGeometryField:q,PageEncodingDescriptor:j,ParquetChunk:Y,ParquetFile:U,PrimaryGeometryField:J,QuantizedGeometryBuffer:$,RangeProviderJs:H,RowGroup:ee,default:se,enableTracing:function(){o.enableTracing()},initSync:function(e){if(void 0!==o)return o;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module:e}=e):console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const t=te();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),re(new WebAssembly.Instance(e,t),e)}},Symbol.toStringTag,{value:"Module"}));async function ne(e,t={}){const{ParquetFile:r}=await async function(){return a||(a=async function(){const e=await Promise.resolve().then(()=>ie);return await e.default({module_or_path:(0,n.g)("esri/libs/parquet/pkg/bundle_bg.wasm")}),e}()),a}(),o=(h=t.getCustomParameters,async function(e,t,r,i){const n=h?.(),o=n?{...n,debug:i}:{debug:i},{data:a}=await(0,s.A)(e,{responseType:"array-buffer",query:o,headers:{range:`bytes=${t}-${r}`}});return a});var h;const u=(l=t.getCustomParameters,async function(e){const{data:t}=await(0,s.A)(e,{responseType:"native",method:"head",query:l?.()}),r=t.headers.get("Content-Length");if(null==r)throw new Error("Unable to parse content length");return parseInt(r,10)}),_=t.geometryInfo?function(e,t){const r=e.spatialReference.wkid,s=t.wkid;if(!r||!s)throw new i.A("parquet","Unable to create ParquetFile, in and out wkid must be specified");const n=function(e){switch(e){case"esriGeometryPoint":return A.Point;case"esriGeometryPolygon":return A.Polygon;case"esriGeometryPolyline":return A.Polyline;case"esriGeometryMultipoint":return A.Multipoint;default:throw new i.A("parquet",`Found unexpected GeometryType: ${e}`)}}(e.geometryType),o=function(e){switch(e.encoding.type){case"wkb":return J.fromWkb(e.encoding.primaryFieldName);case"location":{const{latitudeFieldName:t,longitudeFieldName:r}=e.encoding;return J.fromLocation(t,r)}}}(e),a=[];if("xz"===e.displayOptimization?.mode){const t=e.displayOptimization.multiscale;for(const e of t.levels??[]){const[t,r]=e.transform.translate,[s,i]=e.transform.scale,n=new Float64Array([t,r]),o=new Float64Array([s,i]);a.push(q.new(e.level,e.column,n,o))}}return B.new(n,r,s,o,a)}(t.geometryInfo,t.outSpatialReference??t.geometryInfo.spatialReference):null;var l;return r.fromUrl(e,o,u,_)}function oe(e){const t=e.keyValueMetadata("geo");return null!=t?JSON.parse(t):null}},67321:(e,t,r)=>{r.d(t,{C_:()=>c,OH:()=>p,Vh:()=>g,on:()=>l,pc:()=>m,wB:()=>h,z7:()=>u});var s=r(19247),i=r(13671),n=r(57732),o=r(80959),a=r(35819);function h(e,t,r={}){return _(e,t,r,d)}function u(e,t,r={}){return _(e,t,r,f)}function _(e,t,r={},s){let i=null;const o=r.once?(e,r)=>{s(e)&&((0,n.r)(i),t(e,r))}:(e,r)=>{s(e)&&t(e,r)};if(i=(0,a.w)(e,o,r.sync,r.equals),r.initial){const t=e();o(t,t)}return i}function l(e,t,r,o={}){let a=null,u=null,_=null;function l(){a&&u&&(u.remove(),o.onListenerRemove?.(a),a=null,u=null)}function c(e){o.once&&o.once&&(0,n.r)(_),r(e)}const d=h(e,(e,r)=>{l(),(0,s.i)(e)&&(a=e,u=(0,s.a)(e,t,c),o.onListenerAdd?.(e))},{sync:o.sync,initial:!0});return _=(0,i.m)(()=>{d.remove(),l()}),_}function c(e,t){return function(e,t,r){if((0,o.G4)(r))return Promise.reject((0,o.NK)());const s=e();if(t?.(s))return Promise.resolve(s);let a=null;function h(){a=(0,n.r)(a)}return new Promise((s,n)=>{a=(0,i.h)([(0,o.u7)(r,()=>{h(),n((0,o.NK)())}),_(e,e=>{h(),s(e)},{sync:!1,once:!0},t??d)])})}(e,f,t)}function d(e){return!0}function f(e){return!!e}r(6407),r(32773),r(20266),r(90740),r(59121),r(84699),r(36555),r(45371),r(61532),r(85176),r(93181),r(50704),r(91047),r(36172);const p={sync:!0},g={initial:!0},m={sync:!0,initial:!0}},67535:(e,t,r)=>{r.d(t,{QueueProcessor:()=>_});var s=r(57732),i=r(80959),n=r(41003),o=r(20527),a=r(45371),h=r(7078);r(13671),r(6407),r(32773),r(20266),r(90740),r(59121),r(84699),r(19247),r(91047),r(93181),r(44945),r(58498),r(61532);class u{constructor(e,t){this.item=e,this.controller=t,this.promise=null}}class _{constructor(e){this._schedule=null,this._deferreds=new o.R,this._controllers=new o.R,this._processingItems=new o.R,this._pausedSignal=(0,h.s)(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new n.Q(e.peeker),this.process=e.process}destroy(){this.clear(),this._schedule=(0,s.r)(this._schedule)}get updating(){return this.running}get length(){return this._processingItems.size+this._queue.length}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}abort(e){const t=this._controllers.get(e);t&&t.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(t=>e.push(t)),this._controllers.clear(),e.forEach(e=>e.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((t,r)=>e(r))}get(e){const t=this._deferreds.get(e);return t?t.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,t){const r=this.get(e);if(r)return r;const s=new AbortController;let n=null;t&&(n=(0,i.u7)(t,()=>s.abort()));const o=()=>{a.remove(),null!=n&&n.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},a=(0,i.NY)(s.signal,()=>{const t=this._processingItems.get(e);t&&t.controller.abort(),o(),h.reject((0,i.NK)())}),h=(0,i.Tw)();return this._deferreds.set(e,h),this._controllers.set(e,s),h.promise.then(o,o),this._queue.push(e),this._scheduleNext(),h.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){const e=this._queue.popLast();return e&&(this._deferreds.get(e)?.reject((0,i.NK)()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const t of e)this._queue.push(t.item),t.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._pausedSignal.value||this._schedule||(this._schedule=(0,a._)(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(t))}_processError(e,t){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(t))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(null==e)return;let t;const r=new AbortController,s=new u(e,r);this._processingItems.set(e,s);try{t=this.process(e,r.signal)}catch(e){this._processError(s,e)}(0,i.$X)(t)?(s.promise=t,t.then(e=>this._processResult(s,e),e=>this._processError(s,e))):this._processResult(s,t)}}},67782:(e,t,r)=>{r.d(t,{B:()=>o,C:()=>f,D:()=>d,E:()=>g,F:()=>p,W:()=>_,a:()=>n,b:()=>i,g:()=>c,m:()=>a,p:()=>s,s:()=>l,t:()=>h,y:()=>u});const s=512,i=29,n=24,o=4,a=6,h=1.05,u=3,_=3,l=4,c=1,d=10,f=256,p=32,g=512},83565:(e,t,r)=>{r.d(t,{A:()=>v,F:()=>V,G:()=>A,O:()=>Y,a:()=>Z,b:()=>$,c:()=>X,d:()=>j,p:()=>C});var s=r(32773),i=r(33489),n=r(96153),o=r(65892),a=r(95115),h=r(81272),u=r(47239),_=r(56988),l=r(16699),c=r(84200),d=r(7969),f=r(48402),p=r(69763),g=r(83637),m=r(2824),y=r(67782),b=r(45681),w=r(69310);class x{constructor(e){this._statistics=e}get statistics(){return this._statistics}}const I=Math.PI/180;class v{static create(e){return new v(e.map(e=>function(e){switch(e.statisticType){case"min":return new F(e);case"max":return new S(e);case"avg":return new O(e);case"avg_angle":return new k(e);case"sum":case"count":return new M(e);case"mode":return new P(e)}}(e)))}constructor(e){this._statistics=e}values(){return this._statistics.values()}insert(e,t){for(const r of this._statistics)r.insert(e,t)}merge(e){for(let t=0;t<this._statistics.length;t++){const r=this._statistics[t],s=e._statistics[t];if(r.field.name!==s.field.name)throw new Error("InternalError: Tried to merge incompatible statistics");r.merge(s)}}clone(){return new v(this._statistics.map(e=>e.clone()))}}class T{constructor(e){this.field=e}insert(e,t){if(!this.field.computed)return;const r=this.field.computed.read(e,t);(0,a.i)(r)||this._insertValue(r)}}class F extends T{constructor(){super(...arguments),this.type="min",this.value=Number.MAX_VALUE}_insertValue(e){this.value=Math.min(this.value,e)}merge(e){this.value=Math.min(this.value,e.value)}clone(){const e=new F(this.field);return e.value=this.value,e}}class S extends T{constructor(){super(...arguments),this.type="max",this.value=Number.MIN_VALUE}_insertValue(e){this.value=Math.max(this.value,e)}merge(e){this.value=Math.max(this.value,e.value)}clone(){const e=new S(this.field);return e.value=this.value,e}}class M extends T{constructor(){super(...arguments),this.type="sum",this.value=0}_insertValue(e){this.value+=e}merge(e){this.value+=e.value}clone(){const e=new M(this.field);return e.value=this.value,e}}class O extends T{constructor(){super(...arguments),this.type="avg",this._total=0,this._count=0}get value(){return this._total/this._count}_insertValue(e){this._total+=e,this._count+=1}merge(e){this._total+=e._total,this._count+=e._count}clone(){const e=new O(this.field);return e._total=this._total,e._count=this._count,e}}class k extends T{constructor(){super(...arguments),this.type="avg_angle",this._x=0,this._y=0,this._count=0}get value(){const e=this._x/this._count,t=this._y/this._count,r=180/Math.PI;return Math.atan2(t,e)*r}_insertValue(e){this._x=this._x+Math.cos(e*I),this._y=this._y+Math.sin(e*I),this._count+=1}merge(e){this._x+=e._x,this._y+=e._y,this._count+=e._count}clone(){const e=new k(this.field);return e._x=this._x,e._y=this._y,e._count=this._count,e}}class P extends T{constructor(){super(...arguments),this._frequencies=new Map}get value(){let e,t=0;for(const[r,s]of this._frequencies.entries())s>t&&(t=s,e=r);return e}_insertValue(e){const t=this._frequencies.get(e);null!=t?this._frequencies.set(e,t+1):this._frequencies.set(e,1)}merge(e){for(const[t,r]of e._frequencies.entries()){const e=this._frequencies.get(t);null!=e?this._frequencies.set(t,e+r):this._frequencies.set(t,r)}}clone(){const e=new P(this.field);return e._frequencies=new Map(this._frequencies),e}}class A extends x{static createId(e,t){return`${e}.${t}`}static create(e,t,r,s){return new A(e,t,v.create(r),s)}constructor(e,t,r,s){super(r),this.gridX=e,this.gridY=t,this._worldUnitsPerCell=s,this._count=0,this._xWorldTotal=0,this._yWorldTotal=0,this._objectIds=new Set}get id(){return A.createId(this.gridX,this.gridY)}get containedObjectIds(){return this._objectIds}get count(){return this._count}get firstObjectId(){return this._objectIds.values().next().value}get centroidXWorld(){return this._xWorldTotal/this._count}get centroidYWorld(){return this._yWorldTotal/this._count}clone(){const e=new A(this.gridX,this.gridY,this._statistics.clone(),this._worldUnitsPerCell);return e._count=this._count,e._xWorldTotal=this._xWorldTotal,e._yWorldTotal=this._yWorldTotal,e._firstFeatureAttributes=this._firstFeatureAttributes,e._objectIds=new Set(this._objectIds),e}insert(e,t,r,s){0===this._count?this._firstFeatureAttributes=e.readAttributes():this._firstFeatureAttributes=null,this._count+=1,this._xWorldTotal+=r,this._yWorldTotal+=s,this._statistics.insert(e,t),this._objectIds.add(e.getObjectId())}merge(e){if(0!==e._count){this._count+=e._count,this._firstFeatureAttributes=e._firstFeatureAttributes,this._xWorldTotal+=e._xWorldTotal,this._yWorldTotal+=e._yWorldTotal,this._statistics.merge(e._statistics);for(const t of e._objectIds.values())this._objectIds.add(t)}}getCentroidX(e){return null==e?this.centroidXWorld:(0,g.t)(e,this.centroidXWorld)}getCentroidY(e){return null==e?this.centroidYWorld:(0,g.v)(e,this.centroidYWorld)}getGeometry(e,t){const r=this.gridX*this._worldUnitsPerCell,s=this.gridY*this._worldUnitsPerCell,i=new n.O([4],[r,s,r+this._worldUnitsPerCell,s,r+this._worldUnitsPerCell,s+this._worldUnitsPerCell,r,s+this._worldUnitsPerCell]);if(null!=t){const e=new n.O;return(0,g.q)(e,i,!1,!1,"esriGeometryPolygon",t)}return i}getCentroid(e){const t=new n.O([],[this.centroidXWorld,this.centroidYWorld]);if(null!=e){const r=new n.O;return(0,g.q)(r,t,!1,!1,"esriGeometryPoint",e)}return t}getGeometricCentroid(e,t){const r=this.gridX*this._worldUnitsPerCell+.5*this._worldUnitsPerCell,s=this.gridY*this._worldUnitsPerCell+.5*this._worldUnitsPerCell,i=new n.O([],[r,s]);if(null!=t){const e=new n.O;return(0,g.q)(e,i,!1,!1,"esriGeometryPoint",t)}return i}getAttributes(){const e={aggregateId:this.id};for(const t of this._statistics.values())e[t.field.name]=t.value;return null!=this._firstFeatureAttributes?{...e,...this._firstFeatureAttributes}:e}}class z{constructor(e){this._options=e}insert(e,t){const r=e.getCursor(),{arcadeContextInfo:s,scale:i}=this._options,n=(0,b.c)(i,s);for(;r.next();)this._insertFeature(r,n,this._options.sqlOptions,t)}_insertFeature(e,t,r,s){const{featureFilter:i}=this._options;if(null!==i&&!i.check(e,r))return;let n=0,o=0;if("esriGeometryPoint"===e.geometryType)n=e.readXWorldSpace(),o=e.readYWorldSpace();else{if(s){const t=e.readCentroidForDisplay();if(null==t)return;const[r,s]=t.coords;if(r<0||r>y.p||s<0||s>y.p)return}const t=e.readCentroidWorldSpace();if(null==t)return;n=t.coords[0],o=t.coords[1]}this._insert(e,n,o,t)}}function C(e,t){return(0,p.m)(e)*p.J*96/t}class N extends z{constructor(e){super(e),this._cells=new Map,this._pixelsPerMapUnit=C(e.spatialReference,e.scale)}put(e){for(const t of this._cells.values()){const r=e.get(t.id);r?r.merge(t):e.set(t.id,t.clone())}}putBounded(e,t,r){const s=[t.xmin,t.ymin,t.xmax,t.ymax],[i,n,o,a]=s,h=Math.floor(i*this._pixelsPerMapUnit/this._options.cellSize),u=Math.floor(n*this._pixelsPerMapUnit/this._options.cellSize),_=Math.ceil(o*this._pixelsPerMapUnit/this._options.cellSize),l=Math.ceil(a*this._pixelsPerMapUnit/this._options.cellSize);for(let t=u;t<=l;t++)for(let r=h;r<=_;r++){const s=`${r}.${t}`,i=this._cells.get(s);if(!i)continue;const n=e.get(i.id);n?i&&!e.has(i.id)&&n.merge(i):e.set(i.id,i.clone())}}_insert(e,t,r,s){const i=t*this._pixelsPerMapUnit,n=r*this._pixelsPerMapUnit,o=Math.floor(i/this._options.cellSize),a=Math.floor(n/this._options.cellSize);this._getCellOrCreate(o,a).insert(e,s,t,r)}_getCellOrCreate(e,t){const r=A.createId(e,t);let s=this._cells.get(r);if(!s){const i=1*this._options.cellSize/this._pixelsPerMapUnit;s=A.create(e,t,this._options.fields,i),this._cells.set(r,s)}return s}}class G{static fromReader(e){const t=[],r=e.copy(),s=(0,u.c)();for(;r.next();)r.getBounds(s)&&t.push(r.getIndex());const i=(0,_.r)(9,e=>(r.setIndex(e),{minX:r.getBoundsXMin(),minY:r.getBoundsYMin(),maxX:r.getBoundsXMax(),maxY:r.getBoundsYMax()}));return i.load(t),new G(i)}constructor(e){this._index=e}search(e){const t={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this._index.search(t)}}function W(e,t,r,s){if(s.isWebMercator){const s=(0,l.r)(e/p.x.radius),i=s-360*Math.floor((s+180)/360),n=[0,0];return D(n,0,(0,l.r)(Math.PI/2-2*Math.atan(Math.exp(-t/p.x.radius))),i,r),n}const i=(0,m.p)({x:e,y:t},s,d.A.WGS84);if(!i)return null;const n=[0,0];return D(n,0,i.y,i.x,r),n}function D(e,t,r,s,i){i%2&&(i+=1);let n=0,o=0,a=-90,h=90,u=-180,_=180;for(let e=0;e<i/2;e++){for(let t=0;t<5;t++){const r=(u+_)/2,i=s>r?1:0;n|=i<<29-(t+5*e),u=(1-i)*u+i*r,_=(1-i)*r+i*_}for(let t=0;t<5;t++){const s=(a+h)/2,i=r>s?1:0;o|=i<<29-(t+5*e),a=(1-i)*a+i*s,h=(1-i)*s+i*h}}e[2*t]=n,e[2*t+1]=o}class B extends x{static create(e,t,r,s){const i=v.create(e),n=new Array(32);for(let e=0;e<n.length;e++)n[e]=null;return new B(i,t,r,s,n)}constructor(e,t,r,s,i){super(e),this.xNode=t,this.yNode=r,this.depth=s,this.children=i,this._objectIds=new Set,this._count=0,this._xWorldTotal=0,this._yWorldTotal=0,this._xGeohashTotal=0,this._yGeohashTotal=0,this.next=null}get id(){return`${this.xNode}.${this.yNode}`}get containedObjectIds(){return this._objectIds}get count(){return this._count}clone(){const e=new B(this._statistics.clone(),this.xNode,this.yNode,this.depth,this.children);return e._count=this._count,e._xWorldTotal=this._xWorldTotal,e._yWorldTotal=this._yWorldTotal,e._xGeohashTotal=this._xGeohashTotal,e._yGeohashTotal=this._yGeohashTotal,e.next=this.next,e._objectIds=new Set(this._objectIds),e}insert(e,t,r,s,i,n){this._count+=1,this._xWorldTotal+=t,this._yWorldTotal+=r,this._xGeohashTotal+=s,this._yGeohashTotal+=i,this._statistics.insert(e,n),this._objectIds.add(e.getObjectId())}merge(e){if(0!==e._count){this._count+=e._count,this._xWorldTotal+=e._xWorldTotal,this._yWorldTotal+=e._yWorldTotal,this._xGeohashTotal+=e._xWorldTotal,this._yGeohashTotal+=e._yWorldTotal,this._statistics.merge(e._statistics);for(const t of e._objectIds.values())this._objectIds.add(t)}}getCentroid(e){throw new Error("getCentroid not supported for GeohashNode")}getGeometry(e,t){const r=this._getLngLatBounds(),[s,i,o,a]=r,h=(0,m.p)({rings:[[[s,i],[s,a],[o,a],[o,i],[s,i]]]},d.A.WGS84,e),u=(0,g.m)(new n.O,h,!1,!1);return null!=t?(0,g.q)(new n.O,u,!1,!1,"esriGeometryPolygon",t,!1,!1):u}getGeometricCentroid(e,t){const r=this._getLngLatBounds(),[s,i,o,a]=r,h=(0,m.p)({x:(s+o)/2,y:(i+a)/2},d.A.WGS84,e),u=(0,g.w)(new n.O,h);return null!=t?(0,g.q)(new n.O,u,!1,!1,"esriGeometryPoint",t,!1,!1):u}getAttributes(){const e={aggregateId:this.id};for(const t of this._statistics.values())e[t.field.name]=t.value;return e.aggregateCount=this._count,e}find(e,t,r,s,i,n){if(s>=r)return this;const o=1-s%2,a=3*o+2*(1-o),h=2*o+3*(1-o),u=30-i-a,_=30-n-h,l=((e&7*o+3*(1-o)<<u)>>u)+((t&3*o+7*(1-o)<<_)>>_)*(8*o+4*(1-o)),c=this.children[l];return null==c?null:c.find(e,t,r,s+1,i+a,n+h)}_getLngLatBounds(){const e=this.depth,t=Math.ceil(e/2),r=Math.floor(e/2),s=30-(3*t+2*r),i=30-(2*t+3*r);return function(e,t){let r=-90,s=90,i=-180,n=180;for(let o=0;o<t;o++){const t=Math.ceil((o+1)/2),a=Math.floor((o+1)/2),h=1-o%2,u=30-(3*t+2*a),_=30-(2*t+3*a),l=2*h+3*(1-h),c=(7*h+3*(1-h)<<u&e.geohashX)>>u,d=(3*h+7*(1-h)<<_&e.geohashY)>>_;for(let e=3*h+2*(1-h)-1;e>=0;e--){const t=(i+n)/2,r=c&1<<e?1:0;i=(1-r)*i+r*t,n=(1-r)*t+r*n}for(let e=l-1;e>=0;e--){const t=(r+s)/2,i=d&1<<e?1:0;r=(1-i)*r+i*t,s=(1-i)*t+i*s}}return[i,r,n,s]}({geohashX:this.xNode<<s,geohashY:this.yNode<<i},this.depth)}}class R{constructor(e){this._fields=e,this._size=0,this._depth=0,this._root=B.create(this._fields,0,0,0)}destroy(){}get size(){return this._size}get depth(){return this._depth}find(e,t,r){return this._root.find(e,t,r,0,0,0)}insert(e,t,r,s,i,n,o){let a=this._root,h=0,u=0,_=0;for(;null!==a;){if(a.insert(e,t,r,s,i,o),h>=n)return;const l=Math.ceil((h+1)/2),c=Math.floor((h+1)/2),d=1-h%2,f=30-(3*l+2*c),p=30-(2*l+3*c),g=(s&7*d+3*(1-d)<<f)>>f,m=(i&3*d+7*(1-d)<<p)>>p,y=g+m*(8*d+4*(1-d));u=u<<3*d+2*(1-d)|g,_=_<<2*d+3*(1-d)|m,null==a.children[y]&&(a.children[y]=B.create(this._fields,u,_,h+1),this._depth=Math.max(this._depth,h+1),this._size+=1),h+=1,a=a.children[y]}}putBins(e,t){for(const r of this.getNodes(t)){const t=e.get(r.id);t?t.merge(r):e.set(r.id,r.clone())}}getNodes(e){const t=[],{geohashBounds:r,level:s}=e;let i=this._root;for(;null!==i;){const e=i.depth,n=i.xNode,o=i.yNode;if(e>=s){t.push(i),i=i.next;continue}const a=Math.ceil((e+1)/2),h=Math.floor((e+1)/2),u=1-e%2,_=30-(3*a+2*h),l=30-(2*a+3*h),c=~((1<<_)-1),d=~((1<<l)-1),f=(r.xLL&c)>>_,p=(r.yLL&d)>>l,g=(r.xTR&c)>>_,m=(r.yTR&d)>>l,y=n<<3*u+2*(1-u),b=o<<2*u+3*(1-u),w=y+8*u+4*(1-u),x=b+4*u+8*(1-u),I=Math.max(y,f),v=Math.max(b,p),T=Math.min(w,g),F=Math.min(x,m);let S=null,M=null;for(let e=v;e<=F;e++)for(let t=I;t<=T;t++){const r=t-y+(e-b)*(8*u+4*(1-u)),s=i.children[r];s&&(S||(S=s,S.next=i.next),M&&(M.next=s),M=s,s.next=i.next)}i=S||i.next}return t}}class q extends z{constructor(e){super(e),this._tree=new R(this._options.fields)}put(e){throw new Error("Geohash tree does not support put")}putBounded(e,t,r){const{geohashLevel:s,spatialReference:i}=this._options,o=function(e,t,r,s){const i=[e.xmin,e.ymin,e.xmax,e.ymax],o=c.A.fromExtent((0,f.t)(i,s)),a=(0,m.p)(o,s,d.A.WGS84,{densificationStep:64*t});if(!a)return null;const h=(0,g.m)(new n.O,a,!1,!1),u=h.coords.filter((e,t)=>!(t%2)),_=h.coords.filter((e,t)=>t%2),l=Math.min(...u),p=Math.min(..._),y=Math.max(...u),b=Math.max(..._),w=W(l,p,r,d.A.WGS84),x=W(y,b,r,d.A.WGS84);return w&&x?{bounds:i,geohashBounds:{xLL:w[0],yLL:w[1],xTR:x[0],yTR:x[1]},level:r}:null}(t,r,s,i);null!=o&&this._tree.putBins(e,o)}_insert(e,t,r,s){const{geohashLevel:i,spatialReference:n}=this._options,o=W(t,r,i,n);o&&this._tree.insert(e,t,r,o[0],o[1],i,s)}}class X extends a.b{static from(e,t){if(e instanceof this){const r=new Set(t),s=e._indices.filter(e=>r.has(e));return new X(e._reader,s)}return new X(e.copy(),t)}constructor(e,t){super(e.metadata),this._currentIndex=-1,this._displayTransform=null,this._reader=e,this._indices=t}setTransformForDisplay(e){const t=this._reader.getInTransform();if(null==t)return void(this._displayTransform=(0,w.n)(e));const r=(0,w.n)(t),s=(0,w.n)(e),[i,n]=r.scale,[o,a]=r.translate,[h,u]=s.scale,[_,l]=s.translate,c=i/h,d=n/u,f=(o-_)/h,p=(a-l)/u;this._displayTransform={originPosition:"lowerLeft",scale:[1/c,1/d,1,1],translate:[-f/c,-p/d,0,0]}}getInTransform(){return this._reader.getInTransform()}get fields(){return this._reader.fields}get hasNext(){return this._currentIndex+1<this._indices.length}getSize(){return this._indices.length}getCursor(){return this.copy()}copy(){const e=new X(this._reader.copy(),this._indices);return e._currentIndex=this._currentIndex,e._displayTransform=this._displayTransform,e._processorAttributes=this._processorAttributes,e}get contextTimeZone(){return this._reader.contextTimeZone}set contextTimeZone(e){this._reader.contextTimeZone=e}get usedMemory(){return i.d+this._reader.usedMemory}setProcessorAttributes(e){this._processorAttributes=Object.assign(this._processorAttributes??{},e)}_nextIndex(){return++this._currentIndex<this._indices.length&&(this._reader.setIndex(this._indices[this._currentIndex]),!0)}next(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length}readXForDisplay(){return this._displayTransform?(0,w.f)(this._displayTransform,this._reader.readXForDisplay()):this._reader.readXForDisplay()}readYForDisplay(){return this._displayTransform?(0,w.g)(this._displayTransform,this._reader.readYForDisplay()):this._reader.readYForDisplay()}readGeometryForDisplay(){return this._displayTransform?this._reader.readGeometryForDisplayTransformed(this._displayTransform):this._reader.readGeometryForDisplay()}readCentroidForDisplay(){const e=this._reader.readCentroidForDisplay()?.clone();if(e){const[t,r]=e.coords;this._displayTransform?(e.coords[0]=(0,w.f)(this._displayTransform,t),e.coords[1]=(0,w.g)(this._displayTransform,r)):(e.coords[0]=t,e.coords[1]=r)}return e}get geometryType(){return this._reader.geometryType}get hasFeatures(){return this._reader.hasFeatures}get exceededTransferLimit(){return this._reader.exceededTransferLimit}get hasZ(){return this._reader.hasZ}get hasM(){return this._reader.hasM}readAttribute(e,t=!1){const r=this._reader.readAttribute(e,t);return null==r&&this._processorAttributes?this._processorAttributes[e]:r}readAttributes(){return{...this._processorAttributes??{},...this._reader.readAttributes()}}joinAttributes(e){return this._reader.joinAttributes(e)}getBounds(e){return this._reader.getBounds(e)}getAttributeHash(){return this._reader.getAttributeHash()}getObjectId(){return this._reader.getObjectId()}getDisplayId(){return this._reader.getDisplayId()}setDisplayId(e){return this._reader.setDisplayId(e)}setIndex(e){return this._reader.setIndex(e)}getIndex(){return this._reader.getIndex()}readXWorldSpace(){return this._reader.readXWorldSpace()}readYWorldSpace(){return this._reader.readYWorldSpace()}_readX(){return this._reader.readXForDisplay()}_readY(){return this._reader.readYForDisplay()}_readServerCentroid(){return this._reader._readServerCentroid()}readLegacyFeatureForDisplay(){const e=this.readCentroidForDisplay();return{attributes:this.readAttributes(),geometry:this.readLegacyGeometryForDisplay(),centroid:(e&&{x:e.coords[0],y:e.coords[1]})??null}}readLegacyGeometryForDisplay(){const e=this.readGeometryForDisplay();return(0,g.a)(e,this.geometryType,!1,!1)}readGeometryArea(){return this._displayTransform?this._reader.readGeometryForDisplayTransformed(this._displayTransform)?.area()??0:this._reader.readGeometryArea()}readGeometryWorldSpace(){return this._reader.readGeometryWorldSpace()}_readGeometry(){return this._reader._readGeometry()}_readAttribute(e,t){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}_readAttributes(){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}readArcadeFeature(){return this._reader.readArcadeFeature()}geometry(){return this._reader.geometry()}field(e){return this._reader.field(e)}hasField(e){return this._reader.hasField(e)}setField(e,t){return this._reader.setField(e,t)}keys(){return this._reader.keys()}castToText(e=!1){return this._reader.castToText(e)}}class j{size(){return this.reader.getSize()}get fields(){return this.reader.fields}invalidate(){this._aggregateIndex=null,this._aggregateIndexHash=null,this._spatialIndex=null}registerOverrides(e){this.reader.registerOverrides(e),this.invalidate()}queryFeaturesInBounds(e){const t=this._getSpatialIndex().search(e);return X.from(this.reader,t)}getAggregateIndex(e){const t=JSON.stringify(e);if(t!==this._aggregateIndexHash){switch(this._aggregateIndexHash=t,e.type){case"grid":this._aggregateIndex=new N(e);break;case"geohash":this._aggregateIndex=new q(e)}this._aggregateIndex.insert(this.reader,this.isTiled)}return this._aggregateIndex}_getSpatialIndex(){return this._spatialIndex||(this._spatialIndex=G.fromReader(this.reader)),this._spatialIndex}}class E{constructor(){this.modified=[],this.removed=[]}modify(e){this.modified.push(e)}remove(e){this.removed.push(e)}get isEmpty(){return 0===this.modified.length&&0===this.removed.length}}class Y extends j{constructor(e){super(),this._reader=e,this.chunkId="override",this.normalizedChunkId="override"}static fromFeatures(e,t){const r=a.c.fromOptimizedFeatures(e,t);return new Y(r)}get reader(){return this._reader}get queryInfo(){return{}}get first(){return!1}get end(){return!1}get isTiled(){return!1}getTileReader(e){if(!this._reader.getSize())return null;const t=this.queryFeaturesInBounds(e.bounds);return t.setTransformForDisplay(e.transform),t}}class L{constructor(e,t){this.inner=e,this.isWeak=t,this.lastWeak=null}get isStrong(){return!this.isWeak}}class U{constructor(){this._overrides=new Map,this._update=new E,this._lastCleanup=0}hasOverride(e){return this._overrides.has(e)}onChunkInsert(e){if(this._overrides.size){const t=e.reader.getCursor();for(;t.next();){const e=t.getObjectId(),r=this._overrides.get(e);if(r?.lastWeak&&(r.lastWeak=null),r?.isWeak){const e=t.readOptimizedFeatureWorldSpace();r.inner=e,this._update.modify(e),this.invalidate()}}}e.registerOverrides(this)}apply(e,t){const{updateWeak:r,removeWeak:s,update:i,remove:n,release:o}=e.commands;this.invalidate();for(const e of r){const t=new L(e,!0),r=this._overrides.get(e.objectId);r?.isStrong?r.lastWeak=t:(this._overrides.set(e.objectId,t),this._update.modify(e))}for(const e of i){const t=new L(e,!1),r=this._overrides.get(e.objectId);t.lastWeak=r?.isWeak?r:r?.lastWeak??null,this._overrides.set(e.objectId,t),this._update.modify(e)}for(const e of s){const t=new L(null,!0),r=this._overrides.get(e);r?.isStrong?r.lastWeak=t:(this._overrides.set(e,t),this._update.remove(e))}for(const e of n){const t=new L(null,!1),r=this._overrides.get(e);t.lastWeak=r?.isWeak?r:r?.lastWeak??null,this._overrides.set(e,t),this._update.remove(e)}if(o.length){const e=new Set;for(const t of o){const r=this._overrides.get(t);r?.lastWeak?(this._overrides.set(t,r.lastWeak),null==r.lastWeak.inner?this._update.remove(t):this._update.modify(r.lastWeak.inner)):r&&!r.isWeak&&(this._overrides.delete(t),e.add(t))}t.forEachUnsafe(t=>{const r=t.getObjectId();e.has(r)&&(this._update.modify(t.readOptimizedFeatureWorldSpace()),e.delete(r))});for(const t of e.values())this._update.remove(t)}}clearWeakOverrides(){for(const[e,t]of this._overrides.entries())t.isWeak&&this._overrides.delete(e);this.invalidate()}cleanup(e){if(this._overrides.size<1e4)return;const t=performance.now();if(t-this._lastCleanup<1e3)return;this._lastCleanup=t;const r=this._getWeakDeletions();if(!(r.size<1e4)){for(const t of e){const e=t.reader.withoutOverrides().getCursor();for(;e.next();){const t=e.getObjectId();r.delete(t)}}for(const e of r)this._overrides.delete(e);r.size&&this.invalidate()}}takeOverrideUpdate(){const e=this._update;return e.isEmpty?null:(this._update=new E,e)}asChunk(e){if(!this._chunk){const t=[];for(const e of this._overrides.values())null!=e.inner&&t.push(e.inner);this._chunk=Y.fromFeatures(t,e)}return this._chunk}invalidate(){this._chunk=null}putWeakObjectIdsFromGlobalIds(e,t,r){for(const[s,i]of this._overrides.entries()){if(i.isWeak&&null!=i.inner){const n=i.inner.attributes[r];n&&t.has(n)&&!e.has(n)&&e.set(n,s);continue}if(null!=i.lastWeak&&null!=i.lastWeak.inner){const n=i.lastWeak.inner.attributes[r];n&&t.has(n)&&!e.has(n)&&e.set(n,s)}}}_getWeakDeletions(){const e=new Set;for(const[t,r]of this._overrides.entries())r.isWeak&&null==r.inner&&e.add(t);return e}}class Z extends j{constructor(e,t,r,s){super(),this._reader=e,this._queryJSON=t,this._page=r,this._end=s,this.chunkId=`${this._page}${this.end?"e":""}`,this.normalizedChunkId=this.chunkId}get reader(){return this._reader}get first(){return 0===this._page}get end(){return this._end}get queryInfo(){return{type:"snapshot",chunkId:this.chunkId,queryJSON:this._queryJSON,page:this._page,size:this.size(),end:this.end}}get isTiled(){return!1}getTileReader(e){const t=this.queryFeaturesInBounds(e.bounds);return t.setTransformForDisplay(e.transform),t}}let J;class V extends a.b{constructor(e,t,r,s,n=new Uint32Array(r.size())){super(e),this._fields=t,this._inner=r,this._chunkId=s,this._displayIds=n,this._index=-1,this.usedMemory=i.d,this._size=this._inner.size(),e.featureIdInfo.type,this._chunkId>65535&&console.error("Exceeded max allowed parquet reader size")}destroy(){super.destroy(),this._inner.free()}get fields(){return this._fields}get geometryType(){return this.metadata.geometryType}get hasFeatures(){return!0}get hasNext(){throw new Error("Method not implemented.")}get exceededTransferLimit(){return!1}get hasZ(){return!1}get hasM(){return!1}getInTransform(){return null}getSize(){return this._size}getCursor(){return this.copy()}getAttributeHash(){let e="";for(const t of this.fields.fields)e+=this._readAttribute(t.name,!1)+".";return e}getObjectId(){return this._inner.rowId(this._index)}getDisplayId(){return this._displayIds[this._index]}setDisplayId(e){this._displayIds[this._index]=e}setIndex(e){this._index=e}getBoundsXMin(){return this._inner.boundsXMin(this._index)}getBoundsYMin(){return this._inner.boundsYMin(this._index)}getBoundsXMax(){return this._inner.boundsXMax(this._index)}getBoundsYMax(){return this._inner.boundsYMax(this._index)}setBoundsXMin(e){throw new Error("InternalError: Setting bounds is unsupported")}setBoundsYMin(e){throw new Error("InternalError: Setting bounds is unsupported")}setBoundsXMax(e){throw new Error("InternalError: Setting bounds is unsupported")}setBoundsYMax(e){throw new Error("InternalError: Setting bounds is unsupported")}getIndex(){return this._index}next(){for(;++this._index<this._size&&!this._getExists(););return this._index<this._size}readGeometryArea(){return this.readGeometryForDisplay()?.area()??0}copy(){const e=new V(this.metadata,this._fields,this._inner,this._chunkId,this._displayIds);return this.copyInto(e),e}copyInto(e){super.copyInto(e),e._index=this._index}readGeometryForDisplayTransformed(e){const[t,r]=e.translate,[s,i]=e.scale;return J||(J=o.Q.new()),this._inner.transformGeometry(J,t,r,s,i,this._index)?new n.O(J.readLengthsUnsafe(),J.readCoordsUnsafe()):null}_readGeometry(e){const t=this._inner.readCoords(this._index),r=this._inner.readLengths(this._index);return t&&r?new n.O(r,t):null}_readX(){return this._inner.readX(this._index)}_readY(){return this._inner.readY(this._index)}_readServerCentroid(){return null}_readAttribute(e,t){const r=this.fields.get(e);if(!r)return;if(null==r.column)return this.getObjectId();const s=this._inner.readAttribute(this._index,r.column);if(null==s)return s;const i=this.fields.isDateField(r.name);return t?null==s?s:i?new Date(s):s:s}_readAttributes(){const e={};for(const t of this._fields.fields)null!=t.column&&(this._inner.isEmpty(t.column)||(e[t.name]=this._readAttribute(t.name,!1)));return e.__OBJECTID=this.getObjectId(),e}}class ${constructor(e){this._metadata=e,this._chunks=new Map,this._chunksToRemove=[],this._overrides=new U,this.events=new h.bk,this.featureAdapter=new a.a}destroy(){this.clear()}clear(){for(const e of this._chunks.values())this._chunksToRemove.push(e);this._chunks.clear(),this._overrides.clearWeakOverrides()}*chunks(){this._overrides&&(yield this._overrides.asChunk(this._metadata)),yield*this._chunks.values()}insert(e){(0,s.h)("esri-2d-update-debug")&&console.debug(`Chunk[${e.chunkId}] SourceChunkStore.insert`),this._overrides.onChunkInsert(e),this._chunks.set(e.chunkId,e),this.events.emit("changed")}remove(e){(0,s.h)("esri-2d-update-debug")&&console.debug(`Chunk[${e.chunkId}] SourceChunkStore.remove`),this._chunks.delete(e.chunkId),this._chunksToRemove.push(e)}removeById(e){(0,s.h)("esri-2d-update-debug")&&console.debug(`Chunk[${e}] SourceChunkStore.remove`);const t=this._chunks.get(e);this._chunks.delete(e),t&&this._chunksToRemove.push(t)}cleanup(){const e=this._chunksToRemove;return this._chunksToRemove=[],this._overrides.cleanup(this._chunks.values()),e}applyOverride(e){this._overrides.apply(e,this),this.events.emit("changed");for(const e of this._chunks.values())e.invalidate()}takeOverrideUpdate(){return this._overrides.takeOverrideUpdate()}refresh(){this.events.emit("refresh")}forEach(e){const t=new Set;for(const r of this.chunks()){const s=r.reader.getCursor();for(;s.next();){const r=s.getObjectId();t.has(r)||(e(s.copy()),t.add(r))}}}forEachUnsafe(e){const t=new Set;for(const r of this.chunks()){const s=r.reader.getCursor();for(;s.next();){const r=s.getObjectId();t.has(r)||(e(s),t.add(r))}}}mapObjectIdsFromGlobalIds(e,t){const r=new Map,s=new Set(e);return this._overrides.putWeakObjectIdsFromGlobalIds(r,s,t),this._forEachUnsafeIgnoreOverrides(e=>{const i=e.readAttribute(t);if(i&&s.has(i)&&!r.has(i)){const t=e.getObjectId();r.set(i,t)}}),r}forEachInBounds(e,t){const r=new Set;for(const s of this.chunks()){const i=s.queryFeaturesInBounds(e);for(;i.next();){const e=i.getObjectId();r.has(e)||(t(i.copy()),r.add(e))}}}forEachBounds(e,t){const r=(0,u.c)();for(const s of e)s.getBounds(r)&&t(r)}_forEachUnsafeIgnoreOverrides(e){const t=new Set;for(const r of this._chunks.values()){const s=r.reader.withoutOverrides().getCursor();for(;s.next();){const r=s.getObjectId();t.has(r)||(e(s),t.add(r))}}}}},95115:(e,t,r)=>{r.d(t,{F:()=>W,S:()=>g,a:()=>z,b:()=>P,c:()=>A,d:()=>C,e:()=>G,f:()=>m,i:()=>N});var s=r(58003),i=r(83637),n=r(79875),o=r(26589),a=r(32773),h=r(47334),u=r(47239),_=r(77037),l=r(69310),c=r(96153),d=r(16345),f=r(20266),p=r(7969);class g{static fromBuffer(e,t){return new g(e,t)}static create(e,t=4294967295){const r=new Uint32Array(Math.ceil(e/32));return new g(r,t)}constructor(e,t){this._mask=0,this._buf=e,this._mask=t}_getIndex(e){return Math.floor(e/32)}has(e){const t=this._mask&e;return!!(this._buf[this._getIndex(t)]&1<<t%32)}hasRange(e,t){let r=e,s=t;for(;r%32&&r!==s;){if(this.has(r))return!0;r++}for(;s%32&&r!==s;){if(this.has(r))return!0;s--}if(r===s)return!1;for(let e=r/32;e!==s/32;e++)if(this._buf[e])return!0;return!1}set(e){const t=this._mask&e,r=this._getIndex(t),s=1<<t%32;this._buf[r]|=s}setRange(e,t){let r=e,s=t;for(;r%32&&r!==s;)this.set(r++);for(;s%32&&r!==s;)this.set(s--);if(r!==s)for(let e=r/32;e!==s/32;e++)this._buf[e]=4294967295}unset(e){const t=this._mask&e,r=this._getIndex(t),s=1<<t%32;this._buf[r]&=4294967295^s}resize(e){const t=this._buf,r=new Uint32Array(Math.ceil(e/32));r.set(t),this._buf=r}or(e){for(let t=0;t<this._buf.length;t++)this._buf[t]|=e._buf[t];return this}and(e){for(let t=0;t<this._buf.length;t++)this._buf[t]&=e._buf[t];return this}xor(e){for(let t=0;t<this._buf.length;t++)this._buf[t]^=e._buf[t];return this}ior(e){for(let t=0;t<this._buf.length;t++)this._buf[t]|=~e._buf[t];return this}iand(e){for(let t=0;t<this._buf.length;t++)this._buf[t]&=~e._buf[t];return this}ixor(e){for(let t=0;t<this._buf.length;t++)this._buf[t]^=~e._buf[t];return this}any(){for(let e=0;e<this._buf.length;e++)if(this._buf[e])return!0;return!1}copy(e){for(let t=0;t<this._buf.length;t++)this._buf[t]=e._buf[t];return this}clone(){return new g(this._buf.slice(),this._mask)}clear(){for(let e=0;e<this._buf.length;e++)this._buf[e]=0;return this}forEachSet(e){for(let t=0;t<this._buf.length;t++){let r=this._buf[t],s=32*t;if(r)for(;r;)1&r&&e(s),r>>>=1,s++}}countSet(){let e=0;return this.forEachSet(t=>{e++}),e}}class m{constructor(e){this._valid=g.create(e),this._data=new Array(e)}has(e){return this._valid.has(e)}set(e,t){this._valid.set(e),this._data[e]=t}get(e){return this._data[e]}}const y=(0,a.h)("featurelayer-simplify-thresholds")??[.5,.5,.5,.5],b=y[0],w=y[1],x=y[2],I=y[3],v=(0,a.h)("featurelayer-simplify-payload-size-factors")??[1,2,4],T=v[0],F=v[1],S=v[2],M=(0,a.h)("featurelayer-simplify-mobile-factor")??2,O=(0,a.h)("esri-mobile"),k=4294967295;class P{constructor(e){this.metadata=e,this.type="FeatureSetReader",this._overrides=null,this._joined=[],this._objectIdToIndex=null,this._boundsBuffer=[],this._caches=new Map,this.arcadeDeclaredClass="esri.arcade.Feature",this._contextTimeZone=null}destroy(){}[Symbol.dispose](){this.destroy()}getAreaSimplificationThreshold(e,t){let r=1;const s=O?M:1;t>4e6?r=S*s:t>1e6?r=F*s:t>5e5?r=T*s:t>1e5&&(r=s);let i=0;return e>4e3?i=I*r:e>2e3?i=x*r:e>100?i=w:e>15&&(i=b),i}getBounds(e){!function(e,t){if(!(e.length>t))for(;e.length<=t;)e.push(0)}(this._boundsBuffer,4*this.getIndex()+4);const t=this.getBoundsXMin();if(t===k||!isFinite(t))return!1;if(0===this.getBoundsXMin()){const t=this.readGeometryWorldSpace();if(t?.isPoint&&0===t.coords[0]&&0===t.coords[1])return(0,u.a)(e,0,0,0,0),!0;if(!t)return this.setBoundsXMin(k),!1;let r=1/0,s=1/0,i=-1/0,n=-1/0;return t.forEachVertex((e,t)=>{r=Math.min(r,e),s=Math.min(s,t),i=Math.max(i,e),n=Math.max(n,t)}),this.setBoundsXMin(r),this.setBoundsYMin(s),this.setBoundsXMax(i),this.setBoundsYMax(n),(0,u.a)(e,r,s,i,n),!0}const r=this.getBoundsXMin(),s=this.getBoundsYMin(),i=this.getBoundsXMax(),n=this.getBoundsYMax();return(0,u.a)(e,r,s,i,n),!0}getBoundsXMin(){return this._boundsBuffer[4*this.getIndex()]}setBoundsXMin(e){this._boundsBuffer[4*this.getIndex()]=e}getBoundsYMin(){return this._boundsBuffer[4*this.getIndex()+1]}setBoundsYMin(e){this._boundsBuffer[4*this.getIndex()+1]=e}getBoundsXMax(){return this._boundsBuffer[4*this.getIndex()+2]}setBoundsXMax(e){this._boundsBuffer[4*this.getIndex()+2]=e}getBoundsYMax(){return this._boundsBuffer[4*this.getIndex()+3]}setBoundsYMax(e){this._boundsBuffer[4*this.getIndex()+3]=e}readAttributeAsTimestamp(e){const t=this.readAttribute(e);return"string"==typeof t?new Date(t).getTime():"number"==typeof t||null==t?t:null}readAttribute(e,t=!1){const r=this._readAttribute(e,t);if(void 0!==r)return r;for(const r of this._joined){r.setIndex(this.getIndex());const s=r._readAttribute(e,t);if(void 0!==s)return s}}readAttributes(){const e=this._readAttributes();for(const t of this._joined){t.setIndex(this.getIndex());const r=t._readAttributes();for(const t of Object.keys(r))e[t]=r[t]}return e}joinAttributes(e){this._joined.push(e)}registerOverrides(e){this._overrides=e}withoutOverrides(){const e=this.copy();return e._overrides=null,e}readOptimizedFeatureWorldSpace(){const e=this.readGeometryWorldSpace(),t=this.readAttributes(),r=this.readCentroidWorldSpace();return new s.O(e,t,r,this.getObjectId(),this.getDisplayId())}readLegacyFeatureForDisplay(){const e=this.readCentroidForDisplay();return{attributes:this.readAttributes(),geometry:this.readLegacyGeometryForDisplay(),centroid:(e&&{x:e.coords[0],y:e.coords[1]})??null}}readLegacyFeatureWorldSpace(){const e=this.readCentroidWorldSpace();return{attributes:this.readAttributes(),geometry:this._readLegacyGeometryWorldSpace(),centroid:(e&&{x:e.coords[0],y:e.coords[1]})??null}}readLegacyGeometryForDisplay(){const e=this.readGeometryForDisplay();return(0,i.a)(e,this.geometryType,!1,!1)}readXForDisplay(){return this._readX()}readYForDisplay(){return this._readY()}readXWorldSpace(){const e=this._readX(),t=this.getInTransform();return null==t?e:e*t.scale[0]+t.translate[0]}readYWorldSpace(){const e=this._readY(),t=this.getInTransform();return null==t?e:t.translate[1]-e*t.scale[1]}readGeometryForDisplay(){const e=this._readGeometryDeltaDecoded(!0);if(!e){const e=this._createDeltaQuantizedGeometryFromServerCentroid();return e?e.deltaDecode():null}return e}readGeometryForDisplayTransformed(e){let t=this.readGeometryForDisplay();if(t&&"esriGeometryPolyline"===this.metadata.geometryType&&(t=(0,i.h)(new c.O,t,this.hasZ,this.hasM,this.metadata.geometryType,e.scale[0])),t&&(t=(0,i.p)(t,e,this.metadata.geometryType,this.hasZ,this.hasM)),!t){const t=this.readCentroidForDisplay();if(!t)return null;const r=(0,l.f)(e,t.coords[0]),s=(0,l.g)(e,t.coords[1]);return this._createDeltaQuantizedExtrudedGeometry(r,s).deltaDecode()}return t}readGeometryWorldSpace(){let e=this._readGeometry();if(e||(e=this._createDeltaQuantizedGeometryFromServerCentroid()),!e)return null;const t=e.clone(),r=this.getInTransform();return null!=r&&(0,i.u)(t,t,this.hasZ,this.hasM,r),t}readCentroidForDisplay(){const e=this.readGeometryForDisplay();return e?this._computeDisplayCentroid(e):this._readServerCentroid()}readCentroidWorldSpace(){const e=this.readGeometryForDisplay(),t=e?this._computeDisplayCentroid(e):this._readServerCentroid();if(!t)return null;const r=t.clone(),s=this.getInTransform();return null!=s&&(0,i.u)(r,r,this.hasZ,this.hasM,s),r}setCache(e){let t=this._caches.get(e);null==t&&(t=new m(this.getSize()),this._caches.set(e,t)),this._activeCache=t}setCachedValue(e){this._activeCache.set(this.getIndex(),e)}hasCachedValue(){return this._activeCache.has(this.getIndex())}getCachedValue(){return this._activeCache.get(this.getIndex())}_readGeometryDeltaDecoded(e){const t=this._readGeometry(e);return"esriGeometryPoint"!==this.geometryType&&t&&this.getInTransform()?t.deltaDecode():t}get contextTimeZone(){return this._contextTimeZone}set contextTimeZone(e){this._contextTimeZone=e}readArcadeFeature(){return this}hasField(e){return this.fields.has(e)||this._joined.some(t=>t.hasField(e))}geometry(){const e=this.readGeometryWorldSpace(),t=(0,i.a)(e,this.geometryType,this.hasZ,this.hasM),r=(0,_.rS)(t);if(r){if(!this.metadata.outSpatialReference)throw new Error("InternalError: Expected spatial reference to be defined");r.spatialReference=this.metadata.outSpatialReference}return r}autocastArcadeDate(e,t){return t&&t instanceof Date?this.isUnknownDateTimeField(e)?o.A.unknownDateJSToArcadeDate(t):o.A.dateJSAndZoneToArcadeDate(t,this.contextTimeZone??d.s):t}isUnknownDateTimeField(e){return this.metadata.fieldsIndex.getTimeZone(e)===d.u}field(e){let t=this.fields.get(e);if(t)switch(t.type){case"date-only":case"esriFieldTypeDateOnly":return o.D.fromReader(this.readAttribute(e,!1));case"time-only":case"esriFieldTypeTimeOnly":return o.T.fromReader(this.readAttribute(e,!1));case"esriFieldTypeTimestampOffset":case"timestamp-offset":return o.A.fromReaderAsTimeStampOffset(this.readAttribute(e,!1));case"date":case"esriFieldTypeDate":return this.autocastArcadeDate(e,this.readAttribute(e,!0));default:return this.readAttribute(e,!1)}for(const r of this._joined)if(r.setIndex(this.getIndex()),t=r.fields.get(e),t)switch(t.type){case"date-only":case"esriFieldTypeDateOnly":return o.D.fromReader(r._readAttribute(e,!1));case"time-only":case"esriFieldTypeTimeOnly":return o.T.fromReader(r._readAttribute(e,!1));case"esriFieldTypeTimestampOffset":case"timestamp-offset":return o.A.fromReaderAsTimeStampOffset(r._readAttribute(e,!1));case"date":case"esriFieldTypeDate":return this.autocastArcadeDate(e,r._readAttribute(e,!0));default:return this.readAttribute(e,!1)}throw new Error(`Field ${e} does not exist`)}setField(e,t){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this.fields.fields.map(e=>e.name)}castToText(e=!1){if(!e)return JSON.stringify(this.readLegacyFeatureForDisplay());const t=this.readLegacyFeatureForDisplay();if(!t)return JSON.stringify(null);const r={geometry:t.geometry,attributes:{...t.attributes??{}}};for(const e in r.attributes){const t=r.attributes[e];t instanceof Date&&(r.attributes[e]=t.getTime())}return JSON.stringify(r)}gdbVersion(){return null}fullSchema(){return this.metadata.arcadeSchema}castAsJson(e=null){return{attributes:this._readAttributes(),geometry:!0===e?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(e=null,t=null){return Promise.resolve(this.castAsJson(t))}_getExists(){if(this._overrides){const e=this.getObjectId();return!this._overrides.hasOverride(e)}return!0}_computeDisplayCentroid(e){if(null==this.getInTransform())return(0,s.g)(new c.O,e,this.hasM,this.hasZ);const t=h.G.fromOptimized(e,this.geometryType);t.yFactor*=-1;const r=(0,h.g)(t);return r?(r[1]*=-1,new c.O([],r)):null}copyInto(e){e._joined=this._joined,e._overrides=this._overrides,e._objectIdToIndex=this._objectIdToIndex,e._boundsBuffer=this._boundsBuffer,e._activeCache=this._activeCache,e._caches=this._caches,e._contextTimeZone=this._contextTimeZone}_readLegacyGeometryWorldSpace(){const e=this.readGeometryWorldSpace();return(0,i.a)(e,this.geometryType,!1,!1)}_createDeltaQuantizedGeometryFromServerCentroid(){const e=this._readServerCentroid();if(!e)return null;const[t,r]=e.coords;return this._createDeltaQuantizedExtrudedGeometry(t,r)}_createDeltaQuantizedExtrudedGeometry(e,t){return"esriGeometryPolyline"===this.geometryType?this._createDeltaQuantizedExtrudedLine(e,t):this._createDeltaQuantizedExtrudedQuad(e,t)}_createDeltaQuantizedExtrudedQuad(e,t){return new c.O([5],[e-1,t,1,-1,1,1,-1,1,-1,-1])}_createDeltaQuantizedExtrudedLine(e,t){return new c.O([2],[e-1,t+1,1,-1])}}class A extends P{static fromFeatures(e,t){const{geometryType:r}=t,s=(0,i.d)([],e,r,!1,!1,t.featureIdInfo);for(let t=0;t<s.length;t++)s[t].displayId=e[t].displayId;return A.fromOptimizedFeatures(s,t)}static fromFeatureSet(e,t){const r=(0,i.o)(e,t.featureIdInfo);return A.fromOptimizedFeatureSet(r,t)}static fromOptimizedFeatureSet(e,t){const r=A.fromOptimizedFeatures(e.features,t);return r._exceededTransferLimit=e.exceededTransferLimit,r._transform=e.transform,r._fieldsIndex=new n.A(e.fields),r}static fromOptimizedFeatures(e,t,r){const s=new A(e,t);return s._fieldsIndex=t.fieldsIndex,s._transform=r,s}static empty(e){return new A([],e)}constructor(e,t){super(t),this._exceededTransferLimit=!1,this._featureIndex=-1,this._fieldsIndex=null,this._geometryType=t.geometryType,this._features=e}get fields(){return this._fieldsIndex}get geometryType(){return this._geometryType}get hasFeatures(){return!!this._features.length}get hasNext(){return this._featureIndex+1<this._features.length}get exceededTransferLimit(){return this._exceededTransferLimit}get hasZ(){return!1}get hasM(){return!1}get _current(){return this._features[this._featureIndex]}get usedMemory(){return this._current.usedMemory}getSize(){return this._features.length}getCursor(){return this.copy()}getInTransform(){return this._transform}getAttributeHash(){let e="";for(const t in this._current.attributes)e+=this._current.attributes[t];return e}getIndex(){return this._featureIndex}setIndex(e){this._featureIndex=e}getObjectId(){return this._current?.objectId}getDisplayId(){return this._current.displayId}setDisplayId(e){this._current.displayId=e}copy(){const e=new A(this._features,this.metadata);return this.copyInto(e),e}next(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length}readGeometryArea(){return(0,s.h)(this._current)?(0,i.s)(this._current.geometry,2):0}_readX(){return(0,s.h)(this._current)?this._current.geometry.coords[0]:0}_readY(){return(0,s.h)(this._current)?this._current.geometry.coords[1]:0}_readGeometry(){return(0,s.h)(this._current)?this._current.geometry??null:null}_readServerCentroid(){return this._current.centroid}_readAttribute(e,t){if(!this._fieldsIndex){const t=this._current.attributes[e];if(void 0!==t)return t;const r=e.toLowerCase();for(const e in this._current.attributes)if(e.toLowerCase()===r)return this._current.attributes[e];return}const r=this._fieldsIndex.get(e);if(!r)return;const s=this._current.attributes[r.name];return null==s?s:t&&this.fields.isDateField(e)?new Date(s):s}_readAttributes(){return this._current.attributes}copyInto(e){super.copyInto(e),e._featureIndex=this._featureIndex,e._transform=this._transform,e._fieldsIndex=this._fieldsIndex}}class z{static{this.Shared=new z}getObjectId(e){return e.getObjectId()}getAttributes(e){return e.readAttributes()}getAttribute(e,t){return e.readAttribute(t)}getAttributeAsTimestamp(e,t){return e.readAttributeAsTimestamp(t)}cloneWithGeometry(e,t){const r=e.readAttributes(),i=new s.O(t,r,null,e.getObjectId(),e.getDisplayId()),n=A.fromOptimizedFeatures([i],e.metadata);return n.setIndex(0),n}getGeometry(e){return e.readGeometryWorldSpace()}getCentroid(e,t){return e.readCentroidForDisplay()}}function C(e,t,r){if(null==e)return null;const s=t.readArcadeFeature();t.contextTimeZone=r.$view?.timeZone;try{return e.evaluate(s,r)}catch(e){return f.L.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}function N(e){return null==e||e===1/0||e===-1/0||"number"==typeof e&&isNaN(e)}function G(e,t,r,s){if(null==e)return null!=s?s:null;const i=t.readArcadeFeature();t.contextTimeZone=r.$view?.timeZone;const n=e.evaluate(i,r);return N(n)?null!=s?s:null:n}class W{static minimal(e,t,r=[]){return new W({geometryType:e,fieldsIndex:new n.A(r).toJSON(),featureIdInfo:{type:"object-id",fieldName:t},subtypes:null,subtypeField:null,types:null,globalIdField:null,spatialReference:null,outSpatialReference:null,timeInfo:null,timeReferenceUnknownClient:null,dateFieldsTimeZone:null,typeIdField:null})}static createFeature(e){return new W(e)}constructor(e){let t;this._options=e,this._fieldsIndex=n.A.fromJSON(e.fieldsIndex),e.spatialReference&&(this._spatialReference=p.A.fromJSON(e.spatialReference)),e.outSpatialReference&&(this._outSpatialReference=p.A.fromJSON(e.outSpatialReference)),"object-id"===e.featureIdInfo.type&&(t=e.featureIdInfo.fieldName),this._arcadeSchema={fields:this.fieldsIndex.fields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,objectIdField:t,globalIdField:this._options.globalIdField,spatialReference:this._spatialReference,timeInfo:this._options.timeInfo,typeIdField:this._options.typeIdField??void 0,types:this._options.types??void 0,subtypeField:this._options.subtypeField,subtypes:this._options.subtypes??void 0,datesInUnknownTimezone:this._options.timeReferenceUnknownClient??void 0,dateFieldsTimeZone:this._options.dateFieldsTimeZone??void 0}}get fieldsIndex(){return this._fieldsIndex}get geometryType(){return"esriGeometryMultiPatch"===this._options.geometryType?"esriGeometryPolygon":this._options.geometryType}get serviceGeometryType(){return this._options.geometryType}get subtypeField(){return this._options.subtypeField}get timeInfo(){return this._options.timeInfo}get featureIdInfo(){return this._options.featureIdInfo}get globalIdField(){return this._options.globalIdField}get arcadeSchema(){return this._arcadeSchema}get spatialReference(){return this._spatialReference}get outSpatialReference(){return this._outSpatialReference}get timeReferenceUnknownClient(){return this._options.timeReferenceUnknownClient}weakCloneWithAdditionalFields(e){return new W({fieldsIndex:{fields:[...this._fieldsIndex.fields,...e],timeZoneByFieldName:null},geometryType:this.geometryType,globalIdField:this.globalIdField,featureIdInfo:this.featureIdInfo,spatialReference:this.spatialReference,outSpatialReference:this.outSpatialReference,subtypeField:this.subtypeField,subtypes:this._options.subtypes,timeInfo:this.timeInfo,timeReferenceUnknownClient:this.timeReferenceUnknownClient,dateFieldsTimeZone:this._options.dateFieldsTimeZone,typeIdField:this._options.typeIdField,types:this._options.types})}}}}]);