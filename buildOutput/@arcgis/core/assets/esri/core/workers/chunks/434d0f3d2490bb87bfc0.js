"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[8625],{18625:(e,t,i)=>{i.r(t),i.d(t,{default:()=>q});var n=i(32816),s=i(84560),r=i(52731),o=i(81040),l=i(99924),a=i(57732),h=i(29298),u=i(48844),d=i(32773),p=i(69421),c=i(36544),w=i(64752),y=(i(26809),i(2589),i(18527),i(92080),i(77641),i(46484),i(62482),i(16699)),m=(i(95522),i(47812),i(47239),i(44600)),v=(i(84699),i(59121),i(20266),i(90740),i(2160),i(49877),i(7969),i(41390),i(85176),i(93181),i(13671),i(50704),i(40499),i(36555),i(58498),i(91047),i(35819),i(45371),i(61532),i(80959),i(6407),i(19247),i(36172),i(69763),i(93804),i(96221),i(18683),i(64604),i(29512),i(99063),i(1178),i(56273));i(48064),i(29208),i(48402),i(22522),i(5611),i(91276),i(68208),i(58660);let f=class extends((0,l.T)(r.P)){constructor(e){super(e),this.observer=null,this.farDistance=1e3,this.heading=0,this.tilt=90,this.horizontalFieldOfView=45,this.verticalFieldOfView=45,this.feature=null}get valid(){return null!=this.observer&&this.farDistance>0}equals(e){return(0,a.e)(this.observer,e.observer)&&this.farDistance===e.farDistance&&this.heading===e.heading&&this.tilt===e.tilt&&this.horizontalFieldOfView===e.horizontalFieldOfView&&this.verticalFieldOfView===e.verticalFieldOfView&&(0,s.f)(this.feature,e.feature)}};(0,n._)([(0,h.MZ)({type:w.A,json:{write:{isRequired:!0}}})],f.prototype,"observer",void 0),(0,n._)([(0,h.MZ)({type:Number,nonNullable:!0,range:{min:0},json:{write:{isRequired:!0}}})],f.prototype,"farDistance",void 0),(0,n._)([(0,h.MZ)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),(0,u.w)(e=>o.c.normalize((0,c.f)(e),void 0,!0))],f.prototype,"heading",void 0),(0,n._)([(0,h.MZ)({type:Number,nonNullable:!0,range:{min:0,max:180},json:{write:{isRequired:!0}}})],f.prototype,"tilt",void 0),(0,n._)([(0,h.MZ)({type:Number,nonNullable:!0,range:{min:0,max:360},json:{write:{isRequired:!0}}})],f.prototype,"horizontalFieldOfView",void 0),(0,n._)([(0,h.MZ)({type:Number,nonNullable:!0,range:{min:0,max:180},json:{write:{isRequired:!0}}})],f.prototype,"verticalFieldOfView",void 0),(0,n._)([(0,h.MZ)(s.a)],f.prototype,"feature",void 0),(0,n._)([(0,h.MZ)({readOnly:!0,json:{read:!1}})],f.prototype,"valid",null),f=(0,n._)([(0,p.$)("esri.analysis.Viewshed")],f);var g=i(61912),M=i(17745),_=i(19297),x=i(67321),b=i(88321);i(87220),i(80473),i(81272),i(44945),i(36533),i(84200),i(97827),i(18169),i(20762),i(67504),i(47387),i(46728),i(21632),i(64102);const Z=M.A.ofType(f);let O=class extends g.A{constructor(e){super(e),this.type="viewshed",this._extent=null}initialize(){this.addHandles((0,x.wB)(()=>this._computeExtent(),e=>{null==e.pending&&(this._extent=e.extent)},x.pc))}get viewsheds(){return this._get("viewsheds")||new Z}set viewsheds(e){this._set("viewsheds",(0,_.r)(e,this.viewsheds,Z))}get spatialReference(){for(const e of this.viewsheds)if(null!=e.observer)return e.observer.spatialReference;return null}get extent(){return this._extent}get valid(){return this.viewsheds.every(e=>e.valid)}async waitComputeExtent(){const e=this._computeExtent();null!=e.pending&&await e.pending}_computeExtent(){const{spatialReference:e}=this;if(null==e)return{pending:null,extent:null};const t=this.viewsheds.filter(e=>null!=e.observer),i=t.map(e=>e.observer).toArray(),n=(0,b.projectOrLoadMany)(i,e);return null!=n.pending?{pending:n.pending,extent:null}:{pending:null,extent:n.geometries.map((e,i)=>{const n=t.at(i);return null!=e&&null!=n?this._computeViewshedExtent(this.viewsheds.at(i),e):null}).filter(e=>null!=e).reduce((e,t)=>{return n=t,null==(i=e)?n:null==n?i:i.union(n);var i,n},null)}}_computeViewshedExtent(e,t){const{farDistance:i,heading:n,tilt:s,horizontalFieldOfView:r,verticalFieldOfView:l}=e,{spatialReference:a}=t,h=r/2,u=l/2,d=i/a.metersPerUnit,p=[o.c.normalize(n-h),n,o.c.normalize(n+h)],c=m.A.fromPoint(t),w=e=>{const t=p.map(t=>o.c.normalize(t-e));if(t[0]>t[2]||360===r)return d;const i=t.map(e=>Math.abs(e>180?360-e:e)).reduce((e,t)=>e>t?t:e);return i>90?0:d*Math.cos((0,y.e)(i))};c.xmax+=w(90),c.xmin-=w(-90),c.ymax+=w(0),c.ymin-=w(180);const v=t.z;if(null!=v){let e=v,t=v;const n=s-90,r=(0,y.c)(n+u,-90,90),o=(0,y.c)(n-u,-90,90),l=a?.isGeographic?i:d;e+=l*z(r),t+=l*z(o);const p=V(u)*l,w=z(n)*p*(1-V(h));s<90&&(e-=w),s>90&&(t-=w),c.zmax=Math.max(e,v),c.zmin=Math.min(t,v)}return c}equals(e){return this===e||super.equals(e)&&(0,d.e)(this.viewsheds.toArray(),e.viewsheds.toArray(),(e,t)=>e.equals(t))}clear(){this.viewsheds.removeAll()}};function V(e){return Math.cos((0,y.e)(e))}function z(e){return Math.sin((0,y.e)(e))}(0,n._)([(0,h.MZ)({type:["viewshed"]})],O.prototype,"type",void 0),(0,n._)([(0,h.MZ)({cast:_.c,type:Z,nonNullable:!0})],O.prototype,"viewsheds",null),(0,n._)([(0,h.MZ)({readOnly:!0})],O.prototype,"spatialReference",null),(0,n._)([(0,h.MZ)()],O.prototype,"_extent",void 0),(0,n._)([(0,h.MZ)()],O.prototype,"extent",null),(0,n._)([(0,h.MZ)({readOnly:!0})],O.prototype,"valid",null),O=(0,n._)([(0,p.$)("esri.analysis.ViewshedAnalysis")],O);var R=i(2810),N=i(73597),A=i(88730);i(73509),i(28276),i(58194),i(4734),i(50214),i(59192),i(16345),i(54483),i(65174),i(17012),i(98203),i(30011),i(54131),i(19869),i(53065),i(20804),i(63834),i(87357),i(19969),i(9207),i(64524);let j=class extends((0,A.q)((0,R.M)(N.A))){constructor(e){super(e),this.type="viewshed",this.operationalLayerType="ViewshedLayer",this.source=new O,this.opacity=1}initialize(){this.addHandles((0,x.wB)(()=>this.source,(e,t)=>{null!=t&&t.parent===this&&(t.parent=null),null!=e&&(e.parent=this)},x.pc))}async load(){return this.addResolvingPromise(this.source.waitComputeExtent()),this}get spatialReference(){return this.source.spatialReference}get fullExtent(){return this.source.extent}releaseAnalysis(e){this.source===e&&(this.source=new O)}get analysis(){return this.source}set analysis(e){this.source=e}get viewsheds(){return this.source.viewsheds}set viewsheds(e){this.source.viewsheds=e}writeViewsheds(e,t,i,n){t.viewsheds=e.filter(e=>e.valid).toJSON(n)}};(0,n._)([(0,h.MZ)({json:{read:!1},readOnly:!0})],j.prototype,"type",void 0),(0,n._)([(0,h.MZ)({type:["ViewshedLayer"]})],j.prototype,"operationalLayerType",void 0),(0,n._)([(0,h.MZ)({type:O,nonNullable:!0})],j.prototype,"source",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],j.prototype,"spatialReference",null),(0,n._)([(0,h.MZ)({readOnly:!0})],j.prototype,"fullExtent",null),(0,n._)([(0,h.MZ)({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],j.prototype,"opacity",void 0),(0,n._)([(0,h.MZ)({type:["show","hide"]})],j.prototype,"listMode",void 0),(0,n._)([(0,h.MZ)({type:M.A.ofType(f),json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{ignoreOrigin:!0}}}}})],j.prototype,"viewsheds",null),(0,n._)([(0,v.w)("web-scene","viewsheds")],j.prototype,"writeViewsheds",null),j=(0,n._)([(0,p.$)("esri.layers.ViewshedLayer")],j);const q=j},81040:(e,t,i)=>{i.d(t,{C:()=>s,b:()=>l,c:()=>a});var n=i(16699);class s{constructor(e,t){this.min=e,this.max=t,this.range=t-e}normalize(e,t=0,i=!1){return r(this.range,this.min,this.max,e,t,i)}clamp(e,t=0){return(0,n.c)(e-t,this.min,this.max)+t}monotonic(e,t,i){return e<t?t:t+o(this.range,e-t,i)}minimalMonotonic(e,t,i){return r(this.range,e,e+this.range,t,i)}center(e,t,i){return t=this.monotonic(e,t,i),this.normalize((e+t)/2,i)}diff(e,t,i){return this.monotonic(e,t,i)-e}shortestSignedDiff(e,t){e=this.normalize(e);const i=(t=this.normalize(t))-e,n=t<e?this.minimalMonotonic(e,t)-e:t-this.minimalMonotonic(t,e);return Math.abs(i)<Math.abs(n)?i:n}contains(e,t,i){return t=this.minimalMonotonic(e,t),(i=this.minimalMonotonic(e,i))>e&&i<t}}function r(e,t,i,n,s=0,r=!1){return(n-=s)<t?n+=o(e,t-n):n>i&&(n-=o(e,n-i)),r&&n===i&&(n=t),n+s}function o(e,t,i=0){return Math.ceil((t-i)/e)*e+i}const l=new s(0,2*Math.PI),a=(new s(-Math.PI,Math.PI),new s(0,360))}}]);