"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[8896],{38896:(e,t,n)=>{n.d(t,{A:()=>we,S:()=>m,a:()=>f,b:()=>h});var r=n(32773),a=n(26589),o=n(84699),i=n(54483),s=n(133),l=n(16699),u=n(55032);n(7011),n(59192),n(13671),n(44600),n(32816),n(29298),n(20266),n(90740),n(59121),n(36544),n(85176),n(93181),n(40499),n(6407),n(69421),n(50704),n(91047),n(48064),n(2160),n(99924),n(41390),n(36555),n(58498),n(35819),n(45371),n(61532),n(80959),n(19247),n(36172),n(49877),n(7969),n(69763),n(93804),n(96221),n(18683),n(64604),n(29512),n(99063),n(1178),n(56273),n(64752),n(48844),n(29208);const c={InvalidValueForAggregateFunction:"Invalid value used in aggregate function",MissingStatisticParameters:"Statistic does not have 1 or 0 Parameters",InvalidFunctionParameters:"Invalid parameters for call to {function}",UnsupportedIsLhs:"Unsupported left hand expression in is statement",UnsupportedIsRhs:"Unsupported right hand expression in is statement",UnsupportedOperator:"Unsupported operator - {operator}",UnsupportedSyntax:"Unsupported syntax - {node}",UnsupportedSqlFunction:"Sql function not found = {function}",InvalidDataType:"Invalid sql data type",InvalidDate:"Invalid date encountered",InvalidOperator:"Invalid operator encountered",InvalidTime:"Invalid time encountered",IllegalInterval:"Illegal interval",FunctionNotRecognized:"Function not recognized",InvalidTimeStamp:"Invalid timestamp encountered",InvalidParameterCount:"Invalid parameter count for call to {name}",PrimarySecondaryQualifiers:"Primary and Secondary SqlInterval qualifiers not supported",YearMonthIntervals:"Year-Month Intervals not supported",CannotCastValue:"Cannot cast value to the required data type"};class f extends Error{constructor(e,t){super((0,o.r)(c[e],t)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,f)}}function d(e){return Number.isNaN(e)||0===e?e:Math.trunc(e)}const p="esri.core.sql.SqlTimeStampOffset";class m{constructor(e){this._timeStampOffset=e,this.declaredRootClass=p,this._date=null}static isTimestampOffset(e){return"object"==typeof e&&null!=e&&"declaredRootClass"in e&&e.declaredRootClass===p}toDateTime(){return this._date??=i.D.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return d(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return d(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return m.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(e){return new m(i.D.fromJSDate(e).toISO({includeOffset:!0}))}static fromDateTime(e){return new m(e.toISO({includeOffset:!0}))}static fromParts(e,t,n=0,r=0,a=0,o=0,i=0,s=!1,l=0,u=0){const c=`${e.toString().padStart(4,"0")}-${t.toString().padStart(2,"0")}-${n.toString().padStart(2,"0")}`;let f="";o<10&&(f="0");let d=`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${f+o.toString()}`;0!==i&&(d+="."+i.toString().padStart(3,"0"));const p=`${s?"-":"+"}${l.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`;return new m(c+"T"+d+p)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let e=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return e&&(e=e.replace(".000","")),e}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(e){const t=this.toDateTime().plus(e);return m.fromDateTime(t)}}function h(e,t){const n=w[e.toLowerCase()];if(null==n)throw new f("FunctionNotRecognized");if(t.length<n.minParams||t.length>n.maxParams)throw new f("InvalidParameterCount",{name:e.toUpperCase()});return n.evaluate(t)}function v(e,t){const n=w[e.toLowerCase()];return null!=n&&t>=n.minParams&&t<=n.maxParams}const w={min:{minParams:1,maxParams:1,evaluate:e=>y(e[0],"min")},max:{minParams:1,maxParams:1,evaluate:e=>y(e[0],"max")},avg:{minParams:1,maxParams:1,evaluate:e=>I(e[0])},sum:{minParams:1,maxParams:1,evaluate:e=>function(e){if(null===e)return null;let t=0;for(let n=0;n<e.length;n++){const r=e[n];if(null!==r){if(!g(r))throw new f("InvalidValueForAggregateFunction");t+=r}}return t}(e[0])},stddev:{minParams:1,maxParams:1,evaluate:e=>function(e){if(null===e)return null;const t=T(e);return null===t?null:Math.sqrt(t)}(e[0])},count:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].length},var:{minParams:1,maxParams:1,evaluate:e=>T(e[0])}};function I(e){if(null===e)return null;let t=0,n=0;for(let r=0;r<e.length;r++){const a=e[r];if(null!==a){if(!g(a))throw new f("InvalidValueForAggregateFunction");n++,t+=a}}return 0===n?null:t/e.length}function g(e){return"number"==typeof e}function y(e,t){if(null===e)return null;let n=null,r=null;for(const o of e){let e=o;e=a.D.isDateOnly(o)||a.T.isTimeOnly(o)?o.toNumber():i.D.isDateTime(o)?o.toMillis():m.isTimestampOffset(o)?o.toMilliseconds():o,(null===n||"max"===t&&null!==r&&null!==e&&r<=e||"min"===t&&null!==r&&null!==e&&r>=e)&&(n=o,r=e)}return n}function T(e){if(null===e)return null;if(0===(e=e.filter(e=>null!==e)).length)return null;const t=I(e);if(null===t)return null;let n=0;for(const r of e){if(!g(r))throw new f("InvalidValueForAggregateFunction");n+=(t-r)**2}return n/(e.length-1)}function N(e){if(null!==e.precision||null!==e.secondary)throw new f("PrimarySecondaryQualifiers")}function O(e,t){if(t.includes(".")){const n=t.split(".");e.second=parseFloat(n[0]),e.millis=parseInt(n[1],10)}else e.second=parseFloat(t)}const D="esri.core.sql.SqlInterval";class S{constructor(){this.declaredRootClass=D,this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static isInterval(e){return"object"==typeof e&&null!=e&&"declaredRootClass"in e&&e.declaredRootClass===D}static createFromMilliseconds(e){const t=new S;return t.second=e/1e3,t}static createFromValueAndQualifier(e,t,n){let r=null;const a=new S;if(a.op="-"===n?"-":"+","interval-period"===t.type){N(t);const n=new RegExp("^[0-9]{1,}$");if("year"===t.period||"month"===t.period)throw new f("YearMonthIntervals");if("second"===t.period){if(!/^[0-9]{1,}(\.[0-9]{1,}){0,1}$/.test(e))throw new f("IllegalInterval");O(a,e)}else{if(!n.test(e))throw new f("IllegalInterval");a[t.period]=parseFloat(e)}}else{if(N(t.start),N(t.end),"year"===t.start.period||"month"===t.start.period||"year"===t.end.period||"month"===t.end.period)throw new f("YearMonthIntervals");switch(t.start.period){case"day":switch(t.end.period){case"hour":if(r=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!r.test(e))throw new f("IllegalInterval");a[t.start.period]=parseFloat(e.split(" ")[0]),a[t.end.period]=parseFloat(e.split(" ")[1]);break;case"minute":if(r=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!r.test(e))throw new f("IllegalInterval");{a[t.start.period]=parseFloat(e.split(" ")[0]);const n=e.split(" ")[1].split(":");a.hour=parseFloat(n[0]),a.minute=parseFloat(n[1])}break;case"second":if(r=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}(\\.[0-9]{1,}){0,1}$"),!r.test(e))throw new f("IllegalInterval");{a[t.start.period]=parseFloat(e.split(" ")[0]);const n=e.split(" ")[1].split(":");a.hour=parseFloat(n[0]),a.minute=parseFloat(n[1]),O(a,n[2])}break;default:throw new f("IllegalInterval")}break;case"hour":switch(t.end.period){case"minute":if(r=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!r.test(e))throw new f("IllegalInterval");a.hour=parseFloat(e.split(":")[0]),a.minute=parseFloat(e.split(":")[1]);break;case"second":if(r=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}(\\.[0-9]{1,}){0,1}$"),!r.test(e))throw new f("IllegalInterval");{const t=e.split(":");a.hour=parseFloat(t[0]),a.minute=parseFloat(t[1]),O(a,t[2])}break;default:throw new f("IllegalInterval")}break;case"minute":if("second"!==t.end.period)throw new f("IllegalInterval");if(r=new RegExp("^[0-9]{1,}:[0-9]{1,}(\\.[0-9]{1,}){0,1}$"),!r.test(e))throw new f("IllegalInterval");{const t=e.split(":");a.minute=parseFloat(t[0]),O(a,t[1])}break;default:throw new f("IllegalInterval")}}return a}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}const x=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,E=/^(\d{1,2}):(\d{1,2})$/,C=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,_=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,M=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,b=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)? {0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,A=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})? {0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,F=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function L(e,t){if(t instanceof i.Z)return t===s.U.instance?i.D.fromMillis(e.getTime(),{zone:s.U.instance}):i.D.fromJSDate(e,{zone:t});switch(t){case"system":case"local":case null:return i.D.fromJSDate(e);default:return"unknown"===t?.toLowerCase()?i.D.fromMillis(e.getTime(),{zone:s.U.instance}):i.D.fromJSDate(e,{zone:t})}}function P(e){return S.isInterval(e)}function R(e){return i.D.isDateTime(e)}function $(e){return a.D.isDateOnly(e)}function U(e){return a.T.isTimeOnly(e)}function k(e){return m.isTimestampOffset(e)}function V(e){let t=x.exec(e);if(null!==t){const[,e,n,r]=t,o=a.T.fromParts(parseInt(e,10),parseInt(n,10),parseInt(r,10),0);if(null!==o)return o;throw new f("InvalidTime")}if(t=E.exec(e),null!==t){const[,e,n]=t,r=a.T.fromParts(parseInt(e,10),parseInt(n,10),0,0);if(null!==r)return r;throw new f("InvalidTime")}if(t=C.exec(e),null!==t){const[,e,n,r,o]=t,i=a.T.fromParts(parseInt(e,10),parseInt(n,10),parseInt(r,10),parseInt(o,10));if(null!==i)return i;throw new f("InvalidTime")}throw new f("InvalidTime")}function z(e,t,n=!1){let r=M.exec(e);if(null!==r){const[,e,n,a,o,l,u,c]=r,d=i.D.fromObject({year:parseInt(e,10),month:parseInt(n,10),day:parseInt(a,10),hour:parseInt(o,10),minute:parseInt(l,10),second:parseInt(u,10),millisecond:c?parseInt(c.replace(".",""),10):0},{zone:(0,s.s)(t)});if(!1===d.isValid)throw new f("InvalidTimeStamp");return d}if(r=b.exec(e),null!==r){const[,e,t,n,a,o,i,s,l,u,c]=r,d=m.fromParts(parseInt(e,10),parseInt(t,10),parseInt(n,10),parseInt(a,10),parseInt(o,10),parseInt(i,10),s?parseInt(s.replace(".",""),10):0,"-"===l,parseInt(u,10),parseInt(c,10));if(!1===d.isValid)throw new f("InvalidTimeStamp");return d}if(r=A.exec(e),null!==r){const[,e,t,n,a,o,i,s,l]=r,u=m.fromParts(parseInt(e,10),parseInt(t,10),parseInt(n,10),parseInt(a,10),parseInt(o,10),0,0,"-"===i,parseInt(s,10),parseInt(l,10));if(!1===u.isValid)throw new f("InvalidTimeStamp");return u}if(r=F.exec(e),null!==r){const[,e,n,a,o,l]=r,u=i.D.fromObject({year:parseInt(e,10),month:parseInt(n,10),day:parseInt(a,10),hour:parseInt(o,10),minute:parseInt(l,10),second:0},{zone:(0,s.s)(t)});if(!1===u.isValid)throw new f("InvalidTimeStamp");return u}if(r=_.exec(e),null!==r){const[,e,n,a]=r,o=i.D.fromObject({year:parseInt(e,10),month:parseInt(n,10),day:parseInt(a,10),hour:0,minute:0,second:0},{zone:(0,s.s)(t)});if(!1===o.isValid)throw new f("InvalidTimeStamp");return o}throw new f("InvalidTimeStamp")}function q(e,t){const n=_.exec(e);if(null===n)try{return z(e,t)}catch{throw new f("InvalidDate")}const[,r,o,i]=n,s=a.D.fromParts(parseInt(r,10),parseInt(o,10),parseInt(i,10));if(null===s)throw new f("InvalidDate");return s}function H(e){return!!R(e)||!!k(e)}function Z(e){return!!(R(e)||$(e)||k(e)||U(e))}function j(e){if(R(e))return e.toMillis();if($(e))return e.toNumber();if(k(e))return e.toMilliseconds();throw new f("InvalidDataType")}function Y(e,t,n){if(null==e||null==t)return null;if((0,u.a)(e)){if((0,u.a)(t))return W(e,t,n);if((0,u.c)(t))return function(e,t,n){const r=parseFloat(t);if(!isNaN(r))return W(e,r,n);const a=e.toString();switch(n){case"<>":return a!==t;case"=":return a===t;case">":return a>t;case"<":return a<t;case">=":return a>=t;case"<=":return a<=t}}(e,t,n);if(Z(t))throw new f("InvalidOperator");if($(t))throw new f("InvalidOperator")}else if((0,u.c)(e)){if((0,u.a)(t))return function(e,t,n){const r=parseFloat(e);if(!isNaN(r))return W(r,t,n);const a=t.toString();switch(n){case"<>":return e!==a;case"=":return e===a;case">":return e>a;case"<":return e<a;case">=":return e>=a;case"<=":return e<=a}}(e,t,n);if((0,u.c)(t))return function(e,t,n){switch(n){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}(e,t,n);if(R(t))throw new f("InvalidOperator");if($(t))throw new f("InvalidOperator");if(U(t))throw new f("InvalidOperator");if(k(t))throw new f("InvalidOperator")}else if(R(e)){if(H(t)){if((0,s.i)(e.zone)){if(i.D.isDateTime(t)&&!(0,s.i)(t.zone))return J(e,t,n);if(m.isTimestampOffset(t))return J(e,t,n)}else if(i.D.isDateTime(t)&&(0,s.i)(t.zone)){if(!(0,s.i)(e.zone))return J(e,t,n);if(m.isTimestampOffset(e))return J(e,t,n)}return W(j(e),j(t),n)}if((0,u.c)(t))throw new f("InvalidOperator");if($(t))return function(e,t,n){const r=t.toDateTimeLuxon(e.zone);return W((e=e.startOf("day")).toMillis(),r.toMillis(),n)}(e,t,n);if(U(t))throw new f("InvalidOperator");if((0,u.a)(t))throw new f("InvalidOperator")}else if($(e)){if(k(t))return function(e,t,n){const r=e.toDateTimeLuxon(t.toDateTime().zone);return t=t.startOfDay(),W(r.toMillis(),t.toMilliseconds(),n)}(e,t,n);if(R(t))return function(e,t,n){const r=e.toDateTimeLuxon(t.zone);return t=t.startOf("day"),W(r.toMillis(),t.toMillis(),n)}(e,t,n);if((0,u.c)(t))throw new f("InvalidOperator");if($(t))return W(e.toNumber(),t.toNumber(),n);if(U(t))throw new f("InvalidOperator");if((0,u.a)(t))throw new f("InvalidOperator")}else if(U(e)){if(U(t))return W(e.toNumber(),t.toNumber(),n);if((0,u.c)(t))throw new f("InvalidOperator");if((0,u.a)(t))throw new f("InvalidOperator");if($(t))throw new f("InvalidOperator");if(H(t))throw new f("InvalidOperator")}else if(k(e)){if(H(t))return i.D.isDateTime(t)&&(0,s.i)(t.zone)?J(e,t,n):W(j(e),j(t),n);if((0,u.c)(t))throw new f("InvalidOperator");if($(t))return function(e,t,n){const r=t.toDateTimeLuxon(e.toDateTime().zone);return W((e=e.startOfDay()).toMilliseconds(),r.toMillis(),n)}(e,t,n);if(U(t))throw new f("InvalidOperator");if((0,u.a)(t))throw new f("InvalidOperator")}switch(n){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}function W(e,t,n){switch(n){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}function J(e,t,n){m.isTimestampOffset(e)&&(e=e.toDateTime()),m.isTimestampOffset(t)&&(t=t.toDateTime());const r=B(e),a=B(t);switch(n){case"<>":return r!==a;case"=":return r===a;case">":return r>a;case"<":return r<a;case">=":return r>=a;case"<=":return r<=a}}function B(e){return 321408e5*e.year+26784e5*e.month+864e5*e.day+36e5*e.hour+6e4*e.minute+1e3*e.second+e.millisecond}function G(e,t,n){const r=X[e.toLowerCase()];if(null==r)throw new f("FunctionNotRecognized");if(t.length<r.minParams||t.length>r.maxParams)throw new f("InvalidParameterCount",{name:e.toUpperCase()});return r.evaluate(t,n)}function K(e){return!((0,u.i)(e)||$(e)||R(e)||U(e)||k(e))}function Q(e){return $(e)||U(e)?e.toString():k(e)?e.toSQLValue():R(e)?0===e.millisecond?e.toFormat("yyyy-LL-dd HH:mm:ss"):e.toSQL({includeOffset:!1}):(0,u.i)(e)?Q(i.D.fromJSDate(e)):e.toString()}const X={extract:{minParams:2,maxParams:2,evaluate:([e,t])=>{if(null==t)return null;if((0,u.i)(t))switch(e.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0;case"DOW":return i.D.fromJSDate(t,{zone:"system"}).weekday;case"DOY":return i.D.fromJSDate(t,{zone:"system"}).ordinal;case"WEEK":return i.D.fromJSDate(t,{zone:"system"}).weekNumber}else if(R(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new f("InvalidFunctionParameters",{function:"EXTRACT"});case"DOW":return t.weekday;case"DOY":return t.ordinal;case"WEEK":return t.weekNumber}else if($(t))switch(e.toUpperCase()){case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new f("InvalidFunctionParameters",{function:"EXTRACT"});case"DOW":return t.toDateTime("unknown").weekday;case"DOY":return t.toDateTime("unknown").ordinal;case"WEEK":return t.toDateTime("unknown").weekNumber}else if(U(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour}else if(k(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":return t.timezoneOffsetHour;case"TIMEZONE_MINUTE":return t.timezoneOffsetMinutes;case"DOW":return t.toDateTime().weekday;case"DOY":return t.toDateTime().ordinal;case"WEEK":return t.toDateTime().weekNumber}throw new f("InvalidFunctionParameters",{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:e=>{if(2===e.length){const[t,n]=e;return null==t||null==n?null:t.toString().substring(n-1)}if(3===e.length){const[t,n,r]=e;return null==t||null==n||null==r?null:r<=0?"":t.toString().substring(n-1,n+r-1)}}},position:{minParams:2,maxParams:2,evaluate:([e,t])=>null==e||null==t?null:t.indexOf(e)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{const t=3===e.length,n=t?e[1]:" ",r=t?e[2]:e[1];if(null==n||null==r)return null;const a=`(${(0,o.e)(n)})`;switch(e[0]){case"BOTH":return r.replaceAll(new RegExp(`^${a}*|${a}*$`,"g"),"");case"LEADING":return r.replaceAll(new RegExp(`^${a}*`,"g"),"");case"TRAILING":return r.replaceAll(new RegExp(`${a}*$`,"g"),"")}throw new f("InvalidFunctionParameters",{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.abs(e[0])},ceiling:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.ceil(e[0])},floor:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.floor(e[0])},log:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])},log10:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sin(e[0])},cos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cos(e[0])},tan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tan(e[0])},asin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.asin(e[0])},acos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.acos(e[0])},atan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.atan(e[0])},sign:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0]>0?1:e[0]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]**e[1]},mod:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]%e[1]},round:{minParams:1,maxParams:2,evaluate:e=>{const t=e[0],n=2===e.length?10**e[1]:1;return null==t?null:Math.round(t*n)/n}},truncate:{minParams:1,maxParams:2,evaluate:e=>null==e[0]?null:1===e.length||0===e[1]?Math.trunc(e[0]):(0,l.v)("trunc",e[0],-Number(e[1]))},char_length:{minParams:1,maxParams:1,evaluate:e=>(0,u.c)(e[0])?e[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:e=>{let t="";for(let n=0;n<e.length;n++){if(null==e[n])return null;t+=e[n].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:e=>{for(const t of e)if(null!==t)return t;return null}},cosh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cosh(e[0])},sinh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sinh(e[0])},tanh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tanh(e[0])},nullif:{minParams:2,maxParams:2,evaluate:e=>Y(e[0],e[1],"=")?null:e[0]},cast:{minParams:2,maxParams:2,evaluate:(e,t)=>{const n=e[0],r=e[1];if(null===n)return null;switch(r.type){case"integer":{if(!K(n))throw new f("CannotCastValue");const e=parseInt(n,10);if(isNaN(e))throw new f("CannotCastValue");return e}case"smallint":{if(!K(n))throw new f("CannotCastValue");const e=parseInt(n,10);if(isNaN(e))throw new f("CannotCastValue");if(e>32767||e<-32767)throw new f("CannotCastValue");return e}case"float":case"real":{if(!K(n))throw new f("CannotCastValue");const e=parseFloat(n);if(isNaN(e))throw new f("CannotCastValue");return e}case"time":return function(e){if((0,u.i)(e))return a.T.fromDateJS(e);if(R(e))return a.T.fromDateTime(e);if($(e))throw new f("CannotCastValue");if(U(e))return e;if(k(e))return a.T.fromSqlTimeStampOffset(e);if((0,u.c)(e))return V(e);throw new f("CannotCastValue")}(n);case"date":return function(e){if((0,u.i)(e))return a.D.fromDateJS(e);if(R(e))return a.D.fromParts(e.year,e.month,e.day);if($(e))return e;if(U(e))throw new f("CannotCastValue");if(k(e)&&null===a.D.fromParts(e.year,e.month,e.day))throw new f("CannotCastValue");if((0,u.c)(e)){const t=a.D.fromReader(e);if(null!==t&&t.isValid)return t}throw new f("CannotCastValue")}(n);case"timestamp":return function(e,t,n){if((0,u.i)(e))return L(e,t);if(R(e))return e;if($(e))return e.toDateTimeLuxon("unknown");if(U(e))throw new f("CannotCastValue");if(k(e))return e;if((0,u.c)(e))return z(e,"unknown",n);throw new f("CannotCastValue")}(n,t,!0===r.withtimezone);case"varchar":{const e=Q(n);if(e.length>r.size)throw new f("CannotCastValue");return e}default:throw new f("InvalidDataType")}}}};function ee(e,t,n,r){if("||"===e)return G("concat",[t,n],r);if(null===t||null===n)return null;if((0,u.a)(t)){if((0,u.a)(n))return te(t,n,e);if(P(n))return function(e,t,n){switch(n){case"+":return S.createFromMilliseconds(e+t.valueInMilliseconds());case"-":return S.createFromMilliseconds(e-t.valueInMilliseconds());case"*":return S.createFromMilliseconds(e*t.valueInMilliseconds());case"/":return S.createFromMilliseconds(e/t.valueInMilliseconds())}throw new f("InvalidOperator")}(t,n,e);if(U(n))return function(){throw new f("InvalidOperator")}();if($(n))return function(){throw new f("InvalidOperator")}();if(k(n))return function(){throw new f("InvalidOperator")}();if(R(n))return function(){throw new f("InvalidOperator")}();if((0,u.c)(n))return function(e,t,n){const r=parseFloat(t);if(isNaN(r))throw new f("InvalidOperator");return te(e,r,n)}(t,n,e);throw new f("InvalidOperator")}if($(t)){if((0,u.a)(n))return function(e,t,n){const r=1e3*t*24*60*60;switch(n){case"+":return e.plus("milliseconds",r);case"-":return e.plus("milliseconds",-1*r)}throw new f("InvalidOperator")}(t,n,e);if(P(n))return function(e,t,n){switch(n){case"+":return e.plus("milliseconds",t.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*t.valueInMilliseconds())}throw new f("InvalidOperator")}(t,n,e);if(U(n))return function(){throw new f("InvalidOperator")}();if($(n))return function(e,t,n){if("-"===n)return e.toDateTimeLuxon("UTC").diff(t.toDateTimeLuxon("UTC")).as("days");throw new f("InvalidOperator")}(t,n,e);if(k(n))return function(e,t,n){if("-"===n)return e.toDateTimeLuxon(t.toDateTime().zone).diff(t.toDateTime()).as("days");throw new f("InvalidOperator")}(t,n,e);if(R(n))return function(e,t,n){if("-"===n)return e.toDateTimeLuxon(t.zone).diff(t).as("days");throw new f("InvalidOperator")}(t,n,e);if((0,u.c)(n))return function(){throw new f("InvalidOperator")}();throw new f("InvalidOperator")}if(U(t)){if((0,u.a)(n))return function(e,t,n){const r=1e3*t*24*60*60;switch(n){case"+":return e.plus("milliseconds",r);case"-":return e.plus("milliseconds",-1*r)}throw new f("InvalidOperator")}(t,n,e);if(P(n))return function(e,t,n){switch(n){case"+":return e.plus("milliseconds",t.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*t.valueInMilliseconds())}throw new f("InvalidOperator")}(t,n,e);if(U(n))return function(){throw new f("InvalidOperator")}();if($(n))return function(){throw new f("InvalidOperator")}();if(k(n))return function(){throw new f("InvalidOperator")}();if(R(n))return function(){throw new f("InvalidOperator")}();if((0,u.c)(n))return function(){throw new f("InvalidOperator")}();throw new f("InvalidOperator")}if(P(t)){if((0,u.a)(n))return function(e,t,n){switch(n){case"+":return S.createFromMilliseconds(e.valueInMilliseconds()+t);case"-":return S.createFromMilliseconds(e.valueInMilliseconds()-t);case"*":return S.createFromMilliseconds(e.valueInMilliseconds()*t);case"/":return S.createFromMilliseconds(e.valueInMilliseconds()/t)}throw new f("InvalidOperator")}(t,n,e);if(P(n))return function(e,t,n){switch(n){case"+":return S.createFromMilliseconds(e.valueInMilliseconds()+t.valueInMilliseconds());case"-":return S.createFromMilliseconds(e.valueInMilliseconds()-t.valueInMilliseconds());case"*":return S.createFromMilliseconds(e.valueInMilliseconds()*t.valueInMilliseconds());case"/":return S.createFromMilliseconds(e.valueInMilliseconds()/t.valueInMilliseconds())}throw new f("InvalidOperator")}(t,n,e);if(U(n))return function(e,t,n){if("+"===n)return t.plus("milliseconds",e.valueInMilliseconds());throw new f("InvalidOperator")}(t,n,e);if($(n))return function(e,t,n){if("+"===n)return t.plus("milliseconds",e.valueInMilliseconds());throw new f("InvalidOperator")}(t,n,e);if(k(n))return function(e,t,n){if("+"===n)return t.addMilliseconds(e.valueInMilliseconds());throw new f("InvalidOperator")}(t,n,e);if(R(n))return function(e,t,n){switch(n){case"+":return t.plus({milliseconds:e.valueInMilliseconds()});case"-":return e.valueInMilliseconds()-t.toMillis()}throw new f("InvalidOperator")}(t,n,e);if((0,u.c)(n))return function(){throw new f("InvalidOperator")}();throw new f("InvalidOperator")}if(R(t)){if((0,u.a)(n))return function(e,t,n){const r=1e3*t*24*60*60;switch(n){case"+":return e.plus({milliseconds:r});case"-":return e.minus({milliseconds:r})}throw new f("InvalidOperator")}(t,n,e);if(P(n))return function(e,t,n){switch(n){case"+":return e.plus({milliseconds:t.valueInMilliseconds()});case"-":return e.minus({milliseconds:t.valueInMilliseconds()})}throw new f("InvalidOperator")}(t,n,e);if(U(n))return function(){throw new f("InvalidOperator")}();if($(n))return function(e,t,n){if("-"===n)return e.diff(t.toDateTimeLuxon(e.zone)).as("days");throw new f("InvalidOperator")}(t,n,e);if(k(n))return function(e,t,n){if("-"===n)return e.diff(t.toDateTime()).as("days");throw new f("InvalidOperator")}(t,n,e);if(R(n))return function(e,t,n){if("-"===n)return e.diff(t).as("days");throw new f("InvalidOperator")}(t,n,e);if((0,u.c)(n))return function(){throw new f("InvalidOperator")}();throw new f("InvalidOperator")}if(k(t)){if((0,u.a)(n))return function(e,t,n){const r=1e3*t*24*60*60;switch(n){case"+":return e.addMilliseconds(r);case"-":return e.addMilliseconds(-1*r)}throw new f("InvalidOperator")}(t,n,e);if(P(n))return function(e,t,n){switch(n){case"+":return e.addMilliseconds(t.valueInMilliseconds());case"-":return e.addMilliseconds(-1*t.valueInMilliseconds())}throw new f("InvalidOperator")}(t,n,e);if(U(n))return function(){throw new f("InvalidOperator")}();if($(n))return function(e,t,n){if("-"===n)return e.toDateTime().diff(t.toDateTimeLuxon(e.toDateTime().zone)).as("days");throw new f("InvalidOperator")}(t,n,e);if(k(n))return function(e,t,n){if("-"===n)return e.toDateTime().diff(t.toDateTime()).as("days");throw new f("InvalidOperator")}(t,n,e);if(R(n))return function(e,t,n){if("-"===n)return e.toDateTime().diff(t).as("days");throw new f("InvalidOperator")}(t,n,e);if((0,u.c)(n))return function(){throw new f("InvalidOperator")}();throw new f("InvalidOperator")}if((0,u.c)(t)){if((0,u.a)(n))return function(e,t,n){const r=parseFloat(e);if(isNaN(r))throw new f("InvalidOperator");return te(r,t,n)}(t,n,e);if(P(n))return function(){throw new f("InvalidOperator")}();if(U(n))return function(){throw new f("InvalidOperator")}();if($(n))return function(){throw new f("InvalidOperator")}();if(k(n))return function(){throw new f("InvalidOperator")}();if(R(n))return function(){throw new f("InvalidOperator")}();if((0,u.c)(n))return function(e,t,n){if("+"===n)return e+t;throw new f("InvalidOperator")}(t,n,e);throw new f("InvalidOperator")}throw new f("InvalidOperator")}function te(e,t,n){switch(n){case"+":return e+t;case"-":return e-t;case"*":return e*t;case"/":return e/t}throw new f("InvalidOperator")}class ne extends SyntaxError{constructor(e,t,n,r){super(e),this.expected=t,this.found=n,this.location=r,this.name="SyntaxError"}format(e){let t="Error: "+this.message;if(this.location){let n=null;const r=e.find(e=>e.source===this.location.source);r&&(n=r.text.split(/\r\n|\n|\r/g));const a=this.location.start,o=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(a):a,i=this.location.source+":"+o.line+":"+o.column;if(n){const e=this.location.end,r="".padEnd(o.line.toString().length," "),s=n[a.line-1],l=(a.line===e.line?e.column:s.length+1)-a.column||1;t+="\n --\x3e "+i+"\n"+r+" |\n"+o.line+" | "+s+"\n"+r+" | "+"".padEnd(a.column-1," ")+"".padEnd(l,"^")}else t+="\n at "+i}return t}static buildMessage(e,t){function n(e){return e.codePointAt(0).toString(16).toUpperCase()}const r=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function a(e){return r?e.replace(r,e=>"\\u{"+n(e)+"}"):e}function o(e){return a(e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,e=>"\\x0"+n(e)).replace(/[\x10-\x1F\x7F-\x9F]/g,e=>"\\x"+n(e)))}function i(e){return a(e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,e=>"\\x0"+n(e)).replace(/[\x10-\x1F\x7F-\x9F]/g,e=>"\\x"+n(e)))}const s={literal:e=>'"'+o(e.text)+'"',class(e){const t=e.parts.map(e=>Array.isArray(e)?i(e[0])+"-"+i(e[1]):i(e));return"["+(e.inverted?"^":"")+t.join("")+"]"+(e.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:e=>e.description};function l(e){return s[e.type](e)}return"Expected "+function(e){const t=e.map(l);if(t.sort(),t.length>0){let e=1;for(let n=1;n<t.length;n++)t[n-1]!==t[n]&&(t[e]=t[n],e++);t.length=e}switch(t.length){case 1:return t[0];case 2:return t[0]+" or "+t[1];default:return t.slice(0,-1).join(", ")+", or "+t[t.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."}}class re{static parse(e){return function(e,t){const n={},r=(t=void 0!==t?t:{}).grammarSource,a={start:Nn};let o=Nn;const i="!",s="=",l=">=",u=">",c="<=",f="<>",d="!=",p="||",m="@",h="'",v="N'",w="''",I=".",g="null",y="true",T="false",N="in",O="is",D="like",S="escape",x="not",E="and",C="or",_="between",M="from",b="for",A="substring",F="extract",L="trim",P="position",R="timestamp",$="date",U="time",k="leading",V="trailing",z="both",q="cast",H="as",Z="integer",j="int",Y="smallint",W="float",J="real",B="varchar",G="to",K="interval",Q="year",X="timezone_hour",ee="timezone_minute",te="month",re="day",ae="hour",oe="minute",ie="second",se="dow",le="doy",ue="week",ce="case",fe="end",de="when",pe="then",me="else",he=",",ve="(",we=")",Ie="`",ge=/^[<-=]/,ye=/^[+\-]/,Te=/^[*\/]/,Ne=/^[A-Za-z_\x80-\uFFFF]/,Oe=/^[A-Za-z0-9_]/,De=/^[A-Za-z0-9_.\x80-\uFFFF]/,Se=/^["]/,xe=/^[^']/,Ee=/^[0-9]/,Ce=/^[eE]/,_e=/^[ \t\n\r]/,Me=/^[^`]/,be=wn("!",!1),Ae=wn("=",!1),Fe=wn(">=",!1),Le=wn(">",!1),Pe=wn("<=",!1),Re=wn("<>",!1),$e=In([["<","="]],!1,!1,!1),Ue=wn("!=",!1),ke=In(["+","-"],!1,!1,!1),Ve=wn("||",!1),ze=In(["*","/"],!1,!1,!1),qe=In([["A","Z"],["a","z"],"_",["","￿"]],!1,!1,!1),He=In([["A","Z"],["a","z"],["0","9"],"_"],!1,!1,!1),Ze=In([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1,!1),je=In(['"'],!1,!1,!1),Ye=wn("@",!1),We=wn("'",!1),Je=wn("N'",!1),Be=wn("''",!1),Ge=In(["'"],!0,!1,!1),Ke=wn(".",!1),Qe=In([["0","9"]],!1,!1,!1),Xe=In(["e","E"],!1,!1,!1),et=wn("NULL",!0),tt=wn("TRUE",!0),nt=wn("FALSE",!0),rt=wn("IN",!0),at=wn("IS",!0),ot=wn("LIKE",!0),it=wn("ESCAPE",!0),st=wn("NOT",!0),lt=wn("AND",!0),ut=wn("OR",!0),ct=wn("BETWEEN",!0),ft=wn("FROM",!0),dt=wn("FOR",!0),pt=wn("SUBSTRING",!0),mt=wn("EXTRACT",!0),ht=wn("TRIM",!0),vt=wn("POSITION",!0),wt=wn("TIMESTAMP",!0),It=wn("DATE",!0),gt=wn("TIME",!0),yt=wn("LEADING",!0),Tt=wn("TRAILING",!0),Nt=wn("BOTH",!0),Ot=wn("CAST",!0),Dt=wn("AS",!0),St=wn("INTEGER",!0),xt=wn("INT",!0),Et=wn("SMALLINT",!0),Ct=wn("FLOAT",!0),_t=wn("REAL",!0),Mt=wn("VARCHAR",!0),bt=wn("TO",!0),At=wn("INTERVAL",!0),Ft=wn("YEAR",!0),Lt=wn("TIMEZONE_HOUR",!0),Pt=wn("TIMEZONE_MINUTE",!0),Rt=wn("MONTH",!0),$t=wn("DAY",!0),Ut=wn("HOUR",!0),kt=wn("MINUTE",!0),Vt=wn("SECOND",!0),zt=wn("DOW",!0),qt=wn("DOY",!0),Ht=wn("WEEK",!0),Zt=wn("CASE",!0),jt=wn("END",!0),Yt=wn("WHEN",!0),Wt=wn("THEN",!0),Jt=wn("ELSE",!0),Bt=wn(",",!1),Gt=wn("(",!1),Kt=wn(")",!1),Qt=In([" ","\t","\n","\r"],!1,!1,!1),Xt=wn("`",!1),en=In(["`"],!0,!1,!1);function tn(e,t,n){return{op:t,expr:n,location:hn()}}function nn(e,t,n){return{op:t,expr:n,location:hn()}}function rn(e,t){return{op:e,expr:t,location:hn()}}function an(e,t,n){return{op:t,expr:n,location:hn()}}function on(e,t,n){return{op:t,expr:n,location:hn()}}function sn(){return"'"}let ln=0|t.peg$currPos,un=ln;const cn=[{line:1,column:1}];let fn,dn=ln,pn=t.peg$maxFailExpected||[],mn=0|t.peg$silentFails;if(t.startRule){if(!(t.startRule in a))throw new Error("Can't start parsing from rule \""+t.startRule+'".');o=a[t.startRule]}function hn(){return yn(un,ln)}function vn(e,t){throw function(e,t){return new ne(e,null,null,t)}(e,t=void 0!==t?t:yn(un,ln))}function wn(e,t){return{type:"literal",text:e,ignoreCase:t}}function In(e,t,n,r){return{type:"class",parts:e,inverted:t,ignoreCase:n,unicode:r}}function gn(t){let n,r=cn[t];if(r)return r;if(t>=cn.length)n=cn.length-1;else for(n=t;!cn[--n];);for(r=cn[n],r={line:r.line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return cn[t]=r,r}function yn(e,t,n){const a=gn(e),o=gn(t);return{source:r,start:{offset:e,line:a.line,column:a.column},end:{offset:t,line:o.line,column:o.column}}}function Tn(e){ln<dn||(ln>dn&&(dn=ln,pn=[]),pn.push(e))}function Nn(){let e,t;return e=ln,br(),t=Dn(),t!==n?(br(),un=e,e=t):(ln=e,e=n),e}function On(){let e,t,r,a,o,i,s,l;if(e=ln,t=_r(),t!==n){for(br(),r=[],a=Dn();a!==n;)r.push(a),a=ln,o=ln,i=br(),s=Cr(),s!==n?(l=br(),i=[i,s,l],o=i):(ln=o,o=n),o!==n?(o=Dn(),o===n?(ln=a,a=n):a=o):a=o;a=br(),o=Mr(),o!==n?(un=e,u=r,e={type:"expression-list",location:hn(),value:u}):(ln=e,e=n)}else ln=e,e=n;var u;return e}function Dn(){let e,t,r,a,o,i;if(e=ln,t=Sn(),t!==n){for(r=[],a=ln,br(),o=cr(),o!==n?(br(),i=Sn(),i!==n?(un=a,a=tn(0,o,i)):(ln=a,a=n)):(ln=a,a=n);a!==n;)r.push(a),a=ln,br(),o=cr(),o!==n?(br(),i=Sn(),i!==n?(un=a,a=tn(0,o,i)):(ln=a,a=n)):(ln=a,a=n);un=e,e=Pr(t,r)}else ln=e,e=n;return e}function Sn(){let e,t,r,a,o,i;if(e=ln,t=xn(),t!==n){for(r=[],a=ln,br(),o=ur(),o!==n?(br(),i=xn(),i!==n?(un=a,a=nn(0,o,i)):(ln=a,a=n)):(ln=a,a=n);a!==n;)r.push(a),a=ln,br(),o=ur(),o!==n?(br(),i=xn(),i!==n?(un=a,a=nn(0,o,i)):(ln=a,a=n)):(ln=a,a=n);un=e,e=Pr(t,r)}else ln=e,e=n;return e}function xn(){let t,r,a,o,l;return t=ln,r=lr(),r===n&&(r=ln,33===e.charCodeAt(ln)?(a=i,ln++):(a=n,0===mn&&Tn(be)),a!==n?(o=ln,mn++,61===e.charCodeAt(ln)?(l=s,ln++):(l=n,0===mn&&Tn(Ae)),mn--,l===n?o=void 0:(ln=o,o=n),o!==n?(a=[a,o],r=a):(ln=r,r=n)):(ln=r,r=n)),r!==n?(a=br(),o=xn(),o!==n?(un=t,t=function(e,t,n){return{type:"unary-expression",location:n,operator:"NOT",expr:t}}(0,o,hn())):(ln=t,t=n)):(ln=t,t=n),t===n&&(t=function(){let t,r,a,o;var i,s;return t=ln,r=Mn(),r!==n?(a=ln,br(),o=function(){let t;return t=function(){let e,t,r,a,o;if(e=ln,t=[],r=ln,br(),a=En(),a!==n?(br(),o=Mn(),o!==n?(un=r,r=rn(a,o)):(ln=r,r=n)):(ln=r,r=n),r!==n)for(;r!==n;)t.push(r),r=ln,br(),a=En(),a!==n?(br(),o=Mn(),o!==n?(un=r,r=rn(a,o)):(ln=r,r=n)):(ln=r,r=n);else t=n;return t!==n&&(un=e,t={type:"arithmetic",tail:t}),e=t,e}(),t===n&&(t=function(){let e,t,r;return e=ln,t=_n(),t!==n?(br(),r=On(),r!==n?(un=e,e={op:t,right:r}):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=_n(),t!==n?(br(),r=zn(),r!==n?(un=e,e={op:t,right:r}):(ln=e,e=n)):(ln=e,e=n)),e}(),t===n&&(t=function(){let e,t,r,a,o,i,s,l;var u,c;return e=ln,t=lr(),t!==n?(br(),r=fr(),r!==n?(a=br(),o=ln,i=Mn(),i!==n?(br(),s=ur(),s!==n?(br(),l=Mn(),l!==n?(un=o,u=i,c=l,o=Lr(hn(),u,c)):(ln=o,o=n)):(ln=o,o=n)):(ln=o,o=n),o!==n?(un=e,e={op:"NOT"+r,right:o}):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=fr(),t!==n?(br(),r=ln,a=Mn(),a!==n?(o=br(),i=ur(),i!==n?(br(),s=Mn(),s!==n?(un=r,r=function(e,t,n){return Lr(hn(),t,n)}(0,a,s)):(ln=r,r=n)):(ln=r,r=n)):(ln=r,r=n),r!==n?(un=e,e={op:t,right:r}):(ln=e,e=n)):(ln=e,e=n)),e}(),t===n&&(t=function(){let e,t,r,a;return e=ln,t=ir(),t!==n?(br(),r=lr(),r!==n?(br(),a=Mn(),a!==n?(un=e,e={op:t+"NOT",right:a}):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=ir(),t!==n?(br(),r=Mn(),r!==n?(un=e,e={op:t,right:r}):(ln=e,e=n)):(ln=e,e=n)),e}(),t===n&&(t=function(){let t,r,a,o,i;return t=ln,r=Cn(),r!==n?(br(),a=Bn(),a!==n?(br(),o=function(){let t,r,a,o;return t=ln,r=e.substr(ln,6),r.toLowerCase()===S?ln+=6:(r=n,0===mn&&Tn(it)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="ESCAPE"):(ln=t,t=n)):(ln=t,t=n),t}(),o!==n?(br(),i=Gn(),i!==n?(un=t,t={op:r,right:a,escape:i.value}):(ln=t,t=n)):(ln=t,t=n)):(ln=t,t=n)):(ln=t,t=n),t===n&&(t=ln,r=Cn(),r!==n?(br(),a=Bn(),a!==n?(un=t,t={op:r,right:a,escape:""}):(ln=t,t=n)):(ln=t,t=n)),t}())))),t}(),o!==n?a=o:(ln=a,a=n),a===n&&(a=null),un=t,i=r,t=""==(s=a)||null==s||null==s?i:"arithmetic"==s.type?Pr(i,s.tail):Fr(s.op,i,s.right,s.escape,hn())):(ln=t,t=n),t}()),t}function En(){let t;return e.substr(ln,2)===l?(t=l,ln+=2):(t=n,0===mn&&Tn(Fe)),t===n&&(62===e.charCodeAt(ln)?(t=u,ln++):(t=n,0===mn&&Tn(Le)),t===n&&(e.substr(ln,2)===c?(t=c,ln+=2):(t=n,0===mn&&Tn(Pe)),t===n&&(e.substr(ln,2)===f?(t=f,ln+=2):(t=n,0===mn&&Tn(Re)),t===n&&(t=e.charAt(ln),ge.test(t)?ln++:(t=n,0===mn&&Tn($e)),t===n&&(e.substr(ln,2)===d?(t=d,ln+=2):(t=n,0===mn&&Tn(Ue))))))),t}function Cn(){let e,t,r,a,o;var i;return e=ln,t=ln,r=lr(),r!==n?(a=br(),o=sr(),o!==n?(r=[r,a,o],t=r):(ln=t,t=n)):(ln=t,t=n),t!==n&&(un=e,t=(i=t)[0]+" "+i[2]),e=t,e===n&&(e=sr()),e}function _n(){let e,t,r,a,o;var i;return e=ln,t=ln,r=lr(),r!==n?(a=br(),o=or(),o!==n?(r=[r,a,o],t=r):(ln=t,t=n)):(ln=t,t=n),t!==n&&(un=e,t=(i=t)[0]+" "+i[2]),e=t,e===n&&(e=or()),e}function Mn(){let e,t,r,a,o,i;if(e=ln,t=An(),t!==n){for(r=[],a=ln,br(),o=bn(),o!==n?(br(),i=An(),i!==n?(un=a,a=an(0,o,i)):(ln=a,a=n)):(ln=a,a=n);a!==n;)r.push(a),a=ln,br(),o=bn(),o!==n?(br(),i=An(),i!==n?(un=a,a=an(0,o,i)):(ln=a,a=n)):(ln=a,a=n);un=e,e=Pr(t,r)}else ln=e,e=n;return e}function bn(){let t;return t=e.charAt(ln),ye.test(t)?ln++:(t=n,0===mn&&Tn(ke)),t===n&&(e.substr(ln,2)===p?(t=p,ln+=2):(t=n,0===mn&&Tn(Ve))),t}function An(){let e,t,r,a,o,i;if(e=ln,t=Ln(),t!==n){for(r=[],a=ln,br(),o=Fn(),o!==n?(br(),i=Ln(),i!==n?(un=a,a=on(0,o,i)):(ln=a,a=n)):(ln=a,a=n);a!==n;)r.push(a),a=ln,br(),o=Fn(),o!==n?(br(),i=Ln(),i!==n?(un=a,a=on(0,o,i)):(ln=a,a=n)):(ln=a,a=n);un=e,e=Pr(t,r)}else ln=e,e=n;return e}function Fn(){let t;return t=e.charAt(ln),Te.test(t)?ln++:(t=n,0===mn&&Tn(ze)),t}function Ln(){let t,r,a,o;var i;return t=function(){let t;return t=Gn(),t===n&&(t=function(){let e,t,r,a;var o;return e=ln,t=function(){let e,t,r,a;return e=ln,t=er(),t!==n?(r=tr(),r!==n?(a=nr(),a!==n?(un=e,e=parseFloat(t+r+a)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=er(),t!==n?(r=tr(),r!==n?(un=e,e=parseFloat(t+r)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=er(),t!==n?(r=nr(),r!==n?(un=e,e=parseFloat(t+r)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=er(),t!==n&&(un=e,t=parseFloat(t)),e=t))),e}(),t!==n?(r=ln,mn++,a=Rn(),mn--,a===n?r=void 0:(ln=r,r=n),r!==n?(un=e,o=t,e={type:"number",location:hn(),value:o}):(ln=e,e=n)):(ln=e,e=n),e}(),t===n&&(t=function(){let t,r;return t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===y?ln+=4:(r=n,0===mn&&Tn(tt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(r=[r,a],t=r):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n&&(un=t,r={type:"boolean",location:hn(),value:!0}),t=r,t===n&&(t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,5),r.toLowerCase()===T?ln+=5:(r=n,0===mn&&Tn(nt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(r=[r,a],t=r):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n&&(un=t,r={type:"boolean",location:hn(),value:!1}),t=r),t}(),t===n&&(t=function(){let t,r;return t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===g?ln+=4:(r=n,0===mn&&Tn(et)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(r=[r,a],t=r):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n&&(un=t,r={type:"null",location:hn(),value:null}),t=r,t}(),t===n&&(t=function(){let e,t,r;var a,o;return e=ln,t=hr(),t!==n?(br(),r=Bn(),r!==n?(un=e,"string"===(a=r).type&&(o=a.value,!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(o)&&vn("Date literal is invalid")),e={type:"date",location:hn(),value:a.value}):(ln=e,e=n)):(ln=e,e=n),e}(),t===n&&(t=function(){let e,t,r;var a,o;return e=ln,t=mr(),t!==n?(br(),r=Bn(),r!==n?(un=e,"string"===(a=r).type&&(o=a.value,!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(o)&&vn("Timestamp literal is invalid")),e={type:"timestamp",location:hn(),value:a.value}):(ln=e,e=n)):(ln=e,e=n),e}(),t===n&&(t=function(){let t,r,a,o,i;var s,l,u;return t=ln,r=wr(),r!==n?(br(),a=e.charAt(ln),ye.test(a)?ln++:(a=n,0===mn&&Tn(ke)),a!==n?(br(),o=Bn(),o!==n?(br(),i=jn(),i!==n?(un=t,s=a,l=o,u=i,t={type:"interval",location:hn(),value:l,qualifier:u,op:s}):(ln=t,t=n)):(ln=t,t=n)):(ln=t,t=n)):(ln=t,t=n),t===n&&(t=ln,r=wr(),r!==n?(br(),a=Bn(),a!==n?(br(),o=jn(),o!==n?(un=t,t=function(e,t){return{type:"interval",location:hn(),value:e,qualifier:t,op:""}}(a,o)):(ln=t,t=n)):(ln=t,t=n)):(ln=t,t=n)),t}(),t===n&&(t=function(){let e,t,r;var a,o;return e=ln,t=vr(),t!==n?(br(),r=Bn(),r!==n?(un=e,"string"===(a=r).type&&(o=a.value,!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(o)&&vn("Time literal is invalid")),e={type:"time",location:hn(),value:a.value}):(ln=e,e=n)):(ln=e,e=n),e}()))))))),t}(),t===n&&(t=function(){let e,t,r,a,o,i,s,l;var u,c,f;return e=ln,t=pr(),t!==n?(br(),r=ln,a=_r(),a!==n?(br(),o=Zn(),o!==n?(br(),i=dr(),i!==n?(br(),s=Dn(),s!==n?(br(),l=Mr(),l!==n?(un=r,c=o,f=s,r=Lr(hn(),c,f)):(ln=r,r=n)):(ln=r,r=n)):(ln=r,r=n)):(ln=r,r=n)):(ln=r,r=n),r===n&&(r=ln,a=_r(),a!==n?(br(),o=Zn(),o!==n?(br(),i=Cr(),i!==n?(br(),s=Dn(),s!==n?(br(),l=Mr(),l!==n?(un=r,r=function(e,t){return Lr(hn(),e,t)}(o,s)):(ln=r,r=n)):(ln=r,r=n)):(ln=r,r=n)):(ln=r,r=n)):(ln=r,r=n)),r!==n?(un=e,u=r,e={type:"function",location:hn(),name:"extract",args:u}):(ln=e,e=n)):(ln=e,e=n),e}(),t===n&&(t=function(){let t,r,a,o,i,s,l,u,c,f,d;var p,m,h,v;return t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,9),r.toLowerCase()===A?ln+=9:(r=n,0===mn&&Tn(pt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="SUBSTRING"):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n?(br(),a=ln,o=_r(),o!==n?(br(),i=Dn(),i!==n?(br(),s=dr(),s!==n?(br(),l=Dn(),l!==n?(br(),u=ln,c=function(){let t,r,a,o;return t=ln,r=e.substr(ln,3),r.toLowerCase()===b?ln+=3:(r=n,0===mn&&Tn(dt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="FOR"):(ln=t,t=n)):(ln=t,t=n),t}(),c!==n?(f=br(),d=Dn(),d!==n?(br(),u=d):(ln=u,u=n)):(ln=u,u=n),u===n&&(u=null),c=Mr(),c!==n?(un=a,m=i,h=l,v=u,a=Lr(hn(),m,h,...v?[v]:[])):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n),a===n&&(a=ln,o=_r(),o!==n?(br(),i=Dn(),i!==n?(br(),s=Cr(),s!==n?(br(),l=Dn(),l!==n?(br(),u=Cr(),u!==n?(c=br(),f=Dn(),f!==n?(d=Mr(),d!==n?(un=a,a=function(e,t,n){return Lr(hn(),e,t,n)}(i,l,f)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)),a!==n?(un=t,p=a,t={type:"function",location:hn(),name:"substring",args:p}):(ln=t,t=n)):(ln=t,t=n),t}(),t===n&&(t=function(){let t,r,a,o,i,s,l,u,c;var f,d,p,m;return t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===L?ln+=4:(r=n,0===mn&&Tn(ht)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="TRIM"):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n?(br(),a=ln,o=_r(),o!==n?(br(),i=Hn(),br(),s=Dn(),s!==n?(br(),l=dr(),l!==n?(br(),u=Dn(),u!==n?(br(),c=Mr(),c!==n?(un=a,d=i,p=s,m=u,a=Lr(hn(),d,p,m)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n),a===n&&(a=ln,o=_r(),o!==n?(br(),i=Hn(),br(),s=Dn(),s!==n?(br(),l=Mr(),l!==n?(un=a,a=function(e,t){return Lr(hn(),e,t)}(i,s)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)),a!==n?(un=t,f=a,t={type:"function",location:hn(),name:"trim",args:f}):(ln=t,t=n)):(ln=t,t=n),t}(),t===n&&(t=function(){let t,r,a,o,i,s,l,u;var c,f,d;return t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,8),r.toLowerCase()===P?ln+=8:(r=n,0===mn&&Tn(vt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="POSITION"):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n?(br(),a=ln,o=_r(),o!==n?(br(),i=Dn(),i!==n?(br(),s=or(),s!==n?(br(),l=Dn(),l!==n?(br(),u=Mr(),u!==n?(un=a,f=i,d=l,a=Lr(hn(),f,d)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n),a===n&&(a=ln,o=_r(),o!==n?(br(),i=Dn(),i!==n?(br(),s=Cr(),s!==n?(br(),l=Dn(),l!==n?(br(),u=Mr(),u!==n?(un=a,a=function(e,t){return Lr(hn(),e,t)}(i,l)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)),a!==n?(un=t,c=a,t={type:"function",location:hn(),name:"position",args:c}):(ln=t,t=n)):(ln=t,t=n),t}(),t===n&&(t=function(){let t,r,a,o,i,s,l,u;var c,f,d;return t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===q?ln+=4:(r=n,0===mn&&Tn(Ot)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="CAST"):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n?(br(),a=ln,o=_r(),o!==n?(br(),i=Dn(),i!==n?(br(),s=function(){let t,r,a,o;return t=ln,r=e.substr(ln,2),r.toLowerCase()===H?ln+=2:(r=n,0===mn&&Tn(Dt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="AS"):(ln=t,t=n)):(ln=t,t=n),t}(),s!==n?(br(),l=qn(),l!==n?(br(),u=Mr(),u!==n?(un=a,f=i,d=l,a=Lr(hn(),f,d)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n),a===n&&(a=ln,o=_r(),o!==n?(br(),i=Dn(),i!==n?(br(),s=Cr(),s!==n?(br(),l=qn(),l!==n?(br(),u=Mr(),u!==n?(un=a,a=function(e,t){return Lr(hn(),e,t)}(i,l)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)):(ln=a,a=n)),a!==n?(un=t,c=a,t={type:"function",location:hn(),name:"cast",args:c}):(ln=t,t=n)):(ln=t,t=n),t}(),t===n&&(t=function(){let t,r,a,o;var i,s;return t=ln,r=ln,mn++,a=pr(),mn--,a===n?r=void 0:(ln=r,r=n),r!==n?(a=function(){let t,r,a,o;if(t=ln,r=Pn(),r!==n&&(un=t),t=r,t===n)if(t=ln,96===e.charCodeAt(ln)?(r=Ie,ln++):(r=n,0===mn&&Tn(Xt)),r!==n){if(a=[],o=e.charAt(ln),Me.test(o)?ln++:(o=n,0===mn&&Tn(en)),o!==n)for(;o!==n;)a.push(o),o=e.charAt(ln),Me.test(o)?ln++:(o=n,0===mn&&Tn(en));else a=n;a!==n?(96===e.charCodeAt(ln)?(o=Ie,ln++):(o=n,0===mn&&Tn(Xt)),o!==n?(un=t,t=a.join("")):(ln=t,t=n)):(ln=t,t=n)}else ln=t,t=n;return t}(),a!==n?(br(),o=On(),o!==n?(un=t,i=a,s=o,t={type:"function",location:hn(),name:i,args:s}):(ln=t,t=n)):(ln=t,t=n)):(ln=t,t=n),t}(),t===n&&(t=function(){let e;return e=function(){let e,t,r,a,o,i,s;if(e=ln,t=Dr(),t!==n)if(br(),r=Dn(),r!==n){for(br(),a=[],o=ln,i=Qn(),i!==n?(s=br(),o=i):(ln=o,o=n);o!==n;)a.push(o),o=ln,i=Qn(),i!==n?(s=br(),o=i):(ln=o,o=n);o=Sr(),o!==n?(un=e,l=r,u=a,e={type:"case-expression",location:hn(),format:"simple",operand:l,clauses:u,else:null,elseLocation:null}):(ln=e,e=n)}else ln=e,e=n;else ln=e,e=n;var l,u;if(e===n)if(e=ln,t=Dr(),t!==n)if(br(),r=Dn(),r!==n){for(br(),a=[],o=ln,i=Qn(),i!==n?(s=br(),o=i):(ln=o,o=n);o!==n;)a.push(o),o=ln,i=Qn(),i!==n?(s=br(),o=i):(ln=o,o=n);o=Xn(),o!==n?(i=br(),s=Sr(),s!==n?(un=e,e=function(e,t,n){return{type:"case-expression",location:hn(),format:"simple",operand:e,clauses:t,else:n.value,elseLocation:n.location}}(r,a,o)):(ln=e,e=n)):(ln=e,e=n)}else ln=e,e=n;else ln=e,e=n;return e}(),e===n&&(e=function(){let e,t,r,a,o,i;if(e=ln,t=Dr(),t!==n){for(br(),r=[],a=ln,o=Kn(),o!==n?(i=br(),a=o):(ln=a,a=n);a!==n;)r.push(a),a=ln,o=Kn(),o!==n?(i=br(),a=o):(ln=a,a=n);a=Sr(),a!==n?(un=e,s=r,e={type:"case-expression",location:hn(),format:"searched",clauses:s,else:null,elseLocation:null}):(ln=e,e=n)}else ln=e,e=n;var s;if(e===n)if(e=ln,t=Dr(),t!==n){for(br(),r=[],a=ln,o=Kn(),o!==n?(i=br(),a=o):(ln=a,a=n);a!==n;)r.push(a),a=ln,o=Kn(),o!==n?(i=br(),a=o):(ln=a,a=n);a=Xn(),a!==n?(o=br(),i=Sr(),i!==n?(un=e,e=function(e,t){return{type:"case-expression",location:hn(),format:"searched",clauses:e,else:t.value,elseLocation:t.location}}(r,a)):(ln=e,e=n)):(ln=e,e=n)}else ln=e,e=n;return e}()),e}(),t===n&&(t=function(){let e,t;var r,a;return e=ln,t=function(){let e,t;return e=ln,t=function(){let e,t,r,a;if(e=ln,t=Rn(),t!==n){for(r=[],a=Un();a!==n;)r.push(a),a=Un();un=e,e=t+r.join("")}else ln=e,e=n;return e}(),t!==n&&(un=e),e=t,e}(),t!==n&&(un=e,t=/^CURRENT_DATE$/i.test(r=t)?{type:"current-time",location:hn(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(r)?{type:"current-time",location:hn(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(r)?{type:"current-time",location:hn(),mode:"time"}:/^CURRENT_USER$/i.test(r)?{type:"current-user",location:hn()}:{type:"column-reference",location:hn(),table:"",column:r}),e=t,e===n&&(e=ln,t=function(){let e,t,r,a;return e=ln,t=Vn(),t!==n?(r=function(){let e,t,r;for(e=ln,t=[],r=kn();r!==n;)t.push(r),r=kn();return un=e,t=t.join(""),e=t,e}(),a=Vn(),a!==n?(un=e,e=r):(ln=e,e=n)):(ln=e,e=n),e}(),t!==n&&(un=e,a=t,t={type:"column-reference",location:hn(),table:"",column:a,delimited:!0}),e=t),e}(),t===n&&(t=zn(),t===n&&(t=ln,r=_r(),r!==n?(br(),a=Dn(),a!==n?(br(),o=Mr(),o!==n?(un=t,(i=a).paren=!0,t=i):(ln=t,t=n)):(ln=t,t=n)):(ln=t,t=n))))))))))),t}function Pn(){let e,t,r,a;if(e=ln,t=Rn(),t!==n){for(r=[],a=$n();a!==n;)r.push(a),a=$n();un=e,e=t+r.join("")}else ln=e,e=n;return e}function Rn(){let t;return t=e.charAt(ln),Ne.test(t)?ln++:(t=n,0===mn&&Tn(qe)),t}function $n(){let t;return t=e.charAt(ln),Oe.test(t)?ln++:(t=n,0===mn&&Tn(He)),t}function Un(){let t;return t=e.charAt(ln),De.test(t)?ln++:(t=n,0===mn&&Tn(Ze)),t}function kn(){let t;return t=function(){let t;return t=e.charAt(ln),De.test(t)?ln++:(t=n,0===mn&&Tn(Ze)),t}(),t===n&&(t=function(){let e,t,r;return e=ln,t=Vn(),t!==n?(r=Vn(),r!==n?(un=e,e='"'):(ln=e,e=n)):(ln=e,e=n),e}()),t}function Vn(){let t;return t=e.charAt(ln),Se.test(t)?ln++:(t=n,0===mn&&Tn(je)),t}function zn(){let t,r,a,o;var i;return t=ln,r=ln,64===e.charCodeAt(ln)?(a=m,ln++):(a=n,0===mn&&Tn(Ye)),a!==n?(o=Pn(),o!==n?(a=[a,o],r=a):(ln=r,r=n)):(ln=r,r=n),r!==n&&(un=t,i=r,r={type:"parameter",location:hn(),value:i[1]}),t=r,t}function qn(){let t,r,a,o,i;var s;return t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,7),r.toLowerCase()===Z?ln+=7:(r=n,0===mn&&Tn(St)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="INTEGER"):(ln=t,t=n)):(ln=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,3),r.toLowerCase()===j?ln+=3:(r=n,0===mn&&Tn(xt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="INT"):(ln=t,t=n)):(ln=t,t=n),t}()),r!==n&&(un=t,r={type:"data-type",location:hn(),value:{type:"integer"}}),t=r,t===n&&(t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,8),r.toLowerCase()===Y?ln+=8:(r=n,0===mn&&Tn(Et)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="SMALLINT"):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n&&(un=t,r={type:"data-type",location:hn(),value:{type:"smallint"}}),t=r,t===n&&(t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,5),r.toLowerCase()===W?ln+=5:(r=n,0===mn&&Tn(Ct)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="FLOAT"):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n&&(un=t,r={type:"data-type",location:hn(),value:{type:"float"}}),t=r,t===n&&(t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===J?ln+=4:(r=n,0===mn&&Tn(_t)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="REAL"):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n&&(un=t,r={type:"data-type",location:hn(),value:{type:"real"}}),t=r,t===n&&(t=ln,r=hr(),r!==n&&(un=t,r={type:"data-type",location:hn(),value:{type:"date"}}),t=r,t===n&&(t=ln,r=mr(),r!==n&&(un=t,r={type:"data-type",location:hn(),value:{type:"timestamp"}}),t=r,t===n&&(t=ln,r=vr(),r!==n&&(un=t,r={type:"data-type",location:hn(),value:{type:"time"}}),t=r,t===n&&(t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,7),r.toLowerCase()===B?ln+=7:(r=n,0===mn&&Tn(Mt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="VARCHAR"):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n?(br(),a=_r(),a!==n?(br(),o=rr(),o!==n?(br(),i=Mr(),i!==n?(un=t,s=o,t={type:"data-type",location:hn(),value:{type:"varchar",size:parseInt(s)}}):(ln=t,t=n)):(ln=t,t=n)):(ln=t,t=n)):(ln=t,t=n)))))))),t}function Hn(){let t,r;var a;return t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,7),r.toLowerCase()===k?ln+=7:(r=n,0===mn&&Tn(yt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="LEADING"):(ln=t,t=n)):(ln=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,8),r.toLowerCase()===V?ln+=8:(r=n,0===mn&&Tn(Tt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="TRAILING"):(ln=t,t=n)):(ln=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===z?ln+=4:(r=n,0===mn&&Tn(Nt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="BOTH"):(ln=t,t=n)):(ln=t,t=n),t}())),r===n&&(r=null),un=t,a=r,r={type:"string",location:hn(),value:a??"BOTH"},t=r,t}function Zn(){let t,r;var a;return t=ln,r=Ir(),r===n&&(r=gr(),r===n&&(r=yr(),r===n&&(r=Tr(),r===n&&(r=Nr(),r===n&&(r=Or(),r===n&&(r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,13),r.toLowerCase()===X?ln+=13:(r=n,0===mn&&Tn(Lt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="TIMEZONE_HOUR"):(ln=t,t=n)):(ln=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,15),r.toLowerCase()===ee?ln+=15:(r=n,0===mn&&Tn(Pt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="TIMEZONE_MINUTE"):(ln=t,t=n)):(ln=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,3),r.toLowerCase()===se?ln+=3:(r=n,0===mn&&Tn(zt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="DOW"):(ln=t,t=n)):(ln=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,3),r.toLowerCase()===le?ln+=3:(r=n,0===mn&&Tn(qt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="DOY"):(ln=t,t=n)):(ln=t,t=n),t}(),r===n&&(r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===ue?ln+=4:(r=n,0===mn&&Tn(Ht)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="WEEK"):(ln=t,t=n)):(ln=t,t=n),t}())))))))))),r!==n&&(un=t,a=r,r={type:"string",location:hn(),value:a}),t=r,t}function jn(){let t,r,a,o;var i,s;return t=ln,r=function(){let e,t,r,a,o;var i,s;return e=ln,t=Yn(),t!==n?(br(),r=_r(),r!==n?(br(),a=Jn(),a!==n?(br(),o=Mr(),o!==n?(un=e,i=t,s=a,e={type:"interval-period",location:hn(),period:i.value,precision:s,secondary:null}):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=Yn(),t!==n&&(un=e,t=function(e){return{type:"interval-period",location:hn(),period:e.value,precision:null,secondary:null}}(t)),e=t),e}(),r!==n?(br(),a=function(){let t,r,a,o;return t=ln,r=e.substr(ln,2),r.toLowerCase()===G?ln+=2:(r=n,0===mn&&Tn(bt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="TO"):(ln=t,t=n)):(ln=t,t=n),t}(),a!==n?(br(),o=function(){let e,t,r,a,o,i,s;var l,u,c;return e=ln,t=Yn(),t!==n&&(un=e,l=t,t={type:"interval-period",location:hn(),period:l.value,precision:null,secondary:null}),e=t,e===n&&(e=ln,t=Or(),t!==n?(br(),r=_r(),r!==n?(br(),a=Jn(),a!==n?(br(),o=Cr(),o!==n?(br(),i=Wn(),i!==n?(br(),s=Mr(),s!==n?(un=e,u=a,c=i,e={type:"interval-period",location:hn(),period:"second",precision:u,secondary:c}):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=Or(),t!==n?(br(),r=_r(),r!==n?(br(),a=Jn(),a!==n?(br(),o=Mr(),o!==n?(un=e,e=function(e){return{type:"interval-period",location:hn(),period:"second",precision:e,secondary:null}}(a)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=Or(),t!==n&&(un=e,t={type:"interval-period",location:hn(),period:"second",precision:null,secondary:null}),e=t))),e}(),o!==n?(un=t,i=r,s=o,t={type:"interval-qualifier",location:hn(),start:i,end:s}):(ln=t,t=n)):(ln=t,t=n)):(ln=t,t=n),t===n&&(t=function(){let e,t,r,a,o,i,s;var l,u;return e=ln,t=Yn(),t!==n?(br(),r=_r(),r!==n?(br(),a=Wn(),a!==n?(br(),o=Mr(),o!==n?(un=e,l=t,u=a,e={type:"interval-period",location:hn(),period:l.value,precision:u,secondary:null}):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=Yn(),t!==n&&(un=e,t=function(e){return{type:"interval-period",location:hn(),period:e.value,precision:null,secondary:null}}(t)),e=t,e===n&&(e=ln,t=Or(),t!==n?(br(),r=_r(),r!==n?(br(),a=Jn(),a!==n?(br(),o=Cr(),o!==n?(br(),i=Wn(),i!==n?(br(),s=Mr(),s!==n?(un=e,e=function(e,t){return{type:"interval-period",location:hn(),period:"second",precision:e,secondary:t}}(a,i)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=Or(),t!==n?(br(),r=_r(),r!==n?(br(),a=Wn(),a!==n?(br(),o=Mr(),o!==n?(un=e,e=function(e){return{type:"interval-period",location:hn(),period:"second",precision:e,secondary:null}}(a)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e===n&&(e=ln,t=Or(),t!==n&&(un=e,t={type:"interval-period",location:hn(),period:"second",precision:null,secondary:null}),e=t)))),e}()),t}function Yn(){let e,t;return e=ln,t=yr(),t!==n&&(un=e,t={type:"string",location:hn(),value:"day"}),e=t,e===n&&(e=ln,t=Tr(),t!==n&&(un=e,t={type:"string",location:hn(),value:"hour"}),e=t,e===n&&(e=ln,t=Nr(),t!==n&&(un=e,t={type:"string",location:hn(),value:"minute"}),e=t,e===n&&(e=ln,t=gr(),t!==n&&(un=e,t={type:"string",location:hn(),value:"month"}),e=t,e===n&&(e=ln,t=Ir(),t!==n&&(un=e,t={type:"string",location:hn(),value:"year"}),e=t)))),e}function Wn(){let e,t;return e=ln,t=rr(),t!==n&&(un=e,t=parseFloat(t)),e=t,e}function Jn(){let e,t;return e=ln,t=rr(),t!==n&&(un=e,t=parseFloat(t)),e=t,e}function Bn(){let e;return e=Gn(),e===n&&(e=zn()),e}function Gn(){let t,r,a,o,i;if(t=ln,39===e.charCodeAt(ln)?(r=h,ln++):(r=n,0===mn&&Tn(We)),r===n&&(e.substr(ln,2)===v?(r=v,ln+=2):(r=n,0===mn&&Tn(Je))),r!==n){for(a=[],o=ln,e.substr(ln,2)===w?(i=w,ln+=2):(i=n,0===mn&&Tn(Be)),i!==n&&(un=o,i="'"),o=i,o===n&&(o=e.charAt(ln),xe.test(o)?ln++:(o=n,0===mn&&Tn(Ge)));o!==n;)a.push(o),o=ln,e.substr(ln,2)===w?(i=w,ln+=2):(i=n,0===mn&&Tn(Be)),i!==n&&(un=o,i=sn()),o=i,o===n&&(o=e.charAt(ln),xe.test(o)?ln++:(o=n,0===mn&&Tn(Ge)));39===e.charCodeAt(ln)?(o=h,ln++):(o=n,0===mn&&Tn(We)),o!==n?(un=t,s=a,t={type:"string",location:hn(),value:s.join("")}):(ln=t,t=n)}else ln=t,t=n;var s;return t}function Kn(){let e,t,r,a,o;var i,s;return e=ln,t=xr(),t!==n?(br(),r=Dn(),r!==n?(br(),a=Er(),a!==n?(br(),o=Dn(),o!==n?(un=e,i=r,s=o,e={type:"when-clause",location:hn(),operand:i,value:s}):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e}function Qn(){let e,t,r,a,o;var i,s;return e=ln,t=xr(),t!==n?(br(),r=Dn(),r!==n?(br(),a=Er(),a!==n?(br(),o=Dn(),o!==n?(un=e,i=r,s=o,e={type:"when-clause",location:hn(),operand:i,value:s}):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n)):(ln=e,e=n),e}function Xn(){let t,r,a;var o;return t=ln,r=function(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===me?ln+=4:(r=n,0===mn&&Tn(Jt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="ELSE"):(ln=t,t=n)):(ln=t,t=n),t}(),r!==n?(br(),a=Dn(),a!==n?(un=t,o=a,t={type:"else-clause",location:hn(),value:o}):(ln=t,t=n)):(ln=t,t=n),t}function er(){let t,r,a;var o;return t=rr(),t===n&&(t=ln,r=e.charAt(ln),ye.test(r)?ln++:(r=n,0===mn&&Tn(ke)),r!==n?(a=rr(),a!==n?(un=t,o=a,t=r[0]+o):(ln=t,t=n)):(ln=t,t=n)),t}function tr(){let t,r,a;var o;return t=ln,46===e.charCodeAt(ln)?(r=I,ln++):(r=n,0===mn&&Tn(Ke)),r!==n?(a=rr(),a===n&&(a=null),un=t,t="."+(null!=(o=a)?o:"")):(ln=t,t=n),t}function nr(){let t,r,a;return t=ln,r=function(){let t,r,a;var o;return t=ln,r=e.charAt(ln),Ce.test(r)?ln++:(r=n,0===mn&&Tn(Xe)),r!==n?(a=e.charAt(ln),ye.test(a)?ln++:(a=n,0===mn&&Tn(ke)),a===n&&(a=null),un=t,t="e"+(null===(o=a)?"":o)):(ln=t,t=n),t}(),r!==n?(a=rr(),a!==n?(un=t,t=r+a):(ln=t,t=n)):(ln=t,t=n),t}function rr(){let e,t,r;if(e=ln,t=[],r=ar(),r!==n)for(;r!==n;)t.push(r),r=ar();else t=n;return t!==n&&(un=e,t=t.join("")),e=t,e}function ar(){let t;return t=e.charAt(ln),Ee.test(t)?ln++:(t=n,0===mn&&Tn(Qe)),t}function or(){let t,r,a,o;return t=ln,r=e.substr(ln,2),r.toLowerCase()===N?ln+=2:(r=n,0===mn&&Tn(rt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="IN"):(ln=t,t=n)):(ln=t,t=n),t}function ir(){let t,r,a,o;return t=ln,r=e.substr(ln,2),r.toLowerCase()===O?ln+=2:(r=n,0===mn&&Tn(at)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="IS"):(ln=t,t=n)):(ln=t,t=n),t}function sr(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===D?ln+=4:(r=n,0===mn&&Tn(ot)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="LIKE"):(ln=t,t=n)):(ln=t,t=n),t}function lr(){let t,r,a,o;return t=ln,r=e.substr(ln,3),r.toLowerCase()===x?ln+=3:(r=n,0===mn&&Tn(st)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="NOT"):(ln=t,t=n)):(ln=t,t=n),t}function ur(){let t,r,a,o;return t=ln,r=e.substr(ln,3),r.toLowerCase()===E?ln+=3:(r=n,0===mn&&Tn(lt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="AND"):(ln=t,t=n)):(ln=t,t=n),t}function cr(){let t,r,a,o;return t=ln,r=e.substr(ln,2),r.toLowerCase()===C?ln+=2:(r=n,0===mn&&Tn(ut)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="OR"):(ln=t,t=n)):(ln=t,t=n),t}function fr(){let t,r,a,o;return t=ln,r=e.substr(ln,7),r.toLowerCase()===_?ln+=7:(r=n,0===mn&&Tn(ct)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="BETWEEN"):(ln=t,t=n)):(ln=t,t=n),t}function dr(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===M?ln+=4:(r=n,0===mn&&Tn(ft)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="FROM"):(ln=t,t=n)):(ln=t,t=n),t}function pr(){let t,r,a,o;return t=ln,r=e.substr(ln,7),r.toLowerCase()===F?ln+=7:(r=n,0===mn&&Tn(mt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="EXTRACT"):(ln=t,t=n)):(ln=t,t=n),t}function mr(){let t,r,a,o;return t=ln,r=e.substr(ln,9),r.toLowerCase()===R?ln+=9:(r=n,0===mn&&Tn(wt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="TIMESTAMP"):(ln=t,t=n)):(ln=t,t=n),t}function hr(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===$?ln+=4:(r=n,0===mn&&Tn(It)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="DATE"):(ln=t,t=n)):(ln=t,t=n),t}function vr(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===U?ln+=4:(r=n,0===mn&&Tn(gt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="TIME"):(ln=t,t=n)):(ln=t,t=n),t}function wr(){let t,r,a,o;return t=ln,r=e.substr(ln,8),r.toLowerCase()===K?ln+=8:(r=n,0===mn&&Tn(At)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="INTERVAL"):(ln=t,t=n)):(ln=t,t=n),t}function Ir(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===Q?ln+=4:(r=n,0===mn&&Tn(Ft)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="YEAR"):(ln=t,t=n)):(ln=t,t=n),t}function gr(){let t,r,a,o;return t=ln,r=e.substr(ln,5),r.toLowerCase()===te?ln+=5:(r=n,0===mn&&Tn(Rt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="MONTH"):(ln=t,t=n)):(ln=t,t=n),t}function yr(){let t,r,a,o;return t=ln,r=e.substr(ln,3),r.toLowerCase()===re?ln+=3:(r=n,0===mn&&Tn($t)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="DAY"):(ln=t,t=n)):(ln=t,t=n),t}function Tr(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===ae?ln+=4:(r=n,0===mn&&Tn(Ut)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="HOUR"):(ln=t,t=n)):(ln=t,t=n),t}function Nr(){let t,r,a,o;return t=ln,r=e.substr(ln,6),r.toLowerCase()===oe?ln+=6:(r=n,0===mn&&Tn(kt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="MINUTE"):(ln=t,t=n)):(ln=t,t=n),t}function Or(){let t,r,a,o;return t=ln,r=e.substr(ln,6),r.toLowerCase()===ie?ln+=6:(r=n,0===mn&&Tn(Vt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="SECOND"):(ln=t,t=n)):(ln=t,t=n),t}function Dr(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===ce?ln+=4:(r=n,0===mn&&Tn(Zt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="CASE"):(ln=t,t=n)):(ln=t,t=n),t}function Sr(){let t,r,a,o;return t=ln,r=e.substr(ln,3),r.toLowerCase()===fe?ln+=3:(r=n,0===mn&&Tn(jt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="END"):(ln=t,t=n)):(ln=t,t=n),t}function xr(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===de?ln+=4:(r=n,0===mn&&Tn(Yt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="WHEN"):(ln=t,t=n)):(ln=t,t=n),t}function Er(){let t,r,a,o;return t=ln,r=e.substr(ln,4),r.toLowerCase()===pe?ln+=4:(r=n,0===mn&&Tn(Wt)),r!==n?(a=ln,mn++,o=$n(),mn--,o===n?a=void 0:(ln=a,a=n),a!==n?(un=t,t="THEN"):(ln=t,t=n)):(ln=t,t=n),t}function Cr(){let t;return 44===e.charCodeAt(ln)?(t=he,ln++):(t=n,0===mn&&Tn(Bt)),t}function _r(){let t;return 40===e.charCodeAt(ln)?(t=ve,ln++):(t=n,0===mn&&Tn(Gt)),t}function Mr(){let t;return 41===e.charCodeAt(ln)?(t=we,ln++):(t=n,0===mn&&Tn(Kt)),t}function br(){let e,t;for(e=[],t=Ar();t!==n;)e.push(t),t=Ar();return e}function Ar(){let t;return t=e.charAt(ln),_e.test(t)?ln++:(t=n,0===mn&&Tn(Qt)),t}function Fr(e,t,n,r,a){const o={type:"binary-expression",location:a,operator:e,left:t,right:n};return void 0!==r&&(o.escape=r),o}function Lr(e,...t){return{type:"expression-list",location:e,value:t}}function Pr(e,t){let n=e;for(const{op:e,expr:r,location:{end:a}}of t)n=Fr(e,n,r,void 0,{...n.location,end:a});return n}fn=o();const Rr=fn!==n&&ln===e.length;function $r(){throw fn!==n&&ln<e.length&&Tn({type:"end"}),function(e,t,n){return new ne(ne.buildMessage(e,t),e,t,n)}(pn,dn<e.length?function(t=ln){const n=e.codePointAt(t);return void 0===n?"":String.fromCodePoint(n)}(dn):null,dn<e.length?yn(dn,dn+1):yn(dn,dn))}return t.peg$library?{peg$result:fn,peg$currPos:ln,peg$FAILED:n,peg$maxFailExpected:pn,peg$maxFailPos:dn,peg$success:Rr,peg$throw:Rr?void 0:$r}:Rr?fn:void $r()}(e)}}function ae(e,t){if(null!=e)switch(t(e),e.type){case"when-clause":ae(e.operand,t),ae(e.value,t);break;case"case-expression":for(const n of e.clauses)ae(n,t);"simple"===e.format&&ae(e.operand,t),null!==e.else&&ae(e.else,t);break;case"expression-list":for(const n of e.value)ae(n,t);break;case"unary-expression":ae(e.expr,t);break;case"binary-expression":ae(e.left,t),ae(e.right,t);break;case"function":ae(e.args,t);break;case"interval":ae(e.value,t),ae(e.qualifier,t);break;case"interval-qualifier":ae(e.start,t),ae(e.end,t)}}const oe=new Set(["current_timestamp","current_date","current_time"]);class ie{constructor(e){this.staticData=e}makeBool(e){return Ie(e)}featureValue(e,t,n,r){return _e(e,t,n,r)}equalsNull(e){return null===e}applyLike(e,t,n){return Ce(e,t,n)}ensureArray(e){return ge(e)}applyIn(e,t){return Oe(e,t)}currentTimestamp(e){return De(e)}currentDate(e){return Se(e)}currentTime(e){return xe(e)}makeSqlInterval(e,t,n){return S.createFromValueAndQualifier(e,t,n)}convertInterval(e){return S.isInterval(e)?e.valueInMilliseconds():e}compare(e,t,n){return Y(t,n,e)}calculate(e,t,n,r){return ee(e,t,n,r)}evaluateTime(e){return V(e)}evaluateTimestamp(e,t,n){return z(e,t,n)}evaluateDate(e,t){return q(e,t)}evaluateFunction(e,t,n){return G(e,t,n)}lookup(e,t){const n=t[e];return void 0===n?null:n}between(e,t){return null==e||null==t[0]||null==t[1]?null:Y(e,t[0],">=")&&Y(e,t[1],"<=")}notbetween(e,t){return null==e||null==t[0]||null==t[1]?null:Y(e,t[0],"<")||Y(e,t[1],">")}ternaryNot(e){return ye(e)}ternaryAnd(e,t){return Te(e,t)}ternaryOr(e,t){return Ne(e,t)}}function se(e,...t){return`this.${e}(${t.join(", ")})`}function le(e){return void 0===e?"void 0":JSON.stringify(e)}function ue({type:e,period:t,precision:n,secondary:r}){return JSON.stringify({type:e,period:t,precision:n,secondary:r})}const ce="feature",fe="lookups",de="attributeAdapter",pe="fieldsIndex",me="timeZone",he="currentUser";class ve{constructor(e){this._parseTree=e,this._staticData=Object.create(null),this._nextStaticDataId=0,this._tempVars=new Set,this._nextTempVarId=0}compile(){const e=this._compileNode(this._parseTree),t=`\n      ${this._tempVars.size>0?`var ${Array.from(this._tempVars).join(", ")};`:""}\n      return this.convertInterval(${e});\n    `;return new Function(ce,fe,de,pe,me,he,t).bind(new ie(this._staticData))}_storeStaticData(e){const t="static$"+this._nextStaticDataId++;return this._staticData[t]=e,t}_compileRefStaticData(e){return`this.staticData[${le(e)}]`}_generateTempVar(){const e="temp$"+this._nextTempVarId++;return this._tempVars.add(e),e}_compileSimpleCase(e){const t=this._compileNode(e.operand),n=this._generateTempVar(),r=[];for(const t of e.clauses){const e=se("compare",le("="),n,this._compileNode(t.operand)),a=this._compileNode(t.value);r.push(`${e} ? (${a}) :`)}return null!=e.else?r.push(this._compileNode(e.else)):r.push(le(null)),`(${n} = ${t}, ${r.join(" ")})`}_compileSearchedCase(e){const t=[];for(const n of e.clauses){const e=se("makeBool",this._compileNode(n.operand)),r=this._compileNode(n.value);t.push(`${e} ? (${r}) :`)}return null!=e.else?t.push(this._compileNode(e.else)):t.push(le(null)),t.join(" ")}_compileInExpr(e,t){const n=new Set,r=[];for(const e of t.value)"number"===e.type||"string"===e.type?n.add(e.value):r.push(e);const a=this._compileNode(e),o=se("ensureArray",this._compileNode({type:"expression-list",location:t.location,value:r}));if(n.size>0){const e=this._compileRefStaticData(this._storeStaticData(n)),t=this._generateTempVar();return r.length>0?`(${t} = ${a}, ${e}.has(${t}) || ${se("applyIn",t,o)})`:`(${t} = ${a}, ${t} == null ? null : ${e}.has(${t}))`}return se("applyIn",a,o)}_compileNode(e){switch(e.type){case"interval":return se("makeSqlInterval",this._compileNode(e.value),"interval-qualifier"===e.qualifier.type?function({type:e,start:t,end:n}){return`{type: ${le(e)}, start: ${ue(t)}, end: ${ue(n)}}`}(e.qualifier):ue(e.qualifier),le(e.op));case"case-expression":return"simple"===e.format?this._compileSimpleCase(e):this._compileSearchedCase(e);case"parameter":return se("lookup",le(e.value.toLowerCase()),fe);case"expression-list":return`[${e.value.map(e=>this._compileNode(e)).join(", ")}]`;case"unary-expression":return se("ternaryNot",this._compileNode(e.expr));case"binary-expression":switch(e.operator){case"AND":return se("ternaryAnd",this._compileNode(e.left),this._compileNode(e.right));case"OR":return se("ternaryOr",this._compileNode(e.left),this._compileNode(e.right));case"IS":if("null"!==e.right.type)throw new f("UnsupportedIsRhs");return se("equalsNull",this._compileNode(e.left));case"ISNOT":if("null"!==e.right.type)throw new f("UnsupportedIsRhs");return`!${se("equalsNull",this._compileNode(e.left))}`;case"IN":return this._compileInExpr(e.left,e.right);case"NOT IN":return se("ternaryNot",this._compileInExpr(e.left,e.right));case"BETWEEN":return se("between",this._compileNode(e.left),this._compileNode(e.right));case"NOTBETWEEN":return se("notbetween",this._compileNode(e.left),this._compileNode(e.right));case"LIKE":return se("applyLike",this._compileNode(e.left),this._compileNode(e.right),le(e.escape));case"NOT LIKE":return se("ternaryNot",se("applyLike",this._compileNode(e.left),this._compileNode(e.right),le(e.escape)));case"<>":case"<":case">":case">=":case"<=":case"=":return se("compare",le(e.operator),this._compileNode(e.left),this._compileNode(e.right));case"*":case"-":case"+":case"/":case"||":return se("calculate",le(e.operator),this._compileNode(e.left),this._compileNode(e.right),me);default:throw new f("UnsupportedOperator",{operator:e.operator})}case"null":case"boolean":case"string":case"number":return le(e.value);case"time":try{return this._compileRefStaticData(this._storeStaticData(V(e.value)))}catch{return se("evaluateTime",le(e.value))}case"date":try{return this._compileRefStaticData(this._storeStaticData(q(e.value,"unknown")))}catch{return se("evaluateDate",le(e.value),le("unknown"))}case"timestamp":try{return this._compileRefStaticData(this._storeStaticData(z(e.value,"unknown")))}catch{return se("evaluateTimestamp",le(e.value),le("unknown"))}case"current-time":return"date"===e.mode?se("currentDate",me):"time"===e.mode?se("currentTime",me):se("currentTimestamp",me);case"current-user":return he;case"column-reference":return se("featureValue",ce,le(e.column),pe,de);case"data-type":return function({type:e,size:t,withtimezone:n}){return JSON.stringify({type:e,size:t,withtimezone:n})}(e.value);case"function":return se("evaluateFunction",le(e.name),this._compileNode(e.args),me)}throw new f("UnsupportedSyntax",{node:e.type})}}class we{static create(e,t={}){return new we(e,t.fieldsIndex,t.timeZone??void 0,t.currentUser)}constructor(e,t,n="UTC",r=null){this.fieldsIndex=t,this.timeZone=n,this.currentUser=r,this.parameters={},this._compiledExecutor=null,this._hasDateFunctions=void 0,this.parseTree=re.parse(e);const{isStandardized:a,isAggregate:o,currentUserRequired:i,referencedFieldNames:s}=this._extractExpressionInfo(t);this._referencedFieldNames=s,this.isStandardized=a,this.isAggregate=o,this.currentUserRequired=i}static convertValueToStorageFormat(e,t=null){if(null===t)return(0,u.i)(e)?e.getTime():R(e)?e.toMillis():k(e)?e.toStorageFormat():U(e)?e.toStorageString():$(e)?e.toStorageFormat():e;switch(t){case"date":return(0,u.i)(e)?e.getTime():R(e)?e.toMillis():k(e)?e.toMilliseconds():$(e)?e.toNumber():e;case"date-only":return(0,u.i)(e)?a.D.fromDateJS(e).toString():k(e)?a.D.fromSqlTimeStampOffset(e).toString():R(e)?a.D.fromDateTime(e).toString():e;case"time-only":return(0,u.i)(e)?a.T.fromDateJS(e).toStorageString():R(e)?a.T.fromDateTime(e).toStorageString():k(e)?a.T.fromSqlTimeStampOffset(e).toStorageString():U(e)?e.toStorageString():e;case"timestamp-offset":if((0,u.i)(e))return m.fromJSDate(e).toStorageFormat();if(R(e))return m.fromDateTime(e).toStorageFormat();if(k(e))return e.toStorageFormat()}return e}get fieldNames(){return this._referencedFieldNames}testSet(e,t=Me,n=this.currentUser){return!!this._evaluateNode(this.parseTree,null,t,e,n)}calculateValue(e,t=Me,n=this.currentUser){const r=this._evaluateNode(this.parseTree,e,t,null,n);return S.isInterval(r)?r.valueInMilliseconds()/864e5:r}tryGetCompiledExecutor(){if(null!=this._compiledExecutor)return this._compiledExecutor;if((0,r.h)("esri-csp-restrictions"))return null;const e=new ve(this.parseTree);return this._compiledExecutor=e.compile(),this._compiledExecutor}calculateValueCompiled(e,t=Me,n=this.currentUser){const r=this.tryGetCompiledExecutor();return null==r?this.calculateValue(e,t):r(e,this.parameters,t,this.fieldsIndex,this.timeZone,n??null)}testFeature(e,t=Me,n=this.currentUser){return!!this._evaluateNode(this.parseTree,e,t,null,n)}testFeatureCompiled(e,t=Me,n=this.currentUser){const r=this.tryGetCompiledExecutor();return null==r?this.testFeature(e,t):!!r(e,this.parameters,t,this.fieldsIndex,this.timeZone,n??null)}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,ae(this.parseTree,e=>{"current-time"===e.type?this._hasDateFunctions=!0:"function"===e.type&&(this._hasDateFunctions=this._hasDateFunctions||oe.has(e.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){const e=new Set;return ae(this.parseTree,t=>{"function"===t.type&&e.add(t.name.toLowerCase())}),Array.from(e)}getExpressions(){const e=new Map;return ae(this.parseTree,t=>{if("function"===t.type){const n=t.name.toLowerCase(),r=t.args.value[0];if("column-reference"===r.type){const t=r.column,a=`${n}-${t}`;e.has(a)||e.set(a,{aggregateType:n,field:t})}}}),[...e.values()]}getVariables(){const e=new Set;return ae(this.parseTree,t=>{"parameter"===t.type&&e.add(t.value.toLowerCase())}),Array.from(e)}_extractExpressionInfo(e){const t=[],n=new Set;let r=!0,a=!1,o=!1;return ae(this.parseTree,i=>{switch(i.type){case"column-reference":{const r=e?.get(i.column);let a,o;r?a=o=r.name??"":(o=i.column,a=o.toLowerCase()),n.has(a)||(n.add(a),t.push(o)),i.column=o;break}case"current-user":o=!0;break;case"function":{const{name:e,args:t}=i,n=t.value.length;r&&(r=function(e,t){const n=X[e.toLowerCase()];return null!=n&&t>=n.minParams&&t<=n.maxParams}(e,n)),!1===a&&(a=v(e,n));break}}}),{referencedFieldNames:Array.from(t),isStandardized:r,isAggregate:a,currentUserRequired:o}}_evaluateNode(e,t,n,r,a){let o;switch(e.type){case"interval":{const o=this._evaluateNode(e.value,t,n,r,a);return S.createFromValueAndQualifier(o,e.qualifier,e.op)}case"case-expression":if("simple"===e.format){const o=this._evaluateNode(e.operand,t,n,r,a);for(let i=0;i<e.clauses.length;i++)if(Y(o,this._evaluateNode(e.clauses[i].operand,t,n,r,a),"="))return this._evaluateNode(e.clauses[i].value,t,n,r,a);if(null!==e.else)return this._evaluateNode(e.else,t,n,r,a)}else{for(let o=0;o<e.clauses.length;o++)if(Ie(this._evaluateNode(e.clauses[o].operand,t,n,r,a)))return this._evaluateNode(e.clauses[o].value,t,n,r,a);if(null!==e.else)return this._evaluateNode(e.else,t,n,r,a)}return null;case"parameter":return o=this.parameters[e.value.toLowerCase()],(0,u.i)(o)?i.D.fromJSDate(o):null!=o&&"object"==typeof o&&"toDateTime"in o?o.toDateTime():o;case"expression-list":{const o=[];for(const i of e.value)o.push(this._evaluateNode(i,t,n,r,a));return o}case"unary-expression":return ye(this._evaluateNode(e.expr,t,n,r,a));case"binary-expression":switch(e.operator){case"AND":return Te(this._evaluateNode(e.left,t,n,r,a),this._evaluateNode(e.right,t,n,r,a));case"OR":return Ne(this._evaluateNode(e.left,t,n,r,a),this._evaluateNode(e.right,t,n,r,a));case"IS":if("null"!==e.right.type)throw new f("UnsupportedIsRhs");return null===this._evaluateNode(e.left,t,n,r,a);case"ISNOT":if("null"!==e.right.type)throw new f("UnsupportedIsRhs");return null!==this._evaluateNode(e.left,t,n,r,a);case"IN":{const o=ge(this._evaluateNode(e.right,t,n,r,a));return Oe(this._evaluateNode(e.left,t,n,r,a),o)}case"NOT IN":{const o=ge(this._evaluateNode(e.right,t,n,r,a));return ye(Oe(this._evaluateNode(e.left,t,n,r,a),o))}case"BETWEEN":{const o=this._evaluateNode(e.left,t,n,r,a),i=this._evaluateNode(e.right,t,n,r,a);return null==o||null==i[0]||null==i[1]?null:Y(o,i[0],">=")&&Y(o,i[1],"<=")}case"NOTBETWEEN":{const o=this._evaluateNode(e.left,t,n,r,a),i=this._evaluateNode(e.right,t,n,r,a);return null==o||null==i[0]||null==i[1]?null:Y(o,i[0],"<")||Y(o,i[1],">")}case"LIKE":return Ce(this._evaluateNode(e.left,t,n,r,a),this._evaluateNode(e.right,t,n,r,a),e.escape);case"NOT LIKE":return ye(Ce(this._evaluateNode(e.left,t,n,r,a),this._evaluateNode(e.right,t,n,r,a),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return Y(this._evaluateNode(e.left,t,n,r,a),this._evaluateNode(e.right,t,n,r,a),e.operator);case"-":case"+":case"*":case"/":case"||":return ee(e.operator,this._evaluateNode(e.left,t,n,r,a),this._evaluateNode(e.right,t,n,r,a),this.timeZone)}case"null":case"boolean":case"string":case"number":return e.value;case"date":return e.parsedValue??=q(e.value,"unknown"),e.parsedValue;case"timestamp":return e.parsedValue??=z(e.value,"unknown"),e.parsedValue;case"time":return V(e.value);case"current-time":return"date"===e.mode?Se(this.timeZone):"time"===e.mode?xe(this.timeZone):De(this.timeZone);case"current-user":return a??null;case"column-reference":return _e(t,e.column,this.fieldsIndex,n);case"data-type":return e.value;case"function":{if(this.isAggregate&&v(e.name,e.args.value.length)){const t=[];for(const o of e.args?.value||[]){const e=[];for(const t of r||[])e.push(this._evaluateNode(o,t,n,null,a));t.push(e)}return h(e.name,t)}const o=this._evaluateNode(e.args,t,n,r,a);return G(e.name,o,this.timeZone)}}throw new f("UnsupportedSyntax",{node:e.type})}}function Ie(e){return!0===e}function ge(e){return Array.isArray(e)?e:[e]}function ye(e){return null!==e?!0!==e:null}function Te(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function Ne(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function Oe(e,t){if(null==e)return null;let n=!1;for(const r of t)if(null==r)n=null;else{if(e===r){n=!0;break}if(Z(e)&&Z(r)&&(n=Y(e,r,"="),n))break}return n}function De(e){return L(new Date,e)}function Se(e){return a.D.fromNow(e)}function xe(e){const t=L(new Date,e);return a.T.fromDateTime(t)}const Ee="-[]/{}()*+?.\\^$|";function Ce(e,t,n){if(null==e)return null;const r=function(e,t){const n=t;let r="",a=0;for(let t=0;t<e.length;t++){const o=e.charAt(t);switch(a){case 0:o===n?a=1:Ee.includes(o)?r+="\\"+o:r+="%"===o?".*":"_"===o?".":o;break;case 1:Ee.includes(o)?r+="\\"+o:r+=o,a=0}}return new RegExp("^"+r+"$","m")}(t,n);return r.test(e)}function _e(e,t,n,r){if("getAttributeSQL"in r)return r.getAttributeSQL(e,t);const o=r.getAttribute(e,t);if(null==o)return o;const s=n?.get(t);switch(s?.type){case"esriFieldTypeDate":case"date":return L(new Date(o),n?.getLuxonTimeZone(s.name)??i.F.utcInstance);case"esriFieldTypeDateOnly":case"date-only":return a.D.fromReader(o);case"esriFieldTypeTimeOnly":case"time-only":return a.T.fromReader(o);case"esriFieldTypeTimestampOffset":case"timestamp-offset":return new m(o)}return o}const Me={getAttribute(e,t){var n;return((n=e)&&"object"==typeof n.attributes?e.attributes:e)[t]}};Object.freeze(Object.defineProperty({__proto__:null,default:we},Symbol.toStringTag,{value:"Module"}))}}]);