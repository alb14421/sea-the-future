"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[9622],{69622:(e,t,n)=>{n.r(t),n.d(t,{fromGeometries:()=>oe,fromGeometry:()=>ue,fromGeometryToGXGeometry:()=>me,getSpatialReference:()=>ae,toGeometry:()=>le});var r=n(23160),i=n(6550),a=n(43802),s=(n(82604),n(69763));function o(){if(-1===this.m_i)return this.m_i=0,{value:{m_token:1,m_value:null},done:!1};if(this.m_i<this.m_keys.length){const e=this.m_bReturnKey,t=Math.trunc(this.m_i);return this.m_bReturnKey=!this.m_bReturnKey,this.m_i+=.5,e?{value:{m_token:5,m_value:this.m_keys[t]},done:!1}:{value:{m_token:6,m_value:this.m_o[this.m_keys[t]]},done:!1}}return{value:{m_token:3,m_value:null},done:!0}}function u(){if(-1===this.m_i)return this.m_i=0,{value:{m_token:2,m_value:null},done:!1};if(this.m_i<this.m_a.length){const e={value:{m_token:6,m_value:this.m_a[this.m_i++]},done:!1};return this.m_strict||void 0===e.value.m_value&&(e.value.m_value=Number.NaN),e}return{value:{m_token:4,m_value:null},done:!0}}n(94981),n(88010),n(32816),n(32773),n(93804),n(59121),n(84699),n(96221),n(18683),n(90740),n(64604),n(29512),n(99063),n(6407),n(20266),n(80959),n(13671),n(19247),n(1178),(0,i.b6)(e=>{let t,n;"number"==typeof e?t=e:n=e;const r={wkid:t,wkt:n};let i,a;if(n){i=(0,s.R)(n);const e=(0,s.k)(r);if(!i&&!e)throw new Error(`Unsupported WKT type: ${n}`)}else i=!(0,s.k)(r);return a=t&&s.a8.has(t)?Math.PI/200:i?(0,s.T)(r):Math.PI/180,{isPCS:i,metersOrRadiansPerUnit:a,semiMajor:0,wkidOrWkt:e}});class m{createJSONObjectIterator(e){return{m_iteratorType:"object",m_o:e,m_keys:this.m_options.strict?Object.keys(e):Object.keys(e).filter(t=>void 0!==e[t]),m_i:-1,m_bReturnKey:!0,next:o}}createJSONArrayIterator(e){return{m_iteratorType:"array",m_strict:this.m_options.strict,m_i:-1,m_a:e,next:u}}constructor(e,t){this.m_currentToken=0,this.m_options=t?{...t}:{strict:!0};const n=e;this.m_iteratorStack=[n instanceof Array?this.createJSONArrayIterator(n):this.createJSONObjectIterator(n)],this.m_nextFlatToken={m_value:null,m_token:0}}nextToken(){if(0===this.m_iteratorStack.length)return this.m_currentToken=0;switch(this.m_nextFlatToken=this.m_iteratorStack.at(-1).next().value,this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_currentToken=1;case 3:return this.m_iteratorStack.pop(),this.m_currentToken=3;case 2:return this.m_currentToken=2;case 4:return this.m_iteratorStack.pop(),this.m_currentToken=4;case 5:return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=5;case 6:if(this.m_nextFlatToken.m_value instanceof Array)return this.m_iteratorStack.push(this.createJSONArrayIterator(this.m_nextFlatToken.m_value)),this.nextToken();if(this.m_nextFlatToken.m_value instanceof Object)return this.m_iteratorStack.push(this.createJSONObjectIterator(this.m_nextFlatToken.m_value)),this.nextToken();if("number"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,Number.isSafeInteger(this.m_currentValue)&&this.m_currentValue>=(0,r.Z)()&&this.m_currentValue<=(0,r.n)()?this.m_currentToken=8:this.m_currentToken=7;if("string"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=6;if("boolean"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=this.m_nextFlatToken.m_value?11:12;if("object"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=null,this.m_currentToken=10;(0,r.p)("unrecognized json element type")}return(0,r.p)("unrecognized json element type"),0}currentToken(){return this.m_currentToken}skipChildren(){if(0!==this.m_iteratorStack.length)switch(this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=3,void(this.m_currentToken=3);case 2:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=4,void(this.m_currentToken=4)}}currentString(){return 6!==this.m_currentToken&&5!==this.m_currentToken&&(0,r.a)("invalid token"),this.m_currentValue}currentDoubleValue(){return 7!==this.m_currentToken&&8!==this.m_currentToken&&(0,r.a)("invalid token"),this.m_currentValue}currentInt32Value(){return 8!==this.m_currentToken&&(0,r.a)("invalid token"),this.m_currentValue}currentInt64Value(){return(0,r.b)(0),0n}currentBoolValue(){return 12!==this.m_currentToken&&11!==this.m_currentToken&&(0,r.a)("invalid token"),this.m_currentValue}isError(){return 0}}class l{constructor(e){return this.m_buffer=null,this.m_view=null,this.m_sz=0,this.m_offset=0,this.m_bOwnsBuffer=!0,this.m_bLittleEndian=!0,this.m_element=new ArrayBuffer(8),this.m_elementBytes=new Uint8Array(this.m_element),this.m_elementView=new DataView(this.m_element),this.m_elementDouble=new Float64Array(this.m_element),this.m_elementFloat=new Float32Array(this.m_element),this.m_elementInt64=new BigInt64Array(this.m_element),this.m_elementInt32=new Int32Array(this.m_element),this.m_elementInt16=new Int16Array(this.m_element),void 0!==e.sz?(this.m_sz=e.sz,e.buffer?(this.m_sz<0&&(0,r._)("size out of range"),this.m_buffer=e.buffer,this.m_offset=void 0!==e.offset?e.offset:0,this.m_view=void 0!==e.offset?new DataView(e.buffer,e.offset,e.sz):new DataView(this.m_buffer),this.m_bOwnsBuffer=!1,void(this.m_bLittleEndian=!0)):(this.m_sz<0&&(0,r._)("size out of range"),void(this.m_sz>0&&(this.m_buffer=new ArrayBuffer(this.m_sz),this.m_view=new DataView(this.m_buffer))))):e.move?(this.m_sz=e.move.m_sz,this.m_buffer=e.move.m_buffer,this.m_view=e.move.m_view,this.m_bOwnsBuffer=e.move.m_bOwnsBuffer,this.m_bLittleEndian=e.move.m_bLittleEndian,e.move.m_buffer=null,e.move.m_view=null,e.move.m_sz=0,void(e.move.m_bOwnsBuffer=!0)):void(0,r.p)("unrecognized constructor options")}swapBytesDouble(){this.doSwap()&&(this.m_elementDouble[0]=this.m_elementBytes[0]<<56|this.m_elementBytes[1]<<48|this.m_elementBytes[2]<<40|this.m_elementBytes[3]<<32|this.m_elementBytes[4]<<24|this.m_elementBytes[5]<<16|this.m_elementBytes[6]<<8|this.m_elementBytes[7])}swapBytesInt32(){this.doSwap()&&(this.m_elementInt32[0]=this.m_elementBytes[0]<<24|this.m_elementBytes[1]<<16|this.m_elementBytes[2]<<8|this.m_elementBytes[3])}getOffset(){return this.m_offset}assignMove(e){return this===e||(this.clear(),this.m_sz=e.m_sz,this.m_buffer=e.m_buffer,this.m_view=e.m_view,this.m_bOwnsBuffer=e.m_bOwnsBuffer,this.m_bLittleEndian=e.m_bLittleEndian,e.m_buffer=null,e.m_sz=0,e.m_bOwnsBuffer=!0),this}doSwap(){return this.m_bLittleEndian!==(1===l.getNativeByteOrder())}setNativeByteOrder(){this.m_bLittleEndian=1===l.getNativeByteOrder()}setOrder(e){this.m_bLittleEndian=1===e}getOrder(){return this.m_bLittleEndian?1:0}getView(){return this.m_view||(0,r.I)("buffer not defined"),this.m_view}static getNativeByteOrder(){return 1}clear(){this.m_buffer=null,this.m_sz=0,this.m_bOwnsBuffer=!0}size(){return this.m_sz}readDouble(e){return this.doSwap()?(this.m_elementDouble[0]=this.m_view.getFloat64(e,this.m_bLittleEndian),this.swapBytesDouble(),this.m_elementDouble[0]):this.m_view.getFloat64(e,this.m_bLittleEndian)}writeDouble(e,t){this.m_elementDouble[0]=t,this.swapBytesDouble(),this.m_view.setFloat64(e,this.m_elementDouble[0],this.m_bLittleEndian)}readInt32(e){return this.doSwap()?(this.m_elementInt32[0]=this.m_view.getInt32(e,this.m_bLittleEndian),this.swapBytesInt32(),this.m_elementInt32[0]):this.m_view.getInt32(e,this.m_bLittleEndian)}writeInt32(e,t){this.m_elementInt32[0]=t,this.swapBytesInt32(),this.m_view.setInt32(e,this.m_elementInt32[0],this.m_bLittleEndian)}getPtr(){return this.m_buffer}setSizeNoRealloc(e){(0,r.b)(e>=0&&e<=this.m_sz),this.m_sz=e}}function c(e){let t=!1;for(;3!==e.nextToken();){const n=e.currentString();e.nextToken(),"uwkid"===n?t||(t=!0,8===e.currentToken()&&e.currentInt32Value()):e.skipChildren()}return null}function d(e){let t=!1,n=!1,r=!1,a=!1,s=!1,o=!1,u=!1,m=!1,l=!1,d=!1,h=!1,_=!1,p=!1,f=!1,b=!1,k=!1,y=!1,N=-1,T=-1,g=-1,v=-1,x=0,A=0,S=0,w=0,C=0,D=0,F=0,j=0,I=0,O=0,z="",E="",P=null;for(;3!==e.nextToken();){const i=e.currentString();e.nextToken(),"wkid"===i?t||(t=!0,8===e.currentToken()&&(N=e.currentInt32Value())):"latestWkid"===i?n||(n=!0,8===e.currentToken()&&(T=e.currentInt32Value())):"wkt"===i?s||(s=!0,6===e.currentToken()&&(z=e.currentString())):"wkt2"===i?s||6===e.currentToken()&&(E=e.currentString()):"vcsWkid"===i?r||(r=!0,8===e.currentToken()&&(g=e.currentInt32Value())):"latestVcsWkid"===i?a||(a=!0,8===e.currentToken()&&(v=e.currentInt32Value())):"xyTolerance"===i?u||(u=!0,o=!0,x=e.currentDoubleValue()):"zTolerance"===i?m||(m=!0,o=!0,A=e.currentDoubleValue()):"mTolerance"===i?l||(l=!0,o=!0,S=e.currentDoubleValue()):"falseX"===i?d||(d=!0,o=!0,F=e.currentDoubleValue()):"falseY"===i?h||(h=!0,o=!0,j=e.currentDoubleValue()):"falseZ"===i?_||(_=!0,o=!0,I=e.currentDoubleValue()):"falseM"===i?p||(p=!0,o=!0,O=e.currentDoubleValue()):"xyUnits"===i?f||(f=!0,o=!0,w=e.currentDoubleValue()):"zUnits"===i?b||(b=!0,o=!0,C=e.currentDoubleValue()):"mUnits"===i?k||(k=!0,o=!0,D=e.currentDoubleValue()):"unit"===i?y||(y=!0,P=c(e)):e.skipChildren()}v<=0&&g>0&&(v=g),g<=0&&v>0&&(g=v);let G=null,B=!0;if(0!==z.length&&(B=!1,(0,i.b7)(z)&&(G=(0,i.a)(z))),G||0===E.length||(B=!1,(0,i.b7)(E)&&(G=(0,i.a)(E))),!G&&T>0&&(B=!1,(0,i.b8)(T)&&(v<=0||(0,i.b9)())&&(G=(0,i.c)(T,v))),!G&&N>0&&(B=!1,(0,i.b8)(N)&&(g<=0||(0,i.b9)())&&(G=(0,i.c)(N,g))),B&&(G=(0,i.W)(P)),o&&G){const e=new i.ba;G.queryPrecisionDescriptorWithoutFalseXY(e),u&&e.setTolerance(0,x),m&&e.setTolerance(1,A),l&&e.setTolerance(2,S),f&&d&&h&&e.setGridParams(F,j,w),b&&_&&e.setZParams(I,C),k&&p&&e.setMParams(O,D),G=(0,i.bb)(G,e)}return G}function h(e,t,n,s){2!==s.currentToken()&&(0,r.a)("failed to parse multipath: array of array of vertices is expected");const o=e?new i.P:new i.b,u=o,m=(0,a.l)(0),l=(0,a.j)(2,0),c=(0,a.m)(0);let d=null,h=null,_=null,p=null,b=null,T=0,g=0,v=0;const x=new i.S,A=r.P.getNAN();let S=0,w=0;const C=e?1:0;for(;4!==s.nextToken();){2!==s.currentToken()&&(0,r.a)("failed to parse multipath: ring/path array is expected");let n=2,o=0,D=!0;const F=4;let j=0,I=0;const O=r.P.getNAN(),z=(0,r.r)(F,Number.NaN),E=(0,r.r)(F,Number.NaN);let P=!1;for(s.nextToken();4!==s.currentToken();){if(t&&1===s.currentToken())D&&(0,r.a)("failed to parse multipath: starting vertex array is expected"),_||(_=(0,a.m)(S-1,1),p=(0,a.l)(S-1,-1),b=(0,a.j)(0)),P=!0,n=1,({segFlag:v,toPointSz:j}=N(x,z,A,s));else{for(P=!1,2!==s.currentToken()&&(0,r.a)("failed to parse multipath: array is expected, rings/paths vertices consist of arrays of coordinates"),j=0;4!==s.nextToken();)j===F&&(0,r.a)("failed to parse multipath: each vertex array has to have at most 4 elements"),z[j++]=f(s);j<2&&(0,r.a)("failed to parse multipath: each vertex array has to have at least 2 elements"),(0,a.n)(z[0],z[1])||(0,r.a)("failed to parse multipath: x and y must be finite")}s.nextToken();do{if(l.size()===2*S&&l.resize(k(S)),l.writePoint2D(2*S,O.setCoords(z[0],z[1])),d&&d.size()===S&&d.resize(y(S)),j>2?(d||(d=(0,a.j)(S+1,Number.NaN)),d.write(S,z[2])):d&&d.write(S,Number.NaN),h&&h.size()===S&&h.resize(y(S)),j>3?(h||(h=(0,a.j)(S+1,Number.NaN)),h.write(S,z[3])):h&&h.write(S,Number.NaN),D)w++,m.add(S),c.add(C),D=!1,I=j,(0,r.e)(E,z,0,0,I);else if(null!==_)if(P){const e=(0,i.bh)(v),t=b.size();b.resize(t+e),_.add(v),p.add(T),x.get().writeInBufferStream(b,T),T+=e,u.incCurveType(v,1),g++}else _.add(1),p.add(-1);S++,o++,A.setCoords(z[0],z[1])}while(o<n&&4===s.currentToken())}0!==o&&(e&&o>n&&j===I&&0===(0,r.$)(z,E,j)?(S--,o--):null!==_&&(_.add(1),p.add(-1)))}return S&&(m.resize(w),c.resize(w),S>0&&(m.add(S),c.add(0)),u.setAttributeStreamRef(0,l),u.setPathFlagsStreamRef(c),u.setPathStreamRef(m),null!==_&&(u.updateCurveCounter(g),u.setSegmentData(p,b,_,T)),u.notifyModifiedFlags(65535)),{geometry:o,as:d,bs:h}}function _(e,t){2!==t.currentToken()&&(0,r.a)("failed to parse multipoint: array of vertices is expected");let n=0;const s=new i.M,o=(0,a.j)(2,0);let u=0;const m=(0,r.r)(4,Number.NaN),l=new r.P;let c=null,d=null;for(;4!==t.nextToken();){for(2!==t.currentToken()&&(0,r.a)("failed to parse multipoint: array is expected, multipoint vertices consist of arrays of cooridinates"),u=0;4!==t.nextToken();)4===u&&(0,r.a)("failed to parse multipoint: each vertex array has to have at most 4 elements"),m[u++]=f(t);u<2&&(0,r.a)("failed to parse multipoint: each vertex array has to have at least 2 elements"),(0,a.n)(m[0],m[1])||(0,r.a)("failed to parse multipoint: x and y must be finite"),o.size()===2*n&&o.resize(k(n)),o.writePoint2D(2*n,l.setCoords(m[0],m[1])),c&&c.size()===n&&c.resize(y(n)),u>2?(c||(c=(0,a.j)(n+1,Number.NaN)),c.write(n,m[2])):c&&c.write(n,Number.NaN),d&&d.size()===n&&d.resize(y(n)),u>3?(d||(d=(0,a.j)(n+1,Number.NaN)),d.write(n,m[3])):d&&d.write(n,Number.NaN),n++}if(n){const e=s.getImpl();e.setAttributeStreamRef(0,o),e.resizeNoInit(n),e.notifyModifiedFlags(65535)}return{geometry:s,as:c,bs:d}}function p(e,t){2!==t.currentToken()&&(0,r.a)("failed to parse array of IDs: array of array of integers is expected");const n=(0,a.o)(2,0);let i=0,s=-1;for(;4!==t.nextToken();){const e=i;n.size()===i&&n.resize(y(i)),i++;let a=0;for(-1===s?s=2===t.currentToken()?1:0:1===s&&2!==t.currentToken()&&(0,r.a)("failed to parse array of IDs: array of array of integers is expected"),0===s&&(n.size()===i&&n.resize(y(i)),n.write(i,b(t)),a++,i++);4!==t.nextToken();)n.size()===i&&n.resize(y(i)),n.write(i,b(t)),a++,i++;if(n.write(e,a),0===s)break}return n.resize(i),n}function f(e){const t=e.currentToken();if(10===t||6===t&&"NaN"===e.currentString())return Number.NaN;{const t=e.currentDoubleValue();return Number.isNaN(t)?Number.NaN:t}}function b(e){return e.currentInt32Value()}function k(e){let t=2*Math.trunc(3*(e+1)/2);return t<8?t=8:t<32&&(t=32),t}function y(e){let t=Math.trunc(3*(e+1)/2);return t<4?t=4:t<16&&(t=16),t}function N(e,t,n,a,s){const o={segFlag:0,toPointSz:0};let u=a.currentToken();u=a.nextToken();const m=a.currentString(),c=m[0];for((1!==m.length||"a"!==c&&"b"!==c&&"c"!==c&&"n"!==c&&"q"!==c)&&(0,r.a)('failed to parse curve: expecting "a", "b", "n", "q", or "c"'),u=a.nextToken(),2!==u&&(0,r.a)("failed to parse curve: start array is expected for curve parameters"),u=a.nextToken(),2!==u&&(0,r.a)("failed to parse curve: start array is expected for to point"),o.toPointSz=0;4!==a.nextToken();)4===o.toPointSz&&(0,r.a)("failed to parse curve: vertex array cannot have more than 4 elements"),t[o.toPointSz++]=f(a);o.toPointSz<2&&(0,r.a)("failed to parse curve: vertex array must have at least 2 elements");const d=r.P.construct(t[0],t[1]),h=r.P.getNAN();let _=-1,p=-1,b=!1,k=Number.NaN,y=Number.NaN,N=Number.NaN;const g=[r.P.getNAN(),r.P.getNAN(),r.P.getNAN()],v=r.P.getNAN();if("a"===c){u=a.nextToken(),2!==u&&(0,r.a)("failed to parse curve: start array is expected for center point"),u=a.nextToken();const e=f(a);u=a.nextToken();const t=f(a);u=a.nextToken(),4!==u&&(0,r.a)("failed to parse curve: end array is expected for center point"),h.setCoords(e,t),u=a.nextToken(),_=a.currentInt32Value(),u=a.nextToken(),p=a.currentInt32Value(),u=a.nextToken(),4!==u?(b=!1,k=f(a),u=a.nextToken(),y=f(a),u=a.nextToken(),N=f(a),u=a.nextToken(),4!==u&&(0,r.a)("failed to parse curve: end array is expected for curve parameters")):b=!0,o.segFlag=4}else if("b"===c){for(let e=0;e<2;e++){u=a.nextToken(),2!==u&&(0,r.a)("failed to parse curve: start array is expected for control point"),u=a.nextToken();const t=f(a);u=a.nextToken();const n=f(a);u=a.nextToken(),4!==u&&(0,r.a)("failed to parse curve: end array is expected for control point"),g[e].setCoords(t,n)}u=a.nextToken(),4!==u&&(0,r.a)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=2}else if("n"===c){{u=a.nextToken(),2!==u&&(0,r.a)("failed to parse curve: start array is expected for control point"),u=a.nextToken();const e=f(a);u=a.nextToken();const t=f(a);u=a.nextToken(),4!==u&&(0,r.a)("failed to parse curve: end array is expected for control point"),g[0].setCoords(e,t)}u=a.nextToken();const e=f(a);u=a.nextToken();const t=f(a);u=a.nextToken();const n=f(a);g[1].setCoords(e,t),g[2].setCoords(n,n),u=a.nextToken(),4!==u&&(0,r.a)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=8}else if("q"===c){for(let e=0;e<1;e++){u=a.nextToken(),2!==u&&(0,r.a)("failed to parse curve: start array is expected for control point"),u=a.nextToken();const t=f(a);u=a.nextToken();const n=f(a);u=a.nextToken(),4!==u&&(0,r.a)("failed to parse curve: end array is expected for control point"),g[e].setCoords(t,n)}u=a.nextToken(),4!==u&&(0,r.a)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=16}else{u=a.nextToken(),2!==u&&(0,r.a)("failed to parse curve: start array is expected for interior point"),u=a.nextToken();const e=f(a);u=a.nextToken();const t=f(a);u=a.nextToken(),4!==u&&(0,r.a)("failed to parse curve: end array is expected for interior point"),v.setCoords(e,t),u=a.nextToken(),4!==u&&(0,r.a)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=4}if(u=a.nextToken(),3!==u&&(0,r.a)("failed to parse curve: end object is expected for curve"),"a"===c)if(e.createEllipticArc(),b){const t=!0;T(e.get(),n,d,h,t,_,p)}else!function(e,t,n,r,a,s,o,u,m){e.dropAllAttributes();const c=new ArrayBuffer(44),d=new l({sz:44,buffer:c});let h=0;d.writeDouble(h,r.x),h+=8,d.writeDouble(h,r.y),h+=8,d.writeDouble(h,o),h+=8,d.writeDouble(h,u),h+=8,d.writeDouble(h,m),h+=8;let _=0;s||(_|=2048),a&&(_|=4096),d.writeInt32(h,_),h+=4,function(e,t,n,r){e.m_bits=0,e.m_center.x=r.readDouble(0),e.m_center.y=r.readDouble(8),e.m_rotation=r.readDouble(16),e.m_semiMajorAxis=r.readDouble(24),e.m_minorMajorRatio=r.readDouble(32),e.m_XStart=t.x,e.m_YStart=t.y,e.m_XEnd=n.x,e.m_YEnd=n.y;const a=r.readInt32(40);if(1&a)return!1;let s=!!(64&a),o=!!(128&a);const u=!!(2048&a),m=!!(4096&a);!(512&a)&&!(1024&a)||o||(s=!0),o&&!t.equals(n)?(o=!1,s=!0):s&&t.equals(n)&&(o=!0,s=!1),o?(e.m_center.assign(t),e.m_startAngle=e.m_center.x,e.m_sweepAngle=e.m_center.y,(0,i.bg)(e,Number.NaN,u,m),e.m_semiMajorAxis=0,e.m_interior.setCoordsPoint2D(t)):s?(e.m_center.setNAN(),e.m_semiMajorAxis=1,e.m_minorMajorRatio=0,e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0,(0,i.be)(e),e.queryCoord2D(.5,e.m_interior)):e.constructEllipticArcEndPointsCenter(t,n,e.m_semiMajorAxis,e.m_minorMajorRatio,e.m_rotation,!m,u,e.m_center),e.setProjectionBehavior(1),(0,i.be)(e)}(e,t,n,d)}(e.get(),n,d,h,_,p,k,y,N);else if("b"===c)e.createCubicBezier(),function(e,t,n,i){e.dropAllAttributes();const a=new ArrayBuffer(32),s=new l({sz:32,buffer:a});let o=0;s.writeDouble(o,i[0].x),o+=8,s.writeDouble(o,i[0].y),o+=8,s.writeDouble(o,i[1].x),o+=8,s.writeDouble(o,i[1].y),o+=8,function(e,t,n,i){(0,r.b)(32<=i.size()),e.m_cp=(0,r.m)(r.P,2),e.m_cp[0].x=i.readDouble(0),e.m_cp[0].y=i.readDouble(8),e.m_cp[1].x=i.readDouble(16),e.m_cp[1].y=i.readDouble(24),e.m_XStart=t.x,e.m_YStart=t.y,e.m_XEnd=n.x,e.m_YEnd=n.y}(e,t,n,s)}(e.get(),n,d,g);else if("n"===c)e.createQuadraticRationalBezier(),function(e,t,n,r,i,a,s){e.dropAllAttributes();const o=new ArrayBuffer(40),u=new l({sz:40,buffer:o});let m=0;u.writeDouble(m,r.x),m+=8,u.writeDouble(m,r.y),m+=8,u.writeDouble(m,i),m+=8,u.writeDouble(m,a),m+=8,u.writeDouble(m,s),m+=8,function(e,t,n,r){e.m_cp.x=r.readDouble(0),e.m_cp.y=r.readDouble(8),e.m_weights[0]=r.readDouble(16),e.m_weights[1]=r.readDouble(24),e.m_weights[2]=r.readDouble(32),e.m_XStart=t.x,e.m_YStart=t.y,e.m_XEnd=n.x,e.m_YEnd=n.y}(e,t,n,u)}(e.get(),n,d,g[0],g[1].x,g[1].y,g[2].x);else if("q"===c)e.createQuadraticBezier(),e.get().construct(n,g[0],d);else{e.createEllipticArc();const t=!1;T(e.get(),n,d,v,t,-1,-1)}return o}function T(e,t,n,a,s,o,u){e.dropAllAttributes();const m=new ArrayBuffer(20),c=new l({sz:20,buffer:m});let d=0;c.writeDouble(d,a.x),d+=8,c.writeDouble(d,a.y),d+=8;let h=0;s?(u||(h|=8),o&&(h|=16)):h|=128,c.writeInt32(d,h),d+=4,function(e,t,n,a){0>=a.size()&&(0,r._)("Byte_buffer out of range access"),e.m_bits=0,e.m_rotation=0,e.m_cosr=1,e.m_sinr=0,e.setStartXY(t),e.setEndXY(n);const s=r.P.getNAN();s.x=a.readDouble(0),s.y=a.readDouble(8);const o=a.readInt32(16);if(1&o)return e.m_semiMajorAxis=0,e.m_minorMajorRatio=1,e.m_interior.assign(s),e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0,(0,i.be)(e),!1;let u=!!(64&o);const m=!!(128&o);let l=!!(32&o);const c=!!(8&o),d=!!(16&o),h=t.equals(n);u&&!h&&(u=!1,l=!0),l&&h&&(u=!0,l=!1,s.setCoords(0,0)),u||(m?l?(e.m_semiMajorAxis=1,e.m_minorMajorRatio=0,e.m_interior.assign(s),e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0):(e.constructCircularArcThreePoint(t,n,s),h&&c===e.isClockwise()&&e.reverse()):l?(e.m_semiMajorAxis=1,e.m_minorMajorRatio=0,e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0,(0,i.be)(e),e.queryCoord2D(.5,e.m_interior)):(0,i.bf)(e,t,n,s,c,d)),u&&(e.m_center.assign(t),e.m_startAngle=s.x,e.m_sweepAngle=s.y,(0,i.bg)(e,Number.NaN,c,d),e.m_semiMajorAxis=0,e.m_minorMajorRatio=1,e.m_interior.setCoordsPoint2D(t)),e.setProjectionBehavior(0),(0,i.be)(e)}(e,t,n,c)}function g(e,t,n,a,s){const o=e.getGeometryType();if(o===r.G.enumEllipticArc)return function(e,t,n,a,s){(0,r.b)(!(0,i.bd)(e));const o=e.getEndXY(),u=e.hasAttribute(1)&&!t,m=e.hasAttribute(2)&&!n;let l=Number.NaN,c=Number.NaN;if(u&&(l=e.getEndAttributeAsDbl(1,0)),m&&(c=e.getEndAttributeAsDbl(2,0)),e.isDegenerateToLine()||e.isDegenerate(0))return x(u,m,o.x,o.y,l,c,a,s),!0;const d=0===e.projectionBehavior(),h=!!d&&e.isClosed();if(d&&!h)s.startObject(),s.addFieldName("c"),s.startArray(),x(u,m,o.x,o.y,l,c,a,s),A(e.m_interior.x,e.m_interior.y,17,s),s.endArray(),s.endObject();else if(d){s.startObject(),s.addFieldName("a"),s.startArray(),x(u,m,o.x,o.y,l,c,a,s);const t=0,n=0;A(e.m_center.x+t,e.m_center.y+n,17,s);const r=!e.isMajor();s.addInt32(r?1:0);const i=e.isClockwise();s.addInt32(i?1:0),s.endArray(),s.endObject()}else{s.startObject(),s.addFieldName("a"),s.startArray(),x(u,m,o.x,o.y,l,c,a,s);const t=e;A(t.m_center.x,t.m_center.y,17,s);const n=!t.isMajor();s.addInt32(n?1:0);const r=t.isClockwise();s.addInt32(r?1:0),s.addDouble(t.m_rotation,17),s.addDouble(t.m_semiMajorAxis,17),s.addDouble(t.m_minorMajorRatio,17),s.endArray(),s.endObject()}return!1}(e,t,n,a,s);if(o===r.G.enumBezier)return v(e,t,n,a,s);if(o===r.G.enumRationalBezier2)return function(e,t,n,r,i){const a=e.getEndXY(),s=e.hasAttribute(1)&&!t,o=e.hasAttribute(2)&&!n;let u=Number.NaN,m=Number.NaN;s&&(u=e.getEndAttributeAsDbl(1,0)),o&&(m=e.getEndAttributeAsDbl(2,0)),i.startObject(),i.addFieldName("n"),i.startArray(),x(s,o,a.x,a.y,u,m,r,i),A(e.m_cp.x,e.m_cp.y,r,i);const l=r;return i.addDouble(e.m_weights[0],l),i.addDouble(e.m_weights[1],l),i.addDouble(e.m_weights[2],l),i.endArray(),i.endObject(),!1}(e,t,n,a,s);if(o===r.G.enumBezier2){const r=new i.bc;return r.constructFromQuadraticSegment(e),v(r,t,n,a,s)}(0,r.t)("")}function v(e,t,n,r,i){const a=e.getEndXY(),s=e.hasAttribute(1)&&!t,o=e.hasAttribute(2)&&!n;let u=Number.NaN,m=Number.NaN;return s&&(u=e.getEndAttributeAsDbl(1,0)),o&&(m=e.getEndAttributeAsDbl(2,0)),i.startObject(),i.addFieldName("b"),i.startArray(),x(s,o,a.x,a.y,u,m,r,i),A(e.m_cp[0].x,e.m_cp[0].y,r,i),A(e.m_cp[1].x,e.m_cp[1].y,r,i),i.endArray(),i.endObject(),!1}function x(e,t,n,r,i,a,s,o){o.startArray(),o.addDouble(n,s),o.addDouble(r,s),e&&o.addDouble(i,s),t&&o.addDouble(a,s),o.endArray()}function A(e,t,n,r){r.startArray(),r.addDouble(e,n),r.addDouble(t,n),r.endArray()}function S(e,t,n,s){const o=n.getImpl(),u=!!(2&t),m=!!(4&t),l=!!(8&t),c=o.hasAttribute(1)&&!u,d=o.hasAttribute(2)&&!m,h=o.hasAttribute(3)&&!l,_=o.hasNonLinearSegments();c&&(s.addFieldName("hasZ"),s.addBool(!0)),d&&(s.addFieldName("hasM"),s.addBool(!0)),e?_?s.addFieldName("curveRings"):s.addFieldName("rings"):_?s.addFieldName("curvePaths"):s.addFieldName("paths");let p=null;const f=[];if(n.isEmpty())s.startArray(),s.endArray();else{const e=17-(31&t>>13);s.startArray();const l=n.getPathCount();let b=0;const k=o.getAttributeStreamRef(0);let y=null,N=null,T=null;const v=new i.S;let x=null,A=null,S=null;_&&(x=o.getSegmentFlagsStreamRef(),A=o.getSegmentIndexStreamRef(),S=o.getSegmentDataStreamRef()),c&&(y=o.getAttributeStreamRef(1)),d&&(N=o.getAttributeStreamRef(2)),h&&(T=o.getAttributeStreamRef(3),p=(0,a.p)(3,0));for(let t=0;t<l;t++){s.startArray(),h&&f.push(0);const i=n.getPathEnd(t);if(b===i){s.endArray();continue}const a=n.isClosedPath(t);let o=k.read(2*b),l=k.read(2*b+1),_=c?y.read(b):Number.NaN,C=d?N.read(b):Number.NaN,D=h?T.read(b):0;w(c,d,o,l,_,C,e,s);let F=1;h&&(p.add(D),f[f.length-1]++);const j=o,I=l,O=_,z=C,E=D;let P=!1,G=0,B=Number.NaN,V=Number.NaN,M=0;for(let t=b+1,n=b,R=a?i+1:i;t<R;t++,n++){const a=null!==x?31&x.read(n):1;let b,R;if(t<i?(b=k.read(2*t),R=k.read(2*t+1),c&&(B=y.read(t)),d&&(V=N.read(t)),h&&(M=T.read(t))):(b=j,R=I,B=O,V=z,M=E),1!==a){P=!0,4===a?v.createEllipticArc():2===a?v.createCubicBezier():16===a?v.createQuadraticBezier():8===a?v.createQuadraticRationalBezier():(0,r.t)("JSON export.unsupported curve");const t=v.get(),i=A.read(n);t.setStartXYCoords(o,l),t.setEndXYCoords(b,R),c&&(t.setStartAttribute(1,0,_),t.setEndAttribute(1,0,B)),d&&(t.setStartAttribute(2,0,C),t.setEndAttribute(2,0,V)),t.readFromBufferStream(S,i),g(v.get(),u,m,e,s)&&G++}else w(c,d,b,R,B,V,e,s);h&&(p.add(M),f[f.length-1]++),F++,o=b,l=R,_=B,C=V,D=M}P&&0===G||(F<2&&G<1&&(w(c,d,o,l,_,C,e,s),F++,h&&(p.add(D),f[f.length-1]++)),a&&F<3&&G<2&&(w(c,d,j,I,O,z,e,s),F++,o=j,l=I,_=O,C=z,D=E,h&&(p.add(E),f[f.length-1]++))),s.endArray(),b=i}s.endArray()}if(h){s.addFieldName("ids"),s.startArray();let e=0;for(let t=0,n=f.length;t<n;++t){const n=f[t];(0,r.b)(0===n||null!==p&&e+n<=p.size()),s.startArray();for(let t=0;t<n;++t)s.addInt32(p.read(e)),e++;s.endArray()}s.endArray()}}function w(e,t,n,r,i,a,s,o){o.startArray(),o.addDouble(n,s),o.addDouble(r,s),e&&o.addDouble(i,s),t&&o.addDouble(a,s),o.endArray()}const C="a".charCodeAt(0),D="A".charCodeAt(0),F="*".charCodeAt(0),j="b".charCodeAt(0),I="\\".charCodeAt(0),O="[".charCodeAt(0),z="{".charCodeAt(0),E=":".charCodeAt(0),P=".".charCodeAt(0),G=",".charCodeAt(0),B='"'.charCodeAt(0),V="]".charCodeAt(0),M="}".charCodeAt(0),R="e".charCodeAt(0),U="E".charCodeAt(0),W="f".charCodeAt(0),X="F".charCodeAt(0),L="/".charCodeAt(0),Y="-".charCodeAt(0),K="+".charCodeAt(0),q="n".charCodeAt(0),Z="N".charCodeAt(0),J="r".charCodeAt(0),H="t".charCodeAt(0),Q="u".charCodeAt(0),$="0".charCodeAt(0),ee="9".charCodeAt(0);class te{constructor(e){this.m_functionStack=[],this.m_pushPositions=[],this.m_utf8Decoder=new TextDecoder("utf-8",{fatal:!0}),void 0===e?(this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_endToken=0,this.m_currentTokenType=0,this.m_functionStack.push(()=>this.accept_()),this.m_jsonString=null,this.m_bHasEscapes=!1):e.jsonString?this.resetParserFromString(e.jsonString):e.jsonStream?(0,r.t)("streaming json parsing not yet impl"):(0,r.p)("invalid constructor parameter")}prepSubstrString_(){}getCurrentSubstrString_(){return this.m_jsonString.slice(this.m_startToken,this.m_endToken)}stepOverCharString_(){this.m_endToken++}peekCharString_(){return this.m_jsonString.charCodeAt(this.m_endToken)}getString_(e){const t=this.m_jsonString?.slice(this.m_startToken,this.m_startToken+e-1);return this.m_endToken+=e-1,{s:t,bDone:this.m_endToken>=this.m_jsonString.length}}incrementString_(){this.m_endToken++}eofString_(){return this.m_endToken>=this.m_jsonString.length}setStringFunctions_(){this.m_prepSubstr=this.prepSubstrString_,this.m_getCurrentSubstr=this.getCurrentSubstrString_,this.m_stepOverChar=this.stepOverCharString_,this.m_peekChar=this.peekCharString_,this.m_get=this.getString_,this.m_increment=this.incrementString_,this.m_eof=this.eofString_}setStreamFunctions_(){(0,r.t)("streaming json parsing not yet impl")}reset_(){this.m_jsonString=null,this.m_endToken=0,this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_currentTokenType=0,this.m_bHasEscapes=!1,this.m_functionStack.length=0,this.m_functionStack.push(()=>this.start_()),this.m_pushPositions.length=0}resetParserFromString(e){this.reset_(),this.setStringFunctions_(),this.m_jsonString=e}resetParserFromStream(e){(0,r.t)("streaming json parsing not yet impl")}resetToPosition(e){return!!this.m_jsonString&&(this.m_endToken=e,this.m_startToken=Number.MAX_VALUE,this.m_currentTokenType=0,this.m_functionStack.length=0,e>=this.m_jsonString.length?(this.m_functionStack.push(()=>this.accept_()),!1):(this.m_functionStack.push(()=>this.start_()),!0))}nextToken(){return this.m_functionStack.at(-1)(),this.m_currentTokenType}currentToken(){return this.m_currentTokenType}currentTokenStartIndex(){return this.m_startToken}currentTokenEndIndex(){return this.m_endToken}currentText(){return(0,r.b)(0),""}childrenAsString(){return(0,r.b)(0),""}skipChildren(){this.skipChildren_()}skipChildren_(){if(1===this.m_currentTokenType){let e=1;do{this.m_currentTokenType=this.nextToken(),1===this.m_currentTokenType?e++:3===this.m_currentTokenType&&e--}while(3!==this.m_currentTokenType||0!==e);return}if(2===this.m_currentTokenType){let e=1;do{this.m_currentTokenType=this.nextToken(),2===this.m_currentTokenType?e++:4===this.m_currentTokenType&&e--}while(4!==this.m_currentTokenType||0!==e);return}}currentTerminalAsString_(){switch(this.m_currentTokenType){case 7:case 8:case 9:return this.m_getCurrentSubstr().slice(0,this.m_endToken-this.m_startToken);case 10:return"null";case 11:return"true";case 12:return"false"}(0,r.a)("invalid token")}toUTF8_(e,t){let n=0,r=e;for(;t.charCodeAt(r)===I&&t.charCodeAt(r+1)===Q;)n++,r+=6;r=e;const i=new Uint8Array(n);let a=0;for(;t.charCodeAt(r)===I&&t.charCodeAt(r+1)===Q;)i[a++]=Number.parseInt(t.slice(r+2,r+6),16),r+=6;return{u8s:this.m_utf8Decoder.decode(i),end:r}}unquoteCurrentString_(){let e="",t=1;const n=this.m_endToken-this.m_startToken-1;let r=0;const i=this.m_getCurrentSubstr();for(let a=t;a<n;a++)if(i.charCodeAt(a)!==I)r++;else{switch(r>0&&(e+=i.slice(t,t+r)),i.charCodeAt(++a)){case B:e+='"';break;case Q:{const{u8s:t,end:n}=this.toUTF8_(a-1,i);a=n-1,e+=t;break}case I:e+="\\";break;case L:e+="/";break;case j:e+="\b";break;case W:e+="\f";break;case q:e+="\n";break;case J:e+="\r";break;case H:e+="\t"}t=a+1,r=0}return r>0&&(e+=i.slice(t,t+r)),e}currentString(){return 5!==this.m_currentTokenType&&6!==this.m_currentTokenType?this.currentTerminalAsString_():this.m_bHasEscapes?this.unquoteCurrentString_():this.m_getCurrentSubstr().slice(1,this.m_endToken-this.m_startToken-2+1)}currentDoubleValue(){if(7!==this.m_currentTokenType&&8!==this.m_currentTokenType&&9!==this.m_currentTokenType&&6!==this.m_currentTokenType&&10!==this.m_currentTokenType&&(0,r.a)("invalid token"),10===this.m_currentTokenType)return Number.NaN;let e=this.m_getCurrentSubstr(),t=this.m_endToken-this.m_startToken;if(6===this.m_currentTokenType){if("NaN"===this.currentString())return Number.NaN;e=e.slice(1),t-=2,0===t&&(0,r.a)("invalid token")}const n=Number.parseFloat(e);if(6===this.m_currentTokenType)Number.isNaN(n)&&(0,r.a)("invalid token");else if(Number.isNaN(n))return Number.NaN;return n}currentInt32Value(){8!==this.m_currentTokenType&&6!==this.m_currentTokenType&&(0,r.a)("invalid token");let e=this.m_getCurrentSubstr(),t=this.m_endToken-this.m_startToken;6===this.m_currentTokenType&&(e=e.slice(1),t-=2,0===t&&(0,r.a)("invalid token"));const n=parseInt(e);return Number.isNaN(n)&&(0,r.a)("invalid token"),n}currentInt64Value(){return(0,r.b)(0),0n}currentBoolValue(){return(0,r.b)(0),!1}isError(){return 0}JSONString(){return(0,r.b)(0),""}pushPosition(){return(0,r.b)(0),!1}popPosition(){return(0,r.b)(0),!1}skipCStyleComments_(){(0,r.b)(0)}skipCppStyleComments_(){(0,r.b)(0)}skipComments_(){this.m_prepSubstr();let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,r.a)("invalid token"),e=this.m_peekChar(),e===F?this.skipCStyleComments_():e===L?this.skipCppStyleComments_():(0,r.a)("invalid token")}skipWhiteSpace_(){let e;do{this.m_eof()&&(0,r.a)("invalid token");let t=this.m_peekChar();for(;t>=9&&t<=13||32===t;)this.m_increment(),this.m_eof()&&(0,r.a)("invalid token"),t=this.m_peekChar();t===L?(this.m_startToken=this.m_endToken,e=!0,this.skipComments_()):e=!1}while(e)}rightBracket_(){return this.m_peekChar()===V&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=4,!0)}rightBrace_(){return this.m_peekChar()===M&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=3,!0)}string_(){this.m_prepSubstr(),this.m_bHasEscapes=!1,this.m_stepOverChar(),this.m_eof()&&(0,r.a)("invalid token");let e=this.m_peekChar();for(;e!==B;){const t=e===I;if(this.m_stepOverChar(),this.m_eof()&&(0,r.a)("invalid token"),e=this.m_peekChar(),t)if(this.m_bHasEscapes=!0,e===B||e===I||e===L||e===j||e===W||e===q||e===J||e===H)this.m_stepOverChar(),this.m_eof()&&(0,r.a)("invalid token"),e=this.m_peekChar();else if(e===Q)for(let t=0;t<4;t++)this.m_stepOverChar(),this.m_eof()&&(0,r.a)("invalid token"),e=this.m_peekChar(),e>=$&&e<=ee||e>=C&&e<=W||e>=D&&e<=X||(0,r.a)("invalid token");else(0,r.a)("invalid token")}this.m_stepOverChar()}comma_(){return this.m_peekChar()===G&&(this.m_increment(),!0)}colon_(){return this.m_peekChar()===E&&(this.m_increment(),!0)}fieldNameEnd_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.colon_()?(this.skipWhiteSpace_(),this.value_()):(0,r.a)("invalid token")}fieldNameStart_(){this.m_startToken=this.m_endToken,this.m_peekChar()!==B&&(0,r.a)("invalid token"),this.string_(),this.m_currentTokenType=5,this.m_functionStack.push(()=>this.fieldNameEnd_())}pairEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.fieldNameStart_()):this.rightBrace_()?this.m_functionStack.pop():(0,r.a)("invalid token")}arrayStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBracket_()||(this.m_functionStack.push(()=>this.elementEnd_()),this.value_())}elementEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.value_()):this.rightBracket_()?this.m_functionStack.pop():(0,r.a)("invalid token")}objectStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBrace_()||(this.m_functionStack.push(()=>this.pairEnd_()),this.fieldNameStart_())}valueStartObject_(){this.m_increment(),this.m_currentTokenType=1,this.m_functionStack.push(()=>this.objectStart_())}valueStartArray_(){this.m_increment(),this.m_currentTokenType=2,this.m_functionStack.push(()=>this.arrayStart_())}valueString_(){this.string_(),this.m_currentTokenType=6}int_(){this.m_peekChar()!==$?this.digits_():this.m_stepOverChar()}digits_(){let e=this.m_peekChar();do{this.m_stepOverChar(),this.m_eof()&&(0,r.a)("invalid token"),e=this.m_peekChar()}while(e>=$&&e<=ee)}frac_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,r.a)("invalid token"),e=this.m_peekChar(),e>=$&&e<=ee||(0,r.a)("invalid token"),this.digits_()}exp_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,r.a)("invalid token"),e=this.m_peekChar(),e!==K&&e!==Y||(this.m_stepOverChar(),this.m_eof()&&(0,r.a)("invalid token"),e=this.m_peekChar()),e>=$&&e<=ee||(0,r.a)("invalid token"),this.digits_()}valueNumber_(){this.m_prepSubstr();let e=!1,t=this.m_peekChar();if(t===Y?(this.m_stepOverChar(),this.m_eof()&&(0,r.a)("invalid token"),t=this.m_peekChar(),e=!0,t>=$&&t<=ee||(0,r.a)("invalid token"),this.int_()):this.int_(),t=this.m_peekChar(),t===P)this.m_currentTokenType=7,this.frac_(),t=this.m_peekChar(),t!==R&&t!==U||this.exp_();else if(t===R||t===U)this.m_currentTokenType=7,this.exp_();else{let t=0;e&&t++;const n=this.m_endToken-this.m_startToken-t;if(n<10)this.m_currentTokenType=8;else if(10===n){const n=this.m_getCurrentSubstr();e?n.slice(t)<="2147483648"?this.m_currentTokenType=8:this.m_currentTokenType=9:n.slice(t)<="2147483647"?this.m_currentTokenType=8:this.m_currentTokenType=9}else if(n<19)this.m_currentTokenType=9;else if(19===n){const n=this.m_getCurrentSubstr();e?n.slice(t)<="9223372036854775808"?this.m_currentTokenType=9:this.m_currentTokenType=7:n.slice(t)<="9223372036854775807"?this.m_currentTokenType=9:this.m_currentTokenType=7}else this.m_currentTokenType=7}}valueNull_(){const{s:e,bDone:t}=this.m_get(5);t&&(0,r.a)("invalid token"),"null"!==e&&(0,r.a)("invalid token"),this.m_currentTokenType=10}valueTrue_(){const{s:e,bDone:t}=this.m_get(5);t&&(0,r.a)("invalid token"),"true"!==e&&(0,r.a)("invalid token"),this.m_currentTokenType=11}valueFalse_(){const{s:e,bDone:t}=this.m_get(6);t&&(0,r.a)("invalid token"),"false"!==e&&(0,r.a)("invalid token"),this.m_currentTokenType=12}valueNan_(){const{s:e,bDone:t}=this.m_get(4);t&&(0,r.a)("invalid token"),"NaN"!==e&&(0,r.a)("invalid token"),this.m_currentTokenType=7}value_(){this.m_startToken=this.m_endToken;const e=this.m_peekChar();e===z?this.valueStartObject_():e===O?this.valueStartArray_():e===B?this.valueString_():e===Y||e>=$&&e<=$+9?this.valueNumber_():e===q?this.valueNull_():e===H?this.valueTrue_():e===W?this.valueFalse_():e===Z?this.valueNan_():(0,r.a)("invalid token")}start_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.m_functionStack.push(()=>this.accept_());const e=this.m_peekChar();e!==z&&e!==O&&(0,r.a)("invalid token"),this.value_()}accept_(){this.m_startToken=this.m_endToken,this.m_currentTokenType=0}}const ne=new class{constructor(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject=[]}reset(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject.length=0}startObject(){const e={};this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}startArray(){const e=[];this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}endObject(){this.m_acceptedObject=this.m_currentObject.at(-1),this.m_currentObject.pop()}endArray(){this.m_currentObject.pop()}addFieldName(e){this.m_pendingKey=e}addValue_(e){this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):this.m_currentObject.at(-1).push(e)}addString(e){this.addValue_(e)}addDouble(e,t){this.addValue_(e)}addInt64(e){(0,r.b)(0)}addInt32(e){this.addValue_(e)}addBool(e){this.addValue_(e)}addNull(){this.addValue_(null)}getObject(){return this.m_acceptedObject}},re=new class{getOperatorType(){return 10405}accelerateGeometry(e,t,n){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,t,n,a,s,o){!function(e,t,n,a){if(t||n){if(a.startObject(),null!==t)switch(t.getGeometryType()){case r.G.enumPolygon:S(!0,e,t,a);break;case r.G.enumPolyline:S(!1,e,t,a);break;case r.G.enumMultiPoint:!function(e,t,n){const i=t.getImpl(),a=i.hasAttribute(1)&&!(2&e),s=i.hasAttribute(2)&&!(4&e),o=i.hasAttribute(3)&&!(8&e);a&&(n.addFieldName("hasZ"),n.addBool(!0)),s&&(n.addFieldName("hasM"),n.addBool(!0)),n.addFieldName("points");const u=t.getPointCount();if(t.isEmpty())n.startArray(),n.endArray();else{const t=17-(31&e>>13);n.startArray();const r=i.getAttributeStreamRef(0);let o=null,m=null;a&&(o=i.getAttributeStreamRef(1)),s&&(m=i.getAttributeStreamRef(2));for(let e=0;e<u;e++){const i=r.read(2*e),u=r.read(2*e+1);let l=Number.NaN,c=Number.NaN;a&&(l=o.read(e)),s&&(c=m.read(e)),w(a,s,i,u,l,c,t,n)}n.endArray()}if(o){let e=null;i.isEmpty()||(e=i.getAttributeStreamRef(3)),(0,r.b)(0===u||null!==e&&e.size()>=u),n.addFieldName("ids"),n.startArray();for(let t=0;t<u;t++)n.addInt32(e.read(t));n.endArray()}}(e,t,a);break;case r.G.enumPoint:!function(e,t,n){const r=t.hasAttribute(1)&&!(2&e),i=t.hasAttribute(2)&&!(4&e),a=t.hasAttribute(3)&&!(8&e);if(t.isEmpty())return n.addFieldName("x"),n.addNull(),n.addFieldName("y"),n.addNull(),r&&(n.addFieldName("z"),n.addNull()),i&&(n.addFieldName("m"),n.addNull()),void(a&&(n.addFieldName("id"),n.addInt32(0)));const s=17-(31&e>>13);n.addFieldName("x"),n.addDouble(t.getX(),s),n.addFieldName("y"),n.addDouble(t.getY(),s),r&&(n.addFieldName("z"),n.addDouble(t.getZ(),s)),i&&(n.addFieldName("m"),n.addDouble(t.getM(),s)),a&&(n.addFieldName("id"),n.addInt32(t.getID()))}(e,t,a);break;case r.G.enumEnvelope:!function(e,t,n){const r=t.hasAttribute(1)&&!(2&e),i=t.hasAttribute(2)&&!(4&e),a=t.hasAttribute(3)&&!(8&e);if(t.isEmpty())return n.addFieldName("xmin"),n.addNull(),n.addFieldName("ymin"),n.addNull(),n.addFieldName("xmax"),n.addNull(),n.addFieldName("ymax"),n.addNull(),r&&(n.addFieldName("zmin"),n.addNull(),n.addFieldName("zmax"),n.addNull()),i&&(n.addFieldName("mmin"),n.addNull(),n.addFieldName("mmax"),n.addNull()),void(a&&(n.addFieldName("idmin"),n.addInt32(0),n.addFieldName("idmax"),n.addInt32(0)));const s=17-(31&e>>13);if(n.addFieldName("xmin"),n.addDouble(t.getXMin(),s),n.addFieldName("ymin"),n.addDouble(t.getYMin(),s),n.addFieldName("xmax"),n.addDouble(t.getXMax(),s),n.addFieldName("ymax"),n.addDouble(t.getYMax(),s),r){const e=t.queryInterval(1,0);n.addFieldName("zmin"),n.addDouble(e.vmin,s),n.addFieldName("zmax"),n.addDouble(e.vmax,s)}if(i){const e=t.queryInterval(2,0);n.addFieldName("mmin"),n.addDouble(e.vmin,s),n.addFieldName("mmax"),n.addDouble(e.vmax,s)}if(a){const e=t.queryInterval(3,0);n.addFieldName("idmin"),n.addInt32(e.vmin),n.addFieldName("idmax"),n.addInt32(e.vmax)}}(e,t,a);break;case r.G.enumMultipatch:(0,r.b)(0);break;default:(0,r.p)("exportToJSON")}null!==n&&(a.addFieldName("spatialReference"),function(e,t,n){n.startObject();let a=0;t.isCustomWkid()||(a=t.getOldID());let s=0;const o=t.getVCS();if(null!==o&&(o.isCustomWkid()||(s=o.getOldID()),s<=0&&(a=0)),a>0){n.addFieldName("wkid"),n.addInt32(a);const e=t.getLatestID();if(e>0&&e!==a&&(n.addFieldName("latestWkid"),n.addInt32(e)),s>0){n.addFieldName("vcsWkid"),n.addInt32(s);const e=t.getLatestVerticalID();e!==s&&(n.addFieldName("latestVcsWkid"),n.addInt32(e))}}if(0===t.getCoordinateSystemType())n.addFieldName("wkid"),n.addNull(),null!==t.getUnit()&&(n.addFieldName("unit"),function(e,t,n){n.startObject();const i=t.getID();i<=0&&(0,r.a)("cannot export unit that has no valid WKID"),n.addFieldName("uwkid"),n.addInt32(i),n.endObject()}(0,t.getUnit(),n));else if(a<=0||1&e){let r="";64&e&&(r=t.getText2(),n.addFieldName("wkt2"),n.addString(r));const i=t.getText();i!==r&&(n.addFieldName("wkt"),n.addString(i))}if(16&e){const e=new i.ba;t.queryPrecisionDescriptor(e),n.addFieldName("xyTolerance"),n.addDouble(e.getTolerance(0)),n.addFieldName("zTolerance"),n.addDouble(e.getTolerance(1)),n.addFieldName("mTolerance"),n.addDouble(e.getTolerance(2)),n.addFieldName("falseX"),n.addDouble(e.getFalseX()),n.addFieldName("falseY"),n.addDouble(e.getFalseY()),n.addFieldName("xyUnits"),n.addDouble(e.getGridUnitsXY()),n.addFieldName("falseZ"),n.addDouble(e.getFalseZ()),n.addFieldName("zUnits"),n.addDouble(e.getGridUnitsZ()),n.addFieldName("falseM"),n.addDouble(e.getFalseM()),n.addFieldName("mUnits"),n.addDouble(e.getGridUnitsM())}n.endObject()}(e,n,a)),a.endObject()}}(e,t,n,a)}exportSpatialReference(e,t,n,i){(0,r.b)(0)}exportProjectionTransformation(e,t,n,i){(0,r.b)(0)}exportDatumTransformation(e,t,n,i){(0,r.b)(0)}static geometryTypeToString(e){return(0,r.b)(0),""}},ie=new class{getOperatorType(){return 10404}accelerateGeometry(e,t,n){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,t,n,s,o,u,m){let l;"string"==typeof n?(l=new te({jsonString:n}),l.nextToken()):l=n,1!==l.currentToken()&&(0,r.a)("failed to import map geometry: start of object is expected");const c=function(e,t,n,s,o){let u=!1,m=!1,l=!1,c=!1,k=!1,y=!1,N=!1,T=!1,g=!1,v=!1,x=!1,A=!1,S=!1,w=!1,C=!1,D=!1,F=!1,j=!1,I=!1,O=!1,z=!1,E=!1,P=!1,G=!1,B=Number.NaN,V=Number.NaN,M=Number.NaN,R=Number.NaN,U=0,W=Number.NaN,X=Number.NaN,L=Number.NaN,Y=Number.NaN,K=Number.NaN,q=Number.NaN,Z=Number.NaN,J=Number.NaN,H=0,Q=0,$=!1,ee=!1,te=null,ne=null,re=null,ie=null,ae=null;for(;3!==n.nextToken();){const t=n.currentString();if(n.nextToken(),"spatialReference"===t){if(o&&!u){u=!0,1===n.currentToken()?ie=d(n):10!==n.currentToken()&&(0,r.a)("failed to parse spatial reference: object or null is expected");continue}}else if(s)if("hasZ"===t){if(!m){m=!0,$=11===n.currentToken();continue}}else if("hasM"===t){if(!l){l=!0,ee=11===n.currentToken();continue}}else if("rings"===t){if(!(k||y||e!==r.G.enumUnknown&&e!==r.G.enumPolygon)){k=!0,({geometry:ae,as:te,bs:ne}=h(!0,!1,0,n));continue}}else if("curveRings"===t){if(!y&&(e===r.G.enumUnknown||e===r.G.enumPolygon)){y=!0,({geometry:ae,as:te,bs:ne}=h(!0,!0,0,n));continue}}else if("paths"===t){if(!(N||T||e!==r.G.enumUnknown&&e!==r.G.enumPolyline)){N=!0,({geometry:ae,as:te,bs:ne}=h(!1,!1,0,n));continue}}else if("curvePaths"===t){if(!T&&(e===r.G.enumUnknown||e===r.G.enumPolyline)){T=!0,({geometry:ae,as:te,bs:ne}=h(!1,!0,0,n));continue}}else if("points"===t){if(!g&&(e===r.G.enumUnknown||e===r.G.enumMultiPoint)){g=!0,({geometry:ae,as:te,bs:ne}=_(0,n));continue}}else if("ids"===t){if(!c){c=!0,re=p(0,n);continue}}else if("x"===t){if(!v&&(e===r.G.enumUnknown||e===r.G.enumPoint)){v=!0,B=f(n);continue}}else if("y"===t){if(!x&&(e===r.G.enumUnknown||e===r.G.enumPoint)){x=!0,V=f(n);continue}}else if("z"===t){if(!A&&(e===r.G.enumUnknown||e===r.G.enumPoint)){A=!0,M=f(n);continue}}else if("m"===t){if(!S&&(e===r.G.enumUnknown||e===r.G.enumPoint)){S=!0,R=f(n);continue}}else if("id"===t){if(!w&&(e===r.G.enumUnknown||e===r.G.enumPoint)){w=!0,U=b(n);continue}}else if("xmin"===t){if(!C&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){C=!0,W=f(n);continue}}else if("ymin"===t){if(!D&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){D=!0,X=f(n);continue}}else if("mmin"===t){if(!z&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){z=!0,Z=f(n);continue}}else if("zmin"===t){if(!I&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){I=!0,K=f(n);continue}}else if("idmin"===t){if(!P&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){P=!0,H=b(n);continue}}else if("xmax"===t){if(!F&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){F=!0,L=f(n);continue}}else if("ymax"===t){if(!j&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){j=!0,Y=f(n);continue}}else if("mmax"===t){if(!E&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){E=!0,J=f(n);continue}}else if("zmax"===t){if(!O&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){O=!0,q=f(n);continue}}else if("idmax"===t){if(!G&&(e===r.G.enumUnknown||e===r.G.enumEnvelope)){G=!0,Q=b(n);continue}}else"materials"===t&&(0,r.b)(0);n.skipChildren()}if(k||y||N||T||g){let e=null,t=null;const n=ae;$&&(ae.addAttribute(1),e=te,e||(e=(0,a.j)(n.getPointCount(),Number.NaN))),ee&&(ae.addAttribute(2),t=$?ne:te),null!=re&&ae.addAttribute(3),$&&null!=e&&n.setAttributeStreamRef(1,e),ee&&null!=t&&n.setAttributeStreamRef(2,t),null!=re&&function(e,t){if(e.isEmpty())return;const n=(0,a.o)(2,0),s=e.getGeometryType();let o=0;s===i.M.type?o=1:s===i.b.type||s===i.P.type?o=e.getPathCount():(0,r.p)("not implemented"),n.resize(e.getPointCount(),0);let u=0;for(let a=0;a<o;++a){const o=t.read(u);u++;const m=u+o;let l=0,c=0;s===i.M.type?l=e.getPointCount():s===i.b.type||s===i.P.type?(l=e.getPathSize(a),c=e.getPathStart(a)):(0,r.p)("not implemented");for(let e=0,r=Math.min(o,l);e<r;++e)n.write(c,t.read(u)),u++,c++;u=m}e.getImpl().setAttributeStreamRef(3,n)}(n,re)}else if(v||x||S||A||w){(0,a.k)(B,V)||(0,r.a)("failed to parse point: x and y must be finite or nan"),(Number.isNaN(V)||Number.isNaN(B))&&(B=Number.NaN,V=Number.NaN);const e=new a.P({x:B,y:V});A&&e.setZ(M),S&&e.setM(R),w&&e.setID(U),ae=e}else if(C||D||F||j||I||O||z||E||P||G){(Number.isNaN(X)||Number.isNaN(L)||Number.isNaN(Y))&&(W=Number.NaN);const e=new a.E({xmin:W,ymin:X,xmax:L,ymax:Y});I&&O&&e.setInterval(1,0,K,q),z&&E&&e.setInterval(2,0,Z,J),P&&G&&e.setInterval(3,0,H,Q),ae=e}return{...ae?{geom:ae}:{},...ie?{sr:ie}:{}}}(t,0,l,s,o);return new i.bi(c)}importSpatialReference(e){const t=d(e);return null===t&&(0,r.p)("failed to import spatial reference"),t}importProjectionTransformation(e,t){return(0,r.b)(0),{}}importDatumTransformation(e,t){return(0,r.b)(0),{}}static stringToGeometryType(e){return(e=e.toLowerCase()).startsWith("esrigeometry")||(0,r.a)("string_to_geometry_type"),e.endsWith("point")?r.G.enumPoint:e.endsWith("envelope")?r.G.enumEnvelope:e.endsWith("multipoint")?r.G.enumMultiPoint:e.endsWith("polyline")?r.G.enumPolyline:e.endsWith("polygon")?r.G.enumPolygon:void(0,r.a)("string_to_geometry_type")}};function ae(e){return Array.isArray(e)?e[0].spatialReference:e.spatialReference}function se(e,t){const n=new m(e,{strict:!1});return n.nextToken(),ie.execute(0,r.G.enumUnknown,n,!0,t)}function oe(e){let t=null;return[e.map(e=>{if(null==t){const n=ue(e);return t=n.getSpatialReference(),n.getGeometry()}return me(e)}),t]}function ue(e){return se(e,!0)}function me(e){return se(e,!1).getGeometry()}function le(e,t){return e instanceof i.bi&&(t=e.getSpatialReference(),e=e.getGeometry()),e?.isEmpty()?null:(ne.reset(),re.execute(0,e,t,ne),ne.getObject())}}}]);