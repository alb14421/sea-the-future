/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{L as t}from"../../../chunks/Logger.js";import{g as r,a as e,h as n,i as s,j as o,k as i,l as a,m as c,n as u,o as p,e as f}from"../../../chunks/ensureType.js";import{g as l}from"../../../chunks/get.js";import{g,m}from"../../../chunks/metadata.js";import y from"../../Error.js";import{h as d}from"../../lang.js";import"../../../config.js";import"../../../chunks/object.js";import"../../../chunks/string.js";import"../../../chunks/MapUtils.js";import"../../../chunks/utils.js";import"../../../chunks/handleUtils.js";function h(t,r,e){if(t&&r)if("object"==typeof r)for(const e of Object.getOwnPropertyNames(r))h(t,e,r[e]);else{if(r.includes(".")){const n=r.split("."),s=n.splice(-1,1)[0];return void h(l(t,n),s,e)}const n=t.__accessor__;null!=n&&function(t,r){if(d("esri-unknown-property-errors")&&!function(t,r){return null!=r.metadata[t]}(t,r))throw new y("set:unknown-property",function(t,r){return"setting unknown property '"+t+"' on instance of "+r.host.declaredClass}(t,r))}(r,n),t[r]=e}}function j(y={}){return(d,j)=>{if(d===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${d.name}.${j}. Accessor does not support static properties.`);const k=Object.getOwnPropertyDescriptor(d,j),v=g(d,j);k&&(k.get||k.set?(v.get=k.get||v.get,v.set=k.set||v.set):"value"in k&&("value"in y&&t.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${j}" on "${d.constructor.name}" already defined in the metadata`,y),v.value=y.value=k.value)),null!=y.readOnly&&(v.readOnly=y.readOnly);const O=y.aliasOf;if(O){const t="string"==typeof O?O:O.source,r="string"==typeof O?null:!0===O.overridable;let e;v.dependsOn=[t],v.get=function(){let r=l(this,t);if("function"==typeof r){e||(e=t.split(".").slice(0,-1).join("."));const n=l(this,e);n&&(r=r.bind(n))}return r},v.readOnly||(v.set=r?function(t){this._override(j,t)}:function(r){h(this,t,r)})}const b=y.type,A=y.types;if(!v.cast){let t;b?t=function(t){let r=0,e=t;if(s(t))return o(t);for(;Array.isArray(e)&&1===e.length&&"string"!=typeof e[0]&&"number"!=typeof e[0];)e=e[0],r++;const n=e;if(i(n))return 0===r?a(n):c(a(n),r);if(1===r)return u(n);if(r>1)return p(n,r);const l=t;return l.from?l.from:f(l)}(b):A&&(t=Array.isArray(A)?r(e(A[0])):e(A)),y.cast=w(y.cast,t)}m(v,y),y.range&&(v.cast=n(v.cast,y.range))}}function k(t,r,e){const n=g(t,e);n.json||(n.json={});let s=n.json;return void 0!==r&&(s.origins||(s.origins={}),s.origins[r]||(s.origins[r]={}),s=s.origins[r]),s}function w(t,r){if(t||r)return t?r?(e,n)=>r(t(e,n),n):t:r}export{w as composeCasters,j as property,k as propertyJSONMeta,h as s};
