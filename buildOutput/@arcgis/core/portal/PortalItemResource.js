/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import r from"../core/Accessor.js";import e from"../core/Error.js";import{L as s}from"../chunks/Logger.js";import{isAbsolute as o,makeRelative as p}from"../core/urlUtils.js";import{property as i}from"../core/accessorSupport/decorators/property.js";import{cast as a}from"../core/accessorSupport/decorators/cast.js";import"../core/lang.js";import{subclass as l}from"../core/accessorSupport/decorators/subclass.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/Lifecycle.js";import"../chunks/metadata.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/tracking.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../core/promiseUtils.js";import"../chunks/events.js";import"../chunks/SetUtils.js";import"../chunks/SimpleTrackingTarget.js";import"../chunks/object.js";import"../config.js";import"../chunks/string.js";import"../chunks/jsonUtils.js";import"../chunks/ensureType.js";import"../chunks/MapUtils.js";import"../chunks/Warning.js";let c=class extends r{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t?.portalItem&&t.path?{...t,path:n(t.path,t.portalItem)}:t}set path(t){null!=t&&o(t)?s.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}_castPath(t){return n(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(t="json",r){const s=this.cdnUrl;if(null==s)throw new e("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(s,{responseType:t,query:{token:this.portalItem.apiKey,_ts:r?.cacheBust?Date.now():null},signal:r?.signal})}async update(t,r){const{addOrUpdateResources:e}=await import("../chunks/resourceUtils.js");return await e(this.portalItem,[{resource:this,content:t,compress:r?.compress,access:r?.access}],"update",r),this}hasPath(){return null!=this.path}};function n(t,r){return null==t?t:(t=t.replace(/^\/+/,""),null!=r&&o(t)&&(t=p(t,r.itemUrl)),t?.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}t([i()],c.prototype,"portalItem",void 0),t([i({type:String,value:null})],c.prototype,"path",null),t([a("path")],c.prototype,"_castPath",null),t([i({type:String,readOnly:!0})],c.prototype,"url",null),t([i({type:String,readOnly:!0})],c.prototype,"cdnUrl",null),t([i({type:String,readOnly:!0})],c.prototype,"itemRelativeUrl",null),c=t([l("esri.portal.PortalItemResource")],c);export{c as default};
