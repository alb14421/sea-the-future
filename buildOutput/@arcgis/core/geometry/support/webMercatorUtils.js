/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{clone as s}from"../../core/lang.js";import t from"../../core/Error.js";import n from"../SpatialReference.js";import{x as r,a1 as e,p as i,j as o,i as p}from"../../chunks/unitUtils.js";import"../../chunks/Logger.js";import"../../config.js";import"../../chunks/object.js";import"../../chunks/string.js";import"../../chunks/tslib.es6.js";import"../../core/Accessor.js";import"../../core/Handles.js";import"../../chunks/maybe.js";import"../../core/accessorSupport/decorators/subclass.js";import"../../chunks/Lifecycle.js";import"../../chunks/metadata.js";import"../../chunks/utils.js";import"../../chunks/handleUtils.js";import"../../chunks/tracking.js";import"../../chunks/ensureType.js";import"../../chunks/MapUtils.js";import"../../chunks/Warning.js";import"../../chunks/get.js";import"../../chunks/ObjectPool.js";import"../../chunks/ObservableBase.js";import"../../core/accessorSupport/decorators/property.js";import"../../chunks/watch.js";import"../../core/scheduling.js";import"../../chunks/nextTick.js";import"../../chunks/PooledArray.js";import"../../core/promiseUtils.js";import"../../chunks/events.js";import"../../chunks/SetUtils.js";import"../../chunks/SimpleTrackingTarget.js";import"../../core/JSONSupport.js";import"../../chunks/writer.js";import"../../chunks/jsonMap.js";import"../../chunks/pe.js";import"../../chunks/assets.js";import"../../request.js";import"../../kernel.js";import"../../core/urlUtils.js";import"../../chunks/jsonUtils.js";import"../../chunks/persistableUrlUtils.js";function c(s){if(s&&"object"==typeof s&&"type"in s&&"mesh"===s.type)throw new t("internal:mesh","Mesh geometries are not supported for this operation")}function u(s){s.forEach(c)}function a(s){return 57.29577951308232*s}function h(s){return.017453292519943*s}function m(s){return s/r.radius}function l(s){return Math.PI/2-2*Math.atan(Math.exp(-s/r.radius))}function j(s){return null!=s.wkid||null!=s.wkt}const f=[0,0];function k(s,t,n,r,e){const i=s,o=e;if(o.spatialReference=n,"x"in i&&"x"in o)[o.x,o.y]=t(i.x,i.y,f,r);else if("xmin"in i&&"xmin"in o)[o.xmin,o.ymin]=t(i.xmin,i.ymin,f,r),[o.xmax,o.ymax]=t(i.xmax,i.ymax,f,r);else if("paths"in i&&"paths"in o||"rings"in i&&"rings"in o){const s="paths"in i?i.paths:i.rings,n=[];let e;for(let i=0;i<s.length;i++){const o=s[i];e=[],n.push(e);for(let s=0;s<o.length;s++)e.push(t(o[s][0],o[s][1],[0,0],r)),o[s].length>2&&e[s].push(o[s][2]),o[s].length>3&&e[s].push(o[s][3])}"paths"in o?o.paths=n:o.rings=n}else if("points"in i&&"points"in o){const s=i.points,n=[];for(let e=0;e<s.length;e++)n[e]=t(s[e][0],s[e][1],[0,0],r),s[e].length>2&&n[e].push(s[e][2]),s[e].length>3&&n[e].push(s[e][3]);o.points=n}return e}function g(s,t){const n=s&&(j(s)?s:s.spatialReference),r=t&&(j(t)?t:t.spatialReference);return!(s&&"type"in s&&"mesh"===s.type||t&&"type"in t&&"mesh"===t.type||!n||!r)&&(!!i(r,n)||o(r)&&p(n)||o(n)&&p(r))}function x(t,r){if(null==t)return null;const e=t.spatialReference,c=r&&(j(r)?r:r.spatialReference);return g(e,c)?i(e,c)?s(t):o(c)?k(t,y,n.WebMercator,!1,s(t)):p(c)?k(t,M,n.WGS84,!1,s(t)):null:null}function y(s,t,n=[0,0]){t>89.99999?t=89.99999:t<-89.99999&&(t=-89.99999);const e=h(t);return n[0]=h(s)*r.radius,n[1]=r.halfSemiMajorAxis*Math.log((1+Math.sin(e))/(1-Math.sin(e))),n}function M(s,t,n=[0,0],i=!1){if(s===e[0])n[0]=-180;else if(s===e[1])n[0]=180;else{const t=a(s/r.radius);n[0]=i?t:t-360*Math.floor((t+180)/360)}return n[1]=a(Math.PI/2-2*Math.atan(Math.exp(-t/r.radius))),n}function d(t,r=!1,e=s(t)){return c(t),c(e),k(t,y,n.WebMercator,r,e)}function b(t,r=!1,e=s(t)){return c(t),c(e),k(t,M,n.WGS84,r,e)}export{u as a,c as b,g as canProject,d as geographicToWebMercator,y as lngLatToXY,x as project,b as webMercatorToGeographic,m as x2lon,M as xyToLngLat,l as y2lat};
