/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{_ as s}from"../chunks/tslib.es6.js";import{c as e,Q as r,R as t,T as i,K as o,U as c}from"../chunks/unitUtils.js";import{property as n}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import"../chunks/Logger.js";import{subclass as p}from"../core/accessorSupport/decorators/subclass.js";import a from"./Point.js";import m from"./Polygon.js";import u from"./SpatialReference.js";import{directGeodeticSolver as h}from"./support/geodesicUtils.js";import{webMercatorToGeographic as l,geographicToWebMercator as j}from"./support/webMercatorUtils.js";import"../chunks/jsonMap.js";import"../chunks/object.js";import"../chunks/string.js";import"../chunks/pe.js";import"../chunks/assets.js";import"../config.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/Error.js";import"../chunks/jsonUtils.js";import"../chunks/MapUtils.js";import"../core/promiseUtils.js";import"../chunks/handleUtils.js";import"../chunks/events.js";import"../chunks/maybe.js";import"../chunks/persistableUrlUtils.js";import"../chunks/ensureType.js";import"../chunks/get.js";import"../chunks/utils.js";import"../chunks/metadata.js";import"../chunks/Lifecycle.js";import"../chunks/tracking.js";import"../chunks/Warning.js";import"../core/Accessor.js";import"../core/Handles.js";import"../chunks/ObjectPool.js";import"../chunks/ObservableBase.js";import"../chunks/watch.js";import"../core/scheduling.js";import"../chunks/nextTick.js";import"../chunks/PooledArray.js";import"../chunks/SetUtils.js";import"../chunks/SimpleTrackingTarget.js";import"../core/accessorSupport/decorators/cast.js";import"../chunks/reader.js";import"../chunks/writer.js";import"./Geometry.js";import"../core/JSONSupport.js";import"./Extent.js";import"../chunks/coordsUtils.js";import"../chunks/extentUtils.js";import"../chunks/boundsUtils.js";import"../chunks/aaBoundingRect.js";import"../chunks/mathUtils.js";import"../chunks/zmUtils.js";import"./Polyline.js";import"../chunks/geodesicConstants.js";var d;let k=d=class extends m{constructor(s){super(s),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){const s=this.center,n=this.numberOfPoints;if(this.hasZ=s?.hasZ??!1,0!==this.rings.length||!s)return;const p=e(this.radius,this.radiusUnit,"meters"),a=s.spatialReference;let m,u="geographic";if(a.isWebMercator?u="webMercator":(null!=(a.wkid&&r[a.wkid])||(a.wkt2||a.wkt)&&t(a.wkt2||a.wkt))&&(u="projected"),this.geodesic){let e;switch(u){case"webMercator":e=l(s);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":e=s}m=this._createGeodesicCircle(e,p,n),"webMercator"===u&&(m=j(m))}else{let e;"webMercator"===u||"projected"===u?e=p/i(s.spatialReference):"geographic"===u&&(e=o(p,"meters",c(s.spatialReference).radius)),m=this._createPlanarCircle(s,e,n)}this.spatialReference=m.spatialReference,this.addRing(m.rings[0])}clone(){const{center:s,numberOfPoints:e,radius:r,radiusUnit:t,geodesic:i}=this;return new d({center:s?.clone(),numberOfPoints:e,radius:r,radiusUnit:t,geodesic:i})}_createGeodesicCircle(s,e,r){const t=[],i=[s.x,s.y];for(let o=0;o<360;o+=360/r){const r=this.hasZ?[0,0,s.z??0]:[0,0];h(r,i,o,e,u.WGS84),t.push(r)}return t.push(t[0]),new m({rings:[t]})}_createPlanarCircle(s,e,r){const t=[],i=2*Math.PI/r;for(let o=0;o<r;++o){const r=i*o,c=[s.x+Math.cos(-r)*e,s.y+Math.sin(-r)*e];this.hasZ&&c.push(s.z??0),t.push(c)}return t.push(t[0]),new m({spatialReference:s.spatialReference,rings:[t]})}};s([n({type:a})],k.prototype,"center",void 0),s([n()],k.prototype,"geodesic",void 0),s([n()],k.prototype,"numberOfPoints",void 0),s([n()],k.prototype,"radius",void 0),s([n()],k.prototype,"radiusUnit",void 0),k=d=s([p("esri.geometry.Circle")],k);export{k as default};
